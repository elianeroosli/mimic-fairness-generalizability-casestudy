TRAINING THE CHANNEL-WISE LSTM with augmented data
/share/pi/boussard/eroosli_work/benchmarking/models/ihm/main.py:10: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Using TensorFlow backend.
2020-06-01 17:11:29.692350: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /share/sw/open/oracle/18.5.0.0/lib/:
2020-06-01 17:11:29.703197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /share/sw/open/oracle/18.5.0.0/lib/:
2020-06-01 17:11:29.703215: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
normalizer state: /share/pi/boussard/eroosli_work/benchmarking/models/ihm/ihm_ts1.0.input_str_previous.start_time_zero.normalizer
==> using model models/keras_models/channel_wise_lstms.py
94
==> not used params in network class: dict_keys(['batch_size', 'beta_1', 'data', 'data_name', 'epochs', 'imputation', 'l1', 'l2', 'load_state', 'lr', 'mode', 'network', 'normalizer_state', 'optimizer', 'output_dir', 'prefix', 'save_every', 'small_part', 'target_repl_coef', 'timestep', 'verbose'])
==> excluded demographics: 
==> found 20 channels: ['Capillary refill rate', 'Diastolic blood pressure', 'Ethnicity', 'Fraction inspired oxygen', 'Gender', 'Glascow coma scale eye opening', 'Glascow coma scale motor response', 'Glascow coma scale total', 'Glascow coma scale verbal response', 'Glucose', 'Heart rate', 'Height', 'Insurance', 'Mean blood pressure', 'Oxygen saturation', 'Respiratory rate', 'Systolic blood pressure', 'Temperature', 'Weight', 'pH']
2020-06-01 17:11:33.834108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /share/sw/open/oracle/18.5.0.0/lib/:
2020-06-01 17:11:33.834136: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-06-01 17:11:33.834155: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (slurm-compute-c64xj): /proc/driver/nvidia/version does not exist
2020-06-01 17:11:33.834319: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-06-01 17:11:33.840714: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2020-06-01 17:11:33.840968: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5594226f4c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-06-01 17:11:33.840995: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
==> model.final_name: 2020-06-01_10-11.k_clstms.none
==> compiling the model
Model: "network_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
X (InputLayer)                  (None, None, 94)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, None, 94)     0           X[0][0]                          
__________________________________________________________________________________________________
slice_1 (Slice)                 (None, None, 3)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_2 (Slice)                 (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_3 (Slice)                 (None, None, 6)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_4 (Slice)                 (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_5 (Slice)                 (None, None, 5)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_6 (Slice)                 (None, None, 9)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_7 (Slice)                 (None, None, 13)     0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_8 (Slice)                 (None, None, 14)     0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_9 (Slice)                 (None, None, 13)     0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_10 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_11 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_12 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_13 (Slice)                (None, None, 7)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_14 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_15 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_16 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_17 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_18 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_19 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
slice_20 (Slice)                (None, None, 2)      0           masking_1[0][0]                  
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, None, 8)      256         slice_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, None, 8)      224         slice_2[0][0]                    
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, None, 8)      352         slice_3[0][0]                    
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, None, 8)      224         slice_4[0][0]                    
__________________________________________________________________________________________________
bidirectional_5 (Bidirectional) (None, None, 8)      320         slice_5[0][0]                    
__________________________________________________________________________________________________
bidirectional_6 (Bidirectional) (None, None, 8)      448         slice_6[0][0]                    
__________________________________________________________________________________________________
bidirectional_7 (Bidirectional) (None, None, 8)      576         slice_7[0][0]                    
__________________________________________________________________________________________________
bidirectional_8 (Bidirectional) (None, None, 8)      608         slice_8[0][0]                    
__________________________________________________________________________________________________
bidirectional_9 (Bidirectional) (None, None, 8)      576         slice_9[0][0]                    
__________________________________________________________________________________________________
bidirectional_10 (Bidirectional (None, None, 8)      224         slice_10[0][0]                   
__________________________________________________________________________________________________
bidirectional_11 (Bidirectional (None, None, 8)      224         slice_11[0][0]                   
__________________________________________________________________________________________________
bidirectional_12 (Bidirectional (None, None, 8)      224         slice_12[0][0]                   
__________________________________________________________________________________________________
bidirectional_13 (Bidirectional (None, None, 8)      384         slice_13[0][0]                   
__________________________________________________________________________________________________
bidirectional_14 (Bidirectional (None, None, 8)      224         slice_14[0][0]                   
__________________________________________________________________________________________________
bidirectional_15 (Bidirectional (None, None, 8)      224         slice_15[0][0]                   
__________________________________________________________________________________________________
bidirectional_16 (Bidirectional (None, None, 8)      224         slice_16[0][0]                   
__________________________________________________________________________________________________
bidirectional_17 (Bidirectional (None, None, 8)      224         slice_17[0][0]                   
__________________________________________________________________________________________________
bidirectional_18 (Bidirectional (None, None, 8)      224         slice_18[0][0]                   
__________________________________________________________________________________________________
bidirectional_19 (Bidirectional (None, None, 8)      224         slice_19[0][0]                   
__________________________________________________________________________________________________
bidirectional_20 (Bidirectional (None, None, 8)      224         slice_20[0][0]                   
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, None, 160)    0           bidirectional_1[0][0]            
                                                                 bidirectional_2[0][0]            
                                                                 bidirectional_3[0][0]            
                                                                 bidirectional_4[0][0]            
                                                                 bidirectional_5[0][0]            
                                                                 bidirectional_6[0][0]            
                                                                 bidirectional_7[0][0]            
                                                                 bidirectional_8[0][0]            
                                                                 bidirectional_9[0][0]            
                                                                 bidirectional_10[0][0]           
                                                                 bidirectional_11[0][0]           
                                                                 bidirectional_12[0][0]           
                                                                 bidirectional_13[0][0]           
                                                                 bidirectional_14[0][0]           
                                                                 bidirectional_15[0][0]           
                                                                 bidirectional_16[0][0]           
                                                                 bidirectional_17[0][0]           
                                                                 bidirectional_18[0][0]           
                                                                 bidirectional_19[0][0]           
                                                                 bidirectional_20[0][0]           
__________________________________________________________________________________________________
lstm_21 (LSTM)                  (None, 32)           24704       concatenate_1[0][0]              
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32)           0           lstm_21[0][0]                    
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            33          dropout_1[0][0]                  
==================================================================================================
Total params: 30,945
Trainable params: 30,945
Non-trainable params: 0
__________________________________________________________________________________________________
==> training
Train on 4628 samples, validate on 817 samples
Epoch 1/100
 - 312s - loss: 0.3218 - val_loss: 0.2846

==>predicting on train



confusion matrix:
[[2150    5]
 [ 241   14]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.12262800335884094
difference in average predicted and observed risk = 0.016819003358840942
number samples = 2410
accuracy = 0.897925
precision class 0 = 0.899205
precision class 1 = 0.736842
recall class 0 = 0.99768
recall class 1 = 0.054902
false negative rate = 0.945098
false positive rate = 0.00232
positive prediction rate = 0.007884
AUC of ROC = 0.719414
AUC of PRC = 0.327784
min(+P, Se) = 0.339844

-------------------------------

confusion matrix:
[[1176    3]
 [ 115    3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.11285500228404999
difference in average predicted and observed risk = 0.021876002284049983
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.910922
precision class 1 = 0.5
recall class 0 = 0.997455
recall class 1 = 0.025424
false negative rate = 0.974576
false positive rate = 0.002545
positive prediction rate = 0.004626
AUC of ROC = 0.763589
AUC of PRC = 0.256269
min(+P, Se) = 0.319328

-------------------------------

confusion matrix:
[[654   2]
 [ 65   9]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.13727399706840515
difference in average predicted and observed risk = 0.03590399706840515
number samples = 730
accuracy = 0.908219
precision class 0 = 0.909597
precision class 1 = 0.818182
recall class 0 = 0.996951
recall class 1 = 0.121622
false negative rate = 0.878378
false positive rate = 0.003049
positive prediction rate = 0.015068
AUC of ROC = 0.702332
AUC of PRC = 0.290397
min(+P, Se) = 0.337838

-------------------------------

confusion matrix:
[[167   0]
 [ 22   2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1234230026602745
difference in average predicted and observed risk = -0.0022309973397254823
number samples = 191
accuracy = 0.884817
precision class 0 = 0.883598
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.083333
false negative rate = 0.916667
false positive rate = 0.0
positive prediction rate = 0.010471
AUC of ROC = 0.837076
AUC of PRC = 0.634504
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[2465    9]
 [ 242   13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.11911699920892715
difference in average predicted and observed risk = 0.025675999208927158
number samples = 2729
accuracy = 0.908025
precision class 0 = 0.910602
precision class 1 = 0.590909
recall class 0 = 0.996362
recall class 1 = 0.05098
false negative rate = 0.94902
false positive rate = 0.003638
positive prediction rate = 0.008062
AUC of ROC = 0.713808
AUC of PRC = 0.273301
min(+P, Se) = 0.321569

-------------------------------

confusion matrix:
[[1682    1]
 [ 201   15]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1267089992761612
difference in average predicted and observed risk = 0.012964999276161196
number samples = 1899
accuracy = 0.893628
precision class 0 = 0.893255
precision class 1 = 0.9375
recall class 0 = 0.999406
recall class 1 = 0.069444
false negative rate = 0.930556
false positive rate = 0.000594
positive prediction rate = 0.008425
AUC of ROC = 0.759067
AUC of PRC = 0.37414
min(+P, Se) = 0.37037

-------------------------------

confusion matrix:
[[546   3]
 [ 75   2]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1292790025472641
difference in average predicted and observed risk = 0.006276002547264098
number samples = 626
accuracy = 0.875399
precision class 0 = 0.879227
precision class 1 = 0.4
recall class 0 = 0.994536
recall class 1 = 0.025974
false negative rate = 0.974026
false positive rate = 0.005464
positive prediction rate = 0.007987
AUC of ROC = 0.718544
AUC of PRC = 0.280428
min(+P, Se) = 0.311688

-------------------------------

confusion matrix:
[[2249    0]
 [ 203    5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.11098600178956985
difference in average predicted and observed risk = 0.02633000178956986
number samples = 2457
accuracy = 0.917379
precision class 0 = 0.91721
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.024038
false negative rate = 0.975962
false positive rate = 0.0
positive prediction rate = 0.002035
AUC of ROC = 0.713903
AUC of PRC = 0.252663
min(+P, Se) = 0.278846

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11757499724626541
difference in average predicted and observed risk = 0.016768997246265405
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.673004
AUC of PRC = 0.191383
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[477   4]
 [ 67  15]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14800499379634857
difference in average predicted and observed risk = 0.002356993796348572
number samples = 563
accuracy = 0.87389
precision class 0 = 0.876838
precision class 1 = 0.789474
recall class 0 = 0.991684
recall class 1 = 0.182927
false negative rate = 0.817073
false positive rate = 0.008316
positive prediction rate = 0.033748
AUC of ROC = 0.775721
AUC of PRC = 0.495794
min(+P, Se) = 0.487805

-------------------------------

confusion matrix:
[[653   2]
 [ 73   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.135671004652977
difference in average predicted and observed risk = 0.028042004652976987
number samples = 734
accuracy = 0.89782
precision class 0 = 0.899449
precision class 1 = 0.75
recall class 0 = 0.996947
recall class 1 = 0.075949
false negative rate = 0.924051
false positive rate = 0.003053
positive prediction rate = 0.010899
AUC of ROC = 0.771495
AUC of PRC = 0.381992
min(+P, Se) = 0.376471

-------------------------------

confusion matrix:
[[4147   10]
 [ 443   28]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.12223199754953384
difference in average predicted and observed risk = 0.020459997549533843
number samples = 4628
accuracy = 0.902118
precision class 0 = 0.903486
precision class 1 = 0.736842
recall class 0 = 0.997594
recall class 1 = 0.059448
false negative rate = 0.940552
false positive rate = 0.002406
positive prediction rate = 0.008211
AUC of ROC = 0.734402
AUC of PRC = 0.313739
min(+P, Se) = 0.343949

-------------------------------

==>predicting on validation



confusion matrix:
[[218   0]
 [ 18   1]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.11196699738502502
difference in average predicted and observed risk = 0.03179799738502502
number samples = 237
accuracy = 0.924051
precision class 0 = 0.923729
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.0
positive prediction rate = 0.004219
AUC of ROC = 0.833655
AUC of PRC = 0.339249
min(+P, Se) = 0.409091

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.12452500313520432
difference in average predicted and observed risk = 0.01572900313520431
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.724123
AUC of PRC = 0.345018
min(+P, Se) = 0.382979

-------------------------------

confusion matrix:
[[105   0]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.14285799860954285
difference in average predicted and observed risk = 0.032688998609542844
number samples = 118
accuracy = 0.90678
precision class 0 = 0.905172
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.0
positive prediction rate = 0.016949
AUC of ROC = 0.834432
AUC of PRC = 0.529611
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[26  0]
 [ 3  1]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13603399693965912
difference in average predicted and observed risk = 0.0027009969396591116
number samples = 30
accuracy = 0.9
precision class 0 = 0.896552
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.033333
AUC of ROC = 0.951923
AUC of PRC = 0.793155
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[300   0]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.13085399568080902
difference in average predicted and observed risk = 0.015809995680809028
number samples = 339
accuracy = 0.887906
precision class 0 = 0.887574
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.0
positive prediction rate = 0.00295
AUC of ROC = 0.73906
AUC of PRC = 0.278502
min(+P, Se) = 0.346154

-------------------------------

confusion matrix:
[[434   0]
 [ 38   6]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.11905799806118011
difference in average predicted and observed risk = 0.027007998061180108
number samples = 478
accuracy = 0.920502
precision class 0 = 0.919492
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.136364
false negative rate = 0.863636
false positive rate = 0.0
positive prediction rate = 0.012552
AUC of ROC = 0.820643
AUC of PRC = 0.486011
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[388   0]
 [ 36   2]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.11353799700737
difference in average predicted and observed risk = 0.02433599700736999
number samples = 426
accuracy = 0.915493
precision class 0 = 0.915094
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.0
positive prediction rate = 0.004695
AUC of ROC = 0.776316
AUC of PRC = 0.365281
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.145579993724823
difference in average predicted and observed risk = 0.027932993724822996
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.911111
AUC of PRC = 0.62943
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[113   0]
 [ 11   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1257539987564087
difference in average predicted and observed risk = 0.037043998756408694
number samples = 124
accuracy = 0.91129
precision class 0 = 0.91129
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.685438
AUC of PRC = 0.144011
min(+P, Se) = 0.230769

-------------------------------

confusion matrix:
[[108   0]
 [ 17   2]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.13360799849033356
difference in average predicted and observed risk = -0.015998001509666432
number samples = 127
accuracy = 0.866142
precision class 0 = 0.864
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.015748
AUC of ROC = 0.763645
AUC of PRC = 0.513069
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1445000022649765
difference in average predicted and observed risk = 0.0655530022649765
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.349747
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[734   0]
 [ 76   7]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1239520013332367
difference in average predicted and observed risk = 0.022361001333236694
number samples = 817
accuracy = 0.906977
precision class 0 = 0.906173
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.084337
false negative rate = 0.915663
false positive rate = 0.0
positive prediction rate = 0.008568
AUC of ROC = 0.788139
AUC of PRC = 0.402116
min(+P, Se) = 0.397849

-------------------------------

Epoch 00001: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch1.state
Epoch 2/100
 - 305s - loss: 0.3056 - val_loss: 0.2743

==>predicting on train



confusion matrix:
[[2145   10]
 [ 230   25]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10064899921417236
difference in average predicted and observed risk = -0.005160000785827637
number samples = 2410
accuracy = 0.900415
precision class 0 = 0.903158
precision class 1 = 0.714286
recall class 0 = 0.99536
recall class 1 = 0.098039
false negative rate = 0.901961
false positive rate = 0.00464
positive prediction rate = 0.014523
AUC of ROC = 0.732252
AUC of PRC = 0.344274
min(+P, Se) = 0.368627

-------------------------------

confusion matrix:
[[1167   12]
 [ 111    7]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09778399765491486
difference in average predicted and observed risk = 0.006804997654914852
number samples = 1297
accuracy = 0.905166
precision class 0 = 0.913146
precision class 1 = 0.368421
recall class 0 = 0.989822
recall class 1 = 0.059322
false negative rate = 0.940678
false positive rate = 0.010178
positive prediction rate = 0.014649
AUC of ROC = 0.765242
AUC of PRC = 0.266601
min(+P, Se) = 0.327731

-------------------------------

confusion matrix:
[[652   4]
 [ 64  10]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11289100348949432
difference in average predicted and observed risk = 0.011521003489494322
number samples = 730
accuracy = 0.906849
precision class 0 = 0.910615
precision class 1 = 0.714286
recall class 0 = 0.993902
recall class 1 = 0.135135
false negative rate = 0.864865
false positive rate = 0.006098
positive prediction rate = 0.019178
AUC of ROC = 0.712838
AUC of PRC = 0.32432
min(+P, Se) = 0.337838

-------------------------------

confusion matrix:
[[166   1]
 [ 20   4]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1041489988565445
difference in average predicted and observed risk = -0.021505001143455493
number samples = 191
accuracy = 0.890052
precision class 0 = 0.892473
precision class 1 = 0.8
recall class 0 = 0.994012
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.005988
positive prediction rate = 0.026178
AUC of ROC = 0.840319
AUC of PRC = 0.643049
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[2454   20]
 [ 232   23]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09795600175857544
difference in average predicted and observed risk = 0.004515001758575443
number samples = 2729
accuracy = 0.907658
precision class 0 = 0.913626
precision class 1 = 0.534884
recall class 0 = 0.991916
recall class 1 = 0.090196
false negative rate = 0.909804
false positive rate = 0.008084
positive prediction rate = 0.015757
AUC of ROC = 0.723701
AUC of PRC = 0.286452
min(+P, Se) = 0.329502

-------------------------------

confusion matrix:
[[1676    7]
 [ 193   23]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10762099921703339
difference in average predicted and observed risk = -0.006123000782966612
number samples = 1899
accuracy = 0.894681
precision class 0 = 0.896736
precision class 1 = 0.766667
recall class 0 = 0.995841
recall class 1 = 0.106481
false negative rate = 0.893519
false positive rate = 0.004159
positive prediction rate = 0.015798
AUC of ROC = 0.773839
AUC of PRC = 0.383154
min(+P, Se) = 0.388889

-------------------------------

confusion matrix:
[[543   6]
 [ 75   2]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10760200023651123
difference in average predicted and observed risk = -0.01540099976348877
number samples = 626
accuracy = 0.870607
precision class 0 = 0.878641
precision class 1 = 0.25
recall class 0 = 0.989071
recall class 1 = 0.025974
false negative rate = 0.974026
false positive rate = 0.010929
positive prediction rate = 0.01278
AUC of ROC = 0.727154
AUC of PRC = 0.293254
min(+P, Se) = 0.324675

-------------------------------

confusion matrix:
[[2243    6]
 [ 198   10]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09129200130701065
difference in average predicted and observed risk = 0.0066360013070106555
number samples = 2457
accuracy = 0.916972
precision class 0 = 0.918886
precision class 1 = 0.625
recall class 0 = 0.997332
recall class 1 = 0.048077
false negative rate = 0.951923
false positive rate = 0.002668
positive prediction rate = 0.006512
AUC of ROC = 0.725547
AUC of PRC = 0.265556
min(+P, Se) = 0.287081

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09754899889230728
difference in average predicted and observed risk = -0.0032570011076927252
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.679103
AUC of PRC = 0.197395
min(+P, Se) = 0.296296

-------------------------------

confusion matrix:
[[475   6]
 [ 61  21]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12918800115585327
difference in average predicted and observed risk = -0.016459998844146728
number samples = 563
accuracy = 0.880995
precision class 0 = 0.886194
precision class 1 = 0.777778
recall class 0 = 0.987526
recall class 1 = 0.256098
false negative rate = 0.743902
false positive rate = 0.012474
positive prediction rate = 0.047957
AUC of ROC = 0.790426
AUC of PRC = 0.518601
min(+P, Se) = 0.512195

-------------------------------

confusion matrix:
[[650   5]
 [ 67  12]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11322499811649323
difference in average predicted and observed risk = 0.005595998116493223
number samples = 734
accuracy = 0.901907
precision class 0 = 0.906555
precision class 1 = 0.705882
recall class 0 = 0.992366
recall class 1 = 0.151899
false negative rate = 0.848101
false positive rate = 0.007634
positive prediction rate = 0.023161
AUC of ROC = 0.779283
AUC of PRC = 0.368011
min(+P, Se) = 0.392405

-------------------------------

confusion matrix:
[[4130   27]
 [ 425   46]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10192199796438217
difference in average predicted and observed risk = 0.00014999796438217028
number samples = 4628
accuracy = 0.902334
precision class 0 = 0.906696
precision class 1 = 0.630137
recall class 0 = 0.993505
recall class 1 = 0.097665
false negative rate = 0.902335
false positive rate = 0.006495
positive prediction rate = 0.015774
AUC of ROC = 0.745723
AUC of PRC = 0.330504
min(+P, Se) = 0.360934

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09773500263690948
difference in average predicted and observed risk = 0.01756600263690948
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.848382
AUC of PRC = 0.367968
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10138600319623947
difference in average predicted and observed risk = -0.007409996803760532
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.732246
AUC of PRC = 0.352078
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[105   0]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1217309981584549
difference in average predicted and observed risk = 0.011561998158454892
number samples = 118
accuracy = 0.90678
precision class 0 = 0.905172
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.0
positive prediction rate = 0.016949
AUC of ROC = 0.863736
AUC of PRC = 0.562364
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11597099900245667
difference in average predicted and observed risk = -0.017362000997543342
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[299   1]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11242000013589859
difference in average predicted and observed risk = -0.0026239998641014034
number samples = 339
accuracy = 0.884956
precision class 0 = 0.88724
precision class 1 = 0.5
recall class 0 = 0.996667
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.003333
positive prediction rate = 0.0059
AUC of ROC = 0.760769
AUC of PRC = 0.310311
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09768799692392349
difference in average predicted and observed risk = 0.005637996923923486
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.828079
AUC of PRC = 0.495466
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09399499744176865
difference in average predicted and observed risk = 0.004792997441768643
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.791983
AUC of PRC = 0.388716
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1247439980506897
difference in average predicted and observed risk = 0.007096998050689696
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.92037
AUC of PRC = 0.629619
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10245200246572495
difference in average predicted and observed risk = 0.013742002465724948
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.722446
AUC of PRC = 0.170027
min(+P, Se) = 0.285714

-------------------------------

confusion matrix:
[[107   1]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11326300352811813
difference in average predicted and observed risk = -0.036342996471881855
number samples = 127
accuracy = 0.866142
precision class 0 = 0.869919
precision class 1 = 0.75
recall class 0 = 0.990741
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009259
positive prediction rate = 0.031496
AUC of ROC = 0.782164
AUC of PRC = 0.533772
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13029100000858307
difference in average predicted and observed risk = 0.051344000008583066
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.599747
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[732   2]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10380099713802338
difference in average predicted and observed risk = 0.0022099971380233757
number samples = 817
accuracy = 0.908201
precision class 0 = 0.909317
precision class 1 = 0.833333
recall class 0 = 0.997275
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.002725
positive prediction rate = 0.014688
AUC of ROC = 0.801287
AUC of PRC = 0.418728
min(+P, Se) = 0.448276

-------------------------------

Epoch 00002: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch2.state
Epoch 3/100
 - 304s - loss: 0.2965 - val_loss: 0.2696

==>predicting on train



confusion matrix:
[[2152    3]
 [ 241   14]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09031800180673599
difference in average predicted and observed risk = -0.015490998193264008
number samples = 2410
accuracy = 0.898755
precision class 0 = 0.89929
precision class 1 = 0.823529
recall class 0 = 0.998608
recall class 1 = 0.054902
false negative rate = 0.945098
false positive rate = 0.001392
positive prediction rate = 0.007054
AUC of ROC = 0.737577
AUC of PRC = 0.358819
min(+P, Se) = 0.378906

-------------------------------

confusion matrix:
[[1175    4]
 [ 116    2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09028699994087219
difference in average predicted and observed risk = -0.0006920000591278119
number samples = 1297
accuracy = 0.907479
precision class 0 = 0.910147
precision class 1 = 0.333333
recall class 0 = 0.996607
recall class 1 = 0.016949
false negative rate = 0.983051
false positive rate = 0.003393
positive prediction rate = 0.004626
AUC of ROC = 0.771445
AUC of PRC = 0.275534
min(+P, Se) = 0.330508

-------------------------------

confusion matrix:
[[656   0]
 [ 72   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10075099766254425
difference in average predicted and observed risk = -0.0006190023374557513
number samples = 730
accuracy = 0.90137
precision class 0 = 0.901099
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.027027
false negative rate = 0.972973
false positive rate = 0.0
positive prediction rate = 0.00274
AUC of ROC = 0.73043
AUC of PRC = 0.339438
min(+P, Se) = 0.376623

-------------------------------

confusion matrix:
[[167   0]
 [ 21   3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09623300284147263
difference in average predicted and observed risk = -0.029420997158527362
number samples = 191
accuracy = 0.890052
precision class 0 = 0.888298
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.125
false negative rate = 0.875
false positive rate = 0.0
positive prediction rate = 0.015707
AUC of ROC = 0.849301
AUC of PRC = 0.657106
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[2469    5]
 [ 247    8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08918199688196182
difference in average predicted and observed risk = -0.004259003118038174
number samples = 2729
accuracy = 0.907658
precision class 0 = 0.909057
precision class 1 = 0.615385
recall class 0 = 0.997979
recall class 1 = 0.031373
false negative rate = 0.968627
false positive rate = 0.002021
positive prediction rate = 0.004764
AUC of ROC = 0.73049
AUC of PRC = 0.300299
min(+P, Se) = 0.34902

-------------------------------

confusion matrix:
[[1681    2]
 [ 203   13]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09653499722480774
difference in average predicted and observed risk = -0.01720900277519226
number samples = 1899
accuracy = 0.892048
precision class 0 = 0.892251
precision class 1 = 0.866667
recall class 0 = 0.998812
recall class 1 = 0.060185
false negative rate = 0.939815
false positive rate = 0.001188
positive prediction rate = 0.007899
AUC of ROC = 0.777068
AUC of PRC = 0.390047
min(+P, Se) = 0.407407

-------------------------------

confusion matrix:
[[548   1]
 [ 76   1]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.0998769998550415
difference in average predicted and observed risk = -0.023126000144958497
number samples = 626
accuracy = 0.876997
precision class 0 = 0.878205
precision class 1 = 0.5
recall class 0 = 0.998178
recall class 1 = 0.012987
false negative rate = 0.987013
false positive rate = 0.001821
positive prediction rate = 0.003195
AUC of ROC = 0.733305
AUC of PRC = 0.307752
min(+P, Se) = 0.341772

-------------------------------

confusion matrix:
[[2246    3]
 [ 206    2]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08095800131559372
difference in average predicted and observed risk = -0.0036979986844062757
number samples = 2457
accuracy = 0.914937
precision class 0 = 0.915987
precision class 1 = 0.4
recall class 0 = 0.998666
recall class 1 = 0.009615
false negative rate = 0.990385
false positive rate = 0.001334
positive prediction rate = 0.002035
AUC of ROC = 0.73619
AUC of PRC = 0.264377
min(+P, Se) = 0.296651

-------------------------------

confusion matrix:
[[223   0]
 [ 25   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0849120020866394
difference in average predicted and observed risk = -0.015893997913360602
number samples = 248
accuracy = 0.899194
precision class 0 = 0.899194
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.6687
AUC of PRC = 0.19616
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[479   2]
 [ 68  14]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1193619966506958
difference in average predicted and observed risk = -0.0262860033493042
number samples = 563
accuracy = 0.875666
precision class 0 = 0.875686
precision class 1 = 0.875
recall class 0 = 0.995842
recall class 1 = 0.170732
false negative rate = 0.829268
false positive rate = 0.004158
positive prediction rate = 0.028419
AUC of ROC = 0.801607
AUC of PRC = 0.537965
min(+P, Se) = 0.517241

-------------------------------

confusion matrix:
[[654   1]
 [ 75   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10490500181913376
difference in average predicted and observed risk = -0.002723998180866244
number samples = 734
accuracy = 0.896458
precision class 0 = 0.897119
precision class 1 = 0.8
recall class 0 = 0.998473
recall class 1 = 0.050633
false negative rate = 0.949367
false positive rate = 0.001527
positive prediction rate = 0.006812
AUC of ROC = 0.779244
AUC of PRC = 0.393576
min(+P, Se) = 0.392405

-------------------------------

confusion matrix:
[[4150    7]
 [ 450   21]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09219899773597717
difference in average predicted and observed risk = -0.009573002264022829
number samples = 4628
accuracy = 0.901253
precision class 0 = 0.902174
precision class 1 = 0.75
recall class 0 = 0.998316
recall class 1 = 0.044586
false negative rate = 0.955414
false positive rate = 0.001684
positive prediction rate = 0.00605
AUC of ROC = 0.752301
AUC of PRC = 0.341794
min(+P, Se) = 0.377119

-------------------------------

==>predicting on validation



confusion matrix:
[[217   1]
 [ 18   1]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08896300196647644
difference in average predicted and observed risk = 0.008794001966476436
number samples = 237
accuracy = 0.919831
precision class 0 = 0.923404
precision class 1 = 0.5
recall class 0 = 0.995413
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.004587
positive prediction rate = 0.008439
AUC of ROC = 0.845485
AUC of PRC = 0.379471
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[385   0]
 [ 47   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09059499949216843
difference in average predicted and observed risk = -0.018201000507831577
number samples = 432
accuracy = 0.891204
precision class 0 = 0.891204
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.749931
AUC of PRC = 0.385042
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[105   0]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11112599819898605
difference in average predicted and observed risk = 0.0009569981989860504
number samples = 118
accuracy = 0.90678
precision class 0 = 0.905172
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.0
positive prediction rate = 0.016949
AUC of ROC = 0.87033
AUC of PRC = 0.600856
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11184299737215042
difference in average predicted and observed risk = -0.021490002627849586
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[300   0]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1003739982843399
difference in average predicted and observed risk = -0.014670001715660089
number samples = 339
accuracy = 0.887906
precision class 0 = 0.887574
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.0
positive prediction rate = 0.00295
AUC of ROC = 0.774017
AUC of PRC = 0.3333
min(+P, Se) = 0.409091

-------------------------------

confusion matrix:
[[433   1]
 [ 40   4]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08925200253725052
difference in average predicted and observed risk = -0.002797997462749488
number samples = 478
accuracy = 0.914226
precision class 0 = 0.915433
precision class 1 = 0.8
recall class 0 = 0.997696
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.002304
positive prediction rate = 0.01046
AUC of ROC = 0.829284
AUC of PRC = 0.516801
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[388   0]
 [ 38   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08300899714231491
difference in average predicted and observed risk = -0.006193002857685093
number samples = 426
accuracy = 0.910798
precision class 0 = 0.910798
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.797206
AUC of PRC = 0.418676
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[90  0]
 [10  2]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11391899734735489
difference in average predicted and observed risk = -0.0037280026526451127
number samples = 102
accuracy = 0.901961
precision class 0 = 0.9
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.0
positive prediction rate = 0.019608
AUC of ROC = 0.931481
AUC of PRC = 0.677112
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09508100152015686
difference in average predicted and observed risk = 0.006371001520156863
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.7321
AUC of PRC = 0.175693
min(+P, Se) = 0.272727

-------------------------------

confusion matrix:
[[108   0]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10685200244188309
difference in average predicted and observed risk = -0.0427539975581169
number samples = 127
accuracy = 0.874016
precision class 0 = 0.870968
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.0
positive prediction rate = 0.023622
AUC of ROC = 0.781189
AUC of PRC = 0.564418
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11441300064325333
difference in average predicted and observed risk = 0.03546600064325332
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.55101
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[733   1]
 [ 78   5]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0938669964671135
difference in average predicted and observed risk = -0.007724003532886506
number samples = 817
accuracy = 0.903305
precision class 0 = 0.903822
precision class 1 = 0.833333
recall class 0 = 0.998638
recall class 1 = 0.060241
false negative rate = 0.939759
false positive rate = 0.001362
positive prediction rate = 0.007344
AUC of ROC = 0.806983
AUC of PRC = 0.438145
min(+P, Se) = 0.46988

-------------------------------

Epoch 00003: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch3.state
Epoch 4/100
 - 305s - loss: 0.2980 - val_loss: 0.2656

==>predicting on train



confusion matrix:
[[2142   13]
 [ 226   29]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0905809998512268
difference in average predicted and observed risk = -0.015228000148773194
number samples = 2410
accuracy = 0.90083
precision class 0 = 0.904561
precision class 1 = 0.690476
recall class 0 = 0.993968
recall class 1 = 0.113725
false negative rate = 0.886275
false positive rate = 0.006032
positive prediction rate = 0.017427
AUC of ROC = 0.746163
AUC of PRC = 0.364857
min(+P, Se) = 0.377432

-------------------------------

confusion matrix:
[[1164   15]
 [ 105   13]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08947400003671646
difference in average predicted and observed risk = -0.0015049999632835431
number samples = 1297
accuracy = 0.907479
precision class 0 = 0.917258
precision class 1 = 0.464286
recall class 0 = 0.987277
recall class 1 = 0.110169
false negative rate = 0.889831
false positive rate = 0.012723
positive prediction rate = 0.021588
AUC of ROC = 0.782831
AUC of PRC = 0.282252
min(+P, Se) = 0.327869

-------------------------------

confusion matrix:
[[647   9]
 [ 62  12]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09962400048971176
difference in average predicted and observed risk = -0.0017459995102882403
number samples = 730
accuracy = 0.90274
precision class 0 = 0.912553
precision class 1 = 0.571429
recall class 0 = 0.986281
recall class 1 = 0.162162
false negative rate = 0.837838
false positive rate = 0.01372
positive prediction rate = 0.028767
AUC of ROC = 0.741945
AUC of PRC = 0.345899
min(+P, Se) = 0.382716

-------------------------------

confusion matrix:
[[166   1]
 [ 17   7]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09783600270748138
difference in average predicted and observed risk = -0.027817997292518604
number samples = 191
accuracy = 0.905759
precision class 0 = 0.907104
precision class 1 = 0.875
recall class 0 = 0.994012
recall class 1 = 0.291667
false negative rate = 0.708333
false positive rate = 0.005988
positive prediction rate = 0.041885
AUC of ROC = 0.851796
AUC of PRC = 0.66845
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2452   22]
 [ 224   31]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08915899693965912
difference in average predicted and observed risk = -0.004282003060340878
number samples = 2729
accuracy = 0.909857
precision class 0 = 0.916293
precision class 1 = 0.584906
recall class 0 = 0.991108
recall class 1 = 0.121569
false negative rate = 0.878431
false positive rate = 0.008892
positive prediction rate = 0.019421
AUC of ROC = 0.741795
AUC of PRC = 0.303088
min(+P, Se) = 0.345098

-------------------------------

confusion matrix:
[[1667   16]
 [ 186   30]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09607400000095367
difference in average predicted and observed risk = -0.017669999999046324
number samples = 1899
accuracy = 0.893628
precision class 0 = 0.899622
precision class 1 = 0.652174
recall class 0 = 0.990493
recall class 1 = 0.138889
false negative rate = 0.861111
false positive rate = 0.009507
positive prediction rate = 0.024223
AUC of ROC = 0.783568
AUC of PRC = 0.406315
min(+P, Se) = 0.420814

-------------------------------

confusion matrix:
[[541   8]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10418400168418884
difference in average predicted and observed risk = -0.01881899831581116
number samples = 626
accuracy = 0.875399
precision class 0 = 0.885434
precision class 1 = 0.466667
recall class 0 = 0.985428
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.014572
positive prediction rate = 0.023962
AUC of ROC = 0.742696
AUC of PRC = 0.313302
min(+P, Se) = 0.344828

-------------------------------

confusion matrix:
[[2239   10]
 [ 193   15]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07870999723672867
difference in average predicted and observed risk = -0.005946002763271327
number samples = 2457
accuracy = 0.917379
precision class 0 = 0.920641
precision class 1 = 0.6
recall class 0 = 0.995554
recall class 1 = 0.072115
false negative rate = 0.927885
false positive rate = 0.004446
positive prediction rate = 0.010175
AUC of ROC = 0.746817
AUC of PRC = 0.278578
min(+P, Se) = 0.3125

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08576100319623947
difference in average predicted and observed risk = -0.015044996803760535
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.678744
AUC of PRC = 0.197335
min(+P, Se) = 0.289474

-------------------------------

confusion matrix:
[[473   8]
 [ 58  24]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12521100044250488
difference in average predicted and observed risk = -0.020436999557495117
number samples = 563
accuracy = 0.882771
precision class 0 = 0.890772
precision class 1 = 0.75
recall class 0 = 0.983368
recall class 1 = 0.292683
false negative rate = 0.707317
false positive rate = 0.016632
positive prediction rate = 0.056838
AUC of ROC = 0.803053
AUC of PRC = 0.547507
min(+P, Se) = 0.518072

-------------------------------

confusion matrix:
[[647   8]
 [ 64  15]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10270699858665466
difference in average predicted and observed risk = -0.004922001413345339
number samples = 734
accuracy = 0.901907
precision class 0 = 0.909986
precision class 1 = 0.652174
recall class 0 = 0.987786
recall class 1 = 0.189873
false negative rate = 0.810127
false positive rate = 0.012214
positive prediction rate = 0.031335
AUC of ROC = 0.78738
AUC of PRC = 0.408035
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[4119   38]
 [ 410   61]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09199699759483337
difference in average predicted and observed risk = -0.009775002405166627
number samples = 4628
accuracy = 0.903198
precision class 0 = 0.909472
precision class 1 = 0.616162
recall class 0 = 0.990859
recall class 1 = 0.129512
false negative rate = 0.870488
false positive rate = 0.009141
positive prediction rate = 0.021392
AUC of ROC = 0.761479
AUC of PRC = 0.352509
min(+P, Se) = 0.377119

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08754599839448929
difference in average predicted and observed risk = 0.007376998394489284
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.843312
AUC of PRC = 0.37507
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09026599675416946
difference in average predicted and observed risk = -0.01853000324583054
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.752915
AUC of PRC = 0.395711
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[105   0]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1086840033531189
difference in average predicted and observed risk = -0.0014849966468811066
number samples = 118
accuracy = 0.923729
precision class 0 = 0.921053
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.0
positive prediction rate = 0.033898
AUC of ROC = 0.880586
AUC of PRC = 0.618743
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11316999793052673
difference in average predicted and observed risk = -0.020163002069473274
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09892000257968903
difference in average predicted and observed risk = -0.016123997420310968
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.774701
AUC of PRC = 0.322586
min(+P, Se) = 0.422222

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0887639969587326
difference in average predicted and observed risk = -0.003286003041267402
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.830331
AUC of PRC = 0.525679
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08048400282859802
difference in average predicted and observed risk = -0.008717997171401981
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.804327
AUC of PRC = 0.428651
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1183760017156601
difference in average predicted and observed risk = 0.0007290017156600936
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.923148
AUC of PRC = 0.66973
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09663700312376022
difference in average predicted and observed risk = 0.007927003123760226
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.749799
AUC of PRC = 0.19
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[107   1]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1038609966635704
difference in average predicted and observed risk = -0.045745003336429585
number samples = 127
accuracy = 0.874016
precision class 0 = 0.877049
precision class 1 = 0.8
recall class 0 = 0.990741
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.009259
positive prediction rate = 0.03937
AUC of ROC = 0.780214
AUC of PRC = 0.555528
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11655600368976593
difference in average predicted and observed risk = 0.03760900368976593
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.55101
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[731   3]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09297800064086914
difference in average predicted and observed risk = -0.00861299935913086
number samples = 817
accuracy = 0.910649
precision class 0 = 0.912609
precision class 1 = 0.8125
recall class 0 = 0.995913
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.004087
positive prediction rate = 0.019584
AUC of ROC = 0.808854
AUC of PRC = 0.444368
min(+P, Se) = 0.481928

-------------------------------

Epoch 00004: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch4.state
Epoch 5/100
 - 298s - loss: 0.2941 - val_loss: 0.2823

==>predicting on train



confusion matrix:
[[2155    0]
 [ 253    2]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0577629990875721
difference in average predicted and observed risk = -0.0480460009124279
number samples = 2410
accuracy = 0.895021
precision class 0 = 0.894934
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.007843
false negative rate = 0.992157
false positive rate = 0.0
positive prediction rate = 0.00083
AUC of ROC = 0.748932
AUC of PRC = 0.366971
min(+P, Se) = 0.380392

-------------------------------

confusion matrix:
[[1179    0]
 [ 118    0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.055612001568078995
difference in average predicted and observed risk = -0.03536699843192101
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.909021
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.778389
AUC of PRC = 0.290448
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[656   0]
 [ 74   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.06167300045490265
difference in average predicted and observed risk = -0.03969699954509735
number samples = 730
accuracy = 0.89863
precision class 0 = 0.89863
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.744047
AUC of PRC = 0.352765
min(+P, Se) = 0.418919

-------------------------------

confusion matrix:
[[167   0]
 [ 24   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.06191699951887131
difference in average predicted and observed risk = -0.06373700048112868
number samples = 191
accuracy = 0.874346
precision class 0 = 0.874346
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.850549
AUC of PRC = 0.683403
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2474    0]
 [ 255    0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.05485000088810921
difference in average predicted and observed risk = -0.03859099911189079
number samples = 2729
accuracy = 0.906559
precision class 0 = 0.906559
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.745146
AUC of PRC = 0.309341
min(+P, Se) = 0.357977

-------------------------------

confusion matrix:
[[1683    0]
 [ 214    2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.062401000410318375
difference in average predicted and observed risk = -0.05134299958968162
number samples = 1899
accuracy = 0.887309
precision class 0 = 0.88719
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.009259
false negative rate = 0.990741
false positive rate = 0.0
positive prediction rate = 0.001053
AUC of ROC = 0.785373
AUC of PRC = 0.408092
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[549   0]
 [ 77   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.06642399728298187
difference in average predicted and observed risk = -0.05657900271701813
number samples = 626
accuracy = 0.876997
precision class 0 = 0.876997
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.743382
AUC of PRC = 0.321824
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[2249    0]
 [ 208    0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.04921700060367584
difference in average predicted and observed risk = -0.03543899939632415
number samples = 2457
accuracy = 0.915344
precision class 0 = 0.915344
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.747544
AUC of PRC = 0.284277
min(+P, Se) = 0.331731

-------------------------------

confusion matrix:
[[223   0]
 [ 25   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.05340899899601936
difference in average predicted and observed risk = -0.04739700100398064
number samples = 248
accuracy = 0.899194
precision class 0 = 0.899194
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.67426
AUC of PRC = 0.191421
min(+P, Se) = 0.297297

-------------------------------

confusion matrix:
[[481   0]
 [ 80   2]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.08014900237321854
difference in average predicted and observed risk = -0.06549899762678146
number samples = 563
accuracy = 0.857904
precision class 0 = 0.857397
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.02439
false negative rate = 0.97561
false positive rate = 0.0
positive prediction rate = 0.003552
AUC of ROC = 0.802875
AUC of PRC = 0.546359
min(+P, Se) = 0.522222

-------------------------------

confusion matrix:
[[655   0]
 [ 79   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.06445299834012985
difference in average predicted and observed risk = -0.04317600165987015
number samples = 734
accuracy = 0.892371
precision class 0 = 0.892371
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.793313
AUC of PRC = 0.418098
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[4157    0]
 [ 469    2]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.057948999106884
difference in average predicted and observed risk = -0.043823000893116
number samples = 4628
accuracy = 0.89866
precision class 0 = 0.898616
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.004246
false negative rate = 0.995754
false positive rate = 0.0
positive prediction rate = 0.000432
AUC of ROC = 0.762502
AUC of PRC = 0.356837
min(+P, Se) = 0.388535

-------------------------------

==>predicting on validation



confusion matrix:
[[218   0]
 [ 19   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.054503001272678375
difference in average predicted and observed risk = -0.02566599872732163
number samples = 237
accuracy = 0.919831
precision class 0 = 0.919831
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.850797
AUC of PRC = 0.333536
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[385   0]
 [ 47   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.05612099915742874
difference in average predicted and observed risk = -0.05267500084257126
number samples = 432
accuracy = 0.891204
precision class 0 = 0.891204
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.750705
AUC of PRC = 0.412998
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[105   0]
 [ 13   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.06784799695014954
difference in average predicted and observed risk = -0.04232100304985047
number samples = 118
accuracy = 0.889831
precision class 0 = 0.889831
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.882051
AUC of PRC = 0.635225
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 4  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.07399500161409378
difference in average predicted and observed risk = -0.05933799838590623
number samples = 30
accuracy = 0.866667
precision class 0 = 0.866667
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[300   0]
 [ 39   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.06232500076293945
difference in average predicted and observed risk = -0.05271899923706054
number samples = 339
accuracy = 0.884956
precision class 0 = 0.884956
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.78094
AUC of PRC = 0.348709
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[434   0]
 [ 44   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0549359992146492
difference in average predicted and observed risk = -0.037114000785350806
number samples = 478
accuracy = 0.90795
precision class 0 = 0.90795
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.827922
AUC of PRC = 0.515494
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 38   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.05016399919986725
difference in average predicted and observed risk = -0.039038000800132755
number samples = 426
accuracy = 0.910798
precision class 0 = 0.910798
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.807176
AUC of PRC = 0.435829
min(+P, Se) = 0.387755

-------------------------------

confusion matrix:
[[90  0]
 [12  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.07324600219726562
difference in average predicted and observed risk = -0.04440099780273438
number samples = 102
accuracy = 0.882353
precision class 0 = 0.882353
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.934259
AUC of PRC = 0.684081
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[113   0]
 [ 11   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.05993099883198738
difference in average predicted and observed risk = -0.028779001168012616
number samples = 124
accuracy = 0.91129
precision class 0 = 0.91129
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.747385
AUC of PRC = 0.193841
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[108   0]
 [ 19   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.06705699861049652
difference in average predicted and observed risk = -0.08254900138950347
number samples = 127
accuracy = 0.850394
precision class 0 = 0.850394
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.766569
AUC of PRC = 0.557951
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.0683870017528534
difference in average predicted and observed risk = -0.01055999824714661
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.520455
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[734   0]
 [ 83   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.05800199881196022
difference in average predicted and observed risk = -0.04358900118803978
number samples = 817
accuracy = 0.898409
precision class 0 = 0.898409
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.809231
AUC of PRC = 0.448683
min(+P, Se) = 0.46988

-------------------------------

Epoch 00005: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch5.state
Epoch 6/100
 - 302s - loss: 0.2936 - val_loss: 0.2626

==>predicting on train



confusion matrix:
[[2146    9]
 [ 229   26]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09969799965620041
difference in average predicted and observed risk = -0.006111000343799591
number samples = 2410
accuracy = 0.901245
precision class 0 = 0.903579
precision class 1 = 0.742857
recall class 0 = 0.995824
recall class 1 = 0.101961
false negative rate = 0.898039
false positive rate = 0.004176
positive prediction rate = 0.014523
AUC of ROC = 0.751058
AUC of PRC = 0.367935
min(+P, Se) = 0.390625

-------------------------------

confusion matrix:
[[1167   12]
 [ 104   14]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09456600248813629
difference in average predicted and observed risk = 0.003587002488136287
number samples = 1297
accuracy = 0.910563
precision class 0 = 0.918175
precision class 1 = 0.538462
recall class 0 = 0.989822
recall class 1 = 0.118644
false negative rate = 0.881356
false positive rate = 0.010178
positive prediction rate = 0.020046
AUC of ROC = 0.783269
AUC of PRC = 0.296793
min(+P, Se) = 0.355932

-------------------------------

confusion matrix:
[[653   3]
 [ 65   9]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09947499632835388
difference in average predicted and observed risk = -0.00189500367164612
number samples = 730
accuracy = 0.906849
precision class 0 = 0.909471
precision class 1 = 0.75
recall class 0 = 0.995427
recall class 1 = 0.121622
false negative rate = 0.878378
false positive rate = 0.004573
positive prediction rate = 0.016438
AUC of ROC = 0.743944
AUC of PRC = 0.352836
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[166   1]
 [ 18   6]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09986899793148041
difference in average predicted and observed risk = -0.02578500206851958
number samples = 191
accuracy = 0.900524
precision class 0 = 0.902174
precision class 1 = 0.857143
recall class 0 = 0.994012
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.005988
positive prediction rate = 0.036649
AUC of ROC = 0.849301
AUC of PRC = 0.664829
min(+P, Se) = 0.64

-------------------------------

confusion matrix:
[[2458   16]
 [ 228   27]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09346900135278702
difference in average predicted and observed risk = 2.800135278702154e-05
number samples = 2729
accuracy = 0.91059
precision class 0 = 0.915115
precision class 1 = 0.627907
recall class 0 = 0.993533
recall class 1 = 0.105882
false negative rate = 0.894118
false positive rate = 0.006467
positive prediction rate = 0.015757
AUC of ROC = 0.743914
AUC of PRC = 0.309756
min(+P, Se) = 0.372549

-------------------------------

confusion matrix:
[[1674    9]
 [ 188   28]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10507600009441376
difference in average predicted and observed risk = -0.00866799990558624
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.899033
precision class 1 = 0.756757
recall class 0 = 0.994652
recall class 1 = 0.12963
false negative rate = 0.87037
false positive rate = 0.005348
positive prediction rate = 0.019484
AUC of ROC = 0.792489
AUC of PRC = 0.41434
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[542   7]
 [ 71   6]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11124999821186066
difference in average predicted and observed risk = -0.011753001788139344
number samples = 626
accuracy = 0.875399
precision class 0 = 0.884176
precision class 1 = 0.461538
recall class 0 = 0.98725
recall class 1 = 0.077922
false negative rate = 0.922078
false positive rate = 0.01275
positive prediction rate = 0.020767
AUC of ROC = 0.748634
AUC of PRC = 0.326727
min(+P, Se) = 0.376623

-------------------------------

confusion matrix:
[[2246    3]
 [ 194   14]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08625900000333786
difference in average predicted and observed risk = 0.001603000003337865
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.920492
precision class 1 = 0.823529
recall class 0 = 0.998666
recall class 1 = 0.067308
false negative rate = 0.932692
false positive rate = 0.001334
positive prediction rate = 0.006919
AUC of ROC = 0.745359
AUC of PRC = 0.291069
min(+P, Se) = 0.322275

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0904109999537468
difference in average predicted and observed risk = -0.010395000046253211
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.699731
AUC of PRC = 0.198991
min(+P, Se) = 0.282051

-------------------------------

confusion matrix:
[[475   6]
 [ 58  24]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1304820030927658
difference in average predicted and observed risk = -0.015165996907234192
number samples = 563
accuracy = 0.886323
precision class 0 = 0.891182
precision class 1 = 0.8
recall class 0 = 0.987526
recall class 1 = 0.292683
false negative rate = 0.707317
false positive rate = 0.012474
positive prediction rate = 0.053286
AUC of ROC = 0.803965
AUC of PRC = 0.551529
min(+P, Se) = 0.522222

-------------------------------

confusion matrix:
[[650   5]
 [ 68  11]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10511399805545807
difference in average predicted and observed risk = -0.0025150019445419336
number samples = 734
accuracy = 0.900545
precision class 0 = 0.905292
precision class 1 = 0.6875
recall class 0 = 0.992366
recall class 1 = 0.139241
false negative rate = 0.860759
false positive rate = 0.007634
positive prediction rate = 0.021798
AUC of ROC = 0.797159
AUC of PRC = 0.413297
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4132   25]
 [ 416   55]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09823200106620789
difference in average predicted and observed risk = -0.0035399989337921156
number samples = 4628
accuracy = 0.90471
precision class 0 = 0.908531
precision class 1 = 0.6875
recall class 0 = 0.993986
recall class 1 = 0.116773
false negative rate = 0.883227
false positive rate = 0.006014
positive prediction rate = 0.017286
AUC of ROC = 0.765041
AUC of PRC = 0.35972
min(+P, Se) = 0.392781

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09199599921703339
difference in average predicted and observed risk = 0.011826999217033382
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.853694
AUC of PRC = 0.387907
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09989199787378311
difference in average predicted and observed risk = -0.008904002126216892
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.748494
AUC of PRC = 0.412267
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[105   0]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10999300330877304
difference in average predicted and observed risk = -0.00017599669122696227
number samples = 118
accuracy = 0.915254
precision class 0 = 0.913043
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.0
positive prediction rate = 0.025424
AUC of ROC = 0.890842
AUC of PRC = 0.652867
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11973799765110016
difference in average predicted and observed risk = -0.013595002348899848
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[299   1]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10799799859523773
difference in average predicted and observed risk = -0.0070460014047622616
number samples = 339
accuracy = 0.884956
precision class 0 = 0.88724
precision class 1 = 0.5
recall class 0 = 0.996667
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.003333
positive prediction rate = 0.0059
AUC of ROC = 0.787094
AUC of PRC = 0.351625
min(+P, Se) = 0.413043

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0939679965376854
difference in average predicted and observed risk = 0.0019179965376853875
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.832792
AUC of PRC = 0.521731
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08825299888849258
difference in average predicted and observed risk = -0.0009490011115074193
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.810228
AUC of PRC = 0.436455
min(+P, Se) = 0.382979

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12115500122308731
difference in average predicted and observed risk = 0.0035080012230873092
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.925926
AUC of PRC = 0.676848
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10580600053071976
difference in average predicted and observed risk = 0.01709600053071976
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.76428
AUC of PRC = 0.215295
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[107   1]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10845799744129181
difference in average predicted and observed risk = -0.04114800255870818
number samples = 127
accuracy = 0.866142
precision class 0 = 0.869919
precision class 1 = 0.75
recall class 0 = 0.990741
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009259
positive prediction rate = 0.031496
AUC of ROC = 0.782651
AUC of PRC = 0.567312
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12316499650478363
difference in average predicted and observed risk = 0.04421799650478363
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.520455
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[732   2]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09978900104761124
difference in average predicted and observed risk = -0.0018019989523887642
number samples = 817
accuracy = 0.908201
precision class 0 = 0.909317
precision class 1 = 0.833333
recall class 0 = 0.997275
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.002725
positive prediction rate = 0.014688
AUC of ROC = 0.813335
AUC of PRC = 0.45693
min(+P, Se) = 0.46988

-------------------------------

Epoch 00006: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch6.state
Epoch 7/100
 - 301s - loss: 0.2904 - val_loss: 0.2657

==>predicting on train



confusion matrix:
[[2148    7]
 [ 235   20]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10833899676799774
difference in average predicted and observed risk = 0.0025299967679977414
number samples = 2410
accuracy = 0.899585
precision class 0 = 0.901385
precision class 1 = 0.740741
recall class 0 = 0.996752
recall class 1 = 0.078431
false negative rate = 0.921569
false positive rate = 0.003248
positive prediction rate = 0.011203
AUC of ROC = 0.75501
AUC of PRC = 0.373054
min(+P, Se) = 0.384314

-------------------------------

confusion matrix:
[[1169   10]
 [ 110    8]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10300300270318985
difference in average predicted and observed risk = 0.012024002703189846
number samples = 1297
accuracy = 0.907479
precision class 0 = 0.913995
precision class 1 = 0.444444
recall class 0 = 0.991518
recall class 1 = 0.067797
false negative rate = 0.932203
false positive rate = 0.008482
positive prediction rate = 0.013878
AUC of ROC = 0.783082
AUC of PRC = 0.303211
min(+P, Se) = 0.358333

-------------------------------

confusion matrix:
[[654   2]
 [ 67   7]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11481600254774094
difference in average predicted and observed risk = 0.013446002547740935
number samples = 730
accuracy = 0.905479
precision class 0 = 0.907073
precision class 1 = 0.777778
recall class 0 = 0.996951
recall class 1 = 0.094595
false negative rate = 0.905405
false positive rate = 0.003049
positive prediction rate = 0.012329
AUC of ROC = 0.750845
AUC of PRC = 0.357646
min(+P, Se) = 0.434211

-------------------------------

confusion matrix:
[[166   1]
 [ 19   5]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11366400122642517
difference in average predicted and observed risk = -0.011989998773574817
number samples = 191
accuracy = 0.895288
precision class 0 = 0.897297
precision class 1 = 0.833333
recall class 0 = 0.994012
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.005988
positive prediction rate = 0.031414
AUC of ROC = 0.853044
AUC of PRC = 0.669186
min(+P, Se) = 0.64

-------------------------------

confusion matrix:
[[2461   13]
 [ 240   15]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10394400358200073
difference in average predicted and observed risk = 0.010503003582000736
number samples = 2729
accuracy = 0.907292
precision class 0 = 0.911144
precision class 1 = 0.535714
recall class 0 = 0.994745
recall class 1 = 0.058824
false negative rate = 0.941176
false positive rate = 0.005255
positive prediction rate = 0.01026
AUC of ROC = 0.749186
AUC of PRC = 0.319808
min(+P, Se) = 0.368627

-------------------------------

confusion matrix:
[[1676    7]
 [ 191   25]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11403600126504898
difference in average predicted and observed risk = 0.00029200126504898283
number samples = 1899
accuracy = 0.895735
precision class 0 = 0.897697
precision class 1 = 0.78125
recall class 0 = 0.995841
recall class 1 = 0.115741
false negative rate = 0.884259
false positive rate = 0.004159
positive prediction rate = 0.016851
AUC of ROC = 0.791493
AUC of PRC = 0.41784
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[543   6]
 [ 72   5]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1217230036854744
difference in average predicted and observed risk = -0.0012799963145256055
number samples = 626
accuracy = 0.875399
precision class 0 = 0.882927
precision class 1 = 0.454545
recall class 0 = 0.989071
recall class 1 = 0.064935
false negative rate = 0.935065
false positive rate = 0.010929
positive prediction rate = 0.017572
AUC of ROC = 0.749415
AUC of PRC = 0.329546
min(+P, Se) = 0.365854

-------------------------------

confusion matrix:
[[2247    2]
 [ 201    7]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09542299807071686
difference in average predicted and observed risk = 0.010766998070716863
number samples = 2457
accuracy = 0.917379
precision class 0 = 0.917892
precision class 1 = 0.777778
recall class 0 = 0.999111
recall class 1 = 0.033654
false negative rate = 0.966346
false positive rate = 0.000889
positive prediction rate = 0.003663
AUC of ROC = 0.75218
AUC of PRC = 0.294203
min(+P, Se) = 0.322115

-------------------------------

confusion matrix:
[[221   2]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10161399841308594
difference in average predicted and observed risk = 0.0008079984130859308
number samples = 248
accuracy = 0.891129
precision class 0 = 0.898374
precision class 1 = 0.0
recall class 0 = 0.991031
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.008969
positive prediction rate = 0.008065
AUC of ROC = 0.690942
AUC of PRC = 0.19471
min(+P, Se) = 0.277778

-------------------------------

confusion matrix:
[[474   7]
 [ 64  18]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13992199301719666
difference in average predicted and observed risk = -0.005726006982803344
number samples = 563
accuracy = 0.87389
precision class 0 = 0.881041
precision class 1 = 0.72
recall class 0 = 0.985447
recall class 1 = 0.219512
false negative rate = 0.780488
false positive rate = 0.014553
positive prediction rate = 0.044405
AUC of ROC = 0.80285
AUC of PRC = 0.558359
min(+P, Se) = 0.53012

-------------------------------

confusion matrix:
[[652   3]
 [ 69  10]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.1166049987077713
difference in average predicted and observed risk = 0.008975998707771299
number samples = 734
accuracy = 0.901907
precision class 0 = 0.9043
precision class 1 = 0.769231
recall class 0 = 0.99542
recall class 1 = 0.126582
false negative rate = 0.873418
false positive rate = 0.00458
positive prediction rate = 0.017711
AUC of ROC = 0.798338
AUC of PRC = 0.421476
min(+P, Se) = 0.453488

-------------------------------

confusion matrix:
[[4137   20]
 [ 431   40]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10808499902486801
difference in average predicted and observed risk = 0.00631299902486801
number samples = 4628
accuracy = 0.90255
precision class 0 = 0.905648
precision class 1 = 0.666667
recall class 0 = 0.995189
recall class 1 = 0.084926
false negative rate = 0.915074
false positive rate = 0.004811
positive prediction rate = 0.012965
AUC of ROC = 0.767971
AUC of PRC = 0.365638
min(+P, Se) = 0.396186

-------------------------------

==>predicting on validation



confusion matrix:
[[217   1]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10013899952173233
difference in average predicted and observed risk = 0.019969999521732326
number samples = 237
accuracy = 0.924051
precision class 0 = 0.92735
precision class 1 = 0.666667
recall class 0 = 0.995413
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.004587
positive prediction rate = 0.012658
AUC of ROC = 0.847417
AUC of PRC = 0.389881
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 45   2]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10910400003194809
difference in average predicted and observed risk = 0.0003080000319480858
number samples = 432
accuracy = 0.895833
precision class 0 = 0.895349
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.042553
false negative rate = 0.957447
false positive rate = 0.0
positive prediction rate = 0.00463
AUC of ROC = 0.752805
AUC of PRC = 0.420511
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[105   0]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12627899646759033
difference in average predicted and observed risk = 0.01610999646759033
number samples = 118
accuracy = 0.915254
precision class 0 = 0.913043
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.0
positive prediction rate = 0.025424
AUC of ROC = 0.896703
AUC of PRC = 0.648109
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13144400715827942
difference in average predicted and observed risk = -0.0018889928417205881
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[300   0]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11729700118303299
difference in average predicted and observed risk = 0.002253001183032996
number samples = 339
accuracy = 0.887906
precision class 0 = 0.887574
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.0
positive prediction rate = 0.00295
AUC of ROC = 0.78906
AUC of PRC = 0.361572
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[433   1]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10449100285768509
difference in average predicted and observed risk = 0.012441002857685082
number samples = 478
accuracy = 0.922594
precision class 0 = 0.923241
precision class 1 = 0.888889
recall class 0 = 0.997696
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.002304
positive prediction rate = 0.018828
AUC of ROC = 0.833368
AUC of PRC = 0.532054
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09729000180959702
difference in average predicted and observed risk = 0.008088001809597012
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.809889
AUC of PRC = 0.44179
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13160200417041779
difference in average predicted and observed risk = 0.013955004170417784
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.934259
AUC of PRC = 0.693367
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11716099828481674
difference in average predicted and observed risk = 0.028450998284816745
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.765084
AUC of PRC = 0.206095
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[108   0]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11941699683666229
difference in average predicted and observed risk = -0.030189003163337697
number samples = 127
accuracy = 0.874016
precision class 0 = 0.870968
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.0
positive prediction rate = 0.023622
AUC of ROC = 0.78655
AUC of PRC = 0.559787
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13545100390911102
difference in average predicted and observed risk = 0.05650400390911102
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.528704
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[733   1]
 [ 74   9]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10980399698019028
difference in average predicted and observed risk = 0.008212996980190276
number samples = 817
accuracy = 0.908201
precision class 0 = 0.908302
precision class 1 = 0.9
recall class 0 = 0.998638
recall class 1 = 0.108434
false negative rate = 0.891566
false positive rate = 0.001362
positive prediction rate = 0.01224
AUC of ROC = 0.814615
AUC of PRC = 0.465101
min(+P, Se) = 0.471264

-------------------------------

Epoch 00007: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch7.state
Epoch 8/100
 - 296s - loss: 0.2875 - val_loss: 0.2711

==>predicting on train



confusion matrix:
[[2137   18]
 [ 219   36]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.12039300054311752
difference in average predicted and observed risk = 0.014584000543117523
number samples = 2410
accuracy = 0.90166
precision class 0 = 0.907046
precision class 1 = 0.666667
recall class 0 = 0.991647
recall class 1 = 0.141176
false negative rate = 0.858824
false positive rate = 0.008353
positive prediction rate = 0.022407
AUC of ROC = 0.744605
AUC of PRC = 0.368027
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1164   15]
 [ 104   14]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.11719600111246109
difference in average predicted and observed risk = 0.026217001112461086
number samples = 1297
accuracy = 0.90825
precision class 0 = 0.917981
precision class 1 = 0.482759
recall class 0 = 0.987277
recall class 1 = 0.118644
false negative rate = 0.881356
false positive rate = 0.012723
positive prediction rate = 0.022359
AUC of ROC = 0.779855
AUC of PRC = 0.303439
min(+P, Se) = 0.341463

-------------------------------

confusion matrix:
[[646  10]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.13154399394989014
difference in average predicted and observed risk = 0.030173993949890135
number samples = 730
accuracy = 0.90274
precision class 0 = 0.91372
precision class 1 = 0.565217
recall class 0 = 0.984756
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.015244
positive prediction rate = 0.031507
AUC of ROC = 0.758673
AUC of PRC = 0.382369
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[166   1]
 [ 15   9]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1303420066833496
difference in average predicted and observed risk = 0.0046880066833496215
number samples = 191
accuracy = 0.91623
precision class 0 = 0.917127
precision class 1 = 0.9
recall class 0 = 0.994012
recall class 1 = 0.375
false negative rate = 0.625
false positive rate = 0.005988
positive prediction rate = 0.052356
AUC of ROC = 0.851048
AUC of PRC = 0.675508
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2449   25]
 [ 221   34]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.11615899950265884
difference in average predicted and observed risk = 0.022717999502658848
number samples = 2729
accuracy = 0.909857
precision class 0 = 0.917228
precision class 1 = 0.576271
recall class 0 = 0.989895
recall class 1 = 0.133333
false negative rate = 0.866667
false positive rate = 0.010105
positive prediction rate = 0.02162
AUC of ROC = 0.747785
AUC of PRC = 0.316099
min(+P, Se) = 0.364706

-------------------------------

confusion matrix:
[[1664   19]
 [ 178   38]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1295810043811798
difference in average predicted and observed risk = 0.01583700438117981
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.903366
precision class 1 = 0.666667
recall class 0 = 0.988711
recall class 1 = 0.175926
false negative rate = 0.824074
false positive rate = 0.011289
positive prediction rate = 0.030016
AUC of ROC = 0.77967
AUC of PRC = 0.419458
min(+P, Se) = 0.410959

-------------------------------

confusion matrix:
[[539  10]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13791100680828094
difference in average predicted and observed risk = 0.014908006808280944
number samples = 626
accuracy = 0.878594
precision class 0 = 0.890909
precision class 1 = 0.52381
recall class 0 = 0.981785
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.018215
positive prediction rate = 0.033546
AUC of ROC = 0.735765
AUC of PRC = 0.327858
min(+P, Se) = 0.35443

-------------------------------

confusion matrix:
[[2239   10]
 [ 190   18]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.10715600103139877
difference in average predicted and observed risk = 0.022500001031398778
number samples = 2457
accuracy = 0.9186
precision class 0 = 0.921779
precision class 1 = 0.642857
recall class 0 = 0.995554
recall class 1 = 0.086538
false negative rate = 0.913462
false positive rate = 0.004446
positive prediction rate = 0.011396
AUC of ROC = 0.751095
AUC of PRC = 0.301958
min(+P, Se) = 0.322115

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11601199954748154
difference in average predicted and observed risk = 0.01520599954748153
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.665291
AUC of PRC = 0.185514
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[471  10]
 [ 56  26]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.15781700611114502
difference in average predicted and observed risk = 0.01216900611114502
number samples = 563
accuracy = 0.882771
precision class 0 = 0.893738
precision class 1 = 0.722222
recall class 0 = 0.97921
recall class 1 = 0.317073
false negative rate = 0.682927
false positive rate = 0.02079
positive prediction rate = 0.063943
AUC of ROC = 0.801734
AUC of PRC = 0.559416
min(+P, Se) = 0.542169

-------------------------------

confusion matrix:
[[645  10]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.13056500256061554
difference in average predicted and observed risk = 0.022936002560615537
number samples = 734
accuracy = 0.901907
precision class 0 = 0.912306
precision class 1 = 0.62963
recall class 0 = 0.984733
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.015267
positive prediction rate = 0.036785
AUC of ROC = 0.78767
AUC of PRC = 0.414255
min(+P, Se) = 0.4125

-------------------------------

confusion matrix:
[[4113   44]
 [ 399   72]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.12166599929332733
difference in average predicted and observed risk = 0.01989399929332733
number samples = 4628
accuracy = 0.904278
precision class 0 = 0.911569
precision class 1 = 0.62069
recall class 0 = 0.989415
recall class 1 = 0.152866
false negative rate = 0.847134
false positive rate = 0.010585
positive prediction rate = 0.025065
AUC of ROC = 0.762668
AUC of PRC = 0.366988
min(+P, Se) = 0.3875

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.11525599658489227
difference in average predicted and observed risk = 0.03508699658489227
number samples = 237
accuracy = 0.924051
precision class 0 = 0.934783
precision class 1 = 0.571429
recall class 0 = 0.986239
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.013761
positive prediction rate = 0.029536
AUC of ROC = 0.816997
AUC of PRC = 0.371047
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.11899600178003311
difference in average predicted and observed risk = 0.010200001780033108
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.745676
AUC of PRC = 0.400728
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1438239961862564
difference in average predicted and observed risk = 0.033654996186256406
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.89304
AUC of PRC = 0.629769
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1468600034713745
difference in average predicted and observed risk = 0.013527003471374505
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.13109800219535828
difference in average predicted and observed risk = 0.016054002195358283
number samples = 339
accuracy = 0.882006
precision class 0 = 0.889222
precision class 1 = 0.4
recall class 0 = 0.99
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.01
positive prediction rate = 0.014749
AUC of ROC = 0.763077
AUC of PRC = 0.339787
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.11643700301647186
difference in average predicted and observed risk = 0.024387003016471856
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.823733
AUC of PRC = 0.544211
min(+P, Se) = 0.489796

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.10777299851179123
difference in average predicted and observed risk = 0.018570998511791226
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.789745
AUC of PRC = 0.426433
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.14909100532531738
difference in average predicted and observed risk = 0.03144400532531738
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.937963
AUC of PRC = 0.698175
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.131849005818367
difference in average predicted and observed risk = 0.04313900581836701
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.740145
AUC of PRC = 0.188591
min(+P, Se) = 0.3125

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.13456299901008606
difference in average predicted and observed risk = -0.01504300098991393
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.774366
AUC of PRC = 0.530096
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14583200216293335
difference in average predicted and observed risk = 0.06688500216293335
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.92381
AUC of PRC = 0.569444
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[730   4]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.12251999974250793
difference in average predicted and observed risk = 0.020928999742507934
number samples = 817
accuracy = 0.909425
precision class 0 = 0.9125
precision class 1 = 0.764706
recall class 0 = 0.99455
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.00545
positive prediction rate = 0.020808
AUC of ROC = 0.799087
AUC of PRC = 0.452273
min(+P, Se) = 0.46988

-------------------------------

Epoch 00008: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch8.state
Epoch 9/100
 - 302s - loss: 0.2901 - val_loss: 0.2613

==>predicting on train



confusion matrix:
[[2137   18]
 [ 220   35]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0910940021276474
difference in average predicted and observed risk = -0.0147149978723526
number samples = 2410
accuracy = 0.901245
precision class 0 = 0.906661
precision class 1 = 0.660377
recall class 0 = 0.991647
recall class 1 = 0.137255
false negative rate = 0.862745
false positive rate = 0.008353
positive prediction rate = 0.021992
AUC of ROC = 0.757924
AUC of PRC = 0.374862
min(+P, Se) = 0.388235

-------------------------------

confusion matrix:
[[1163   16]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08880399912595749
difference in average predicted and observed risk = -0.0021750008740425153
number samples = 1297
accuracy = 0.90825
precision class 0 = 0.918641
precision class 1 = 0.483871
recall class 0 = 0.986429
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.013571
positive prediction rate = 0.023901
AUC of ROC = 0.785764
AUC of PRC = 0.309085
min(+P, Se) = 0.355932

-------------------------------

confusion matrix:
[[646  10]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10138499736785889
difference in average predicted and observed risk = 1.4997367858884947e-05
number samples = 730
accuracy = 0.90274
precision class 0 = 0.91372
precision class 1 = 0.565217
recall class 0 = 0.984756
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.015244
positive prediction rate = 0.031507
AUC of ROC = 0.751545
AUC of PRC = 0.377975
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[166   1]
 [ 16   8]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10263600200414658
difference in average predicted and observed risk = -0.023017997995853412
number samples = 191
accuracy = 0.910995
precision class 0 = 0.912088
precision class 1 = 0.888889
recall class 0 = 0.994012
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.005988
positive prediction rate = 0.04712
AUC of ROC = 0.84506
AUC of PRC = 0.664833
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2446   28]
 [ 220   35]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08808699995279312
difference in average predicted and observed risk = -0.005354000047206875
number samples = 2729
accuracy = 0.909124
precision class 0 = 0.917479
precision class 1 = 0.555556
recall class 0 = 0.988682
recall class 1 = 0.137255
false negative rate = 0.862745
false positive rate = 0.011318
positive prediction rate = 0.023085
AUC of ROC = 0.753572
AUC of PRC = 0.325827
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[1666   17]
 [ 180   36]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09896799921989441
difference in average predicted and observed risk = -0.014776000780105589
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.902492
precision class 1 = 0.679245
recall class 0 = 0.989899
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.010101
positive prediction rate = 0.027909
AUC of ROC = 0.791111
AUC of PRC = 0.4269
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[540   9]
 [ 67  10]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10818299651145935
difference in average predicted and observed risk = -0.01482000348854065
number samples = 626
accuracy = 0.878594
precision class 0 = 0.889621
precision class 1 = 0.526316
recall class 0 = 0.983607
recall class 1 = 0.12987
false negative rate = 0.87013
false positive rate = 0.016393
positive prediction rate = 0.030351
AUC of ROC = 0.746055
AUC of PRC = 0.328316
min(+P, Se) = 0.359223

-------------------------------

confusion matrix:
[[2239   10]
 [ 190   18]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.077845998108387
difference in average predicted and observed risk = -0.006810001891613002
number samples = 2457
accuracy = 0.9186
precision class 0 = 0.921779
precision class 1 = 0.642857
recall class 0 = 0.995554
recall class 1 = 0.086538
false negative rate = 0.913462
false positive rate = 0.004446
positive prediction rate = 0.011396
AUC of ROC = 0.753557
AUC of PRC = 0.306803
min(+P, Se) = 0.32243

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08839400112628937
difference in average predicted and observed risk = -0.012411998873710639
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.696861
AUC of PRC = 0.19738
min(+P, Se) = 0.285714

-------------------------------

confusion matrix:
[[471  10]
 [ 55  27]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12958799302577972
difference in average predicted and observed risk = -0.016060006974220276
number samples = 563
accuracy = 0.884547
precision class 0 = 0.895437
precision class 1 = 0.72973
recall class 0 = 0.97921
recall class 1 = 0.329268
false negative rate = 0.670732
false positive rate = 0.02079
positive prediction rate = 0.065719
AUC of ROC = 0.808149
AUC of PRC = 0.569404
min(+P, Se) = 0.526882

-------------------------------

confusion matrix:
[[644  11]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10144499689340591
difference in average predicted and observed risk = -0.006184003106594088
number samples = 734
accuracy = 0.899183
precision class 0 = 0.910891
precision class 1 = 0.592593
recall class 0 = 0.983206
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.016794
positive prediction rate = 0.036785
AUC of ROC = 0.793101
AUC of PRC = 0.412644
min(+P, Se) = 0.433735

-------------------------------

confusion matrix:
[[4112   45]
 [ 400   71]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09255199879407883
difference in average predicted and observed risk = -0.009220001205921174
number samples = 4628
accuracy = 0.903846
precision class 0 = 0.911348
precision class 1 = 0.612069
recall class 0 = 0.989175
recall class 1 = 0.150743
false negative rate = 0.849257
false positive rate = 0.010825
positive prediction rate = 0.025065
AUC of ROC = 0.7698
AUC of PRC = 0.37269
min(+P, Se) = 0.385567

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08604999631643295
difference in average predicted and observed risk = 0.005880996316432949
number samples = 237
accuracy = 0.92827
precision class 0 = 0.935065
precision class 1 = 0.666667
recall class 0 = 0.990826
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.009174
positive prediction rate = 0.025316
AUC of ROC = 0.838242
AUC of PRC = 0.388204
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09045299887657166
difference in average predicted and observed risk = -0.01834300112342835
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.749876
AUC of PRC = 0.401728
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.113987997174263
difference in average predicted and observed risk = 0.0038189971742629975
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.904029
AUC of PRC = 0.642144
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12265100330114365
difference in average predicted and observed risk = -0.01068199669885636
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1016480028629303
difference in average predicted and observed risk = -0.013395997137069696
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.78453
AUC of PRC = 0.342712
min(+P, Se) = 0.44186

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08816099911928177
difference in average predicted and observed risk = -0.003889000880718238
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.828865
AUC of PRC = 0.550019
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07905200123786926
difference in average predicted and observed risk = -0.01014999876213074
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.807786
AUC of PRC = 0.437322
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12041100114583969
difference in average predicted and observed risk = 0.0027640011458396896
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.940741
AUC of PRC = 0.696915
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10187999904155731
difference in average predicted and observed risk = 0.013169999041557315
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.759453
AUC of PRC = 0.202064
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1048789992928505
difference in average predicted and observed risk = -0.044727000707149495
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.783138
AUC of PRC = 0.550544
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12339799851179123
difference in average predicted and observed risk = 0.044450998511791226
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09375700354576111
difference in average predicted and observed risk = -0.007833996454238892
number samples = 817
accuracy = 0.909425
precision class 0 = 0.911471
precision class 1 = 0.8
recall class 0 = 0.995913
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.004087
positive prediction rate = 0.01836
AUC of ROC = 0.810249
AUC of PRC = 0.466982
min(+P, Se) = 0.488095

-------------------------------

Epoch 00009: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch9.state
Epoch 10/100
 - 311s - loss: 0.2881 - val_loss: 0.2642

==>predicting on train



confusion matrix:
[[2152    3]
 [ 237   18]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.081727996468544
difference in average predicted and observed risk = -0.024081003531455994
number samples = 2410
accuracy = 0.900415
precision class 0 = 0.900795
precision class 1 = 0.857143
recall class 0 = 0.998608
recall class 1 = 0.070588
false negative rate = 0.929412
false positive rate = 0.001392
positive prediction rate = 0.008714
AUC of ROC = 0.760782
AUC of PRC = 0.377764
min(+P, Se) = 0.394531

-------------------------------

confusion matrix:
[[1176    3]
 [ 115    3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07731799781322479
difference in average predicted and observed risk = -0.013661002186775212
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.910922
precision class 1 = 0.5
recall class 0 = 0.997455
recall class 1 = 0.025424
false negative rate = 0.974576
false positive rate = 0.002545
positive prediction rate = 0.004626
AUC of ROC = 0.791528
AUC of PRC = 0.309463
min(+P, Se) = 0.369748

-------------------------------

confusion matrix:
[[656   0]
 [ 70   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0866909995675087
difference in average predicted and observed risk = -0.014679000432491304
number samples = 730
accuracy = 0.90411
precision class 0 = 0.903581
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.054054
false negative rate = 0.945946
false positive rate = 0.0
positive prediction rate = 0.005479
AUC of ROC = 0.751195
AUC of PRC = 0.370587
min(+P, Se) = 0.418919

-------------------------------

confusion matrix:
[[167   0]
 [ 19   5]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.08918900042772293
difference in average predicted and observed risk = -0.03646499957227706
number samples = 191
accuracy = 0.900524
precision class 0 = 0.897849
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.0
positive prediction rate = 0.026178
AUC of ROC = 0.85479
AUC of PRC = 0.671297
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2471    3]
 [ 245   10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07858800143003464
difference in average predicted and observed risk = -0.014852998569965359
number samples = 2729
accuracy = 0.909124
precision class 0 = 0.909794
precision class 1 = 0.769231
recall class 0 = 0.998787
recall class 1 = 0.039216
false negative rate = 0.960784
false positive rate = 0.001213
positive prediction rate = 0.004764
AUC of ROC = 0.753223
AUC of PRC = 0.329734
min(+P, Se) = 0.370229

-------------------------------

confusion matrix:
[[1680    3]
 [ 196   20]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08588600158691406
difference in average predicted and observed risk = -0.027857998413085935
number samples = 1899
accuracy = 0.895208
precision class 0 = 0.895522
precision class 1 = 0.869565
recall class 0 = 0.998217
recall class 1 = 0.092593
false negative rate = 0.907407
false positive rate = 0.001783
positive prediction rate = 0.012112
AUC of ROC = 0.795897
AUC of PRC = 0.425552
min(+P, Se) = 0.421525

-------------------------------

confusion matrix:
[[547   2]
 [ 75   2]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09414699673652649
difference in average predicted and observed risk = -0.028856003263473512
number samples = 626
accuracy = 0.876997
precision class 0 = 0.879421
precision class 1 = 0.5
recall class 0 = 0.996357
recall class 1 = 0.025974
false negative rate = 0.974026
false positive rate = 0.003643
positive prediction rate = 0.00639
AUC of ROC = 0.755636
AUC of PRC = 0.348508
min(+P, Se) = 0.390244

-------------------------------

confusion matrix:
[[2248    1]
 [ 203    5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07003100216388702
difference in average predicted and observed risk = -0.014624997836112971
number samples = 2457
accuracy = 0.916972
precision class 0 = 0.917177
precision class 1 = 0.833333
recall class 0 = 0.999555
recall class 1 = 0.024038
false negative rate = 0.975962
false positive rate = 0.000445
positive prediction rate = 0.002442
AUC of ROC = 0.753102
AUC of PRC = 0.307023
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[223   0]
 [ 25   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.07880900055170059
difference in average predicted and observed risk = -0.021996999448299415
number samples = 248
accuracy = 0.899194
precision class 0 = 0.899194
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.713004
AUC of PRC = 0.198933
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[479   2]
 [ 65  17]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11025699973106384
difference in average predicted and observed risk = -0.03539100026893616
number samples = 563
accuracy = 0.880995
precision class 0 = 0.880515
precision class 1 = 0.894737
recall class 0 = 0.995842
recall class 1 = 0.207317
false negative rate = 0.792683
false positive rate = 0.004158
positive prediction rate = 0.033748
AUC of ROC = 0.809568
AUC of PRC = 0.570959
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[654   1]
 [ 73   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.0884770005941391
difference in average predicted and observed risk = -0.019151999405860903
number samples = 734
accuracy = 0.899183
precision class 0 = 0.899587
precision class 1 = 0.857143
recall class 0 = 0.998473
recall class 1 = 0.075949
false negative rate = 0.924051
false positive rate = 0.001527
positive prediction rate = 0.009537
AUC of ROC = 0.796251
AUC of PRC = 0.414251
min(+P, Se) = 0.432099

-------------------------------

confusion matrix:
[[4151    6]
 [ 441   30]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08158300071954727
difference in average predicted and observed risk = -0.02018899928045273
number samples = 4628
accuracy = 0.903414
precision class 0 = 0.903963
precision class 1 = 0.833333
recall class 0 = 0.998557
recall class 1 = 0.063694
false negative rate = 0.936306
false positive rate = 0.001443
positive prediction rate = 0.007779
AUC of ROC = 0.772646
AUC of PRC = 0.374731
min(+P, Se) = 0.392931

-------------------------------

==>predicting on validation



confusion matrix:
[[217   1]
 [ 18   1]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07507199794054031
difference in average predicted and observed risk = -0.00509700205945969
number samples = 237
accuracy = 0.919831
precision class 0 = 0.923404
precision class 1 = 0.5
recall class 0 = 0.995413
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.004587
positive prediction rate = 0.008439
AUC of ROC = 0.845727
AUC of PRC = 0.350529
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 45   2]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0810299962759018
difference in average predicted and observed risk = -0.02776600372409821
number samples = 432
accuracy = 0.895833
precision class 0 = 0.895349
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.042553
false negative rate = 0.957447
false positive rate = 0.0
positive prediction rate = 0.00463
AUC of ROC = 0.751257
AUC of PRC = 0.402684
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[105   0]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09695599973201752
difference in average predicted and observed risk = -0.013213000267982486
number samples = 118
accuracy = 0.90678
precision class 0 = 0.905172
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.0
positive prediction rate = 0.016949
AUC of ROC = 0.912821
AUC of PRC = 0.666665
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.10844799876213074
difference in average predicted and observed risk = -0.02488500123786927
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[300   0]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08761999756097794
difference in average predicted and observed risk = -0.027424002439022058
number samples = 339
accuracy = 0.887906
precision class 0 = 0.887574
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.0
positive prediction rate = 0.00295
AUC of ROC = 0.788974
AUC of PRC = 0.353006
min(+P, Se) = 0.413043

-------------------------------

confusion matrix:
[[433   1]
 [ 38   6]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07905399799346924
difference in average predicted and observed risk = -0.012996002006530769
number samples = 478
accuracy = 0.91841
precision class 0 = 0.919321
precision class 1 = 0.857143
recall class 0 = 0.997696
recall class 1 = 0.136364
false negative rate = 0.863636
false positive rate = 0.002304
positive prediction rate = 0.014644
AUC of ROC = 0.83651
AUC of PRC = 0.531636
min(+P, Se) = 0.510638

-------------------------------

confusion matrix:
[[388   0]
 [ 36   2]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07108200341463089
difference in average predicted and observed risk = -0.018119996585369114
number samples = 426
accuracy = 0.915493
precision class 0 = 0.915094
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.0
positive prediction rate = 0.004695
AUC of ROC = 0.81016
AUC of PRC = 0.440048
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[90  0]
 [10  2]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10136000066995621
difference in average predicted and observed risk = -0.016286999330043794
number samples = 102
accuracy = 0.901961
precision class 0 = 0.9
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.0
positive prediction rate = 0.019608
AUC of ROC = 0.939815
AUC of PRC = 0.719716
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08912099897861481
difference in average predicted and observed risk = 0.00041099897861480994
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.777957
AUC of PRC = 0.220762
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[108   0]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09236600250005722
difference in average predicted and observed risk = -0.05723999749994277
number samples = 127
accuracy = 0.874016
precision class 0 = 0.870968
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.0
positive prediction rate = 0.023622
AUC of ROC = 0.795322
AUC of PRC = 0.559734
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1076280027627945
difference in average predicted and observed risk = 0.02868100276279449
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.518849
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[733   1]
 [ 76   7]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08260899782180786
difference in average predicted and observed risk = -0.01898200217819214
number samples = 817
accuracy = 0.905753
precision class 0 = 0.906057
precision class 1 = 0.875
recall class 0 = 0.998638
recall class 1 = 0.084337
false negative rate = 0.915663
false positive rate = 0.001362
positive prediction rate = 0.009792
AUC of ROC = 0.81716
AUC of PRC = 0.462644
min(+P, Se) = 0.454545

-------------------------------

Epoch 00010: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch10.state
Epoch 11/100
 - 313s - loss: 0.2891 - val_loss: 0.2639

==>predicting on train



confusion matrix:
[[2147    8]
 [ 234   21]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0947130024433136
difference in average predicted and observed risk = -0.011095997556686402
number samples = 2410
accuracy = 0.899585
precision class 0 = 0.901722
precision class 1 = 0.724138
recall class 0 = 0.996288
recall class 1 = 0.082353
false negative rate = 0.917647
false positive rate = 0.003712
positive prediction rate = 0.012033
AUC of ROC = 0.762617
AUC of PRC = 0.380974
min(+P, Se) = 0.378906

-------------------------------

confusion matrix:
[[1169   10]
 [ 110    8]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09004899859428406
difference in average predicted and observed risk = -0.0009300014057159467
number samples = 1297
accuracy = 0.907479
precision class 0 = 0.913995
precision class 1 = 0.444444
recall class 0 = 0.991518
recall class 1 = 0.067797
false negative rate = 0.932203
false positive rate = 0.008482
positive prediction rate = 0.013878
AUC of ROC = 0.790651
AUC of PRC = 0.313918
min(+P, Se) = 0.355932

-------------------------------

confusion matrix:
[[652   4]
 [ 65   9]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.1009339988231659
difference in average predicted and observed risk = -0.0004360011768341082
number samples = 730
accuracy = 0.905479
precision class 0 = 0.909344
precision class 1 = 0.692308
recall class 0 = 0.993902
recall class 1 = 0.121622
false negative rate = 0.878378
false positive rate = 0.006098
positive prediction rate = 0.017808
AUC of ROC = 0.758487
AUC of PRC = 0.37651
min(+P, Se) = 0.405405

-------------------------------

confusion matrix:
[[166   1]
 [ 16   8]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10817500203847885
difference in average predicted and observed risk = -0.017478997961521137
number samples = 191
accuracy = 0.910995
precision class 0 = 0.912088
precision class 1 = 0.888889
recall class 0 = 0.994012
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.005988
positive prediction rate = 0.04712
AUC of ROC = 0.851297
AUC of PRC = 0.673553
min(+P, Se) = 0.653846

-------------------------------

confusion matrix:
[[2462   12]
 [ 237   18]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09064800292253494
difference in average predicted and observed risk = -0.0027929970774650537
number samples = 2729
accuracy = 0.908758
precision class 0 = 0.91219
precision class 1 = 0.6
recall class 0 = 0.99515
recall class 1 = 0.070588
false negative rate = 0.929412
false positive rate = 0.00485
positive prediction rate = 0.010993
AUC of ROC = 0.756279
AUC of PRC = 0.329071
min(+P, Se) = 0.373077

-------------------------------

confusion matrix:
[[1672   11]
 [ 188   28]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10111600160598755
difference in average predicted and observed risk = -0.012627998394012449
number samples = 1899
accuracy = 0.895208
precision class 0 = 0.898925
precision class 1 = 0.717949
recall class 0 = 0.993464
recall class 1 = 0.12963
false negative rate = 0.87037
false positive rate = 0.006536
positive prediction rate = 0.020537
AUC of ROC = 0.796153
AUC of PRC = 0.436273
min(+P, Se) = 0.412037

-------------------------------

confusion matrix:
[[543   6]
 [ 72   5]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11315999925136566
difference in average predicted and observed risk = -0.00984300074863434
number samples = 626
accuracy = 0.875399
precision class 0 = 0.882927
precision class 1 = 0.454545
recall class 0 = 0.989071
recall class 1 = 0.064935
false negative rate = 0.935065
false positive rate = 0.010929
positive prediction rate = 0.017572
AUC of ROC = 0.758569
AUC of PRC = 0.342831
min(+P, Se) = 0.38961

-------------------------------

confusion matrix:
[[2247    2]
 [ 196   12]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08153100311756134
difference in average predicted and observed risk = -0.003124996882438655
number samples = 2457
accuracy = 0.919414
precision class 0 = 0.919771
precision class 1 = 0.857143
recall class 0 = 0.999111
recall class 1 = 0.057692
false negative rate = 0.942308
false positive rate = 0.000889
positive prediction rate = 0.005698
AUC of ROC = 0.762046
AUC of PRC = 0.310169
min(+P, Se) = 0.319048

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09227900207042694
difference in average predicted and observed risk = -0.008526997929573066
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.693453
AUC of PRC = 0.196266
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[476   5]
 [ 63  19]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1249919980764389
difference in average predicted and observed risk = -0.020656001923561096
number samples = 563
accuracy = 0.879218
precision class 0 = 0.883117
precision class 1 = 0.791667
recall class 0 = 0.989605
recall class 1 = 0.231707
false negative rate = 0.768293
false positive rate = 0.010395
positive prediction rate = 0.042629
AUC of ROC = 0.803205
AUC of PRC = 0.577589
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[650   5]
 [ 69  10]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10215499997138977
difference in average predicted and observed risk = -0.005474000028610232
number samples = 734
accuracy = 0.899183
precision class 0 = 0.904033
precision class 1 = 0.666667
recall class 0 = 0.992366
recall class 1 = 0.126582
false negative rate = 0.873418
false positive rate = 0.007634
positive prediction rate = 0.020436
AUC of ROC = 0.802957
AUC of PRC = 0.425451
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4134   23]
 [ 425   46]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09494300186634064
difference in average predicted and observed risk = -0.006828998133659364
number samples = 4628
accuracy = 0.903198
precision class 0 = 0.906778
precision class 1 = 0.666667
recall class 0 = 0.994467
recall class 1 = 0.097665
false negative rate = 0.902335
false positive rate = 0.005533
positive prediction rate = 0.014909
AUC of ROC = 0.774977
AUC of PRC = 0.38029
min(+P, Se) = 0.388535

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08731500059366226
difference in average predicted and observed risk = 0.007146000593662258
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.847417
AUC of PRC = 0.331757
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09442699700593948
difference in average predicted and observed risk = -0.01436900299406052
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.744405
AUC of PRC = 0.412997
min(+P, Se) = 0.387755

-------------------------------

confusion matrix:
[[105   0]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11172600090503693
difference in average predicted and observed risk = 0.0015570009050369232
number samples = 118
accuracy = 0.915254
precision class 0 = 0.913043
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.0
positive prediction rate = 0.025424
AUC of ROC = 0.902564
AUC of PRC = 0.682634
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13205400109291077
difference in average predicted and observed risk = -0.0012789989070892405
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[299   1]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10180599987506866
difference in average predicted and observed risk = -0.013238000124931329
number samples = 339
accuracy = 0.884956
precision class 0 = 0.88724
precision class 1 = 0.5
recall class 0 = 0.996667
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.003333
positive prediction rate = 0.0059
AUC of ROC = 0.779744
AUC of PRC = 0.35842
min(+P, Se) = 0.418605

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09229999780654907
difference in average predicted and observed risk = 0.00024999780654906545
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.827765
AUC of PRC = 0.531679
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08232200145721436
difference in average predicted and observed risk = -0.006879998542785648
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.800258
AUC of PRC = 0.434524
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11480899900197983
difference in average predicted and observed risk = -0.0028380009980201737
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.933333
AUC of PRC = 0.718129
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10863900184631348
difference in average predicted and observed risk = 0.01992900184631348
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.772325
AUC of PRC = 0.231326
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[107   1]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10851799696683884
difference in average predicted and observed risk = -0.04108800303316115
number samples = 127
accuracy = 0.866142
precision class 0 = 0.869919
precision class 1 = 0.75
recall class 0 = 0.990741
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009259
positive prediction rate = 0.031496
AUC of ROC = 0.775828
AUC of PRC = 0.55963
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1210160031914711
difference in average predicted and observed risk = 0.0420690031914711
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[732   2]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09624399989843369
difference in average predicted and observed risk = -0.0053470001015663154
number samples = 817
accuracy = 0.908201
precision class 0 = 0.909317
precision class 1 = 0.833333
recall class 0 = 0.997275
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.002725
positive prediction rate = 0.014688
AUC of ROC = 0.808165
AUC of PRC = 0.462154
min(+P, Se) = 0.445783

-------------------------------

Epoch 00011: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch11.state
Epoch 12/100
 - 314s - loss: 0.2866 - val_loss: 0.2605

==>predicting on train



confusion matrix:
[[2130   25]
 [ 208   47]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10484100133180618
difference in average predicted and observed risk = -0.0009679986681938174
number samples = 2410
accuracy = 0.903319
precision class 0 = 0.911035
precision class 1 = 0.652778
recall class 0 = 0.988399
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.011601
positive prediction rate = 0.029876
AUC of ROC = 0.770937
AUC of PRC = 0.386264
min(+P, Se) = 0.396078

-------------------------------

confusion matrix:
[[1155   24]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10374899953603745
difference in average predicted and observed risk = 0.01276999953603744
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.92474
precision class 1 = 0.5
recall class 0 = 0.979644
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.020356
positive prediction rate = 0.037008
AUC of ROC = 0.799909
AUC of PRC = 0.330907
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[640  16]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11769399791955948
difference in average predicted and observed risk = 0.016323997919559477
number samples = 730
accuracy = 0.89726
precision class 0 = 0.915594
precision class 1 = 0.483871
recall class 0 = 0.97561
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.02439
positive prediction rate = 0.042466
AUC of ROC = 0.766933
AUC of PRC = 0.38342
min(+P, Se) = 0.418919

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12874199450016022
difference in average predicted and observed risk = 0.0030879945001602294
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.851297
AUC of PRC = 0.670668
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2436   38]
 [ 206   49]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10239599645137787
difference in average predicted and observed risk = 0.008954996451377872
number samples = 2729
accuracy = 0.91059
precision class 0 = 0.922029
precision class 1 = 0.563218
recall class 0 = 0.98464
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.01536
positive prediction rate = 0.03188
AUC of ROC = 0.768025
AUC of PRC = 0.33552
min(+P, Se) = 0.378788

-------------------------------

confusion matrix:
[[1654   29]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11495400220155716
difference in average predicted and observed risk = 0.0012100022015571615
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.907794
precision class 1 = 0.623377
recall class 0 = 0.982769
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.017231
positive prediction rate = 0.040548
AUC of ROC = 0.799094
AUC of PRC = 0.439268
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[535  14]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13409799337387085
difference in average predicted and observed risk = 0.011094993373870848
number samples = 626
accuracy = 0.880192
precision class 0 = 0.897651
precision class 1 = 0.533333
recall class 0 = 0.974499
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.025501
positive prediction rate = 0.047923
AUC of ROC = 0.767227
AUC of PRC = 0.34538
min(+P, Se) = 0.376623

-------------------------------

confusion matrix:
[[2228   21]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08909700065851212
difference in average predicted and observed risk = 0.00444100065851212
number samples = 2457
accuracy = 0.9186
precision class 0 = 0.925634
precision class 1 = 0.58
recall class 0 = 0.990663
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.009337
positive prediction rate = 0.02035
AUC of ROC = 0.767839
AUC of PRC = 0.319447
min(+P, Se) = 0.317308

-------------------------------

confusion matrix:
[[216   7]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10231500118970871
difference in average predicted and observed risk = 0.001509001189708703
number samples = 248
accuracy = 0.870968
precision class 0 = 0.896266
precision class 1 = 0.0
recall class 0 = 0.96861
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.03139
positive prediction rate = 0.028226
AUC of ROC = 0.716951
AUC of PRC = 0.213446
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[469  12]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.150737002491951
difference in average predicted and observed risk = 0.005089002491950989
number samples = 563
accuracy = 0.889876
precision class 0 = 0.903661
precision class 1 = 0.727273
recall class 0 = 0.975052
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.024948
positive prediction rate = 0.078153
AUC of ROC = 0.819
AUC of PRC = 0.594791
min(+P, Se) = 0.547619

-------------------------------

confusion matrix:
[[642  13]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11531200259923935
difference in average predicted and observed risk = 0.007683002599239347
number samples = 734
accuracy = 0.901907
precision class 0 = 0.915835
precision class 1 = 0.606061
recall class 0 = 0.980153
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.019847
positive prediction rate = 0.044959
AUC of ROC = 0.802976
AUC of PRC = 0.422837
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[4090   67]
 [ 374   97]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10754899680614471
difference in average predicted and observed risk = 0.005776996806144713
number samples = 4628
accuracy = 0.90471
precision class 0 = 0.916219
precision class 1 = 0.591463
recall class 0 = 0.983883
recall class 1 = 0.205945
false negative rate = 0.794055
false positive rate = 0.016117
positive prediction rate = 0.035436
AUC of ROC = 0.782499
AUC of PRC = 0.386476
min(+P, Se) = 0.400424

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10033299773931503
difference in average predicted and observed risk = 0.02016399773931503
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.852004
AUC of PRC = 0.337836
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10514900088310242
difference in average predicted and observed risk = -0.003646999116897587
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.75601
AUC of PRC = 0.407888
min(+P, Se) = 0.382979

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1341399997472763
difference in average predicted and observed risk = 0.023970999747276303
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.903297
AUC of PRC = 0.576731
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1516679972410202
difference in average predicted and observed risk = 0.018334997241020196
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[296   4]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11830899864435196
difference in average predicted and observed risk = 0.0032649986443519657
number samples = 339
accuracy = 0.884956
precision class 0 = 0.89426
precision class 1 = 0.5
recall class 0 = 0.986667
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.013333
positive prediction rate = 0.023599
AUC of ROC = 0.78735
AUC of PRC = 0.345651
min(+P, Se) = 0.409091

-------------------------------

confusion matrix:
[[432   2]
 [ 31  13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.1035040020942688
difference in average predicted and observed risk = 0.011454002094268792
number samples = 478
accuracy = 0.930962
precision class 0 = 0.933045
precision class 1 = 0.866667
recall class 0 = 0.995392
recall class 1 = 0.295455
false negative rate = 0.704545
false positive rate = 0.004608
positive prediction rate = 0.031381
AUC of ROC = 0.836406
AUC of PRC = 0.544052
min(+P, Se) = 0.488889

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09038899838924408
difference in average predicted and observed risk = 0.001186998389244076
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.816129
AUC of PRC = 0.431478
min(+P, Se) = 0.395349

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13911299407482147
difference in average predicted and observed risk = 0.02146599407482147
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.927778
AUC of PRC = 0.696818
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[111   2]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.12965500354766846
difference in average predicted and observed risk = 0.04094500354766846
number samples = 124
accuracy = 0.895161
precision class 0 = 0.909836
precision class 1 = 0.0
recall class 0 = 0.982301
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017699
positive prediction rate = 0.016129
AUC of ROC = 0.783588
AUC of PRC = 0.226458
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12165900319814682
difference in average predicted and observed risk = -0.02794699680185317
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.78655
AUC of PRC = 0.532631
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1410139948129654
difference in average predicted and observed risk = 0.06206699481296539
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[728   6]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1096469983458519
difference in average predicted and observed risk = 0.008055998345851897
number samples = 817
accuracy = 0.911873
precision class 0 = 0.916877
precision class 1 = 0.73913
recall class 0 = 0.991826
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.008174
positive prediction rate = 0.028152
AUC of ROC = 0.816372
AUC of PRC = 0.451554
min(+P, Se) = 0.46988

-------------------------------

Epoch 00012: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch12.state
Epoch 13/100
 - 315s - loss: 0.2850 - val_loss: 0.2649

==>predicting on train



confusion matrix:
[[2150    5]
 [ 235   20]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08132699877023697
difference in average predicted and observed risk = -0.02448200122976303
number samples = 2410
accuracy = 0.900415
precision class 0 = 0.901468
precision class 1 = 0.8
recall class 0 = 0.99768
recall class 1 = 0.078431
false negative rate = 0.921569
false positive rate = 0.00232
positive prediction rate = 0.010373
AUC of ROC = 0.776827
AUC of PRC = 0.395824
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1169   10]
 [ 108   10]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07920199632644653
difference in average predicted and observed risk = -0.011777003673553471
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.915427
precision class 1 = 0.5
recall class 0 = 0.991518
recall class 1 = 0.084746
false negative rate = 0.915254
false positive rate = 0.008482
positive prediction rate = 0.01542
AUC of ROC = 0.784527
AUC of PRC = 0.317303
min(+P, Se) = 0.368852

-------------------------------

confusion matrix:
[[653   3]
 [ 68   6]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08621600270271301
difference in average predicted and observed risk = -0.015153997297286989
number samples = 730
accuracy = 0.90274
precision class 0 = 0.905687
precision class 1 = 0.666667
recall class 0 = 0.995427
recall class 1 = 0.081081
false negative rate = 0.918919
false positive rate = 0.004573
positive prediction rate = 0.012329
AUC of ROC = 0.769199
AUC of PRC = 0.382084
min(+P, Se) = 0.391892

-------------------------------

confusion matrix:
[[166   1]
 [ 17   7]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09201999753713608
difference in average predicted and observed risk = -0.03363400246286391
number samples = 191
accuracy = 0.905759
precision class 0 = 0.907104
precision class 1 = 0.875
recall class 0 = 0.994012
recall class 1 = 0.291667
false negative rate = 0.708333
false positive rate = 0.005988
positive prediction rate = 0.041885
AUC of ROC = 0.868263
AUC of PRC = 0.680123
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2464   10]
 [ 240   15]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07963799685239792
difference in average predicted and observed risk = -0.013803003147602078
number samples = 2729
accuracy = 0.908391
precision class 0 = 0.911243
precision class 1 = 0.6
recall class 0 = 0.995958
recall class 1 = 0.058824
false negative rate = 0.941176
false positive rate = 0.004042
positive prediction rate = 0.009161
AUC of ROC = 0.768233
AUC of PRC = 0.337843
min(+P, Se) = 0.380392

-------------------------------

confusion matrix:
[[1674    9]
 [ 188   28]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08525700122117996
difference in average predicted and observed risk = -0.028486998778820036
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.899033
precision class 1 = 0.756757
recall class 0 = 0.994652
recall class 1 = 0.12963
false negative rate = 0.87037
false positive rate = 0.005348
positive prediction rate = 0.019484
AUC of ROC = 0.798079
AUC of PRC = 0.444955
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[543   6]
 [ 73   4]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09630399942398071
difference in average predicted and observed risk = -0.02669900057601929
number samples = 626
accuracy = 0.873802
precision class 0 = 0.881494
precision class 1 = 0.4
recall class 0 = 0.989071
recall class 1 = 0.051948
false negative rate = 0.948052
false positive rate = 0.010929
positive prediction rate = 0.015974
AUC of ROC = 0.768363
AUC of PRC = 0.345993
min(+P, Se) = 0.402597

-------------------------------

confusion matrix:
[[2247    2]
 [ 197   11]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07057200372219086
difference in average predicted and observed risk = -0.014083996277809138
number samples = 2457
accuracy = 0.919007
precision class 0 = 0.919394
precision class 1 = 0.846154
recall class 0 = 0.999111
recall class 1 = 0.052885
false negative rate = 0.947115
false positive rate = 0.000889
positive prediction rate = 0.005291
AUC of ROC = 0.766879
AUC of PRC = 0.326634
min(+P, Se) = 0.322115

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08350100368261337
difference in average predicted and observed risk = -0.017304996317386634
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.70296
AUC of PRC = 0.2052
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[477   4]
 [ 64  18]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.10757800191640854
difference in average predicted and observed risk = -0.03806999808359146
number samples = 563
accuracy = 0.879218
precision class 0 = 0.881701
precision class 1 = 0.818182
recall class 0 = 0.991684
recall class 1 = 0.219512
false negative rate = 0.780488
false positive rate = 0.008316
positive prediction rate = 0.039076
AUC of ROC = 0.82293
AUC of PRC = 0.588222
min(+P, Se) = 0.535714

-------------------------------

confusion matrix:
[[651   4]
 [ 69  10]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08757500350475311
difference in average predicted and observed risk = -0.02005399649524689
number samples = 734
accuracy = 0.900545
precision class 0 = 0.904167
precision class 1 = 0.714286
recall class 0 = 0.993893
recall class 1 = 0.126582
false negative rate = 0.873418
false positive rate = 0.006107
positive prediction rate = 0.019074
AUC of ROC = 0.794299
AUC of PRC = 0.413555
min(+P, Se) = 0.433333

-------------------------------

confusion matrix:
[[4138   19]
 [ 428   43]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08194400370121002
difference in average predicted and observed risk = -0.01982799629878998
number samples = 4628
accuracy = 0.903414
precision class 0 = 0.906264
precision class 1 = 0.693548
recall class 0 = 0.995429
recall class 1 = 0.091295
false negative rate = 0.908705
false positive rate = 0.004571
positive prediction rate = 0.013397
AUC of ROC = 0.781974
AUC of PRC = 0.389099
min(+P, Se) = 0.399151

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 18   1]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07849500328302383
difference in average predicted and observed risk = -0.00167399671697617
number samples = 237
accuracy = 0.915612
precision class 0 = 0.923077
precision class 1 = 0.333333
recall class 0 = 0.990826
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.009174
positive prediction rate = 0.012658
AUC of ROC = 0.806374
AUC of PRC = 0.313955
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 45   2]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07816199958324432
difference in average predicted and observed risk = -0.03063400041675568
number samples = 432
accuracy = 0.895833
precision class 0 = 0.895349
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.042553
false negative rate = 0.957447
false positive rate = 0.0
positive prediction rate = 0.00463
AUC of ROC = 0.768721
AUC of PRC = 0.419739
min(+P, Se) = 0.408163

-------------------------------

confusion matrix:
[[105   0]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09544199705123901
difference in average predicted and observed risk = -0.01472700294876099
number samples = 118
accuracy = 0.90678
precision class 0 = 0.905172
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.0
positive prediction rate = 0.016949
AUC of ROC = 0.90989
AUC of PRC = 0.620108
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11428000032901764
difference in average predicted and observed risk = -0.019052999670982368
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[299   1]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08441600203514099
difference in average predicted and observed risk = -0.030627997964859002
number samples = 339
accuracy = 0.884956
precision class 0 = 0.88724
precision class 1 = 0.5
recall class 0 = 0.996667
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.003333
positive prediction rate = 0.0059
AUC of ROC = 0.78735
AUC of PRC = 0.359611
min(+P, Se) = 0.422222

-------------------------------

confusion matrix:
[[433   1]
 [ 38   6]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.080424003303051
difference in average predicted and observed risk = -0.011625996696949012
number samples = 478
accuracy = 0.91841
precision class 0 = 0.919321
precision class 1 = 0.857143
recall class 0 = 0.997696
recall class 1 = 0.136364
false negative rate = 0.863636
false positive rate = 0.002304
positive prediction rate = 0.014644
AUC of ROC = 0.833211
AUC of PRC = 0.519032
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[388   0]
 [ 36   2]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07024099677801132
difference in average predicted and observed risk = -0.01896100322198868
number samples = 426
accuracy = 0.915493
precision class 0 = 0.915094
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.0
positive prediction rate = 0.004695
AUC of ROC = 0.81423
AUC of PRC = 0.446391
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[90  0]
 [10  2]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09824900329113007
difference in average predicted and observed risk = -0.019397996708869936
number samples = 102
accuracy = 0.901961
precision class 0 = 0.9
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.0
positive prediction rate = 0.019608
AUC of ROC = 0.937037
AUC of PRC = 0.707557
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08986599743366241
difference in average predicted and observed risk = 0.0011559974336624174
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.800483
AUC of PRC = 0.229839
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[107   1]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09308400005102158
difference in average predicted and observed risk = -0.05652199994897841
number samples = 127
accuracy = 0.866142
precision class 0 = 0.869919
precision class 1 = 0.75
recall class 0 = 0.990741
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009259
positive prediction rate = 0.031496
AUC of ROC = 0.770468
AUC of PRC = 0.524931
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.10922800004482269
difference in average predicted and observed risk = 0.03028100004482269
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[732   2]
 [ 76   7]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08207999914884567
difference in average predicted and observed risk = -0.019511000851154328
number samples = 817
accuracy = 0.904529
precision class 0 = 0.905941
precision class 1 = 0.777778
recall class 0 = 0.997275
recall class 1 = 0.084337
false negative rate = 0.915663
false positive rate = 0.002725
positive prediction rate = 0.011016
AUC of ROC = 0.812859
AUC of PRC = 0.450877
min(+P, Se) = 0.458824

-------------------------------

Epoch 00013: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch13.state
Epoch 14/100
 - 315s - loss: 0.2867 - val_loss: 0.2635

==>predicting on train



confusion matrix:
[[2146    9]
 [ 228   27]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08480899780988693
difference in average predicted and observed risk = -0.021000002190113068
number samples = 2410
accuracy = 0.90166
precision class 0 = 0.90396
precision class 1 = 0.75
recall class 0 = 0.995824
recall class 1 = 0.105882
false negative rate = 0.894118
false positive rate = 0.004176
positive prediction rate = 0.014938
AUC of ROC = 0.764591
AUC of PRC = 0.388247
min(+P, Se) = 0.396887

-------------------------------

confusion matrix:
[[1167   12]
 [ 105   13]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08235099911689758
difference in average predicted and observed risk = -0.008628000883102421
number samples = 1297
accuracy = 0.909792
precision class 0 = 0.917453
precision class 1 = 0.52
recall class 0 = 0.989822
recall class 1 = 0.110169
false negative rate = 0.889831
false positive rate = 0.010178
positive prediction rate = 0.019275
AUC of ROC = 0.789731
AUC of PRC = 0.336674
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[653   3]
 [ 64  10]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09070499986410141
difference in average predicted and observed risk = -0.010665000135898592
number samples = 730
accuracy = 0.908219
precision class 0 = 0.910739
precision class 1 = 0.769231
recall class 0 = 0.995427
recall class 1 = 0.135135
false negative rate = 0.864865
false positive rate = 0.004573
positive prediction rate = 0.017808
AUC of ROC = 0.763946
AUC of PRC = 0.383224
min(+P, Se) = 0.405405

-------------------------------

confusion matrix:
[[166   1]
 [ 16   8]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09291300177574158
difference in average predicted and observed risk = -0.03274099822425841
number samples = 191
accuracy = 0.910995
precision class 0 = 0.912088
precision class 1 = 0.888889
recall class 0 = 0.994012
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.005988
positive prediction rate = 0.04712
AUC of ROC = 0.866267
AUC of PRC = 0.682494
min(+P, Se) = 0.64

-------------------------------

confusion matrix:
[[2460   14]
 [ 232   23]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08267500251531601
difference in average predicted and observed risk = -0.010765997484683987
number samples = 2729
accuracy = 0.909857
precision class 0 = 0.913819
precision class 1 = 0.621622
recall class 0 = 0.994341
recall class 1 = 0.090196
false negative rate = 0.909804
false positive rate = 0.005659
positive prediction rate = 0.013558
AUC of ROC = 0.75908
AUC of PRC = 0.340541
min(+P, Se) = 0.380392

-------------------------------

confusion matrix:
[[1672   11]
 [ 181   35]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08927900344133377
difference in average predicted and observed risk = -0.024464996558666227
number samples = 1899
accuracy = 0.898894
precision class 0 = 0.902321
precision class 1 = 0.76087
recall class 0 = 0.993464
recall class 1 = 0.162037
false negative rate = 0.837963
false positive rate = 0.006536
positive prediction rate = 0.024223
AUC of ROC = 0.799086
AUC of PRC = 0.440713
min(+P, Se) = 0.422727

-------------------------------

confusion matrix:
[[542   7]
 [ 71   6]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10056299716234207
difference in average predicted and observed risk = -0.02244000283765793
number samples = 626
accuracy = 0.875399
precision class 0 = 0.884176
precision class 1 = 0.461538
recall class 0 = 0.98725
recall class 1 = 0.077922
false negative rate = 0.922078
false positive rate = 0.01275
positive prediction rate = 0.020767
AUC of ROC = 0.761834
AUC of PRC = 0.340621
min(+P, Se) = 0.397436

-------------------------------

confusion matrix:
[[2245    4]
 [ 190   18]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07287199795246124
difference in average predicted and observed risk = -0.011784002047538752
number samples = 2457
accuracy = 0.921042
precision class 0 = 0.921971
precision class 1 = 0.818182
recall class 0 = 0.998221
recall class 1 = 0.086538
false negative rate = 0.913462
false positive rate = 0.001779
positive prediction rate = 0.008954
AUC of ROC = 0.76114
AUC of PRC = 0.321159
min(+P, Se) = 0.317308

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08540599793195724
difference in average predicted and observed risk = -0.015400002068042762
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.707444
AUC of PRC = 0.218965
min(+P, Se) = 0.296296

-------------------------------

confusion matrix:
[[477   4]
 [ 60  22]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11361800134181976
difference in average predicted and observed risk = -0.032029998658180237
number samples = 563
accuracy = 0.886323
precision class 0 = 0.888268
precision class 1 = 0.846154
recall class 0 = 0.991684
recall class 1 = 0.268293
false negative rate = 0.731707
false positive rate = 0.008316
positive prediction rate = 0.046181
AUC of ROC = 0.81256
AUC of PRC = 0.589145
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[649   6]
 [ 67  12]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09266199916601181
difference in average predicted and observed risk = -0.014967000833988192
number samples = 734
accuracy = 0.900545
precision class 0 = 0.906425
precision class 1 = 0.666667
recall class 0 = 0.99084
recall class 1 = 0.151899
false negative rate = 0.848101
false positive rate = 0.00916
positive prediction rate = 0.024523
AUC of ROC = 0.805199
AUC of PRC = 0.425309
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4132   25]
 [ 413   58]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08538500219583511
difference in average predicted and observed risk = -0.016386997804164888
number samples = 4628
accuracy = 0.905359
precision class 0 = 0.909131
precision class 1 = 0.698795
recall class 0 = 0.993986
recall class 1 = 0.123142
false negative rate = 0.876858
false positive rate = 0.006014
positive prediction rate = 0.017934
AUC of ROC = 0.777823
AUC of PRC = 0.38708
min(+P, Se) = 0.399151

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08032499998807907
difference in average predicted and observed risk = 0.0001559999880790669
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.845485
AUC of PRC = 0.34191
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08427099883556366
difference in average predicted and observed risk = -0.024525001164436344
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.746781
AUC of PRC = 0.404296
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10271099954843521
difference in average predicted and observed risk = -0.007458000451564792
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.890842
AUC of PRC = 0.587587
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11215999722480774
difference in average predicted and observed risk = -0.021173002775192268
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09162800014019012
difference in average predicted and observed risk = -0.02341599985980987
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.78359
AUC of PRC = 0.33926
min(+P, Se) = 0.434783

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08340000361204147
difference in average predicted and observed risk = -0.008649996387958533
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.828393
AUC of PRC = 0.531097
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07396700233221054
difference in average predicted and observed risk = -0.015234997667789463
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.801411
AUC of PRC = 0.423263
min(+P, Se) = 0.368421

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.105772003531456
difference in average predicted and observed risk = -0.011874996468544008
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.918519
AUC of PRC = 0.718153
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09388499706983566
difference in average predicted and observed risk = 0.005174997069835666
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.778761
AUC of PRC = 0.221162
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09945700317621231
difference in average predicted and observed risk = -0.05014899682378768
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.781189
AUC of PRC = 0.531161
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11462400108575821
difference in average predicted and observed risk = 0.035677001085758206
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[731   3]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08681400120258331
difference in average predicted and observed risk = -0.014776998797416688
number samples = 817
accuracy = 0.908201
precision class 0 = 0.910336
precision class 1 = 0.785714
recall class 0 = 0.995913
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.004087
positive prediction rate = 0.017136
AUC of ROC = 0.808805
AUC of PRC = 0.441249
min(+P, Se) = 0.465909

-------------------------------

Epoch 00014: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch14.state
Epoch 15/100
 - 322s - loss: 0.2860 - val_loss: 0.2664

==>predicting on train



confusion matrix:
[[2153    2]
 [ 239   16]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09118600189685822
difference in average predicted and observed risk = -0.014622998103141785
number samples = 2410
accuracy = 0.9
precision class 0 = 0.900084
precision class 1 = 0.888889
recall class 0 = 0.999072
recall class 1 = 0.062745
false negative rate = 0.937255
false positive rate = 0.000928
positive prediction rate = 0.007469
AUC of ROC = 0.760459
AUC of PRC = 0.387378
min(+P, Se) = 0.375969

-------------------------------

confusion matrix:
[[1173    6]
 [ 111    7]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08671899884939194
difference in average predicted and observed risk = -0.004260001150608067
number samples = 1297
accuracy = 0.909792
precision class 0 = 0.913551
precision class 1 = 0.538462
recall class 0 = 0.994911
recall class 1 = 0.059322
false negative rate = 0.940678
false positive rate = 0.005089
positive prediction rate = 0.010023
AUC of ROC = 0.777397
AUC of PRC = 0.338107
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[653   3]
 [ 67   7]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0941929966211319
difference in average predicted and observed risk = -0.007177003378868105
number samples = 730
accuracy = 0.90411
precision class 0 = 0.906944
precision class 1 = 0.7
recall class 0 = 0.995427
recall class 1 = 0.094595
false negative rate = 0.905405
false positive rate = 0.004573
positive prediction rate = 0.013699
AUC of ROC = 0.755129
AUC of PRC = 0.37966
min(+P, Se) = 0.405405

-------------------------------

confusion matrix:
[[166   1]
 [ 18   6]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09443599730730057
difference in average predicted and observed risk = -0.03121800269269942
number samples = 191
accuracy = 0.900524
precision class 0 = 0.902174
precision class 1 = 0.857143
recall class 0 = 0.994012
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.005988
positive prediction rate = 0.036649
AUC of ROC = 0.862774
AUC of PRC = 0.677601
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[2470    4]
 [ 245   10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08626099675893784
difference in average predicted and observed risk = -0.007180003241062161
number samples = 2729
accuracy = 0.908758
precision class 0 = 0.909761
precision class 1 = 0.714286
recall class 0 = 0.998383
recall class 1 = 0.039216
false negative rate = 0.960784
false positive rate = 0.001617
positive prediction rate = 0.00513
AUC of ROC = 0.749047
AUC of PRC = 0.334325
min(+P, Se) = 0.361538

-------------------------------

confusion matrix:
[[1675    8]
 [ 190   26]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09669499844312668
difference in average predicted and observed risk = -0.01704900155687332
number samples = 1899
accuracy = 0.895735
precision class 0 = 0.898123
precision class 1 = 0.764706
recall class 0 = 0.995247
recall class 1 = 0.12037
false negative rate = 0.87963
false positive rate = 0.004753
positive prediction rate = 0.017904
AUC of ROC = 0.794547
AUC of PRC = 0.443202
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[546   3]
 [ 76   1]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10303600132465363
difference in average predicted and observed risk = -0.019966998675346376
number samples = 626
accuracy = 0.873802
precision class 0 = 0.877814
precision class 1 = 0.25
recall class 0 = 0.994536
recall class 1 = 0.012987
false negative rate = 0.987013
false positive rate = 0.005464
positive prediction rate = 0.00639
AUC of ROC = 0.756984
AUC of PRC = 0.341924
min(+P, Se) = 0.405063

-------------------------------

confusion matrix:
[[2247    2]
 [ 199    9]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07990600168704987
difference in average predicted and observed risk = -0.004749998312950129
number samples = 2457
accuracy = 0.918193
precision class 0 = 0.918643
precision class 1 = 0.818182
recall class 0 = 0.999111
recall class 1 = 0.043269
false negative rate = 0.956731
false positive rate = 0.000889
positive prediction rate = 0.004477
AUC of ROC = 0.757131
AUC of PRC = 0.321757
min(+P, Se) = 0.330144

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09167099744081497
difference in average predicted and observed risk = -0.009135002559185035
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.693991
AUC of PRC = 0.205654
min(+P, Se) = 0.285714

-------------------------------

confusion matrix:
[[478   3]
 [ 64  18]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11432299762964249
difference in average predicted and observed risk = -0.03132500237035751
number samples = 563
accuracy = 0.880995
precision class 0 = 0.881919
precision class 1 = 0.857143
recall class 0 = 0.993763
recall class 1 = 0.219512
false negative rate = 0.780488
false positive rate = 0.006237
positive prediction rate = 0.0373
AUC of ROC = 0.799072
AUC of PRC = 0.580394
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[654   1]
 [ 71   8]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09687100350856781
difference in average predicted and observed risk = -0.010757996491432192
number samples = 734
accuracy = 0.901907
precision class 0 = 0.902069
precision class 1 = 0.888889
recall class 0 = 0.998473
recall class 1 = 0.101266
false negative rate = 0.898734
false positive rate = 0.001527
positive prediction rate = 0.012262
AUC of ROC = 0.794898
AUC of PRC = 0.42552
min(+P, Se) = 0.405063

-------------------------------

confusion matrix:
[[4145   12]
 [ 435   36]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09054200351238251
difference in average predicted and observed risk = -0.011229996487617494
number samples = 4628
accuracy = 0.903414
precision class 0 = 0.905022
precision class 1 = 0.75
recall class 0 = 0.997113
recall class 1 = 0.076433
false negative rate = 0.923567
false positive rate = 0.002887
positive prediction rate = 0.010372
AUC of ROC = 0.770658
AUC of PRC = 0.385228
min(+P, Se) = 0.389006

-------------------------------

==>predicting on validation



confusion matrix:
[[217   1]
 [ 18   1]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08624400198459625
difference in average predicted and observed risk = 0.006075001984596248
number samples = 237
accuracy = 0.919831
precision class 0 = 0.923404
precision class 1 = 0.5
recall class 0 = 0.995413
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.004587
positive prediction rate = 0.008439
AUC of ROC = 0.832931
AUC of PRC = 0.345426
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 45   2]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08981099724769592
difference in average predicted and observed risk = -0.01898500275230408
number samples = 432
accuracy = 0.895833
precision class 0 = 0.895349
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.042553
false negative rate = 0.957447
false positive rate = 0.0
positive prediction rate = 0.00463
AUC of ROC = 0.737441
AUC of PRC = 0.389959
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10447700321674347
difference in average predicted and observed risk = -0.005691996783256534
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.895971
AUC of PRC = 0.527241
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1140109971165657
difference in average predicted and observed risk = -0.019322002883434303
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 38   1]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09769999980926514
difference in average predicted and observed risk = -0.017344000190734857
number samples = 339
accuracy = 0.882006
precision class 0 = 0.886905
precision class 1 = 0.333333
recall class 0 = 0.993333
recall class 1 = 0.025641
false negative rate = 0.974359
false positive rate = 0.006667
positive prediction rate = 0.00885
AUC of ROC = 0.787949
AUC of PRC = 0.341118
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[434   0]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08758699893951416
difference in average predicted and observed risk = -0.004463001060485847
number samples = 478
accuracy = 0.922594
precision class 0 = 0.921444
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.0
positive prediction rate = 0.014644
AUC of ROC = 0.812736
AUC of PRC = 0.520877
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[388   0]
 [ 36   2]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08021900057792664
difference in average predicted and observed risk = -0.008982999422073368
number samples = 426
accuracy = 0.915493
precision class 0 = 0.915094
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.052632
false negative rate = 0.947368
false positive rate = 0.0
positive prediction rate = 0.004695
AUC of ROC = 0.784319
AUC of PRC = 0.412401
min(+P, Se) = 0.380952

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.106625996530056
difference in average predicted and observed risk = -0.011021003469944002
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.938889
AUC of PRC = 0.720934
min(+P, Se) = 0.692308

-------------------------------

confusion matrix:
[[113   0]
 [ 11   0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09838499873876572
difference in average predicted and observed risk = 0.00967499873876572
number samples = 124
accuracy = 0.91129
precision class 0 = 0.91129
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.783588
AUC of PRC = 0.224948
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10432899743318558
difference in average predicted and observed risk = -0.04527700256681441
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.780214
AUC of PRC = 0.525171
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11811000108718872
difference in average predicted and observed risk = 0.03916300108718872
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[732   2]
 [ 75   8]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09178300201892853
difference in average predicted and observed risk = -0.009807997981071473
number samples = 817
accuracy = 0.905753
precision class 0 = 0.907063
precision class 1 = 0.8
recall class 0 = 0.997275
recall class 1 = 0.096386
false negative rate = 0.903614
false positive rate = 0.002725
positive prediction rate = 0.01224
AUC of ROC = 0.805079
AUC of PRC = 0.438891
min(+P, Se) = 0.46988

-------------------------------

Epoch 00015: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch15.state
Epoch 16/100
 - 319s - loss: 0.2867 - val_loss: 0.2660

==>predicting on train



confusion matrix:
[[2145   10]
 [ 225   30]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11969999969005585
difference in average predicted and observed risk = 0.013890999690055847
number samples = 2410
accuracy = 0.90249
precision class 0 = 0.905063
precision class 1 = 0.75
recall class 0 = 0.99536
recall class 1 = 0.117647
false negative rate = 0.882353
false positive rate = 0.00464
positive prediction rate = 0.016598
AUC of ROC = 0.77936
AUC of PRC = 0.397971
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1166   13]
 [ 104   14]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10850200057029724
difference in average predicted and observed risk = 0.017523000570297237
number samples = 1297
accuracy = 0.909792
precision class 0 = 0.91811
precision class 1 = 0.518519
recall class 0 = 0.988974
recall class 1 = 0.118644
false negative rate = 0.881356
false positive rate = 0.011026
positive prediction rate = 0.020817
AUC of ROC = 0.798285
AUC of PRC = 0.348113
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[653   3]
 [ 64  10]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11623799800872803
difference in average predicted and observed risk = 0.014867998008728026
number samples = 730
accuracy = 0.908219
precision class 0 = 0.910739
precision class 1 = 0.769231
recall class 0 = 0.995427
recall class 1 = 0.135135
false negative rate = 0.864865
false positive rate = 0.004573
positive prediction rate = 0.017808
AUC of ROC = 0.772268
AUC of PRC = 0.391811
min(+P, Se) = 0.391892

-------------------------------

confusion matrix:
[[166   1]
 [ 16   8]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12125299870967865
difference in average predicted and observed risk = -0.004401001290321338
number samples = 191
accuracy = 0.910995
precision class 0 = 0.912088
precision class 1 = 0.888889
recall class 0 = 0.994012
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.005988
positive prediction rate = 0.04712
AUC of ROC = 0.87475
AUC of PRC = 0.689605
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2458   16]
 [ 229   26]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10921899974346161
difference in average predicted and observed risk = 0.015777999743461613
number samples = 2729
accuracy = 0.910224
precision class 0 = 0.914775
precision class 1 = 0.619048
recall class 0 = 0.993533
recall class 1 = 0.101961
false negative rate = 0.898039
false positive rate = 0.006467
positive prediction rate = 0.01539
AUC of ROC = 0.773072
AUC of PRC = 0.346228
min(+P, Se) = 0.382812

-------------------------------

confusion matrix:
[[1672   11]
 [ 180   36]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1259389966726303
difference in average predicted and observed risk = 0.012194996672630312
number samples = 1899
accuracy = 0.899421
precision class 0 = 0.902808
precision class 1 = 0.765957
recall class 0 = 0.993464
recall class 1 = 0.166667
false negative rate = 0.833333
false positive rate = 0.006536
positive prediction rate = 0.02475
AUC of ROC = 0.807013
AUC of PRC = 0.455342
min(+P, Se) = 0.439815

-------------------------------

confusion matrix:
[[542   7]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1310420036315918
difference in average predicted and observed risk = 0.008039003631591796
number samples = 626
accuracy = 0.878594
precision class 0 = 0.88707
precision class 1 = 0.533333
recall class 0 = 0.98725
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.01275
positive prediction rate = 0.023962
AUC of ROC = 0.769167
AUC of PRC = 0.350777
min(+P, Se) = 0.405063

-------------------------------

confusion matrix:
[[2244    5]
 [ 188   20]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.10468800365924835
difference in average predicted and observed risk = 0.020032003659248357
number samples = 2457
accuracy = 0.921449
precision class 0 = 0.922697
precision class 1 = 0.8
recall class 0 = 0.997777
recall class 1 = 0.096154
false negative rate = 0.903846
false positive rate = 0.002223
positive prediction rate = 0.010175
AUC of ROC = 0.774182
AUC of PRC = 0.333909
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11913999915122986
difference in average predicted and observed risk = 0.01833399915122985
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.727892
AUC of PRC = 0.229915
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[476   5]
 [ 60  22]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1418839991092682
difference in average predicted and observed risk = -0.003764000890731811
number samples = 563
accuracy = 0.884547
precision class 0 = 0.88806
precision class 1 = 0.814815
recall class 0 = 0.989605
recall class 1 = 0.268293
false negative rate = 0.731707
false positive rate = 0.010395
positive prediction rate = 0.047957
AUC of ROC = 0.821257
AUC of PRC = 0.591872
min(+P, Se) = 0.53012

-------------------------------

confusion matrix:
[[649   6]
 [ 67  12]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.12062399834394455
difference in average predicted and observed risk = 0.012994998343944547
number samples = 734
accuracy = 0.900545
precision class 0 = 0.906425
precision class 1 = 0.666667
recall class 0 = 0.99084
recall class 1 = 0.151899
false negative rate = 0.848101
false positive rate = 0.00916
positive prediction rate = 0.024523
AUC of ROC = 0.813315
AUC of PRC = 0.440334
min(+P, Se) = 0.481013

-------------------------------

confusion matrix:
[[4130   27]
 [ 409   62]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11608000099658966
difference in average predicted and observed risk = 0.01430800099658966
number samples = 4628
accuracy = 0.905791
precision class 0 = 0.909892
precision class 1 = 0.696629
recall class 0 = 0.993505
recall class 1 = 0.131635
false negative rate = 0.868365
false positive rate = 0.006495
positive prediction rate = 0.019231
AUC of ROC = 0.789023
AUC of PRC = 0.399173
min(+P, Se) = 0.399151

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10708100348711014
difference in average predicted and observed risk = 0.026912003487110134
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.851521
AUC of PRC = 0.381727
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.11910299956798553
difference in average predicted and observed risk = 0.01030699956798553
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.761094
AUC of PRC = 0.403502
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1287589967250824
difference in average predicted and observed risk = 0.018589996725082394
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.887912
AUC of PRC = 0.568155
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13742999732494354
difference in average predicted and observed risk = 0.004096997324943535
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1282459944486618
difference in average predicted and observed risk = 0.01320199444866181
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.79453
AUC of PRC = 0.355451
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.11019200086593628
difference in average predicted and observed risk = 0.018142000865936272
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.833264
AUC of PRC = 0.530294
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.10587199777364731
difference in average predicted and observed risk = 0.016669997773647305
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.810431
AUC of PRC = 0.424577
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13268199563026428
difference in average predicted and observed risk = 0.01503499563026428
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.925
AUC of PRC = 0.71256
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.12449599802494049
difference in average predicted and observed risk = 0.035785998024940494
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.802896
AUC of PRC = 0.228633
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12849299609661102
difference in average predicted and observed risk = -0.021113003903388966
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.776316
AUC of PRC = 0.528226
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.15147599577903748
difference in average predicted and observed risk = 0.07252899577903747
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.50101
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11768300086259842
difference in average predicted and observed risk = 0.01609200086259842
number samples = 817
accuracy = 0.908201
precision class 0 = 0.910336
precision class 1 = 0.785714
recall class 0 = 0.995913
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.004087
positive prediction rate = 0.017136
AUC of ROC = 0.81844
AUC of PRC = 0.4533
min(+P, Se) = 0.481928

-------------------------------

Epoch 00016: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch16.state
Epoch 17/100
 - 322s - loss: 0.2831 - val_loss: 0.2611

==>predicting on train



confusion matrix:
[[2139   16]
 [ 219   36]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09625499695539474
difference in average predicted and observed risk = -0.009554003044605255
number samples = 2410
accuracy = 0.90249
precision class 0 = 0.907125
precision class 1 = 0.692308
recall class 0 = 0.992575
recall class 1 = 0.141176
false negative rate = 0.858824
false positive rate = 0.007425
positive prediction rate = 0.021577
AUC of ROC = 0.78577
AUC of PRC = 0.399696
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1164   15]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09257300198078156
difference in average predicted and observed risk = 0.0015940019807815509
number samples = 1297
accuracy = 0.909792
precision class 0 = 0.919431
precision class 1 = 0.516129
recall class 0 = 0.987277
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.012723
positive prediction rate = 0.023901
AUC of ROC = 0.795748
AUC of PRC = 0.335226
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[647   9]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.1005299985408783
difference in average predicted and observed risk = -0.0008400014591217059
number samples = 730
accuracy = 0.905479
precision class 0 = 0.915134
precision class 1 = 0.608696
recall class 0 = 0.986281
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.01372
positive prediction rate = 0.031507
AUC of ROC = 0.782548
AUC of PRC = 0.403778
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10297100245952606
difference in average predicted and observed risk = -0.022682997540473926
number samples = 191
accuracy = 0.91623
precision class 0 = 0.921788
precision class 1 = 0.833333
recall class 0 = 0.988024
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.011976
positive prediction rate = 0.062827
AUC of ROC = 0.874251
AUC of PRC = 0.686908
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2446   28]
 [ 217   38]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09282500296831131
difference in average predicted and observed risk = -0.0006159970316886865
number samples = 2729
accuracy = 0.910224
precision class 0 = 0.918513
precision class 1 = 0.575758
recall class 0 = 0.988682
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.011318
positive prediction rate = 0.024185
AUC of ROC = 0.780647
AUC of PRC = 0.351908
min(+P, Se) = 0.382239

-------------------------------

confusion matrix:
[[1669   14]
 [ 178   38]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1009880006313324
difference in average predicted and observed risk = -0.0127559993686676
number samples = 1899
accuracy = 0.898894
precision class 0 = 0.903628
precision class 1 = 0.730769
recall class 0 = 0.991682
recall class 1 = 0.175926
false negative rate = 0.824074
false positive rate = 0.008318
positive prediction rate = 0.027383
AUC of ROC = 0.805949
AUC of PRC = 0.449232
min(+P, Se) = 0.435185

-------------------------------

confusion matrix:
[[540   9]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10997699946165085
difference in average predicted and observed risk = -0.013026000538349153
number samples = 626
accuracy = 0.876997
precision class 0 = 0.888158
precision class 1 = 0.5
recall class 0 = 0.983607
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.016393
positive prediction rate = 0.028754
AUC of ROC = 0.774797
AUC of PRC = 0.371376
min(+P, Se) = 0.392405

-------------------------------

confusion matrix:
[[2240    9]
 [ 183   25]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08411400020122528
difference in average predicted and observed risk = -0.0005419997987747144
number samples = 2457
accuracy = 0.921856
precision class 0 = 0.924474
precision class 1 = 0.735294
recall class 0 = 0.995998
recall class 1 = 0.120192
false negative rate = 0.879808
false positive rate = 0.004002
positive prediction rate = 0.013838
AUC of ROC = 0.778944
AUC of PRC = 0.33584
min(+P, Se) = 0.312796

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09849300235509872
difference in average predicted and observed risk = -0.0023129976449012823
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.731659
AUC of PRC = 0.216287
min(+P, Se) = 0.297297

-------------------------------

confusion matrix:
[[472   9]
 [ 58  24]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1247130036354065
difference in average predicted and observed risk = -0.020934996364593506
number samples = 563
accuracy = 0.880995
precision class 0 = 0.890566
precision class 1 = 0.727273
recall class 0 = 0.981289
recall class 1 = 0.292683
false negative rate = 0.707317
false positive rate = 0.018711
positive prediction rate = 0.058615
AUC of ROC = 0.827823
AUC of PRC = 0.587211
min(+P, Se) = 0.542169

-------------------------------

confusion matrix:
[[645  10]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10210199654102325
difference in average predicted and observed risk = -0.005527003458976748
number samples = 734
accuracy = 0.90327
precision class 0 = 0.913598
precision class 1 = 0.642857
recall class 0 = 0.984733
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.015267
positive prediction rate = 0.038147
AUC of ROC = 0.807672
AUC of PRC = 0.418176
min(+P, Se) = 0.447059

-------------------------------

confusion matrix:
[[4115   42]
 [ 395   76]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09617500007152557
difference in average predicted and observed risk = -0.005596999928474428
number samples = 4628
accuracy = 0.905575
precision class 0 = 0.912417
precision class 1 = 0.644068
recall class 0 = 0.989897
recall class 1 = 0.161359
false negative rate = 0.838641
false positive rate = 0.010103
positive prediction rate = 0.025497
AUC of ROC = 0.792682
AUC of PRC = 0.396341
min(+P, Se) = 0.407643

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09039299935102463
difference in average predicted and observed risk = 0.010223999351024624
number samples = 237
accuracy = 0.92827
precision class 0 = 0.935065
precision class 1 = 0.666667
recall class 0 = 0.990826
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.009174
positive prediction rate = 0.025316
AUC of ROC = 0.822791
AUC of PRC = 0.372923
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09335599839687347
difference in average predicted and observed risk = -0.01544000160312653
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.771815
AUC of PRC = 0.411785
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11293800175189972
difference in average predicted and observed risk = 0.002769001751899716
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.898168
AUC of PRC = 0.540645
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11690399795770645
difference in average predicted and observed risk = -0.016429002042293556
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10147800296545029
difference in average predicted and observed risk = -0.013565997034549707
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.792479
AUC of PRC = 0.334785
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0924379974603653
difference in average predicted and observed risk = 0.0003879974603652886
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.831588
AUC of PRC = 0.549186
min(+P, Se) = 0.530612

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0838410034775734
difference in average predicted and observed risk = -0.005360996522426609
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.812941
AUC of PRC = 0.433929
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11449000239372253
difference in average predicted and observed risk = -0.0031569976062774674
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.925
AUC of PRC = 0.676647
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1008559986948967
difference in average predicted and observed risk = 0.0121459986948967
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.786002
AUC of PRC = 0.210665
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10808300226926804
difference in average predicted and observed risk = -0.04152299773073195
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.784113
AUC of PRC = 0.540449
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.130512997508049
difference in average predicted and observed risk = 0.05156599750804901
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[731   3]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0961889997124672
difference in average predicted and observed risk = -0.005402000287532807
number samples = 817
accuracy = 0.910649
precision class 0 = 0.912609
precision class 1 = 0.8125
recall class 0 = 0.995913
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.004087
positive prediction rate = 0.019584
AUC of ROC = 0.817734
AUC of PRC = 0.457545
min(+P, Se) = 0.465116

-------------------------------

Epoch 00017: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch17.state
Epoch 18/100
 - 320s - loss: 0.2781 - val_loss: 0.2639

==>predicting on train



confusion matrix:
[[2138   17]
 [ 218   37]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.07541699707508087
difference in average predicted and observed risk = -0.03039200292491913
number samples = 2410
accuracy = 0.90249
precision class 0 = 0.90747
precision class 1 = 0.685185
recall class 0 = 0.992111
recall class 1 = 0.145098
false negative rate = 0.854902
false positive rate = 0.007889
positive prediction rate = 0.022407
AUC of ROC = 0.779884
AUC of PRC = 0.403601
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1163   16]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07227300107479095
difference in average predicted and observed risk = -0.01870599892520905
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.919368
precision class 1 = 0.5
recall class 0 = 0.986429
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.013571
positive prediction rate = 0.024672
AUC of ROC = 0.792067
AUC of PRC = 0.335304
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[647   9]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.07853300124406815
difference in average predicted and observed risk = -0.022836998755931856
number samples = 730
accuracy = 0.90411
precision class 0 = 0.913842
precision class 1 = 0.590909
recall class 0 = 0.986281
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.01372
positive prediction rate = 0.030137
AUC of ROC = 0.77645
AUC of PRC = 0.405733
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 15   9]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.08685100078582764
difference in average predicted and observed risk = -0.03880299921417235
number samples = 191
accuracy = 0.910995
precision class 0 = 0.916667
precision class 1 = 0.818182
recall class 0 = 0.988024
recall class 1 = 0.375
false negative rate = 0.625
false positive rate = 0.011976
positive prediction rate = 0.057592
AUC of ROC = 0.86976
AUC of PRC = 0.690619
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2447   27]
 [ 220   35]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07191099971532822
difference in average predicted and observed risk = -0.02153000028467178
number samples = 2729
accuracy = 0.909491
precision class 0 = 0.91751
precision class 1 = 0.564516
recall class 0 = 0.989087
recall class 1 = 0.137255
false negative rate = 0.862745
false positive rate = 0.010914
positive prediction rate = 0.022719
AUC of ROC = 0.7755
AUC of PRC = 0.350852
min(+P, Se) = 0.380769

-------------------------------

confusion matrix:
[[1666   17]
 [ 176   40]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.080656997859478
difference in average predicted and observed risk = -0.033087002140522
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.904452
precision class 1 = 0.701754
recall class 0 = 0.989899
recall class 1 = 0.185185
false negative rate = 0.814815
false positive rate = 0.010101
positive prediction rate = 0.030016
AUC of ROC = 0.80007
AUC of PRC = 0.451966
min(+P, Se) = 0.439815

-------------------------------

confusion matrix:
[[541   8]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.08880899846553802
difference in average predicted and observed risk = -0.034194001534461976
number samples = 626
accuracy = 0.876997
precision class 0 = 0.886885
precision class 1 = 0.5
recall class 0 = 0.985428
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.014572
positive prediction rate = 0.025559
AUC of ROC = 0.771272
AUC of PRC = 0.384556
min(+P, Se) = 0.402597

-------------------------------

confusion matrix:
[[2237   12]
 [ 184   24]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06320299953222275
difference in average predicted and observed risk = -0.021453000467777247
number samples = 2457
accuracy = 0.920228
precision class 0 = 0.923998
precision class 1 = 0.666667
recall class 0 = 0.994664
recall class 1 = 0.115385
false negative rate = 0.884615
false positive rate = 0.005336
positive prediction rate = 0.014652
AUC of ROC = 0.77397
AUC of PRC = 0.338298
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.07595700025558472
difference in average predicted and observed risk = -0.02484899974441529
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.719103
AUC of PRC = 0.210804
min(+P, Se) = 0.294118

-------------------------------

confusion matrix:
[[472   9]
 [ 56  26]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1049100011587143
difference in average predicted and observed risk = -0.040737998841285705
number samples = 563
accuracy = 0.884547
precision class 0 = 0.893939
precision class 1 = 0.742857
recall class 0 = 0.981289
recall class 1 = 0.317073
false negative rate = 0.682927
false positive rate = 0.018711
positive prediction rate = 0.062167
AUC of ROC = 0.820876
AUC of PRC = 0.587104
min(+P, Se) = 0.53012

-------------------------------

confusion matrix:
[[645  10]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08259899914264679
difference in average predicted and observed risk = -0.025030000857353213
number samples = 734
accuracy = 0.901907
precision class 0 = 0.912306
precision class 1 = 0.62963
recall class 0 = 0.984733
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.015267
positive prediction rate = 0.036785
AUC of ROC = 0.804329
AUC of PRC = 0.425053
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[4113   44]
 [ 396   75]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0754999965429306
difference in average predicted and observed risk = -0.0262720034570694
number samples = 4628
accuracy = 0.904927
precision class 0 = 0.912176
precision class 1 = 0.630252
recall class 0 = 0.989415
recall class 1 = 0.159236
false negative rate = 0.840764
false positive rate = 0.010585
positive prediction rate = 0.025713
AUC of ROC = 0.787249
AUC of PRC = 0.398626
min(+P, Se) = 0.403397

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07062699645757675
difference in average predicted and observed risk = -0.009542003542423252
number samples = 237
accuracy = 0.924051
precision class 0 = 0.934783
precision class 1 = 0.571429
recall class 0 = 0.986239
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.013761
positive prediction rate = 0.029536
AUC of ROC = 0.812409
AUC of PRC = 0.323893
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07238099724054337
difference in average predicted and observed risk = -0.03641500275945664
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.763471
AUC of PRC = 0.392331
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09130000323057175
difference in average predicted and observed risk = -0.018868996769428256
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.898901
AUC of PRC = 0.595178
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.10106699913740158
difference in average predicted and observed risk = -0.032266000862598426
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08063899725675583
difference in average predicted and observed risk = -0.034405002743244165
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.771197
AUC of PRC = 0.339594
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07212600111961365
difference in average predicted and observed risk = -0.01992399888038636
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.838395
AUC of PRC = 0.533209
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06261499971151352
difference in average predicted and observed risk = -0.026587000288486484
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.800868
AUC of PRC = 0.416216
min(+P, Se) = 0.390244

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.0960870012640953
difference in average predicted and observed risk = -0.021559998735904695
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.910185
AUC of PRC = 0.676266
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08021099865436554
difference in average predicted and observed risk = -0.008499001345634458
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.775543
AUC of PRC = 0.207047
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.08915100246667862
difference in average predicted and observed risk = -0.06045499753332137
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.79191
AUC of PRC = 0.550169
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.10708700120449066
difference in average predicted and observed risk = 0.02814000120449066
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.07565800100564957
difference in average predicted and observed risk = -0.025932998994350434
number samples = 817
accuracy = 0.909425
precision class 0 = 0.9125
precision class 1 = 0.764706
recall class 0 = 0.99455
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.00545
positive prediction rate = 0.020808
AUC of ROC = 0.810463
AUC of PRC = 0.441454
min(+P, Se) = 0.476744

-------------------------------

Epoch 00018: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch18.state
Epoch 19/100
 - 320s - loss: 0.2820 - val_loss: 0.2588

==>predicting on train



confusion matrix:
[[2137   18]
 [ 217   38]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09976299852132797
difference in average predicted and observed risk = -0.006046001478672028
number samples = 2410
accuracy = 0.90249
precision class 0 = 0.907816
precision class 1 = 0.678571
recall class 0 = 0.991647
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.008353
positive prediction rate = 0.023237
AUC of ROC = 0.785178
AUC of PRC = 0.404305
min(+P, Se) = 0.396078

-------------------------------

confusion matrix:
[[1163   16]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09294100105762482
difference in average predicted and observed risk = 0.0019620010576248126
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.922284
precision class 1 = 0.555556
recall class 0 = 0.986429
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.013571
positive prediction rate = 0.027756
AUC of ROC = 0.794899
AUC of PRC = 0.340078
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[646  10]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10173299908638
difference in average predicted and observed risk = 0.0003629990863800031
number samples = 730
accuracy = 0.90274
precision class 0 = 0.91372
precision class 1 = 0.565217
recall class 0 = 0.984756
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.015244
positive prediction rate = 0.031507
AUC of ROC = 0.770868
AUC of PRC = 0.404683
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10209999978542328
difference in average predicted and observed risk = -0.02355400021457671
number samples = 191
accuracy = 0.91623
precision class 0 = 0.921788
precision class 1 = 0.833333
recall class 0 = 0.988024
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.011976
positive prediction rate = 0.062827
AUC of ROC = 0.871507
AUC of PRC = 0.667174
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2446   28]
 [ 215   40]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09361399710178375
difference in average predicted and observed risk = 0.00017299710178375616
number samples = 2729
accuracy = 0.910956
precision class 0 = 0.919203
precision class 1 = 0.588235
recall class 0 = 0.988682
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.011318
positive prediction rate = 0.024918
AUC of ROC = 0.774781
AUC of PRC = 0.347326
min(+P, Se) = 0.37931

-------------------------------

confusion matrix:
[[1665   18]
 [ 175   41]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10493200272321701
difference in average predicted and observed risk = -0.008811997276782987
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.904891
precision class 1 = 0.694915
recall class 0 = 0.989305
recall class 1 = 0.189815
false negative rate = 0.810185
false positive rate = 0.010695
positive prediction rate = 0.031069
AUC of ROC = 0.806348
AUC of PRC = 0.458511
min(+P, Se) = 0.442922

-------------------------------

confusion matrix:
[[541   8]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11526300013065338
difference in average predicted and observed risk = -0.00773999986934662
number samples = 626
accuracy = 0.878594
precision class 0 = 0.888342
precision class 1 = 0.529412
recall class 0 = 0.985428
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.014572
positive prediction rate = 0.027157
AUC of ROC = 0.774324
AUC of PRC = 0.375366
min(+P, Se) = 0.397436

-------------------------------

confusion matrix:
[[2236   13]
 [ 181   27]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08444800227880478
difference in average predicted and observed risk = -0.0002079977211952161
number samples = 2457
accuracy = 0.921042
precision class 0 = 0.925114
precision class 1 = 0.675
recall class 0 = 0.99422
recall class 1 = 0.129808
false negative rate = 0.870192
false positive rate = 0.00578
positive prediction rate = 0.01628
AUC of ROC = 0.776623
AUC of PRC = 0.340773
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10597299784421921
difference in average predicted and observed risk = 0.005166997844219201
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.727354
AUC of PRC = 0.212317
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[471  10]
 [ 56  26]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12732599675655365
difference in average predicted and observed risk = -0.01832200324344635
number samples = 563
accuracy = 0.882771
precision class 0 = 0.893738
precision class 1 = 0.722222
recall class 0 = 0.97921
recall class 1 = 0.317073
false negative rate = 0.682927
false positive rate = 0.02079
positive prediction rate = 0.063943
AUC of ROC = 0.824679
AUC of PRC = 0.589156
min(+P, Se) = 0.536585

-------------------------------

confusion matrix:
[[645  10]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10508199781179428
difference in average predicted and observed risk = -0.0025470021882057214
number samples = 734
accuracy = 0.904632
precision class 0 = 0.914894
precision class 1 = 0.655172
recall class 0 = 0.984733
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.015267
positive prediction rate = 0.03951
AUC of ROC = 0.800251
AUC of PRC = 0.426092
min(+P, Se) = 0.422222

-------------------------------

confusion matrix:
[[4111   46]
 [ 390   81]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09825800359249115
difference in average predicted and observed risk = -0.0035139964075088514
number samples = 4628
accuracy = 0.905791
precision class 0 = 0.913353
precision class 1 = 0.637795
recall class 0 = 0.988934
recall class 1 = 0.171975
false negative rate = 0.828025
false positive rate = 0.011066
positive prediction rate = 0.027442
AUC of ROC = 0.78991
AUC of PRC = 0.400793
min(+P, Se) = 0.408034

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09126000106334686
difference in average predicted and observed risk = 0.011091001063346859
number samples = 237
accuracy = 0.924051
precision class 0 = 0.934783
precision class 1 = 0.571429
recall class 0 = 0.986239
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.013761
positive prediction rate = 0.029536
AUC of ROC = 0.828102
AUC of PRC = 0.38518
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09722200036048889
difference in average predicted and observed risk = -0.011573999639511112
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.769494
AUC of PRC = 0.400699
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11519300192594528
difference in average predicted and observed risk = 0.005024001925945279
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.917216
AUC of PRC = 0.536594
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11853200197219849
difference in average predicted and observed risk = -0.01480099802780152
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10565900057554245
difference in average predicted and observed risk = -0.009384999424457544
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.789316
AUC of PRC = 0.332836
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09405600279569626
difference in average predicted and observed risk = 0.0020060027956962517
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.844784
AUC of PRC = 0.54561
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08383599668741226
difference in average predicted and observed risk = -0.0053660033125877415
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.813619
AUC of PRC = 0.428634
min(+P, Se) = 0.413043

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11843600124120712
difference in average predicted and observed risk = 0.0007890012412071212
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.936111
AUC of PRC = 0.675722
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10847300291061401
difference in average predicted and observed risk = 0.019763002910614016
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.810137
AUC of PRC = 0.216923
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11174199730157852
difference in average predicted and observed risk = -0.03786400269842147
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.789961
AUC of PRC = 0.538351
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1405390053987503
difference in average predicted and observed risk = 0.0615920053987503
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09887000173330307
difference in average predicted and observed risk = -0.0027209982666969307
number samples = 817
accuracy = 0.910649
precision class 0 = 0.913642
precision class 1 = 0.777778
recall class 0 = 0.99455
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.00545
positive prediction rate = 0.022032
AUC of ROC = 0.822396
AUC of PRC = 0.450233
min(+P, Se) = 0.482353

-------------------------------

Epoch 00019: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch19.state
Epoch 20/100
 - 317s - loss: 0.2803 - val_loss: 0.2641

==>predicting on train



confusion matrix:
[[2137   18]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08984299749135971
difference in average predicted and observed risk = -0.01596600250864029
number samples = 2410
accuracy = 0.903734
precision class 0 = 0.908975
precision class 1 = 0.694915
recall class 0 = 0.991647
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.008353
positive prediction rate = 0.024481
AUC of ROC = 0.771574
AUC of PRC = 0.396813
min(+P, Se) = 0.398438

-------------------------------

confusion matrix:
[[1163   16]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0821629986166954
difference in average predicted and observed risk = -0.0088160013833046
number samples = 1297
accuracy = 0.90825
precision class 0 = 0.918641
precision class 1 = 0.483871
recall class 0 = 0.986429
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.013571
positive prediction rate = 0.023901
AUC of ROC = 0.782788
AUC of PRC = 0.331232
min(+P, Se) = 0.347458

-------------------------------

confusion matrix:
[[648   8]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09265899658203125
difference in average predicted and observed risk = -0.008711003417968752
number samples = 730
accuracy = 0.905479
precision class 0 = 0.913963
precision class 1 = 0.619048
recall class 0 = 0.987805
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.012195
positive prediction rate = 0.028767
AUC of ROC = 0.771753
AUC of PRC = 0.413672
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09985200315713882
difference in average predicted and observed risk = -0.025801996842861163
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.863772
AUC of PRC = 0.674098
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2445   29]
 [ 217   38]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08447100222110748
difference in average predicted and observed risk = -0.008969997778892513
number samples = 2729
accuracy = 0.909857
precision class 0 = 0.918482
precision class 1 = 0.567164
recall class 0 = 0.988278
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.011722
positive prediction rate = 0.024551
AUC of ROC = 0.76695
AUC of PRC = 0.347496
min(+P, Se) = 0.384314

-------------------------------

confusion matrix:
[[1668   15]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09440799802541733
difference in average predicted and observed risk = -0.01933600197458267
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905537
precision class 1 = 0.736842
recall class 0 = 0.991087
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.008913
positive prediction rate = 0.030016
AUC of ROC = 0.793796
AUC of PRC = 0.45279
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[540   9]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10331500321626663
difference in average predicted and observed risk = -0.01968799678373337
number samples = 626
accuracy = 0.876997
precision class 0 = 0.888158
precision class 1 = 0.5
recall class 0 = 0.983607
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.016393
positive prediction rate = 0.028754
AUC of ROC = 0.758664
AUC of PRC = 0.36712
min(+P, Se) = 0.415584

-------------------------------

confusion matrix:
[[2238   11]
 [ 184   24]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07521499693393707
difference in average predicted and observed risk = -0.009441003066062922
number samples = 2457
accuracy = 0.920635
precision class 0 = 0.92403
precision class 1 = 0.685714
recall class 0 = 0.995109
recall class 1 = 0.115385
false negative rate = 0.884615
false positive rate = 0.004891
positive prediction rate = 0.014245
AUC of ROC = 0.769618
AUC of PRC = 0.332706
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08897700160741806
difference in average predicted and observed risk = -0.011828998392581946
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.70565
AUC of PRC = 0.208117
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[471  10]
 [ 54  28]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11846300214529037
difference in average predicted and observed risk = -0.027184997854709625
number samples = 563
accuracy = 0.886323
precision class 0 = 0.897143
precision class 1 = 0.736842
recall class 0 = 0.97921
recall class 1 = 0.341463
false negative rate = 0.658537
false positive rate = 0.02079
positive prediction rate = 0.067496
AUC of ROC = 0.808808
AUC of PRC = 0.593475
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[645  10]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09749399870634079
difference in average predicted and observed risk = -0.010135001293659213
number samples = 734
accuracy = 0.904632
precision class 0 = 0.914894
precision class 1 = 0.655172
recall class 0 = 0.984733
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.015267
positive prediction rate = 0.03951
AUC of ROC = 0.800541
AUC of PRC = 0.427904
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4113   44]
 [ 391   80]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08854799717664719
difference in average predicted and observed risk = -0.013224002823352815
number samples = 4628
accuracy = 0.906007
precision class 0 = 0.913188
precision class 1 = 0.645161
recall class 0 = 0.989415
recall class 1 = 0.169851
false negative rate = 0.830149
false positive rate = 0.010585
positive prediction rate = 0.026793
AUC of ROC = 0.780067
AUC of PRC = 0.398664
min(+P, Se) = 0.40552

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08139699697494507
difference in average predicted and observed risk = 0.0012279969749450642
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.802752
AUC of PRC = 0.361674
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08566100150346756
difference in average predicted and observed risk = -0.023134998496532444
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.74037
AUC of PRC = 0.399973
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10634800046682358
difference in average predicted and observed risk = -0.003820999533176425
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.892308
AUC of PRC = 0.52663
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1146949976682663
difference in average predicted and observed risk = -0.01863800233173371
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.0937110036611557
difference in average predicted and observed risk = -0.021332996338844293
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.758034
AUC of PRC = 0.324907
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08476699888706207
difference in average predicted and observed risk = -0.007283001112937934
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.823523
AUC of PRC = 0.525691
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07433599978685379
difference in average predicted and observed risk = -0.014866000213146213
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.774349
AUC of PRC = 0.40675
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10614699870347977
difference in average predicted and observed risk = -0.011500001296520235
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.915741
AUC of PRC = 0.66598
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09653600305318832
difference in average predicted and observed risk = 0.007826003053188327
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.776348
AUC of PRC = 0.220816
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10515899956226349
difference in average predicted and observed risk = -0.0444470004377365
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.7846
AUC of PRC = 0.528719
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11754400283098221
difference in average predicted and observed risk = 0.038597002830982205
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[731   3]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08847799897193909
difference in average predicted and observed risk = -0.013113001028060914
number samples = 817
accuracy = 0.909425
precision class 0 = 0.911471
precision class 1 = 0.8
recall class 0 = 0.995913
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.004087
positive prediction rate = 0.01836
AUC of ROC = 0.797347
AUC of PRC = 0.441057
min(+P, Se) = 0.46988

-------------------------------

Epoch 00020: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch20.state
Epoch 21/100
 - 320s - loss: 0.2784 - val_loss: 0.2653

==>predicting on train



confusion matrix:
[[2128   27]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.13602100312709808
difference in average predicted and observed risk = 0.030212003127098083
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.912913
precision class 1 = 0.658228
recall class 0 = 0.987471
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.012529
positive prediction rate = 0.03278
AUC of ROC = 0.794692
AUC of PRC = 0.413967
min(+P, Se) = 0.403922

-------------------------------

confusion matrix:
[[1159   20]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.12499400228261948
difference in average predicted and observed risk = 0.03401500228261947
number samples = 1297
accuracy = 0.910563
precision class 0 = 0.923506
precision class 1 = 0.52381
recall class 0 = 0.983036
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.016964
positive prediction rate = 0.032382
AUC of ROC = 0.804395
AUC of PRC = 0.340388
min(+P, Se) = 0.378151

-------------------------------

confusion matrix:
[[641  15]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.13438700139522552
difference in average predicted and observed risk = 0.03301700139522552
number samples = 730
accuracy = 0.9
precision class 0 = 0.917024
precision class 1 = 0.516129
recall class 0 = 0.977134
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.022866
positive prediction rate = 0.042466
AUC of ROC = 0.771506
AUC of PRC = 0.394681
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.14075399935245514
difference in average predicted and observed risk = 0.015099999352455151
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.875749
AUC of PRC = 0.716315
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2437   37]
 [ 203   52]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.12604600191116333
difference in average predicted and observed risk = 0.032605001911163334
number samples = 2729
accuracy = 0.912056
precision class 0 = 0.923106
precision class 1 = 0.58427
recall class 0 = 0.985044
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.014956
positive prediction rate = 0.032613
AUC of ROC = 0.783404
AUC of PRC = 0.361456
min(+P, Se) = 0.389105

-------------------------------

confusion matrix:
[[1656   27]
 [ 167   49]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.14267200231552124
difference in average predicted and observed risk = 0.028928002315521242
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.908393
precision class 1 = 0.644737
recall class 0 = 0.983957
recall class 1 = 0.226852
false negative rate = 0.773148
false positive rate = 0.016043
positive prediction rate = 0.040021
AUC of ROC = 0.815381
AUC of PRC = 0.469562
min(+P, Se) = 0.437788

-------------------------------

confusion matrix:
[[538  11]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.15285499393939972
difference in average predicted and observed risk = 0.029851993939399718
number samples = 626
accuracy = 0.880192
precision class 0 = 0.893688
precision class 1 = 0.541667
recall class 0 = 0.979964
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.020036
positive prediction rate = 0.038339
AUC of ROC = 0.781019
AUC of PRC = 0.380192
min(+P, Se) = 0.402062

-------------------------------

confusion matrix:
[[2228   21]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.1170549988746643
difference in average predicted and observed risk = 0.03239899887466431
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.926789
precision class 1 = 0.603774
recall class 0 = 0.990663
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009337
positive prediction rate = 0.021571
AUC of ROC = 0.783491
AUC of PRC = 0.34304
min(+P, Se) = 0.336538

-------------------------------

confusion matrix:
[[219   4]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.14369599521160126
difference in average predicted and observed risk = 0.04288999521160125
number samples = 248
accuracy = 0.891129
precision class 0 = 0.904959
precision class 1 = 0.333333
recall class 0 = 0.982063
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.017937
positive prediction rate = 0.024194
AUC of ROC = 0.751749
AUC of PRC = 0.2427
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[468  13]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.16788999736309052
difference in average predicted and observed risk = 0.022241997363090515
number samples = 563
accuracy = 0.889876
precision class 0 = 0.905222
precision class 1 = 0.717391
recall class 0 = 0.972973
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.027027
positive prediction rate = 0.081705
AUC of ROC = 0.836139
AUC of PRC = 0.609803
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[640  15]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.13823600113391876
difference in average predicted and observed risk = 0.03060700113391876
number samples = 734
accuracy = 0.900545
precision class 0 = 0.916905
precision class 1 = 0.583333
recall class 0 = 0.977099
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.022901
positive prediction rate = 0.049046
AUC of ROC = 0.81318
AUC of PRC = 0.435769
min(+P, Se) = 0.433735

-------------------------------

confusion matrix:
[[4093   64]
 [ 370  101]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.13286800682544708
difference in average predicted and observed risk = 0.03109600682544708
number samples = 4628
accuracy = 0.906223
precision class 0 = 0.917096
precision class 1 = 0.612121
recall class 0 = 0.984604
recall class 1 = 0.214437
false negative rate = 0.785563
false positive rate = 0.015396
positive prediction rate = 0.035653
AUC of ROC = 0.798265
AUC of PRC = 0.411679
min(+P, Se) = 0.416136

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.12301400303840637
difference in average predicted and observed risk = 0.04284500303840637
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.846451
AUC of PRC = 0.385719
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.13310100138187408
difference in average predicted and observed risk = 0.02430500138187408
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.772368
AUC of PRC = 0.407245
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.14980299770832062
difference in average predicted and observed risk = 0.039633997708320615
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.915751
AUC of PRC = 0.526765
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.15840700268745422
difference in average predicted and observed risk = 0.025074002687454217
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1443749964237213
difference in average predicted and observed risk = 0.02933099642372132
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.803504
AUC of PRC = 0.343128
min(+P, Se) = 0.431818

-------------------------------

confusion matrix:
[[431   3]
 [ 31  13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.1258160024881363
difference in average predicted and observed risk = 0.033766002488136285
number samples = 478
accuracy = 0.92887
precision class 0 = 0.9329
precision class 1 = 0.8125
recall class 0 = 0.993088
recall class 1 = 0.295455
false negative rate = 0.704545
false positive rate = 0.006912
positive prediction rate = 0.033473
AUC of ROC = 0.84248
AUC of PRC = 0.549671
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.11763200163841248
difference in average predicted and observed risk = 0.028430001638412472
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.816061
AUC of PRC = 0.435328
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1543329954147339
difference in average predicted and observed risk = 0.036685995414733885
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.937963
AUC of PRC = 0.68656
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.14551199972629547
difference in average predicted and observed risk = 0.056801999726295474
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.823813
AUC of PRC = 0.238895
min(+P, Se) = 0.3125

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.14517800509929657
difference in average predicted and observed risk = -0.004427994900703419
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.790936
AUC of PRC = 0.512222
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.17759400606155396
difference in average predicted and observed risk = 0.09864700606155395
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.13351599872112274
difference in average predicted and observed risk = 0.03192499872112274
number samples = 817
accuracy = 0.911873
precision class 0 = 0.916877
precision class 1 = 0.73913
recall class 0 = 0.991826
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.008174
positive prediction rate = 0.028152
AUC of ROC = 0.82801
AUC of PRC = 0.456513
min(+P, Se) = 0.464286

-------------------------------

Epoch 00021: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch21.state
Epoch 22/100
 - 318s - loss: 0.2812 - val_loss: 0.2575

==>predicting on train



confusion matrix:
[[2133   22]
 [ 208   47]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10334999859333038
difference in average predicted and observed risk = -0.002459001406669617
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.911149
precision class 1 = 0.681159
recall class 0 = 0.989791
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.010209
positive prediction rate = 0.028631
AUC of ROC = 0.785144
AUC of PRC = 0.409382
min(+P, Se) = 0.396887

-------------------------------

confusion matrix:
[[1163   16]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09484700113534927
difference in average predicted and observed risk = 0.0038680011353492694
number samples = 1297
accuracy = 0.909021
precision class 0 = 0.919368
precision class 1 = 0.5
recall class 0 = 0.986429
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.013571
positive prediction rate = 0.024672
AUC of ROC = 0.789796
AUC of PRC = 0.334567
min(+P, Se) = 0.355932

-------------------------------

confusion matrix:
[[644  12]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10314200073480606
difference in average predicted and observed risk = 0.001772000734806059
number samples = 730
accuracy = 0.90137
precision class 0 = 0.914773
precision class 1 = 0.538462
recall class 0 = 0.981707
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.018293
positive prediction rate = 0.035616
AUC of ROC = 0.773113
AUC of PRC = 0.408839
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11171100288629532
difference in average predicted and observed risk = -0.01394299711370467
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.871257
AUC of PRC = 0.70994
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2447   27]
 [ 214   41]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0967559963464737
difference in average predicted and observed risk = 0.0033149963464736976
number samples = 2729
accuracy = 0.911689
precision class 0 = 0.919579
precision class 1 = 0.602941
recall class 0 = 0.989087
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.010914
positive prediction rate = 0.024918
AUC of ROC = 0.774522
AUC of PRC = 0.360065
min(+P, Se) = 0.377432

-------------------------------

confusion matrix:
[[1658   25]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10778000205755234
difference in average predicted and observed risk = -0.00596399794244766
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.907499
precision class 1 = 0.652778
recall class 0 = 0.985146
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.014854
positive prediction rate = 0.037915
AUC of ROC = 0.805778
AUC of PRC = 0.466012
min(+P, Se) = 0.439815

-------------------------------

confusion matrix:
[[540   9]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12110699713230133
difference in average predicted and observed risk = -0.0018960028676986707
number samples = 626
accuracy = 0.876997
precision class 0 = 0.888158
precision class 1 = 0.5
recall class 0 = 0.983607
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.016393
positive prediction rate = 0.028754
AUC of ROC = 0.776264
AUC of PRC = 0.378361
min(+P, Se) = 0.407407

-------------------------------

confusion matrix:
[[2232   17]
 [ 180   28]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08595100045204163
difference in average predicted and observed risk = 0.0012950004520416308
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.925373
precision class 1 = 0.622222
recall class 0 = 0.992441
recall class 1 = 0.134615
false negative rate = 0.865385
false positive rate = 0.007559
positive prediction rate = 0.018315
AUC of ROC = 0.776078
AUC of PRC = 0.336832
min(+P, Se) = 0.331731

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10926900058984756
difference in average predicted and observed risk = 0.008463000589847558
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.729865
AUC of PRC = 0.218433
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[470  11]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13607099652290344
difference in average predicted and observed risk = -0.009577003477096557
number samples = 563
accuracy = 0.889876
precision class 0 = 0.902111
precision class 1 = 0.738095
recall class 0 = 0.977131
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.022869
positive prediction rate = 0.0746
AUC of ROC = 0.824299
AUC of PRC = 0.608576
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[644  11]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.1062920019030571
difference in average predicted and observed risk = -0.001336998096942904
number samples = 734
accuracy = 0.904632
precision class 0 = 0.916074
precision class 1 = 0.645161
recall class 0 = 0.983206
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.016794
positive prediction rate = 0.042234
AUC of ROC = 0.799845
AUC of PRC = 0.437519
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4105   52]
 [ 383   88]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10127899795770645
difference in average predicted and observed risk = -0.0004930020422935499
number samples = 4628
accuracy = 0.906007
precision class 0 = 0.914661
precision class 1 = 0.628571
recall class 0 = 0.987491
recall class 1 = 0.186837
false negative rate = 0.813163
false positive rate = 0.012509
positive prediction rate = 0.030251
AUC of ROC = 0.789245
AUC of PRC = 0.409147
min(+P, Se) = 0.401274

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09313900023698807
difference in average predicted and observed risk = 0.012970000236988063
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.822549
AUC of PRC = 0.332113
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10039699822664261
difference in average predicted and observed risk = -0.008399001773357395
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.764023
AUC of PRC = 0.398303
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11731799691915512
difference in average predicted and observed risk = 0.007148996919155118
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.921612
AUC of PRC = 0.602641
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13157899677753448
difference in average predicted and observed risk = -0.0017540032224655222
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10793200135231018
difference in average predicted and observed risk = -0.007111998647689813
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.787265
AUC of PRC = 0.33389
min(+P, Se) = 0.413043

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09758900105953217
difference in average predicted and observed risk = 0.005539001059532159
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.841223
AUC of PRC = 0.546736
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.086046002805233
difference in average predicted and observed risk = -0.003155997194767002
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.808464
AUC of PRC = 0.438619
min(+P, Se) = 0.395349

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1260569989681244
difference in average predicted and observed risk = 0.008409998968124388
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.932407
AUC of PRC = 0.669818
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11378200352191925
difference in average predicted and observed risk = 0.025072003521919253
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.810137
AUC of PRC = 0.22795
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11223000288009644
difference in average predicted and observed risk = -0.03737599711990355
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.797271
AUC of PRC = 0.536048
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.141075000166893
difference in average predicted and observed risk = 0.062128000166893
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[730   4]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10187999904155731
difference in average predicted and observed risk = 0.00028899904155731126
number samples = 817
accuracy = 0.911873
precision class 0 = 0.914787
precision class 1 = 0.789474
recall class 0 = 0.99455
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.00545
positive prediction rate = 0.023256
AUC of ROC = 0.819244
AUC of PRC = 0.451838
min(+P, Se) = 0.460674

-------------------------------

Epoch 00022: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch22.state
Epoch 23/100
 - 313s - loss: 0.2833 - val_loss: 0.2541

==>predicting on train



confusion matrix:
[[2132   23]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09376499801874161
difference in average predicted and observed risk = -0.012044001981258393
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.911501
precision class 1 = 0.676056
recall class 0 = 0.989327
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.010673
positive prediction rate = 0.029461
AUC of ROC = 0.782598
AUC of PRC = 0.408845
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1162   17]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08704899996519089
difference in average predicted and observed risk = -0.003930000034809117
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.922955
precision class 1 = 0.552632
recall class 0 = 0.985581
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.014419
positive prediction rate = 0.029298
AUC of ROC = 0.791464
AUC of PRC = 0.332586
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[641  15]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0958470031619072
difference in average predicted and observed risk = -0.005522996838092806
number samples = 730
accuracy = 0.89726
precision class 0 = 0.914408
precision class 1 = 0.482759
recall class 0 = 0.977134
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.022866
positive prediction rate = 0.039726
AUC of ROC = 0.766336
AUC of PRC = 0.396591
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10373199731111526
difference in average predicted and observed risk = -0.021922002688884723
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.873752
AUC of PRC = 0.721136
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2444   30]
 [ 208   47]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08937399834394455
difference in average predicted and observed risk = -0.004067001656055447
number samples = 2729
accuracy = 0.912789
precision class 0 = 0.921569
precision class 1 = 0.61039
recall class 0 = 0.987874
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.012126
positive prediction rate = 0.028215
AUC of ROC = 0.768715
AUC of PRC = 0.35711
min(+P, Se) = 0.376471

-------------------------------

confusion matrix:
[[1656   27]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.097291000187397
difference in average predicted and observed risk = -0.016452999812602995
number samples = 1899
accuracy = 0.896788
precision class 0 = 0.907397
precision class 1 = 0.635135
recall class 0 = 0.983957
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.016043
positive prediction rate = 0.038968
AUC of ROC = 0.808612
AUC of PRC = 0.466935
min(+P, Se) = 0.435185

-------------------------------

confusion matrix:
[[538  11]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10818599909543991
difference in average predicted and observed risk = -0.01481700090456009
number samples = 626
accuracy = 0.878594
precision class 0 = 0.892206
precision class 1 = 0.521739
recall class 0 = 0.979964
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.020036
positive prediction rate = 0.036741
AUC of ROC = 0.775909
AUC of PRC = 0.374932
min(+P, Se) = 0.40404

-------------------------------

confusion matrix:
[[2231   18]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07739099860191345
difference in average predicted and observed risk = -0.007265001398086543
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.925726
precision class 1 = 0.617021
recall class 0 = 0.991996
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.008004
positive prediction rate = 0.019129
AUC of ROC = 0.772241
AUC of PRC = 0.333225
min(+P, Se) = 0.317308

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09704399853944778
difference in average predicted and observed risk = -0.0037620014605522223
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.745291
AUC of PRC = 0.228922
min(+P, Se) = 0.297297

-------------------------------

confusion matrix:
[[469  12]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13131900131702423
difference in average predicted and observed risk = -0.014328998682975769
number samples = 563
accuracy = 0.891652
precision class 0 = 0.905405
precision class 1 = 0.733333
recall class 0 = 0.975052
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.024948
positive prediction rate = 0.079929
AUC of ROC = 0.822955
AUC of PRC = 0.610995
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[643  12]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09916000068187714
difference in average predicted and observed risk = -0.008468999318122866
number samples = 734
accuracy = 0.90327
precision class 0 = 0.915954
precision class 1 = 0.625
recall class 0 = 0.981679
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.018321
positive prediction rate = 0.043597
AUC of ROC = 0.7977
AUC of PRC = 0.437805
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4100   57]
 [ 377   94]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09262199699878693
difference in average predicted and observed risk = -0.009150003001213075
number samples = 4628
accuracy = 0.906223
precision class 0 = 0.915792
precision class 1 = 0.622517
recall class 0 = 0.986288
recall class 1 = 0.199575
false negative rate = 0.800425
false positive rate = 0.013712
positive prediction rate = 0.032627
AUC of ROC = 0.787352
AUC of PRC = 0.407941
min(+P, Se) = 0.39916

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08443500101566315
difference in average predicted and observed risk = 0.004266001015663143
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.838484
AUC of PRC = 0.376287
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09177900105714798
difference in average predicted and observed risk = -0.017016998942852024
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.769605
AUC of PRC = 0.401787
min(+P, Se) = 0.418182

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11139799654483795
difference in average predicted and observed risk = 0.0012289965448379486
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.92381
AUC of PRC = 0.608565
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12138800323009491
difference in average predicted and observed risk = -0.011944996769905097
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09868499636650085
difference in average predicted and observed risk = -0.01635900363349914
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.798974
AUC of PRC = 0.339003
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08994100242853165
difference in average predicted and observed risk = -0.00210899757146836
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.846146
AUC of PRC = 0.554857
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07821299880743027
difference in average predicted and observed risk = -0.010989001192569736
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.817349
AUC of PRC = 0.45051
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12241499871015549
difference in average predicted and observed risk = 0.0047679987101554855
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.933333
AUC of PRC = 0.652913
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09984300285577774
difference in average predicted and observed risk = 0.011133002855777743
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.811746
AUC of PRC = 0.230386
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10460899770259857
difference in average predicted and observed risk = -0.04499700229740142
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.802632
AUC of PRC = 0.54952
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1309259980916977
difference in average predicted and observed risk = 0.05197899809169769
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09356900304555893
difference in average predicted and observed risk = -0.008021996954441071
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.826631
AUC of PRC = 0.455407
min(+P, Se) = 0.465116

-------------------------------

Epoch 00023: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch23.state
Epoch 24/100
 - 316s - loss: 0.2810 - val_loss: 0.2538

==>predicting on train



confusion matrix:
[[2134   21]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10224799811840057
difference in average predicted and observed risk = -0.0035610018815994265
number samples = 2410
accuracy = 0.905809
precision class 0 = 0.911966
precision class 1 = 0.7
recall class 0 = 0.990255
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.009745
positive prediction rate = 0.029046
AUC of ROC = 0.790845
AUC of PRC = 0.418531
min(+P, Se) = 0.412639

-------------------------------

confusion matrix:
[[1160   19]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09441900253295898
difference in average predicted and observed risk = 0.00344000253295898
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.924303
precision class 1 = 0.547619
recall class 0 = 0.983885
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.016115
positive prediction rate = 0.032382
AUC of ROC = 0.794483
AUC of PRC = 0.347147
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[642  14]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10491400212049484
difference in average predicted and observed risk = 0.0035440021204948408
number samples = 730
accuracy = 0.9
precision class 0 = 0.915835
precision class 1 = 0.517241
recall class 0 = 0.978659
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.021341
positive prediction rate = 0.039726
AUC of ROC = 0.777212
AUC of PRC = 0.397995
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10655699670314789
difference in average predicted and observed risk = -0.0190970032968521
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.876248
AUC of PRC = 0.71414
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2442   32]
 [ 204   51]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09679099917411804
difference in average predicted and observed risk = 0.0033499991741180457
number samples = 2729
accuracy = 0.913521
precision class 0 = 0.922902
precision class 1 = 0.614458
recall class 0 = 0.987065
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.012935
positive prediction rate = 0.030414
AUC of ROC = 0.778937
AUC of PRC = 0.3662
min(+P, Se) = 0.384314

-------------------------------

confusion matrix:
[[1659   24]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10620100051164627
difference in average predicted and observed risk = -0.007542999488353727
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.907549
precision class 1 = 0.661972
recall class 0 = 0.98574
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.01426
positive prediction rate = 0.037388
AUC of ROC = 0.810323
AUC of PRC = 0.468666
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[538  11]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11653299629688263
difference in average predicted and observed risk = -0.006470003703117372
number samples = 626
accuracy = 0.881789
precision class 0 = 0.895175
precision class 1 = 0.56
recall class 0 = 0.979964
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.020036
positive prediction rate = 0.039936
AUC of ROC = 0.780569
AUC of PRC = 0.376715
min(+P, Se) = 0.415584

-------------------------------

confusion matrix:
[[2231   18]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08589699864387512
difference in average predicted and observed risk = 0.001240998643875127
number samples = 2457
accuracy = 0.920228
precision class 0 = 0.92611
precision class 1 = 0.625
recall class 0 = 0.991996
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.008004
positive prediction rate = 0.019536
AUC of ROC = 0.780071
AUC of PRC = 0.347391
min(+P, Se) = 0.34434

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10814300179481506
difference in average predicted and observed risk = 0.007337001794815057
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.741345
AUC of PRC = 0.220393
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[470  11]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1376419961452484
difference in average predicted and observed risk = -0.008006003854751587
number samples = 563
accuracy = 0.893428
precision class 0 = 0.905588
precision class 1 = 0.75
recall class 0 = 0.977131
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.022869
positive prediction rate = 0.078153
AUC of ROC = 0.830485
AUC of PRC = 0.617123
min(+P, Se) = 0.536585

-------------------------------

confusion matrix:
[[643  12]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10559800267219543
difference in average predicted and observed risk = -0.002030997327804568
number samples = 734
accuracy = 0.90327
precision class 0 = 0.915954
precision class 1 = 0.625
recall class 0 = 0.981679
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.018321
positive prediction rate = 0.043597
AUC of ROC = 0.803111
AUC of PRC = 0.435344
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4101   56]
 [ 373   98]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10065200179815292
difference in average predicted and observed risk = -0.0011199982018470778
number samples = 4628
accuracy = 0.907303
precision class 0 = 0.916629
precision class 1 = 0.636364
recall class 0 = 0.986529
recall class 1 = 0.208068
false negative rate = 0.791932
false positive rate = 0.013471
positive prediction rate = 0.033276
AUC of ROC = 0.793739
AUC of PRC = 0.415418
min(+P, Se) = 0.399586

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09211599826812744
difference in average predicted and observed risk = 0.011946998268127437
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.837035
AUC of PRC = 0.38814
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09860900044441223
difference in average predicted and observed risk = -0.010186999555587772
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.781376
AUC of PRC = 0.413475
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11983300000429153
difference in average predicted and observed risk = 0.009664000004291531
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.920147
AUC of PRC = 0.581507
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12339100241661072
difference in average predicted and observed risk = -0.00994199758338929
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10729300230741501
difference in average predicted and observed risk = -0.007750997692584985
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.80359
AUC of PRC = 0.347751
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09602600336074829
difference in average predicted and observed risk = 0.003976003360748284
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.851016
AUC of PRC = 0.554486
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08620700240135193
difference in average predicted and observed risk = -0.002994997598648075
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.822504
AUC of PRC = 0.450276
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12393400073051453
difference in average predicted and observed risk = 0.006287000730514525
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.946296
AUC of PRC = 0.70801
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1062370017170906
difference in average predicted and observed risk = 0.01752700171709061
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.819791
AUC of PRC = 0.231423
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11263100057840347
difference in average predicted and observed risk = -0.036974999421596516
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.799708
AUC of PRC = 0.548463
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14288699626922607
difference in average predicted and observed risk = 0.06393999626922607
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1007009968161583
difference in average predicted and observed risk = -0.0008900031838417061
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.831982
AUC of PRC = 0.467305
min(+P, Se) = 0.482759

-------------------------------

Epoch 00024: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch24.state
Epoch 25/100
 - 315s - loss: 0.2764 - val_loss: 0.2594

==>predicting on train



confusion matrix:
[[2128   27]
 [ 205   50]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.1050809994339943
difference in average predicted and observed risk = -0.0007280005660057071
number samples = 2410
accuracy = 0.903734
precision class 0 = 0.91213
precision class 1 = 0.649351
recall class 0 = 0.987471
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.012529
positive prediction rate = 0.03195
AUC of ROC = 0.780816
AUC of PRC = 0.406423
min(+P, Se) = 0.400778

-------------------------------

confusion matrix:
[[1159   20]
 [  93   25]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09709200263023376
difference in average predicted and observed risk = 0.00611300263023376
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.925719
precision class 1 = 0.555556
recall class 0 = 0.983036
recall class 1 = 0.211864
false negative rate = 0.788136
false positive rate = 0.016964
positive prediction rate = 0.034695
AUC of ROC = 0.788279
AUC of PRC = 0.346334
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[641  15]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10596500337123871
difference in average predicted and observed risk = 0.004595003371238707
number samples = 730
accuracy = 0.89863
precision class 0 = 0.915714
precision class 1 = 0.5
recall class 0 = 0.977134
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.022866
positive prediction rate = 0.041096
AUC of ROC = 0.777048
AUC of PRC = 0.401167
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11588399857282639
difference in average predicted and observed risk = -0.009770001427173602
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.87475
AUC of PRC = 0.717113
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2437   37]
 [ 200   55]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09882599860429764
difference in average predicted and observed risk = 0.005384998604297642
number samples = 2729
accuracy = 0.913155
precision class 0 = 0.924156
precision class 1 = 0.597826
recall class 0 = 0.985044
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.014956
positive prediction rate = 0.033712
AUC of ROC = 0.771994
AUC of PRC = 0.3631
min(+P, Se) = 0.382812

-------------------------------

confusion matrix:
[[1656   27]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11004000157117844
difference in average predicted and observed risk = -0.0037039984288215616
number samples = 1899
accuracy = 0.896261
precision class 0 = 0.9069
precision class 1 = 0.630137
recall class 0 = 0.983957
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.016043
positive prediction rate = 0.038441
AUC of ROC = 0.80311
AUC of PRC = 0.461496
min(+P, Se) = 0.439815

-------------------------------

confusion matrix:
[[538  11]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12182500213384628
difference in average predicted and observed risk = -0.0011779978661537183
number samples = 626
accuracy = 0.884984
precision class 0 = 0.898164
precision class 1 = 0.592593
recall class 0 = 0.979964
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.020036
positive prediction rate = 0.043131
AUC of ROC = 0.763182
AUC of PRC = 0.375592
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[2230   19]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08748400211334229
difference in average predicted and observed risk = 0.00282800211334229
number samples = 2457
accuracy = 0.919414
precision class 0 = 0.925695
precision class 1 = 0.604167
recall class 0 = 0.991552
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.008448
positive prediction rate = 0.019536
AUC of ROC = 0.775759
AUC of PRC = 0.340272
min(+P, Se) = 0.33945

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10632199794054031
difference in average predicted and observed risk = 0.005515997940540307
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.730942
AUC of PRC = 0.222872
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[466  15]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14339600503444672
difference in average predicted and observed risk = -0.0022519949655532834
number samples = 563
accuracy = 0.886323
precision class 0 = 0.904854
precision class 1 = 0.6875
recall class 0 = 0.968815
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.031185
positive prediction rate = 0.085258
AUC of ROC = 0.822575
AUC of PRC = 0.612716
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[641  14]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10947100073099136
difference in average predicted and observed risk = 0.001842000730991361
number samples = 734
accuracy = 0.901907
precision class 0 = 0.917024
precision class 1 = 0.6
recall class 0 = 0.978626
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.021374
positive prediction rate = 0.047684
AUC of ROC = 0.800039
AUC of PRC = 0.428105
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[4093   64]
 [ 370  101]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10342700034379959
difference in average predicted and observed risk = 0.0016550003437995897
number samples = 4628
accuracy = 0.906223
precision class 0 = 0.917096
precision class 1 = 0.612121
recall class 0 = 0.984604
recall class 1 = 0.214437
false negative rate = 0.785563
false positive rate = 0.015396
positive prediction rate = 0.035653
AUC of ROC = 0.786931
AUC of PRC = 0.409399
min(+P, Se) = 0.41189

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0948610007762909
difference in average predicted and observed risk = 0.01469200077629089
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.820859
AUC of PRC = 0.303792
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09949400275945663
difference in average predicted and observed risk = -0.00930199724054337
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.76535
AUC of PRC = 0.412637
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12022700160741806
difference in average predicted and observed risk = 0.010058001607418057
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.894505
AUC of PRC = 0.561732
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1299010068178177
difference in average predicted and observed risk = -0.003431993182182319
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10868000239133835
difference in average predicted and observed risk = -0.006363997608661645
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.786325
AUC of PRC = 0.333926
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[431   3]
 [ 31  13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09770900011062622
difference in average predicted and observed risk = 0.005659000110626214
number samples = 478
accuracy = 0.92887
precision class 0 = 0.9329
precision class 1 = 0.8125
recall class 0 = 0.993088
recall class 1 = 0.295455
false negative rate = 0.704545
false positive rate = 0.006912
positive prediction rate = 0.033473
AUC of ROC = 0.834311
AUC of PRC = 0.517224
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0864349976181984
difference in average predicted and observed risk = -0.0027670023818016087
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.807786
AUC of PRC = 0.423569
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12525899708271027
difference in average predicted and observed risk = 0.0076119970827102645
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.930556
AUC of PRC = 0.619603
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11128599941730499
difference in average predicted and observed risk = 0.022575999417304995
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.794851
AUC of PRC = 0.215838
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11704400181770325
difference in average predicted and observed risk = -0.03256199818229674
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.775828
AUC of PRC = 0.525281
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1390949934720993
difference in average predicted and observed risk = 0.0601479934720993
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1022609993815422
difference in average predicted and observed risk = 0.0006699993815422051
number samples = 817
accuracy = 0.911873
precision class 0 = 0.916877
precision class 1 = 0.73913
recall class 0 = 0.991826
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.008174
positive prediction rate = 0.028152
AUC of ROC = 0.814878
AUC of PRC = 0.437676
min(+P, Se) = 0.46988

-------------------------------

Epoch 00025: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch25.state
Epoch 26/100
 - 317s - loss: 0.2752 - val_loss: 0.2613

==>predicting on train



confusion matrix:
[[2127   28]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0772629976272583
difference in average predicted and observed risk = -0.0285460023727417
number samples = 2410
accuracy = 0.903734
precision class 0 = 0.912484
precision class 1 = 0.64557
recall class 0 = 0.987007
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.012993
positive prediction rate = 0.03278
AUC of ROC = 0.789089
AUC of PRC = 0.418224
min(+P, Se) = 0.407843

-------------------------------

confusion matrix:
[[1161   18]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07155299931764603
difference in average predicted and observed risk = -0.019426000682353978
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.924363
precision class 1 = 0.560976
recall class 0 = 0.984733
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.015267
positive prediction rate = 0.031611
AUC of ROC = 0.790644
AUC of PRC = 0.34229
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[642  14]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.07803399860858917
difference in average predicted and observed risk = -0.02333600139141083
number samples = 730
accuracy = 0.89863
precision class 0 = 0.91453
precision class 1 = 0.5
recall class 0 = 0.978659
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.021341
positive prediction rate = 0.038356
AUC of ROC = 0.780096
AUC of PRC = 0.405503
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.08797799795866013
difference in average predicted and observed risk = -0.03767600204133986
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.873503
AUC of PRC = 0.718537
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2438   36]
 [ 202   53]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07163500040769577
difference in average predicted and observed risk = -0.021805999592304226
number samples = 2729
accuracy = 0.912789
precision class 0 = 0.923485
precision class 1 = 0.595506
recall class 0 = 0.985449
recall class 1 = 0.207843
false negative rate = 0.792157
false positive rate = 0.014551
positive prediction rate = 0.032613
AUC of ROC = 0.78248
AUC of PRC = 0.367376
min(+P, Se) = 0.388235

-------------------------------

confusion matrix:
[[1657   26]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08282499760389328
difference in average predicted and observed risk = -0.030919002396106718
number samples = 1899
accuracy = 0.896788
precision class 0 = 0.906951
precision class 1 = 0.638889
recall class 0 = 0.984551
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.015449
positive prediction rate = 0.037915
AUC of ROC = 0.802541
AUC of PRC = 0.465411
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[538  11]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09349200129508972
difference in average predicted and observed risk = -0.02951099870491028
number samples = 626
accuracy = 0.884984
precision class 0 = 0.898164
precision class 1 = 0.592593
recall class 0 = 0.979964
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.020036
positive prediction rate = 0.043131
AUC of ROC = 0.771485
AUC of PRC = 0.388222
min(+P, Se) = 0.418605

-------------------------------

confusion matrix:
[[2230   19]
 [ 180   28]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06131099909543991
difference in average predicted and observed risk = -0.023345000904560084
number samples = 2457
accuracy = 0.919007
precision class 0 = 0.925311
precision class 1 = 0.595745
recall class 0 = 0.991552
recall class 1 = 0.134615
false negative rate = 0.865385
false positive rate = 0.008448
positive prediction rate = 0.019129
AUC of ROC = 0.779451
AUC of PRC = 0.344127
min(+P, Se) = 0.341346

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08183400332927704
difference in average predicted and observed risk = -0.018971996670722968
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.730045
AUC of PRC = 0.215627
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[465  16]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11495699733495712
difference in average predicted and observed risk = -0.030691002665042877
number samples = 563
accuracy = 0.884547
precision class 0 = 0.904669
precision class 1 = 0.673469
recall class 0 = 0.966736
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.033264
positive prediction rate = 0.087034
AUC of ROC = 0.831601
AUC of PRC = 0.619882
min(+P, Se) = 0.52439

-------------------------------

confusion matrix:
[[644  11]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.07983099669218063
difference in average predicted and observed risk = -0.02779800330781937
number samples = 734
accuracy = 0.904632
precision class 0 = 0.916074
precision class 1 = 0.645161
recall class 0 = 0.983206
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.016794
positive prediction rate = 0.042234
AUC of ROC = 0.80373
AUC of PRC = 0.441888
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4095   62]
 [ 372   99]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.07622700184583664
difference in average predicted and observed risk = -0.025544998154163362
number samples = 4628
accuracy = 0.906223
precision class 0 = 0.916723
precision class 1 = 0.614907
recall class 0 = 0.985085
recall class 1 = 0.210191
false negative rate = 0.789809
false positive rate = 0.014915
positive prediction rate = 0.034788
AUC of ROC = 0.792022
AUC of PRC = 0.415379
min(+P, Se) = 0.41189

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.06954199820756912
difference in average predicted and observed risk = -0.010627001792430882
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.816514
AUC of PRC = 0.355449
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07046099752187729
difference in average predicted and observed risk = -0.038335002478122715
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.777176
AUC of PRC = 0.42034
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.08997000008821487
difference in average predicted and observed risk = -0.02019899991178513
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.902564
AUC of PRC = 0.587857
min(+P, Se) = 0.5625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.09848999977111816
difference in average predicted and observed risk = -0.03484300022888184
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.07990700006484985
difference in average predicted and observed risk = -0.03513699993515014
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.79
AUC of PRC = 0.330099
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[431   3]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.06988099962472916
difference in average predicted and observed risk = -0.02216900037527085
number samples = 478
accuracy = 0.926778
precision class 0 = 0.930886
precision class 1 = 0.8
recall class 0 = 0.993088
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.006912
positive prediction rate = 0.031381
AUC of ROC = 0.840385
AUC of PRC = 0.528528
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.059137001633644104
difference in average predicted and observed risk = -0.0300649983663559
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.814365
AUC of PRC = 0.433988
min(+P, Se) = 0.404762

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09721899777650833
difference in average predicted and observed risk = -0.02042800222349167
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.926852
AUC of PRC = 0.652026
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08155100047588348
difference in average predicted and observed risk = -0.007158999524116513
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.798069
AUC of PRC = 0.212873
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.08670300245285034
difference in average predicted and observed risk = -0.06290299754714965
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.79386
AUC of PRC = 0.542875
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11208900064229965
difference in average predicted and observed risk = 0.03314200064229965
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.07404100149869919
difference in average predicted and observed risk = -0.027549998501300813
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.820853
AUC of PRC = 0.446536
min(+P, Se) = 0.457831

-------------------------------

Epoch 00026: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch26.state
Epoch 27/100
 - 317s - loss: 0.2757 - val_loss: 0.2560

==>predicting on train



confusion matrix:
[[2134   21]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11596400290727615
difference in average predicted and observed risk = 0.010155002907276153
number samples = 2410
accuracy = 0.905394
precision class 0 = 0.911576
precision class 1 = 0.695652
recall class 0 = 0.990255
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.009745
positive prediction rate = 0.028631
AUC of ROC = 0.793647
AUC of PRC = 0.420938
min(+P, Se) = 0.413127

-------------------------------

confusion matrix:
[[1163   16]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10304799675941467
difference in average predicted and observed risk = 0.012068996759414669
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.923016
precision class 1 = 0.567568
recall class 0 = 0.986429
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.013571
positive prediction rate = 0.028527
AUC of ROC = 0.802123
AUC of PRC = 0.360192
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[645  11]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11167699843645096
difference in average predicted and observed risk = 0.010306998436450956
number samples = 730
accuracy = 0.90274
precision class 0 = 0.914894
precision class 1 = 0.56
recall class 0 = 0.983232
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.016768
positive prediction rate = 0.034247
AUC of ROC = 0.780014
AUC of PRC = 0.409535
min(+P, Se) = 0.472973

-------------------------------

confusion matrix:
[[165   2]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11637800186872482
difference in average predicted and observed risk = -0.009275998131275165
number samples = 191
accuracy = 0.91623
precision class 0 = 0.921788
precision class 1 = 0.833333
recall class 0 = 0.988024
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.011976
positive prediction rate = 0.062827
AUC of ROC = 0.876747
AUC of PRC = 0.722446
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2448   26]
 [ 207   48]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10756099969148636
difference in average predicted and observed risk = 0.014119999691486362
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.922034
precision class 1 = 0.648649
recall class 0 = 0.989491
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.010509
positive prediction rate = 0.027116
AUC of ROC = 0.782946
AUC of PRC = 0.370333
min(+P, Se) = 0.398438

-------------------------------

confusion matrix:
[[1659   24]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11761099845170975
difference in average predicted and observed risk = 0.0038669984517097494
number samples = 1899
accuracy = 0.897314
precision class 0 = 0.906557
precision class 1 = 0.652174
recall class 0 = 0.98574
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.01426
positive prediction rate = 0.036335
AUC of ROC = 0.813365
AUC of PRC = 0.475009
min(+P, Se) = 0.451613

-------------------------------

confusion matrix:
[[538  11]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13297200202941895
difference in average predicted and observed risk = 0.009969002029418944
number samples = 626
accuracy = 0.883387
precision class 0 = 0.896667
precision class 1 = 0.576923
recall class 0 = 0.979964
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.020036
positive prediction rate = 0.041534
AUC of ROC = 0.781468
AUC of PRC = 0.392036
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[2234   15]
 [ 181   27]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0960799977183342
difference in average predicted and observed risk = 0.011423997718334203
number samples = 2457
accuracy = 0.920228
precision class 0 = 0.925052
precision class 1 = 0.642857
recall class 0 = 0.99333
recall class 1 = 0.129808
false negative rate = 0.870192
false positive rate = 0.00667
positive prediction rate = 0.017094
AUC of ROC = 0.786721
AUC of PRC = 0.355005
min(+P, Se) = 0.360577

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11859100311994553
difference in average predicted and observed risk = 0.01778500311994552
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.73417
AUC of PRC = 0.218797
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[471  10]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1510400027036667
difference in average predicted and observed risk = 0.005392002703666687
number samples = 563
accuracy = 0.895204
precision class 0 = 0.905769
precision class 1 = 0.767442
recall class 0 = 0.97921
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.02079
positive prediction rate = 0.076377
AUC of ROC = 0.833959
AUC of PRC = 0.618645
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[646   9]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11324799805879593
difference in average predicted and observed risk = 0.0056189980587959265
number samples = 734
accuracy = 0.904632
precision class 0 = 0.91372
precision class 1 = 0.666667
recall class 0 = 0.98626
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.01374
positive prediction rate = 0.036785
AUC of ROC = 0.805392
AUC of PRC = 0.43019
min(+P, Se) = 0.438202

-------------------------------

confusion matrix:
[[4107   50]
 [ 378   93]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11168500036001205
difference in average predicted and observed risk = 0.009913000360012053
number samples = 4628
accuracy = 0.907519
precision class 0 = 0.915719
precision class 1 = 0.65035
recall class 0 = 0.987972
recall class 1 = 0.197452
false negative rate = 0.802548
false positive rate = 0.012028
positive prediction rate = 0.030899
AUC of ROC = 0.797549
AUC of PRC = 0.421836
min(+P, Se) = 0.420382

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10183300077915192
difference in average predicted and observed risk = 0.021664000779151912
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.837518
AUC of PRC = 0.389235
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.11108600348234177
difference in average predicted and observed risk = 0.0022900034823417625
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.780492
AUC of PRC = 0.434993
min(+P, Se) = 0.442308

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12586699426174164
difference in average predicted and observed risk = 0.015697994261741635
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.928938
AUC of PRC = 0.605412
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13870200514793396
difference in average predicted and observed risk = 0.005369005147933953
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11622799932956696
difference in average predicted and observed risk = 0.001183999329566962
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.812991
AUC of PRC = 0.36279
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.1082329973578453
difference in average predicted and observed risk = 0.0161829973578453
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.843999
AUC of PRC = 0.545554
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09552299976348877
difference in average predicted and observed risk = 0.006320999763488766
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.822097
AUC of PRC = 0.469939
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13780100643634796
difference in average predicted and observed risk = 0.02015400643634796
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.943519
AUC of PRC = 0.707367
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.12255199998617172
difference in average predicted and observed risk = 0.033841999986171725
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.823009
AUC of PRC = 0.233576
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12219099700450897
difference in average predicted and observed risk = -0.027415002995491017
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.802632
AUC of PRC = 0.54726
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14929799735546112
difference in average predicted and observed risk = 0.07035099735546112
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11155100166797638
difference in average predicted and observed risk = 0.009960001667976379
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.832392
AUC of PRC = 0.474571
min(+P, Se) = 0.481928

-------------------------------

Epoch 00027: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch27.state
Epoch 28/100
 - 318s - loss: 0.2788 - val_loss: 0.2607

==>predicting on train



confusion matrix:
[[2135   20]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10901200026273727
difference in average predicted and observed risk = 0.003203000262737274
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.912003
precision class 1 = 0.710145
recall class 0 = 0.990719
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.009281
positive prediction rate = 0.028631
AUC of ROC = 0.783351
AUC of PRC = 0.413784
min(+P, Se) = 0.396078

-------------------------------

confusion matrix:
[[1163   16]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10267700254917145
difference in average predicted and observed risk = 0.011698002549171443
number samples = 1297
accuracy = 0.911334
precision class 0 = 0.921553
precision class 1 = 0.542857
recall class 0 = 0.986429
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.013571
positive prediction rate = 0.026985
AUC of ROC = 0.797624
AUC of PRC = 0.359416
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[643  13]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11086799949407578
difference in average predicted and observed risk = 0.009497999494075773
number samples = 730
accuracy = 0.89863
precision class 0 = 0.913352
precision class 1 = 0.5
recall class 0 = 0.980183
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.019817
positive prediction rate = 0.035616
AUC of ROC = 0.782115
AUC of PRC = 0.405699
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11256200075149536
difference in average predicted and observed risk = -0.013091999248504627
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.876497
AUC of PRC = 0.720829
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2449   25]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.1042179986834526
difference in average predicted and observed risk = 0.01077699868345261
number samples = 2729
accuracy = 0.914254
precision class 0 = 0.921369
precision class 1 = 0.647887
recall class 0 = 0.989895
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.010105
positive prediction rate = 0.026017
AUC of ROC = 0.776926
AUC of PRC = 0.370944
min(+P, Se) = 0.389313

-------------------------------

confusion matrix:
[[1657   26]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11264599859714508
difference in average predicted and observed risk = -0.0010980014028549173
number samples = 1899
accuracy = 0.896788
precision class 0 = 0.906951
precision class 1 = 0.638889
recall class 0 = 0.984551
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.015449
positive prediction rate = 0.037915
AUC of ROC = 0.810738
AUC of PRC = 0.470753
min(+P, Se) = 0.449541

-------------------------------

confusion matrix:
[[539  10]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13099299371242523
difference in average predicted and observed risk = 0.00798999371242523
number samples = 626
accuracy = 0.883387
precision class 0 = 0.895349
precision class 1 = 0.583333
recall class 0 = 0.981785
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.018215
positive prediction rate = 0.038339
AUC of ROC = 0.774324
AUC of PRC = 0.387354
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[2233   16]
 [ 181   27]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09183499962091446
difference in average predicted and observed risk = 0.007178999620914464
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.925021
precision class 1 = 0.627907
recall class 0 = 0.992886
recall class 1 = 0.129808
false negative rate = 0.870192
false positive rate = 0.007114
positive prediction rate = 0.017501
AUC of ROC = 0.781901
AUC of PRC = 0.339787
min(+P, Se) = 0.344498

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11414100229740143
difference in average predicted and observed risk = 0.013335002297401422
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.728072
AUC of PRC = 0.226805
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[471  10]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14303700625896454
difference in average predicted and observed risk = -0.002610993741035461
number samples = 563
accuracy = 0.891652
precision class 0 = 0.902299
precision class 1 = 0.756098
recall class 0 = 0.97921
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.02079
positive prediction rate = 0.072824
AUC of ROC = 0.825237
AUC of PRC = 0.619497
min(+P, Se) = 0.560976

-------------------------------

confusion matrix:
[[645  10]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11150900274515152
difference in average predicted and observed risk = 0.0038800027451515173
number samples = 734
accuracy = 0.904632
precision class 0 = 0.914894
precision class 1 = 0.655172
recall class 0 = 0.984733
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.015267
positive prediction rate = 0.03951
AUC of ROC = 0.80543
AUC of PRC = 0.443288
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4106   51]
 [ 379   92]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10767599940299988
difference in average predicted and observed risk = 0.005903999402999877
number samples = 4628
accuracy = 0.907087
precision class 0 = 0.915496
precision class 1 = 0.643357
recall class 0 = 0.987732
recall class 1 = 0.195329
false negative rate = 0.804671
false positive rate = 0.012268
positive prediction rate = 0.030899
AUC of ROC = 0.792669
AUC of PRC = 0.418223
min(+P, Se) = 0.409766

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.1018579974770546
difference in average predicted and observed risk = 0.021688997477054592
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.834138
AUC of PRC = 0.368264
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10578200221061707
difference in average predicted and observed risk = -0.0030139977893829384
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.75706
AUC of PRC = 0.414263
min(+P, Se) = 0.408163

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12501299381256104
difference in average predicted and observed risk = 0.014843993812561032
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.901832
AUC of PRC = 0.609577
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.133215993642807
difference in average predicted and observed risk = -0.00011700635719300023
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11220800131559372
difference in average predicted and observed risk = -0.002835998684406274
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.796239
AUC of PRC = 0.35544
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[433   1]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.1057479977607727
difference in average predicted and observed risk = 0.013697997760772698
number samples = 478
accuracy = 0.930962
precision class 0 = 0.931183
precision class 1 = 0.923077
recall class 0 = 0.997696
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.002304
positive prediction rate = 0.027197
AUC of ROC = 0.826875
AUC of PRC = 0.529149
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0919409990310669
difference in average predicted and observed risk = 0.002738999031066891
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.802903
AUC of PRC = 0.441763
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1297750025987625
difference in average predicted and observed risk = 0.01212800259876251
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.933333
AUC of PRC = 0.701284
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1228019967675209
difference in average predicted and observed risk = 0.03409199676752091
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.79646
AUC of PRC = 0.21519
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12198799848556519
difference in average predicted and observed risk = -0.027618001514434803
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.787524
AUC of PRC = 0.528188
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1437470018863678
difference in average predicted and observed risk = 0.0648000018863678
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[730   4]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1084280014038086
difference in average predicted and observed risk = 0.006837001403808593
number samples = 817
accuracy = 0.911873
precision class 0 = 0.914787
precision class 1 = 0.789474
recall class 0 = 0.99455
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.00545
positive prediction rate = 0.023256
AUC of ROC = 0.814747
AUC of PRC = 0.455293
min(+P, Se) = 0.481928

-------------------------------

Epoch 00028: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch28.state
Epoch 29/100
 - 314s - loss: 0.2819 - val_loss: 0.2534

==>predicting on train



confusion matrix:
[[2135   20]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09782899916172028
difference in average predicted and observed risk = -0.007980000838279724
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.912783
precision class 1 = 0.71831
recall class 0 = 0.990719
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.009281
positive prediction rate = 0.029461
AUC of ROC = 0.786166
AUC of PRC = 0.413799
min(+P, Se) = 0.396947

-------------------------------

confusion matrix:
[[1163   16]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0932679995894432
difference in average predicted and observed risk = 0.0022889995894432025
number samples = 1297
accuracy = 0.911334
precision class 0 = 0.921553
precision class 1 = 0.542857
recall class 0 = 0.986429
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.013571
positive prediction rate = 0.026985
AUC of ROC = 0.794971
AUC of PRC = 0.357966
min(+P, Se) = 0.366667

-------------------------------

confusion matrix:
[[645  11]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10051800310611725
difference in average predicted and observed risk = -0.0008519968938827532
number samples = 730
accuracy = 0.90274
precision class 0 = 0.914894
precision class 1 = 0.56
recall class 0 = 0.983232
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.016768
positive prediction rate = 0.034247
AUC of ROC = 0.77231
AUC of PRC = 0.405209
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10636500269174576
difference in average predicted and observed risk = -0.01928899730825423
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.87999
AUC of PRC = 0.732634
min(+P, Se) = 0.692308

-------------------------------

confusion matrix:
[[2450   24]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09318699687719345
difference in average predicted and observed risk = -0.00025400312280654536
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.921399
precision class 1 = 0.657143
recall class 0 = 0.990299
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.009701
positive prediction rate = 0.02565
AUC of ROC = 0.775605
AUC of PRC = 0.368191
min(+P, Se) = 0.370656

-------------------------------

confusion matrix:
[[1658   25]
 [ 167   49]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10327699780464172
difference in average predicted and observed risk = -0.010467002195358274
number samples = 1899
accuracy = 0.898894
precision class 0 = 0.908493
precision class 1 = 0.662162
recall class 0 = 0.985146
recall class 1 = 0.226852
false negative rate = 0.773148
false positive rate = 0.014854
positive prediction rate = 0.038968
AUC of ROC = 0.808551
AUC of PRC = 0.470893
min(+P, Se) = 0.449541

-------------------------------

confusion matrix:
[[539  10]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11502700299024582
difference in average predicted and observed risk = -0.007975997009754182
number samples = 626
accuracy = 0.884984
precision class 0 = 0.896839
precision class 1 = 0.6
recall class 0 = 0.981785
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.018215
positive prediction rate = 0.039936
AUC of ROC = 0.778369
AUC of PRC = 0.389555
min(+P, Se) = 0.415584

-------------------------------

confusion matrix:
[[2234   15]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0821710005402565
difference in average predicted and observed risk = -0.002484999459743495
number samples = 2457
accuracy = 0.921042
precision class 0 = 0.925819
precision class 1 = 0.659091
recall class 0 = 0.99333
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.00667
positive prediction rate = 0.017908
AUC of ROC = 0.77847
AUC of PRC = 0.346925
min(+P, Se) = 0.326923

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.1031159982085228
difference in average predicted and observed risk = 0.00230999820852279
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.729507
AUC of PRC = 0.217866
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[471  10]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13573400676250458
difference in average predicted and observed risk = -0.009913993237495422
number samples = 563
accuracy = 0.893428
precision class 0 = 0.904031
precision class 1 = 0.761905
recall class 0 = 0.97921
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.02079
positive prediction rate = 0.0746
AUC of ROC = 0.832032
AUC of PRC = 0.616683
min(+P, Se) = 0.541176

-------------------------------

confusion matrix:
[[646   9]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10155099630355835
difference in average predicted and observed risk = -0.006078003696441653
number samples = 734
accuracy = 0.905995
precision class 0 = 0.915014
precision class 1 = 0.678571
recall class 0 = 0.98626
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.01374
positive prediction rate = 0.038147
AUC of ROC = 0.790646
AUC of PRC = 0.42496
min(+P, Se) = 0.417722

-------------------------------

confusion matrix:
[[4108   49]
 [ 376   95]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09732700139284134
difference in average predicted and observed risk = -0.004444998607158662
number samples = 4628
accuracy = 0.908168
precision class 0 = 0.916146
precision class 1 = 0.659722
recall class 0 = 0.988213
recall class 1 = 0.201699
false negative rate = 0.798301
false positive rate = 0.011787
positive prediction rate = 0.031115
AUC of ROC = 0.791217
AUC of PRC = 0.417554
min(+P, Se) = 0.403805

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09251900017261505
difference in average predicted and observed risk = 0.012350000172615047
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.826654
AUC of PRC = 0.379363
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09361299872398376
difference in average predicted and observed risk = -0.01518300127601624
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.774413
AUC of PRC = 0.410684
min(+P, Se) = 0.408163

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11531399935483932
difference in average predicted and observed risk = 0.005144999354839322
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.92967
AUC of PRC = 0.608754
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12873099744319916
difference in average predicted and observed risk = -0.004602002556800849
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10221599787473679
difference in average predicted and observed risk = -0.012828002125263208
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.804957
AUC of PRC = 0.370894
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09453099966049194
difference in average predicted and observed risk = 0.0024809996604919365
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.840176
AUC of PRC = 0.544473
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08207400143146515
difference in average predicted and observed risk = -0.007127998568534855
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.809617
AUC of PRC = 0.467292
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1245260015130043
difference in average predicted and observed risk = 0.006879001513004301
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.936111
AUC of PRC = 0.655366
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10577300190925598
difference in average predicted and observed risk = 0.017063001909255984
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.810941
AUC of PRC = 0.217813
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10969799757003784
difference in average predicted and observed risk = -0.03990800242996215
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.808967
AUC of PRC = 0.541093
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13484099507331848
difference in average predicted and observed risk = 0.05589399507331848
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.933333
AUC of PRC = 0.568651
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09771899878978729
difference in average predicted and observed risk = -0.0038720012102127083
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.826237
AUC of PRC = 0.463818
min(+P, Se) = 0.471264

-------------------------------

Epoch 00029: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch29.state
Epoch 30/100
 - 314s - loss: 0.2771 - val_loss: 0.2546

==>predicting on train



confusion matrix:
[[2139   16]
 [ 213   42]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08766300231218338
difference in average predicted and observed risk = -0.01814599768781662
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.909439
precision class 1 = 0.724138
recall class 0 = 0.992575
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.007425
positive prediction rate = 0.024066
AUC of ROC = 0.789886
AUC of PRC = 0.419184
min(+P, Se) = 0.407843

-------------------------------

confusion matrix:
[[1168   11]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08190499991178513
difference in average predicted and observed risk = -0.009074000088214879
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.918961
precision class 1 = 0.576923
recall class 0 = 0.99067
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.00933
positive prediction rate = 0.020046
AUC of ROC = 0.798084
AUC of PRC = 0.356043
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[651   5]
 [ 64  10]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09053000062704086
difference in average predicted and observed risk = -0.010839999372959139
number samples = 730
accuracy = 0.905479
precision class 0 = 0.910489
precision class 1 = 0.666667
recall class 0 = 0.992378
recall class 1 = 0.135135
false negative rate = 0.864865
false positive rate = 0.007622
positive prediction rate = 0.020548
AUC of ROC = 0.777563
AUC of PRC = 0.406075
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10566899925470352
difference in average predicted and observed risk = -0.019985000745296466
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.877994
AUC of PRC = 0.717505
min(+P, Se) = 0.692308

-------------------------------

confusion matrix:
[[2456   18]
 [ 220   35]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08218099921941757
difference in average predicted and observed risk = -0.011260000780582424
number samples = 2729
accuracy = 0.912789
precision class 0 = 0.917788
precision class 1 = 0.660377
recall class 0 = 0.992724
recall class 1 = 0.137255
false negative rate = 0.862745
false positive rate = 0.007276
positive prediction rate = 0.019421
AUC of ROC = 0.780189
AUC of PRC = 0.365389
min(+P, Se) = 0.385214

-------------------------------

confusion matrix:
[[1667   16]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09452100098133087
difference in average predicted and observed risk = -0.019222999018669126
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905978
precision class 1 = 0.728814
recall class 0 = 0.990493
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.009507
positive prediction rate = 0.031069
AUC of ROC = 0.811448
AUC of PRC = 0.478868
min(+P, Se) = 0.458333

-------------------------------

confusion matrix:
[[543   6]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1036050021648407
difference in average predicted and observed risk = -0.019397997835159303
number samples = 626
accuracy = 0.881789
precision class 0 = 0.888707
precision class 1 = 0.6
recall class 0 = 0.989071
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.010929
positive prediction rate = 0.023962
AUC of ROC = 0.781515
AUC of PRC = 0.389433
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[2239   10]
 [ 185   23]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07273499667644501
difference in average predicted and observed risk = -0.011921003323554988
number samples = 2457
accuracy = 0.920635
precision class 0 = 0.92368
precision class 1 = 0.69697
recall class 0 = 0.995554
recall class 1 = 0.110577
false negative rate = 0.889423
false positive rate = 0.004446
positive prediction rate = 0.013431
AUC of ROC = 0.784118
AUC of PRC = 0.35417
min(+P, Se) = 0.350962

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09320099651813507
difference in average predicted and observed risk = -0.007605003481864936
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.723049
AUC of PRC = 0.220149
min(+P, Se) = 0.285714

-------------------------------

confusion matrix:
[[475   6]
 [ 54  28]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12367899715900421
difference in average predicted and observed risk = -0.021969002840995788
number samples = 563
accuracy = 0.893428
precision class 0 = 0.897921
precision class 1 = 0.823529
recall class 0 = 0.987526
recall class 1 = 0.341463
false negative rate = 0.658537
false positive rate = 0.012474
positive prediction rate = 0.060391
AUC of ROC = 0.831778
AUC of PRC = 0.615792
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[648   7]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09189999848604202
difference in average predicted and observed risk = -0.01572900151395798
number samples = 734
accuracy = 0.907357
precision class 0 = 0.913963
precision class 1 = 0.72
recall class 0 = 0.989313
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.010687
positive prediction rate = 0.03406
AUC of ROC = 0.79799
AUC of PRC = 0.440366
min(+P, Se) = 0.432099

-------------------------------

confusion matrix:
[[4123   34]
 [ 393   78]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08724500238895416
difference in average predicted and observed risk = -0.014526997611045839
number samples = 4628
accuracy = 0.907736
precision class 0 = 0.912976
precision class 1 = 0.696429
recall class 0 = 0.991821
recall class 1 = 0.165605
false negative rate = 0.834395
false positive rate = 0.008179
positive prediction rate = 0.024201
AUC of ROC = 0.794969
AUC of PRC = 0.420187
min(+P, Se) = 0.409766

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08135899901390076
difference in average predicted and observed risk = 0.0011899990139007527
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.83438
AUC of PRC = 0.354807
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08313799649477005
difference in average predicted and observed risk = -0.025658003505229954
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.77491
AUC of PRC = 0.415179
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10401300340890884
difference in average predicted and observed risk = -0.006155996591091159
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.923077
AUC of PRC = 0.602985
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12895900011062622
difference in average predicted and observed risk = -0.004373999889373786
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09161300212144852
difference in average predicted and observed risk = -0.023430997878551477
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.802906
AUC of PRC = 0.379743
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08427499979734421
difference in average predicted and observed risk = -0.007775000202655799
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.840647
AUC of PRC = 0.544607
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07191599905490875
difference in average predicted and observed risk = -0.01728600094509125
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.814569
AUC of PRC = 0.458092
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11175599694252014
difference in average predicted and observed risk = -0.00589100305747986
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.941667
AUC of PRC = 0.70538
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09469299763441086
difference in average predicted and observed risk = 0.005982997634410861
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.820595
AUC of PRC = 0.225861
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.102572001516819
difference in average predicted and observed risk = -0.04703399848318099
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.797271
AUC of PRC = 0.529763
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.119378000497818
difference in average predicted and observed risk = 0.04043100049781799
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[731   3]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0873199999332428
difference in average predicted and observed risk = -0.014271000066757203
number samples = 817
accuracy = 0.910649
precision class 0 = 0.912609
precision class 1 = 0.8125
recall class 0 = 0.995913
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.004087
positive prediction rate = 0.019584
AUC of ROC = 0.82622
AUC of PRC = 0.469617
min(+P, Se) = 0.481928

-------------------------------

Epoch 00030: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch30.state
Epoch 31/100
 - 319s - loss: 0.2735 - val_loss: 0.2615

==>predicting on train



confusion matrix:
[[2136   19]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11413600295782089
difference in average predicted and observed risk = 0.008327002957820892
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.911652
precision class 1 = 0.716418
recall class 0 = 0.991183
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.008817
positive prediction rate = 0.027801
AUC of ROC = 0.788767
AUC of PRC = 0.421011
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1162   17]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10962600260972977
difference in average predicted and observed risk = 0.018647002609729763
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.924423
precision class 1 = 0.575
recall class 0 = 0.985581
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.014419
positive prediction rate = 0.03084
AUC of ROC = 0.801196
AUC of PRC = 0.355853
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[641  15]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11693800240755081
difference in average predicted and observed risk = 0.01556800240755081
number samples = 730
accuracy = 0.89726
precision class 0 = 0.914408
precision class 1 = 0.482759
recall class 0 = 0.977134
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.022866
positive prediction rate = 0.039726
AUC of ROC = 0.789552
AUC of PRC = 0.413099
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12939299643039703
difference in average predicted and observed risk = 0.0037389964303970458
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.880988
AUC of PRC = 0.713604
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2444   30]
 [ 204   51]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10916099697351456
difference in average predicted and observed risk = 0.01571999697351456
number samples = 2729
accuracy = 0.914254
precision class 0 = 0.922961
precision class 1 = 0.62963
recall class 0 = 0.987874
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.012126
positive prediction rate = 0.029681
AUC of ROC = 0.784981
AUC of PRC = 0.371439
min(+P, Se) = 0.384314

-------------------------------

confusion matrix:
[[1660   23]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.12081699818372726
difference in average predicted and observed risk = 0.0070729981837272665
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.906608
precision class 1 = 0.661765
recall class 0 = 0.986334
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.013666
positive prediction rate = 0.035808
AUC of ROC = 0.812675
AUC of PRC = 0.47577
min(+P, Se) = 0.458333

-------------------------------

confusion matrix:
[[538  11]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13271699845790863
difference in average predicted and observed risk = 0.00971399845790863
number samples = 626
accuracy = 0.880192
precision class 0 = 0.893688
precision class 1 = 0.541667
recall class 0 = 0.979964
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.020036
positive prediction rate = 0.038339
AUC of ROC = 0.782816
AUC of PRC = 0.387871
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[2232   17]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0988759994506836
difference in average predicted and observed risk = 0.014219999450683599
number samples = 2457
accuracy = 0.920635
precision class 0 = 0.926141
precision class 1 = 0.638298
recall class 0 = 0.992441
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.007559
positive prediction rate = 0.019129
AUC of ROC = 0.78922
AUC of PRC = 0.353882
min(+P, Se) = 0.33945

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.12077900022268295
difference in average predicted and observed risk = 0.019973000222682946
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.723767
AUC of PRC = 0.221049
min(+P, Se) = 0.297297

-------------------------------

confusion matrix:
[[471  10]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1506499946117401
difference in average predicted and observed risk = 0.005001994611740113
number samples = 563
accuracy = 0.891652
precision class 0 = 0.902299
precision class 1 = 0.756098
recall class 0 = 0.97921
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.02079
positive prediction rate = 0.072824
AUC of ROC = 0.828736
AUC of PRC = 0.610903
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[645  10]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11790700256824493
difference in average predicted and observed risk = 0.010278002568244932
number samples = 734
accuracy = 0.907357
precision class 0 = 0.917496
precision class 1 = 0.677419
recall class 0 = 0.984733
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.015267
positive prediction rate = 0.042234
AUC of ROC = 0.8109
AUC of PRC = 0.452265
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4104   53]
 [ 375   96]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11394400149583817
difference in average predicted and observed risk = 0.012172001495838164
number samples = 4628
accuracy = 0.907519
precision class 0 = 0.916276
precision class 1 = 0.644295
recall class 0 = 0.98725
recall class 1 = 0.203822
false negative rate = 0.796178
false positive rate = 0.01275
positive prediction rate = 0.032195
AUC of ROC = 0.797985
AUC of PRC = 0.420003
min(+P, Se) = 0.416136

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.1073480024933815
difference in average predicted and observed risk = 0.027179002493381496
number samples = 237
accuracy = 0.924051
precision class 0 = 0.934783
precision class 1 = 0.571429
recall class 0 = 0.986239
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.013761
positive prediction rate = 0.029536
AUC of ROC = 0.83607
AUC of PRC = 0.399254
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10922200232744217
difference in average predicted and observed risk = 0.0004260023274421654
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.766897
AUC of PRC = 0.424188
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1310330033302307
difference in average predicted and observed risk = 0.02086400333023071
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.898168
AUC of PRC = 0.522477
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.15095999836921692
difference in average predicted and observed risk = 0.017626998369216912
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11769700050354004
difference in average predicted and observed risk = 0.0026530005035400456
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.788462
AUC of PRC = 0.354686
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.11028599739074707
difference in average predicted and observed risk = 0.018235997390747063
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.837924
AUC of PRC = 0.538097
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09743800014257431
difference in average predicted and observed risk = 0.008236000142574307
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.806905
AUC of PRC = 0.428766
min(+P, Se) = 0.368421

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13568399846553802
difference in average predicted and observed risk = 0.018036998465538023
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.92037
AUC of PRC = 0.68957
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1221340000629425
difference in average predicted and observed risk = 0.03342400006294251
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.79646
AUC of PRC = 0.218136
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.13000500202178955
difference in average predicted and observed risk = -0.019600997978210438
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.787524
AUC of PRC = 0.538803
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14770099520683289
difference in average predicted and observed risk = 0.06875399520683288
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[730   4]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11336100101470947
difference in average predicted and observed risk = 0.011770001014709472
number samples = 817
accuracy = 0.911873
precision class 0 = 0.914787
precision class 1 = 0.789474
recall class 0 = 0.99455
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.00545
positive prediction rate = 0.023256
AUC of ROC = 0.816848
AUC of PRC = 0.459537
min(+P, Se) = 0.466667

-------------------------------

Epoch 00031: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch31.state
Epoch 32/100
 - 318s - loss: 0.2755 - val_loss: 0.2558

==>predicting on train



confusion matrix:
[[2136   19]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11212000250816345
difference in average predicted and observed risk = 0.006311002508163452
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.911652
precision class 1 = 0.716418
recall class 0 = 0.991183
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.008817
positive prediction rate = 0.027801
AUC of ROC = 0.788332
AUC of PRC = 0.42186
min(+P, Se) = 0.406015

-------------------------------

confusion matrix:
[[1164   15]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10323599725961685
difference in average predicted and observed risk = 0.012256997259616847
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.92381
precision class 1 = 0.594595
recall class 0 = 0.987277
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.012723
positive prediction rate = 0.028527
AUC of ROC = 0.795769
AUC of PRC = 0.367459
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[644  12]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10998400300741196
difference in average predicted and observed risk = 0.008614003007411955
number samples = 730
accuracy = 0.9
precision class 0 = 0.913475
precision class 1 = 0.52
recall class 0 = 0.981707
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.018293
positive prediction rate = 0.034247
AUC of ROC = 0.785658
AUC of PRC = 0.422162
min(+P, Se) = 0.472973

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1229960024356842
difference in average predicted and observed risk = -0.002657997564315784
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.883733
AUC of PRC = 0.730577
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2448   26]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10381200164556503
difference in average predicted and observed risk = 0.010371001645565037
number samples = 2729
accuracy = 0.913888
precision class 0 = 0.92134
precision class 1 = 0.638889
recall class 0 = 0.989491
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.010509
positive prediction rate = 0.026383
AUC of ROC = 0.780668
AUC of PRC = 0.375422
min(+P, Se) = 0.385214

-------------------------------

confusion matrix:
[[1661   22]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11826500296592712
difference in average predicted and observed risk = 0.004521002965927126
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.908147
precision class 1 = 0.685714
recall class 0 = 0.986928
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.013072
positive prediction rate = 0.036862
AUC of ROC = 0.81109
AUC of PRC = 0.479367
min(+P, Se) = 0.457014

-------------------------------

confusion matrix:
[[541   8]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12634100019931793
difference in average predicted and observed risk = 0.003338000199317931
number samples = 626
accuracy = 0.883387
precision class 0 = 0.892739
precision class 1 = 0.6
recall class 0 = 0.985428
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.014572
positive prediction rate = 0.031949
AUC of ROC = 0.781918
AUC of PRC = 0.386719
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[2232   17]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09501300007104874
difference in average predicted and observed risk = 0.010357000071048741
number samples = 2457
accuracy = 0.921042
precision class 0 = 0.926526
precision class 1 = 0.645833
recall class 0 = 0.992441
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.007559
positive prediction rate = 0.019536
AUC of ROC = 0.785326
AUC of PRC = 0.354829
min(+P, Se) = 0.350962

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11441300064325333
difference in average predicted and observed risk = 0.01360700064325332
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.72
AUC of PRC = 0.225338
min(+P, Se) = 0.282051

-------------------------------

confusion matrix:
[[470  11]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14872600138187408
difference in average predicted and observed risk = 0.003078001381874085
number samples = 563
accuracy = 0.889876
precision class 0 = 0.902111
precision class 1 = 0.738095
recall class 0 = 0.977131
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.022869
positive prediction rate = 0.0746
AUC of ROC = 0.82757
AUC of PRC = 0.623562
min(+P, Se) = 0.529412

-------------------------------

confusion matrix:
[[647   8]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11341100186109543
difference in average predicted and observed risk = 0.005782001861095426
number samples = 734
accuracy = 0.908719
precision class 0 = 0.916431
precision class 1 = 0.714286
recall class 0 = 0.987786
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.012214
positive prediction rate = 0.038147
AUC of ROC = 0.801778
AUC of PRC = 0.455209
min(+P, Se) = 0.448276

-------------------------------

confusion matrix:
[[4109   48]
 [ 377   94]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10974200069904327
difference in average predicted and observed risk = 0.007970000699043273
number samples = 4628
accuracy = 0.908168
precision class 0 = 0.915961
precision class 1 = 0.661972
recall class 0 = 0.988453
recall class 1 = 0.199575
false negative rate = 0.800425
false positive rate = 0.011547
positive prediction rate = 0.030683
AUC of ROC = 0.795024
AUC of PRC = 0.424121
min(+P, Se) = 0.418259

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10198599845170975
difference in average predicted and observed risk = 0.021816998451709743
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.832207
AUC of PRC = 0.34641
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.1091260015964508
difference in average predicted and observed risk = 0.00033000159645080185
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.775573
AUC of PRC = 0.415344
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12492299824953079
difference in average predicted and observed risk = 0.01475399824953079
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.920879
AUC of PRC = 0.54283
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1455180048942566
difference in average predicted and observed risk = 0.012185004894256585
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1176460012793541
difference in average predicted and observed risk = 0.002602001279354102
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.802308
AUC of PRC = 0.349818
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10572700202465057
difference in average predicted and observed risk = 0.013677002024650567
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.844313
AUC of PRC = 0.544323
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09432599693536758
difference in average predicted and observed risk = 0.005123996935367581
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.815722
AUC of PRC = 0.460787
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13833999633789062
difference in average predicted and observed risk = 0.020692996337890623
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.930556
AUC of PRC = 0.627603
min(+P, Se) = 0.533333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11928799748420715
difference in average predicted and observed risk = 0.030577997484207156
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.818986
AUC of PRC = 0.233229
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.123430997133255
difference in average predicted and observed risk = -0.026175002866744984
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.798246
AUC of PRC = 0.543252
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1489119976758957
difference in average predicted and observed risk = 0.06996499767589569
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.933333
AUC of PRC = 0.568651
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11067300289869308
difference in average predicted and observed risk = 0.009082002898693084
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.827813
AUC of PRC = 0.454977
min(+P, Se) = 0.481928

-------------------------------

Epoch 00032: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch32.state
Epoch 33/100
 - 314s - loss: 0.2731 - val_loss: 0.2542

==>predicting on train



confusion matrix:
[[2139   16]
 [ 215   40]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09571699798107147
difference in average predicted and observed risk = -0.010092002018928528
number samples = 2410
accuracy = 0.904149
precision class 0 = 0.908666
precision class 1 = 0.714286
recall class 0 = 0.992575
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.007425
positive prediction rate = 0.023237
AUC of ROC = 0.798435
AUC of PRC = 0.426039
min(+P, Se) = 0.412451

-------------------------------

confusion matrix:
[[1163   16]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0894559994339943
difference in average predicted and observed risk = -0.001523000566005711
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.922284
precision class 1 = 0.555556
recall class 0 = 0.986429
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.013571
positive prediction rate = 0.027756
AUC of ROC = 0.81187
AUC of PRC = 0.38216
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[648   8]
 [ 62  12]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09620799869298935
difference in average predicted and observed risk = -0.005162001307010652
number samples = 730
accuracy = 0.90411
precision class 0 = 0.912676
precision class 1 = 0.6
recall class 0 = 0.987805
recall class 1 = 0.162162
false negative rate = 0.837838
false positive rate = 0.012195
positive prediction rate = 0.027397
AUC of ROC = 0.791406
AUC of PRC = 0.412334
min(+P, Se) = 0.413333

-------------------------------

confusion matrix:
[[165   2]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10487200319766998
difference in average predicted and observed risk = -0.020781996802330005
number samples = 191
accuracy = 0.91623
precision class 0 = 0.921788
precision class 1 = 0.833333
recall class 0 = 0.988024
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.011976
positive prediction rate = 0.062827
AUC of ROC = 0.891717
AUC of PRC = 0.717669
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2451   23]
 [ 215   40]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08860199898481369
difference in average predicted and observed risk = -0.004839001015186306
number samples = 2729
accuracy = 0.912789
precision class 0 = 0.919355
precision class 1 = 0.634921
recall class 0 = 0.990703
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.009297
positive prediction rate = 0.023085
AUC of ROC = 0.79375
AUC of PRC = 0.377789
min(+P, Se) = 0.395349

-------------------------------

confusion matrix:
[[1664   19]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10277500003576279
difference in average predicted and observed risk = -0.010968999964237211
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.905332
precision class 1 = 0.688525
recall class 0 = 0.988711
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.011289
positive prediction rate = 0.032122
AUC of ROC = 0.8186
AUC of PRC = 0.480618
min(+P, Se) = 0.449074

-------------------------------

confusion matrix:
[[539  10]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11105799674987793
difference in average predicted and observed risk = -0.011945003250122072
number samples = 626
accuracy = 0.878594
precision class 0 = 0.890909
precision class 1 = 0.52381
recall class 0 = 0.981785
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.018215
positive prediction rate = 0.033546
AUC of ROC = 0.791191
AUC of PRC = 0.387819
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2237   12]
 [ 182   26]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08018600195646286
difference in average predicted and observed risk = -0.004469998043537135
number samples = 2457
accuracy = 0.921042
precision class 0 = 0.924762
precision class 1 = 0.684211
recall class 0 = 0.994664
recall class 1 = 0.125
false negative rate = 0.875
false positive rate = 0.005336
positive prediction rate = 0.015466
AUC of ROC = 0.795939
AUC of PRC = 0.364438
min(+P, Se) = 0.364486

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10215099900960922
difference in average predicted and observed risk = 0.0013449990096092157
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.738655
AUC of PRC = 0.22642
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[472   9]
 [ 54  28]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13001200556755066
difference in average predicted and observed risk = -0.01563599443244934
number samples = 563
accuracy = 0.888099
precision class 0 = 0.897338
precision class 1 = 0.756757
recall class 0 = 0.981289
recall class 1 = 0.341463
false negative rate = 0.658537
false positive rate = 0.018711
positive prediction rate = 0.065719
AUC of ROC = 0.837686
AUC of PRC = 0.62393
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[648   7]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09794999659061432
difference in average predicted and observed risk = -0.009679003409385684
number samples = 734
accuracy = 0.905995
precision class 0 = 0.912676
precision class 1 = 0.708333
recall class 0 = 0.989313
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.010687
positive prediction rate = 0.032698
AUC of ROC = 0.815828
AUC of PRC = 0.456823
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4115   42]
 [ 389   82]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09441699832677841
difference in average predicted and observed risk = -0.0073550016732215895
number samples = 4628
accuracy = 0.906871
precision class 0 = 0.913632
precision class 1 = 0.66129
recall class 0 = 0.989897
recall class 1 = 0.174098
false negative rate = 0.825902
false positive rate = 0.010103
positive prediction rate = 0.026793
AUC of ROC = 0.805667
AUC of PRC = 0.426595
min(+P, Se) = 0.41189

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08767999708652496
difference in average predicted and observed risk = 0.007510997086524959
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.840174
AUC of PRC = 0.335417
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09213999658823013
difference in average predicted and observed risk = -0.01665600341176987
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.77281
AUC of PRC = 0.431244
min(+P, Se) = 0.418182

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11104899644851685
difference in average predicted and observed risk = 0.0008799964485168427
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.910623
AUC of PRC = 0.534587
min(+P, Se) = 0.5625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12738199532032013
difference in average predicted and observed risk = -0.005951004679679878
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10081200301647186
difference in average predicted and observed risk = -0.01423199698352813
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.798803
AUC of PRC = 0.361484
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09065800160169601
difference in average predicted and observed risk = -0.0013919983983039924
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.843894
AUC of PRC = 0.541685
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07930400222539902
difference in average predicted and observed risk = -0.009897997774600986
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.808193
AUC of PRC = 0.451064
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11708799749612808
difference in average predicted and observed risk = -0.0005590025038719193
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.927778
AUC of PRC = 0.69528
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10255099833011627
difference in average predicted and observed risk = 0.013840998330116275
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.81255
AUC of PRC = 0.225752
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11116699874401093
difference in average predicted and observed risk = -0.038439001255989064
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.802144
AUC of PRC = 0.547367
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13023200631141663
difference in average predicted and observed risk = 0.05128500631141662
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09487099945545197
difference in average predicted and observed risk = -0.006720000544548035
number samples = 817
accuracy = 0.910649
precision class 0 = 0.913642
precision class 1 = 0.777778
recall class 0 = 0.99455
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.00545
positive prediction rate = 0.022032
AUC of ROC = 0.825761
AUC of PRC = 0.462416
min(+P, Se) = 0.458824

-------------------------------

Epoch 00033: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch33.state
Epoch 34/100
 - 324s - loss: 0.2729 - val_loss: 0.2595

==>predicting on train



confusion matrix:
[[2136   19]
 [ 209   46]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11516900360584259
difference in average predicted and observed risk = 0.00936000360584259
number samples = 2410
accuracy = 0.905394
precision class 0 = 0.910874
precision class 1 = 0.707692
recall class 0 = 0.991183
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.008817
positive prediction rate = 0.026971
AUC of ROC = 0.792816
AUC of PRC = 0.420041
min(+P, Se) = 0.412451

-------------------------------

confusion matrix:
[[1163   16]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10387899726629257
difference in average predicted and observed risk = 0.012899997266292568
number samples = 1297
accuracy = 0.912105
precision class 0 = 0.922284
precision class 1 = 0.555556
recall class 0 = 0.986429
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.013571
positive prediction rate = 0.027756
AUC of ROC = 0.799629
AUC of PRC = 0.364206
min(+P, Se) = 0.362319

-------------------------------

confusion matrix:
[[647   9]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11459299921989441
difference in average predicted and observed risk = 0.013222999219894407
number samples = 730
accuracy = 0.90411
precision class 0 = 0.913842
precision class 1 = 0.590909
recall class 0 = 0.986281
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.01372
positive prediction rate = 0.030137
AUC of ROC = 0.793486
AUC of PRC = 0.423731
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12397400289773941
difference in average predicted and observed risk = -0.0016799971022605775
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.87999
AUC of PRC = 0.725593
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2451   23]
 [ 210   45]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.1063769981265068
difference in average predicted and observed risk = 0.01293599812650681
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.921082
precision class 1 = 0.661765
recall class 0 = 0.990703
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.009297
positive prediction rate = 0.024918
AUC of ROC = 0.78775
AUC of PRC = 0.376842
min(+P, Se) = 0.392157

-------------------------------

confusion matrix:
[[1660   23]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.12075600028038025
difference in average predicted and observed risk = 0.007012000280380251
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.906608
precision class 1 = 0.661765
recall class 0 = 0.986334
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.013666
positive prediction rate = 0.035808
AUC of ROC = 0.812455
AUC of PRC = 0.478293
min(+P, Se) = 0.456221

-------------------------------

confusion matrix:
[[539  10]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.13143500685691833
difference in average predicted and observed risk = 0.008432006856918334
number samples = 626
accuracy = 0.878594
precision class 0 = 0.890909
precision class 1 = 0.52381
recall class 0 = 0.981785
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.018215
positive prediction rate = 0.033546
AUC of ROC = 0.784922
AUC of PRC = 0.393558
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2235   14]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09727100282907486
difference in average predicted and observed risk = 0.012615002829074864
number samples = 2457
accuracy = 0.921449
precision class 0 = 0.925849
precision class 1 = 0.674419
recall class 0 = 0.993775
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.006225
positive prediction rate = 0.017501
AUC of ROC = 0.791262
AUC of PRC = 0.359815
min(+P, Se) = 0.350962

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11943600326776505
difference in average predicted and observed risk = 0.01863000326776504
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.733274
AUC of PRC = 0.22493
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[472   9]
 [ 52  30]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14892099797725677
difference in average predicted and observed risk = 0.003272997977256775
number samples = 563
accuracy = 0.891652
precision class 0 = 0.900763
precision class 1 = 0.769231
recall class 0 = 0.981289
recall class 1 = 0.365854
false negative rate = 0.634146
false positive rate = 0.018711
positive prediction rate = 0.069272
AUC of ROC = 0.824831
AUC of PRC = 0.614239
min(+P, Se) = 0.536585

-------------------------------

confusion matrix:
[[647   8]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11564599722623825
difference in average predicted and observed risk = 0.008016997226238248
number samples = 734
accuracy = 0.907357
precision class 0 = 0.915134
precision class 1 = 0.703704
recall class 0 = 0.987786
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.012214
positive prediction rate = 0.036785
AUC of ROC = 0.812078
AUC of PRC = 0.453507
min(+P, Se) = 0.445783

-------------------------------

confusion matrix:
[[4111   46]
 [ 381   90]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11227700114250183
difference in average predicted and observed risk = 0.01050500114250183
number samples = 4628
accuracy = 0.907736
precision class 0 = 0.915183
precision class 1 = 0.661765
recall class 0 = 0.988934
recall class 1 = 0.191083
false negative rate = 0.808917
false positive rate = 0.011066
positive prediction rate = 0.029386
AUC of ROC = 0.799362
AUC of PRC = 0.423081
min(+P, Se) = 0.418259

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10239099711179733
difference in average predicted and observed risk = 0.02222199711179733
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.820377
AUC of PRC = 0.338947
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.1122409999370575
difference in average predicted and observed risk = 0.0034449999370574913
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.763415
AUC of PRC = 0.41466
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12805600464344025
difference in average predicted and observed risk = 0.017887004643440244
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.916484
AUC of PRC = 0.603405
min(+P, Se) = 0.611111

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1442759931087494
difference in average predicted and observed risk = 0.010942993108749383
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11922000348567963
difference in average predicted and observed risk = 0.004176003485679633
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.780342
AUC of PRC = 0.343084
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10832200199365616
difference in average predicted and observed risk = 0.01627200199365615
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.84248
AUC of PRC = 0.547731
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09636799991130829
difference in average predicted and observed risk = 0.007165999911308285
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.796595
AUC of PRC = 0.447976
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13837400078773499
difference in average predicted and observed risk = 0.020727000787734984
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.933333
AUC of PRC = 0.686455
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.12312699854373932
difference in average predicted and observed risk = 0.03441699854373932
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.802896
AUC of PRC = 0.217118
min(+P, Se) = 0.315789

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1266999989748001
difference in average predicted and observed risk = -0.02290600102519988
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.802632
AUC of PRC = 0.562941
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14916299283504486
difference in average predicted and observed risk = 0.07021599283504486
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.551786
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[730   4]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11284399777650833
difference in average predicted and observed risk = 0.01125299777650833
number samples = 817
accuracy = 0.910649
precision class 0 = 0.913642
precision class 1 = 0.777778
recall class 0 = 0.99455
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.00545
positive prediction rate = 0.022032
AUC of ROC = 0.817094
AUC of PRC = 0.459708
min(+P, Se) = 0.477273

-------------------------------

Epoch 00034: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch34.state
Epoch 35/100
 - 321s - loss: 0.2709 - val_loss: 0.2557

==>predicting on train



confusion matrix:
[[2136   19]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08076299726963043
difference in average predicted and observed risk = -0.025046002730369568
number samples = 2410
accuracy = 0.903319
precision class 0 = 0.908936
precision class 1 = 0.683333
recall class 0 = 0.991183
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.008817
positive prediction rate = 0.024896
AUC of ROC = 0.803032
AUC of PRC = 0.425475
min(+P, Se) = 0.418605

-------------------------------

confusion matrix:
[[1170    9]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07156199961900711
difference in average predicted and observed risk = -0.019417000380992894
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.919089
precision class 1 = 0.625
recall class 0 = 0.992366
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.007634
positive prediction rate = 0.018504
AUC of ROC = 0.808707
AUC of PRC = 0.378063
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[654   2]
 [ 66   8]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0784979984164238
difference in average predicted and observed risk = -0.022872001583576204
number samples = 730
accuracy = 0.906849
precision class 0 = 0.908333
precision class 1 = 0.8
recall class 0 = 0.996951
recall class 1 = 0.108108
false negative rate = 0.891892
false positive rate = 0.003049
positive prediction rate = 0.013699
AUC of ROC = 0.801273
AUC of PRC = 0.427262
min(+P, Se) = 0.418919

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09399999678134918
difference in average predicted and observed risk = -0.031654003218650806
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.899202
AUC of PRC = 0.735001
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2458   16]
 [ 223   32]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07227099686861038
difference in average predicted and observed risk = -0.021170003131389614
number samples = 2729
accuracy = 0.912422
precision class 0 = 0.916822
precision class 1 = 0.666667
recall class 0 = 0.993533
recall class 1 = 0.12549
false negative rate = 0.87451
false positive rate = 0.006467
positive prediction rate = 0.017589
AUC of ROC = 0.799854
AUC of PRC = 0.384233
min(+P, Se) = 0.400778

-------------------------------

confusion matrix:
[[1667   16]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08714299649000168
difference in average predicted and observed risk = -0.02660100350999832
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905978
precision class 1 = 0.728814
recall class 0 = 0.990493
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.009507
positive prediction rate = 0.031069
AUC of ROC = 0.818663
AUC of PRC = 0.483179
min(+P, Se) = 0.447005

-------------------------------

confusion matrix:
[[544   5]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.0931600034236908
difference in average predicted and observed risk = -0.029842996576309205
number samples = 626
accuracy = 0.883387
precision class 0 = 0.888889
precision class 1 = 0.642857
recall class 0 = 0.990893
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.009107
positive prediction rate = 0.022364
AUC of ROC = 0.798382
AUC of PRC = 0.409319
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[2238   11]
 [ 187   21]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0654740035533905
difference in average predicted and observed risk = -0.019181996446609492
number samples = 2457
accuracy = 0.919414
precision class 0 = 0.922887
precision class 1 = 0.65625
recall class 0 = 0.995109
recall class 1 = 0.100962
false negative rate = 0.899038
false positive rate = 0.004891
positive prediction rate = 0.013024
AUC of ROC = 0.800054
AUC of PRC = 0.364386
min(+P, Se) = 0.365385

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08559399843215942
difference in average predicted and observed risk = -0.015212001567840583
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.740448
AUC of PRC = 0.223797
min(+P, Se) = 0.28

-------------------------------

confusion matrix:
[[475   6]
 [ 53  29]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11053100228309631
difference in average predicted and observed risk = -0.035116997716903686
number samples = 563
accuracy = 0.895204
precision class 0 = 0.899621
precision class 1 = 0.828571
recall class 0 = 0.987526
recall class 1 = 0.353659
false negative rate = 0.646341
false positive rate = 0.012474
positive prediction rate = 0.062167
AUC of ROC = 0.838877
AUC of PRC = 0.61901
min(+P, Se) = 0.528736

-------------------------------

confusion matrix:
[[649   6]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08184099942445755
difference in average predicted and observed risk = -0.025788000575542452
number samples = 734
accuracy = 0.905995
precision class 0 = 0.911517
precision class 1 = 0.727273
recall class 0 = 0.99084
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.00916
positive prediction rate = 0.029973
AUC of ROC = 0.817412
AUC of PRC = 0.454211
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4125   32]
 [ 396   75]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0783739984035492
difference in average predicted and observed risk = -0.023398001596450807
number samples = 4628
accuracy = 0.907519
precision class 0 = 0.912409
precision class 1 = 0.700935
recall class 0 = 0.992302
recall class 1 = 0.159236
false negative rate = 0.840764
false positive rate = 0.007698
positive prediction rate = 0.02312
AUC of ROC = 0.808878
AUC of PRC = 0.429294
min(+P, Se) = 0.427061

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.06927499920129776
difference in average predicted and observed risk = -0.010894000798702244
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.825688
AUC of PRC = 0.337665
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07709799706935883
difference in average predicted and observed risk = -0.03169800293064118
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.784968
AUC of PRC = 0.423661
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.0918470025062561
difference in average predicted and observed risk = -0.0183219974937439
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.911355
AUC of PRC = 0.592249
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11535400152206421
difference in average predicted and observed risk = -0.017978998477935798
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08496099710464478
difference in average predicted and observed risk = -0.030083002895355218
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.801709
AUC of PRC = 0.356622
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07368399947881699
difference in average predicted and observed risk = -0.01836600052118302
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.848869
AUC of PRC = 0.551801
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06403099745512009
difference in average predicted and observed risk = -0.025171002544879917
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.81701
AUC of PRC = 0.455168
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09907799959182739
difference in average predicted and observed risk = -0.01856900040817261
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.928704
AUC of PRC = 0.69679
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0840580016374588
difference in average predicted and observed risk = -0.004651998362541196
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.824618
AUC of PRC = 0.227238
min(+P, Se) = 0.3125

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.0930429995059967
difference in average predicted and observed risk = -0.056563000494003285
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.807992
AUC of PRC = 0.551816
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11579299718141556
difference in average predicted and observed risk = 0.036845997181415555
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.538889
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[730   4]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.07836300134658813
difference in average predicted and observed risk = -0.023227998653411866
number samples = 817
accuracy = 0.908201
precision class 0 = 0.911361
precision class 1 = 0.75
recall class 0 = 0.99455
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.00545
positive prediction rate = 0.019584
AUC of ROC = 0.829109
AUC of PRC = 0.466222
min(+P, Se) = 0.460674

-------------------------------

Epoch 00035: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch35.state
Epoch 36/100
 - 318s - loss: 0.2713 - val_loss: 0.2542

==>predicting on train



confusion matrix:
[[2126   29]
 [ 199   56]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11812900006771088
difference in average predicted and observed risk = 0.012320000067710876
number samples = 2410
accuracy = 0.905394
precision class 0 = 0.914409
precision class 1 = 0.658824
recall class 0 = 0.986543
recall class 1 = 0.219608
false negative rate = 0.780392
false positive rate = 0.013457
positive prediction rate = 0.03527
AUC of ROC = 0.800508
AUC of PRC = 0.42106
min(+P, Se) = 0.406593

-------------------------------

confusion matrix:
[[1156   23]
 [  90   28]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10585899651050568
difference in average predicted and observed risk = 0.014879996510505672
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.927769
precision class 1 = 0.54902
recall class 0 = 0.980492
recall class 1 = 0.237288
false negative rate = 0.762712
false positive rate = 0.019508
positive prediction rate = 0.039322
AUC of ROC = 0.811029
AUC of PRC = 0.373179
min(+P, Se) = 0.364407

-------------------------------

confusion matrix:
[[637  19]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11448100209236145
difference in average predicted and observed risk = 0.013111002092361448
number samples = 730
accuracy = 0.89863
precision class 0 = 0.92052
precision class 1 = 0.5
recall class 0 = 0.971037
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.028963
positive prediction rate = 0.052055
AUC of ROC = 0.797524
AUC of PRC = 0.417863
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1307619959115982
difference in average predicted and observed risk = 0.005107995911598218
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.901447
AUC of PRC = 0.736715
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2433   41]
 [ 194   61]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10726799815893173
difference in average predicted and observed risk = 0.013826998158931736
number samples = 2729
accuracy = 0.913888
precision class 0 = 0.926152
precision class 1 = 0.598039
recall class 0 = 0.983428
recall class 1 = 0.239216
false negative rate = 0.760784
false positive rate = 0.016572
positive prediction rate = 0.037376
AUC of ROC = 0.795788
AUC of PRC = 0.382975
min(+P, Se) = 0.388235

-------------------------------

confusion matrix:
[[1651   32]
 [ 163   53]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1252260059118271
difference in average predicted and observed risk = 0.01148200591182709
number samples = 1899
accuracy = 0.897314
precision class 0 = 0.910143
precision class 1 = 0.623529
recall class 0 = 0.980986
recall class 1 = 0.24537
false negative rate = 0.75463
false positive rate = 0.019014
positive prediction rate = 0.04476
AUC of ROC = 0.820421
AUC of PRC = 0.473916
min(+P, Se) = 0.431193

-------------------------------

confusion matrix:
[[536  13]
 [ 59  18]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12873299419879913
difference in average predicted and observed risk = 0.005729994198799132
number samples = 626
accuracy = 0.884984
precision class 0 = 0.90084
precision class 1 = 0.580645
recall class 0 = 0.976321
recall class 1 = 0.233766
false negative rate = 0.766234
false positive rate = 0.023679
positive prediction rate = 0.049521
AUC of ROC = 0.79093
AUC of PRC = 0.404597
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[2225   24]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.10009899735450745
difference in average predicted and observed risk = 0.015442997354507451
number samples = 2457
accuracy = 0.919821
precision class 0 = 0.927857
precision class 1 = 0.59322
recall class 0 = 0.989329
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.010671
positive prediction rate = 0.024013
AUC of ROC = 0.79952
AUC of PRC = 0.3535
min(+P, Se) = 0.370192

-------------------------------

confusion matrix:
[[217   6]
 [ 21   4]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.12151200324296951
difference in average predicted and observed risk = 0.020706003242969506
number samples = 248
accuracy = 0.891129
precision class 0 = 0.911765
precision class 1 = 0.4
recall class 0 = 0.973094
recall class 1 = 0.16
false negative rate = 0.84
false positive rate = 0.026906
positive prediction rate = 0.040323
AUC of ROC = 0.75139
AUC of PRC = 0.239996
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[467  14]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.15201400220394135
difference in average predicted and observed risk = 0.0063660022039413455
number samples = 563
accuracy = 0.891652
precision class 0 = 0.90856
precision class 1 = 0.714286
recall class 0 = 0.970894
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.029106
positive prediction rate = 0.087034
AUC of ROC = 0.839156
AUC of PRC = 0.632578
min(+P, Se) = 0.536585

-------------------------------

confusion matrix:
[[639  16]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.12028399854898453
difference in average predicted and observed risk = 0.012654998548984525
number samples = 734
accuracy = 0.900545
precision class 0 = 0.918103
precision class 1 = 0.578947
recall class 0 = 0.975573
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.024427
positive prediction rate = 0.051771
AUC of ROC = 0.814571
AUC of PRC = 0.438653
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[4084   73]
 [ 357  114]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11463599652051926
difference in average predicted and observed risk = 0.012863996520519255
number samples = 4628
accuracy = 0.907087
precision class 0 = 0.919613
precision class 1 = 0.609626
recall class 0 = 0.982439
recall class 1 = 0.242038
false negative rate = 0.757962
false positive rate = 0.017561
positive prediction rate = 0.040406
AUC of ROC = 0.807802
AUC of PRC = 0.425208
min(+P, Se) = 0.411392

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 14   5]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.10380499809980392
difference in average predicted and observed risk = 0.02363599809980392
number samples = 237
accuracy = 0.924051
precision class 0 = 0.938596
precision class 1 = 0.555556
recall class 0 = 0.981651
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018349
positive prediction rate = 0.037975
AUC of ROC = 0.833897
AUC of PRC = 0.326922
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.1156499981880188
difference in average predicted and observed risk = 0.006853998188018795
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.787234
AUC of PRC = 0.397064
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12980200350284576
difference in average predicted and observed risk = 0.01963300350284576
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.917949
AUC of PRC = 0.533547
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.152878999710083
difference in average predicted and observed risk = 0.019545999710083
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[296   4]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.12650799751281738
difference in average predicted and observed risk = 0.01146399751281739
number samples = 339
accuracy = 0.887906
precision class 0 = 0.89697
precision class 1 = 0.555556
recall class 0 = 0.986667
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.013333
positive prediction rate = 0.026549
AUC of ROC = 0.807436
AUC of PRC = 0.331015
min(+P, Se) = 0.413043

-------------------------------

confusion matrix:
[[431   3]
 [ 30  14]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10790599882602692
difference in average predicted and observed risk = 0.01585599882602691
number samples = 478
accuracy = 0.930962
precision class 0 = 0.934924
precision class 1 = 0.823529
recall class 0 = 0.993088
recall class 1 = 0.318182
false negative rate = 0.681818
false positive rate = 0.006912
positive prediction rate = 0.035565
AUC of ROC = 0.850911
AUC of PRC = 0.526997
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 30   8]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09972000122070312
difference in average predicted and observed risk = 0.010518001220703121
number samples = 426
accuracy = 0.92723
precision class 0 = 0.928058
precision class 1 = 0.888889
recall class 0 = 0.997423
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.002577
positive prediction rate = 0.021127
AUC of ROC = 0.824539
AUC of PRC = 0.40019
min(+P, Se) = 0.395349

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1404860019683838
difference in average predicted and observed risk = 0.022839001968383787
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.931481
AUC of PRC = 0.599034
min(+P, Se) = 0.5625

-------------------------------

confusion matrix:
[[111   2]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.12052600085735321
difference in average predicted and observed risk = 0.03181600085735321
number samples = 124
accuracy = 0.895161
precision class 0 = 0.909836
precision class 1 = 0.0
recall class 0 = 0.982301
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017699
positive prediction rate = 0.016129
AUC of ROC = 0.815768
AUC of PRC = 0.21185
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12929099798202515
difference in average predicted and observed risk = -0.020315002017974843
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.804094
AUC of PRC = 0.553917
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 2  1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1655299961566925
difference in average predicted and observed risk = 0.0865829961566925
number samples = 38
accuracy = 0.947368
precision class 0 = 0.945946
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.026316
AUC of ROC = 0.914286
AUC of PRC = 0.538889
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[727   7]
 [ 64  19]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.11562500149011612
difference in average predicted and observed risk = 0.014034001490116119
number samples = 817
accuracy = 0.913097
precision class 0 = 0.91909
precision class 1 = 0.730769
recall class 0 = 0.990463
recall class 1 = 0.228916
false negative rate = 0.771084
false positive rate = 0.009537
positive prediction rate = 0.031824
AUC of ROC = 0.834329
AUC of PRC = 0.43969
min(+P, Se) = 0.457831

-------------------------------

Epoch 00036: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch36.state
Epoch 37/100
 - 323s - loss: 0.2752 - val_loss: 0.2530

==>predicting on train



confusion matrix:
[[2136   19]
 [ 210   45]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08376099914312363
difference in average predicted and observed risk = -0.022048000856876374
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.910486
precision class 1 = 0.703125
recall class 0 = 0.991183
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.008817
positive prediction rate = 0.026556
AUC of ROC = 0.812154
AUC of PRC = 0.432825
min(+P, Se) = 0.420849

-------------------------------

confusion matrix:
[[1168   11]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07629799842834473
difference in average predicted and observed risk = -0.014681001571655278
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.919685
precision class 1 = 0.592593
recall class 0 = 0.99067
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.00933
positive prediction rate = 0.020817
AUC of ROC = 0.822674
AUC of PRC = 0.390986
min(+P, Se) = 0.386555

-------------------------------

confusion matrix:
[[650   6]
 [ 62  12]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08468999713659286
difference in average predicted and observed risk = -0.016680002863407137
number samples = 730
accuracy = 0.906849
precision class 0 = 0.912921
precision class 1 = 0.666667
recall class 0 = 0.990854
recall class 1 = 0.162162
false negative rate = 0.837838
false positive rate = 0.009146
positive prediction rate = 0.024658
AUC of ROC = 0.800264
AUC of PRC = 0.421585
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.0993880033493042
difference in average predicted and observed risk = -0.02626599665069579
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.89521
AUC of PRC = 0.732303
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2456   18]
 [ 217   38]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07528000324964523
difference in average predicted and observed risk = -0.018160996750354763
number samples = 2729
accuracy = 0.913888
precision class 0 = 0.918818
precision class 1 = 0.678571
recall class 0 = 0.992724
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.007276
positive prediction rate = 0.02052
AUC of ROC = 0.808645
AUC of PRC = 0.393231
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1663   20]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09278099983930588
difference in average predicted and observed risk = -0.02096300016069412
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.907256
precision class 1 = 0.69697
recall class 0 = 0.988116
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.011884
positive prediction rate = 0.034755
AUC of ROC = 0.827867
AUC of PRC = 0.486128
min(+P, Se) = 0.449074

-------------------------------

confusion matrix:
[[543   6]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09531199932098389
difference in average predicted and observed risk = -0.027691000679016115
number samples = 626
accuracy = 0.880192
precision class 0 = 0.887255
precision class 1 = 0.571429
recall class 0 = 0.989071
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.010929
positive prediction rate = 0.022364
AUC of ROC = 0.808033
AUC of PRC = 0.420095
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[2236   13]
 [ 180   28]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06964000314474106
difference in average predicted and observed risk = -0.015015996855258937
number samples = 2457
accuracy = 0.921449
precision class 0 = 0.925497
precision class 1 = 0.682927
recall class 0 = 0.99422
recall class 1 = 0.134615
false negative rate = 0.865385
false positive rate = 0.00578
positive prediction rate = 0.016687
AUC of ROC = 0.808415
AUC of PRC = 0.365577
min(+P, Se) = 0.368421

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09034000337123871
difference in average predicted and observed risk = -0.010465996628761298
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.755874
AUC of PRC = 0.238897
min(+P, Se) = 0.322581

-------------------------------

confusion matrix:
[[475   6]
 [ 52  30]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1145550012588501
difference in average predicted and observed risk = -0.031092998741149902
number samples = 563
accuracy = 0.89698
precision class 0 = 0.901328
precision class 1 = 0.833333
recall class 0 = 0.987526
recall class 1 = 0.365854
false negative rate = 0.634146
false positive rate = 0.012474
positive prediction rate = 0.063943
AUC of ROC = 0.851529
AUC of PRC = 0.638245
min(+P, Se) = 0.552941

-------------------------------

confusion matrix:
[[647   8]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08713799715042114
difference in average predicted and observed risk = -0.02049100284957886
number samples = 734
accuracy = 0.905995
precision class 0 = 0.913842
precision class 1 = 0.692308
recall class 0 = 0.987786
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.012214
positive prediction rate = 0.035422
AUC of ROC = 0.82292
AUC of PRC = 0.453011
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4119   38]
 [ 387   84]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08246099948883057
difference in average predicted and observed risk = -0.019311000511169435
number samples = 4628
accuracy = 0.908168
precision class 0 = 0.914115
precision class 1 = 0.688525
recall class 0 = 0.990859
recall class 1 = 0.178344
false negative rate = 0.821656
false positive rate = 0.009141
positive prediction rate = 0.026361
AUC of ROC = 0.817708
AUC of PRC = 0.435318
min(+P, Se) = 0.422505

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07425399869680405
difference in average predicted and observed risk = -0.0059150013031959575
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.840898
AUC of PRC = 0.342173
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0801130011677742
difference in average predicted and observed risk = -0.028682998832225803
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.789666
AUC of PRC = 0.417306
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09877700358629227
difference in average predicted and observed risk = -0.011391996413707736
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.917216
AUC of PRC = 0.526537
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11749199777841568
difference in average predicted and observed risk = -0.015841002221584327
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09176299721002579
difference in average predicted and observed risk = -0.023281002789974206
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.806923
AUC of PRC = 0.340581
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07589899748563766
difference in average predicted and observed risk = -0.016151002514362342
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.851382
AUC of PRC = 0.553554
min(+P, Se) = 0.490196

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06852400302886963
difference in average predicted and observed risk = -0.020677996971130375
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.826845
AUC of PRC = 0.452121
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10143200308084488
difference in average predicted and observed risk = -0.016214996919155122
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.95
AUC of PRC = 0.727465
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08618099987506866
difference in average predicted and observed risk = -0.0025290001249313326
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.822204
AUC of PRC = 0.223723
min(+P, Se) = 0.3125

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09812600165605545
difference in average predicted and observed risk = -0.05147999834394454
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.799708
AUC of PRC = 0.559917
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12371999770402908
difference in average predicted and observed risk = 0.04477299770402908
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.87619
AUC of PRC = 0.494192
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0824820026755333
difference in average predicted and observed risk = -0.019108997324466706
number samples = 817
accuracy = 0.908201
precision class 0 = 0.911361
precision class 1 = 0.75
recall class 0 = 0.99455
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.00545
positive prediction rate = 0.019584
AUC of ROC = 0.83469
AUC of PRC = 0.459878
min(+P, Se) = 0.476744

-------------------------------

Epoch 00037: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch37.state
Epoch 38/100
 - 317s - loss: 0.2804 - val_loss: 0.2561

==>predicting on train



confusion matrix:
[[2139   16]
 [ 218   37]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10729700326919556
difference in average predicted and observed risk = 0.0014880032691955564
number samples = 2410
accuracy = 0.902905
precision class 0 = 0.90751
precision class 1 = 0.698113
recall class 0 = 0.992575
recall class 1 = 0.145098
false negative rate = 0.854902
false positive rate = 0.007425
positive prediction rate = 0.021992
AUC of ROC = 0.813122
AUC of PRC = 0.435161
min(+P, Se) = 0.439216

-------------------------------

confusion matrix:
[[1172    7]
 [ 106   12]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0977879986166954
difference in average predicted and observed risk = 0.0068089986166954
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.917058
precision class 1 = 0.631579
recall class 0 = 0.994063
recall class 1 = 0.101695
false negative rate = 0.898305
false positive rate = 0.005937
positive prediction rate = 0.014649
AUC of ROC = 0.826548
AUC of PRC = 0.396854
min(+P, Se) = 0.396825

-------------------------------

confusion matrix:
[[655   1]
 [ 67   7]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10636600106954575
difference in average predicted and observed risk = 0.004996001069545744
number samples = 730
accuracy = 0.906849
precision class 0 = 0.907202
precision class 1 = 0.875
recall class 0 = 0.998476
recall class 1 = 0.094595
false negative rate = 0.905405
false positive rate = 0.001524
positive prediction rate = 0.010959
AUC of ROC = 0.821152
AUC of PRC = 0.423628
min(+P, Se) = 0.391892

-------------------------------

confusion matrix:
[[165   2]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11485099792480469
difference in average predicted and observed risk = -0.0108030020751953
number samples = 191
accuracy = 0.91623
precision class 0 = 0.921788
precision class 1 = 0.833333
recall class 0 = 0.988024
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.011976
positive prediction rate = 0.062827
AUC of ROC = 0.896707
AUC of PRC = 0.739415
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2463   11]
 [ 231   24]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09907300025224686
difference in average predicted and observed risk = 0.00563200025224686
number samples = 2729
accuracy = 0.911323
precision class 0 = 0.914254
precision class 1 = 0.685714
recall class 0 = 0.995554
recall class 1 = 0.094118
false negative rate = 0.905882
false positive rate = 0.004446
positive prediction rate = 0.012825
AUC of ROC = 0.815128
AUC of PRC = 0.396662
min(+P, Se) = 0.411765

-------------------------------

confusion matrix:
[[1668   15]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11302100121974945
difference in average predicted and observed risk = -0.0007229987802505472
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905537
precision class 1 = 0.736842
recall class 0 = 0.991087
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.008913
positive prediction rate = 0.030016
AUC of ROC = 0.831133
AUC of PRC = 0.489396
min(+P, Se) = 0.462963

-------------------------------

confusion matrix:
[[545   4]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12112300097942352
difference in average predicted and observed risk = -0.0018799990205764783
number samples = 626
accuracy = 0.881789
precision class 0 = 0.886179
precision class 1 = 0.636364
recall class 0 = 0.992714
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.007286
positive prediction rate = 0.017572
AUC of ROC = 0.822227
AUC of PRC = 0.432608
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2239   10]
 [ 188   20]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09219600260257721
difference in average predicted and observed risk = 0.007540002602577214
number samples = 2457
accuracy = 0.919414
precision class 0 = 0.922538
precision class 1 = 0.666667
recall class 0 = 0.995554
recall class 1 = 0.096154
false negative rate = 0.903846
false positive rate = 0.004446
positive prediction rate = 0.01221
AUC of ROC = 0.808556
AUC of PRC = 0.361688
min(+P, Se) = 0.355769

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11561600118875504
difference in average predicted and observed risk = 0.014810001188755029
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.754978
AUC of PRC = 0.246469
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[477   4]
 [ 56  26]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1339689940214157
difference in average predicted and observed risk = -0.01167900597858429
number samples = 563
accuracy = 0.893428
precision class 0 = 0.894934
precision class 1 = 0.866667
recall class 0 = 0.991684
recall class 1 = 0.317073
false negative rate = 0.682927
false positive rate = 0.008316
positive prediction rate = 0.053286
AUC of ROC = 0.859211
AUC of PRC = 0.636154
min(+P, Se) = 0.564706

-------------------------------

confusion matrix:
[[650   5]
 [ 66  13]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10701999813318253
difference in average predicted and observed risk = -0.0006090018668174768
number samples = 734
accuracy = 0.90327
precision class 0 = 0.907821
precision class 1 = 0.722222
recall class 0 = 0.992366
recall class 1 = 0.164557
false negative rate = 0.835443
false positive rate = 0.007634
positive prediction rate = 0.024523
AUC of ROC = 0.833375
AUC of PRC = 0.471161
min(+P, Se) = 0.469136

-------------------------------

confusion matrix:
[[4131   26]
 [ 405   66]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10479699820280075
difference in average predicted and observed risk = 0.0030249982028007494
number samples = 4628
accuracy = 0.906871
precision class 0 = 0.910714
precision class 1 = 0.717391
recall class 0 = 0.993746
recall class 1 = 0.140127
false negative rate = 0.859873
false positive rate = 0.006255
positive prediction rate = 0.019879
AUC of ROC = 0.822912
AUC of PRC = 0.439755
min(+P, Se) = 0.433121

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09448199719190598
difference in average predicted and observed risk = 0.014312997191905971
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.829792
AUC of PRC = 0.338103
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10372000187635422
difference in average predicted and observed risk = -0.005075998123645786
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.795192
AUC of PRC = 0.441966
min(+P, Se) = 0.458333

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1193389967083931
difference in average predicted and observed risk = 0.009169996708393094
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.905495
AUC of PRC = 0.524487
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13374899327754974
difference in average predicted and observed risk = 0.0004159932775497366
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1120849996805191
difference in average predicted and observed risk = -0.0029590003194808895
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.805214
AUC of PRC = 0.347788
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09894700348377228
difference in average predicted and observed risk = 0.006897003483772271
number samples = 478
accuracy = 0.920502
precision class 0 = 0.921277
precision class 1 = 0.875
recall class 0 = 0.997696
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.002304
positive prediction rate = 0.016736
AUC of ROC = 0.849864
AUC of PRC = 0.555188
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.09057000279426575
difference in average predicted and observed risk = 0.0013680027942657436
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.817621
AUC of PRC = 0.454054
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11923400312662125
difference in average predicted and observed risk = 0.0015870031266212448
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.941667
AUC of PRC = 0.726622
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1136149987578392
difference in average predicted and observed risk = 0.024904998757839206
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.8214
AUC of PRC = 0.231882
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11858899891376495
difference in average predicted and observed risk = -0.031017001086235035
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.805556
AUC of PRC = 0.560932
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14210399985313416
difference in average predicted and observed risk = 0.06315699985313415
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.828571
AUC of PRC = 0.207443
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 74   9]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10439799726009369
difference in average predicted and observed risk = 0.0028069972600936882
number samples = 817
accuracy = 0.905753
precision class 0 = 0.908075
precision class 1 = 0.75
recall class 0 = 0.995913
recall class 1 = 0.108434
false negative rate = 0.891566
false positive rate = 0.004087
positive prediction rate = 0.014688
AUC of ROC = 0.83231
AUC of PRC = 0.463483
min(+P, Se) = 0.493976

-------------------------------

Epoch 00038: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch38.state
Epoch 39/100
 - 323s - loss: 0.2763 - val_loss: 0.2531

==>predicting on train



confusion matrix:
[[2132   23]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09966599941253662
difference in average predicted and observed risk = -0.006143000587463379
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.913845
precision class 1 = 0.701299
recall class 0 = 0.989327
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.010673
positive prediction rate = 0.03195
AUC of ROC = 0.809572
AUC of PRC = 0.430153
min(+P, Se) = 0.424125

-------------------------------

confusion matrix:
[[1162   17]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0916069969534874
difference in average predicted and observed risk = 0.0006279969534873919
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.923688
precision class 1 = 0.564103
recall class 0 = 0.985581
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.014419
positive prediction rate = 0.030069
AUC of ROC = 0.823198
AUC of PRC = 0.391599
min(+P, Se) = 0.389831

-------------------------------

confusion matrix:
[[645  11]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09947600215673447
difference in average predicted and observed risk = -0.0018939978432655352
number samples = 730
accuracy = 0.90411
precision class 0 = 0.916193
precision class 1 = 0.576923
recall class 0 = 0.983232
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.016768
positive prediction rate = 0.035616
AUC of ROC = 0.808092
AUC of PRC = 0.430473
min(+P, Se) = 0.405405

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11409500241279602
difference in average predicted and observed risk = -0.011558997587203967
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.898703
AUC of PRC = 0.735414
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2448   26]
 [ 202   53]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09281899780035019
difference in average predicted and observed risk = -0.0006220021996498071
number samples = 2729
accuracy = 0.916453
precision class 0 = 0.923774
precision class 1 = 0.670886
recall class 0 = 0.989491
recall class 1 = 0.207843
false negative rate = 0.792157
false positive rate = 0.010509
positive prediction rate = 0.028948
AUC of ROC = 0.807853
AUC of PRC = 0.394107
min(+P, Se) = 0.396078

-------------------------------

confusion matrix:
[[1656   27]
 [ 167   49]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10537999868392944
difference in average predicted and observed risk = -0.008364001316070555
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.908393
precision class 1 = 0.644737
recall class 0 = 0.983957
recall class 1 = 0.226852
false negative rate = 0.773148
false positive rate = 0.016043
positive prediction rate = 0.040021
AUC of ROC = 0.828495
AUC of PRC = 0.486845
min(+P, Se) = 0.445455

-------------------------------

confusion matrix:
[[539  10]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11315000057220459
difference in average predicted and observed risk = -0.009852999427795411
number samples = 626
accuracy = 0.883387
precision class 0 = 0.895349
precision class 1 = 0.583333
recall class 0 = 0.981785
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.018215
positive prediction rate = 0.038339
AUC of ROC = 0.81558
AUC of PRC = 0.425067
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[2232   17]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08393599838018417
difference in average predicted and observed risk = -0.0007200016198158216
number samples = 2457
accuracy = 0.92267
precision class 0 = 0.928067
precision class 1 = 0.673077
recall class 0 = 0.992441
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.007559
positive prediction rate = 0.021164
AUC of ROC = 0.811527
AUC of PRC = 0.359106
min(+P, Se) = 0.355769

-------------------------------

confusion matrix:
[[217   6]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10268399864435196
difference in average predicted and observed risk = 0.0018779986443519525
number samples = 248
accuracy = 0.887097
precision class 0 = 0.90795
precision class 1 = 0.333333
recall class 0 = 0.973094
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.026906
positive prediction rate = 0.03629
AUC of ROC = 0.746009
AUC of PRC = 0.234556
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[472   9]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13219399750232697
difference in average predicted and observed risk = -0.013454002497673034
number samples = 563
accuracy = 0.893428
precision class 0 = 0.902486
precision class 1 = 0.775
recall class 0 = 0.981289
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.018711
positive prediction rate = 0.071048
AUC of ROC = 0.842173
AUC of PRC = 0.635421
min(+P, Se) = 0.560976

-------------------------------

confusion matrix:
[[644  11]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10417699813842773
difference in average predicted and observed risk = -0.003452001861572268
number samples = 734
accuracy = 0.90327
precision class 0 = 0.914773
precision class 1 = 0.633333
recall class 0 = 0.983206
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.016794
positive prediction rate = 0.040872
AUC of ROC = 0.82292
AUC of PRC = 0.449872
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[4104   53]
 [ 369  102]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09797299653291702
difference in average predicted and observed risk = -0.0037990034670829786
number samples = 4628
accuracy = 0.908816
precision class 0 = 0.917505
precision class 1 = 0.658065
recall class 0 = 0.98725
recall class 1 = 0.216561
false negative rate = 0.78344
false positive rate = 0.01275
positive prediction rate = 0.033492
AUC of ROC = 0.817647
AUC of PRC = 0.435871
min(+P, Se) = 0.422505

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08922900259494781
difference in average predicted and observed risk = 0.00906000259494781
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.848865
AUC of PRC = 0.378082
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09631899744272232
difference in average predicted and observed risk = -0.012477002557277683
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.786737
AUC of PRC = 0.412584
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11532799899578094
difference in average predicted and observed risk = 0.005158998995780942
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.90696
AUC of PRC = 0.528508
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.134333997964859
difference in average predicted and observed risk = 0.0010009979648590017
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1052979975938797
difference in average predicted and observed risk = -0.009746002406120294
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.801453
AUC of PRC = 0.342546
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09351400285959244
difference in average predicted and observed risk = 0.001464002859592431
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.855729
AUC of PRC = 0.543721
min(+P, Se) = 0.510204

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08313900232315063
difference in average predicted and observed risk = -0.006062997676849369
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.821351
AUC of PRC = 0.449359
min(+P, Se) = 0.394737

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11945399641990662
difference in average predicted and observed risk = 0.0018069964199066146
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.933333
AUC of PRC = 0.667673
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1045370027422905
difference in average predicted and observed risk = 0.0158270027422905
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.820595
AUC of PRC = 0.227783
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11573699861764908
difference in average predicted and observed risk = -0.03386900138235091
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.801657
AUC of PRC = 0.553555
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13508500158786774
difference in average predicted and observed risk = 0.056138001587867734
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09840399771928787
difference in average predicted and observed risk = -0.0031870022807121284
number samples = 817
accuracy = 0.911873
precision class 0 = 0.915829
precision class 1 = 0.761905
recall class 0 = 0.993188
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.006812
positive prediction rate = 0.025704
AUC of ROC = 0.833705
AUC of PRC = 0.456025
min(+P, Se) = 0.465116

-------------------------------

Epoch 00039: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch39.state
Epoch 40/100
 - 322s - loss: 0.2747 - val_loss: 0.2533

==>predicting on train



confusion matrix:
[[2134   21]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09928999841213226
difference in average predicted and observed risk = -0.006519001587867737
number samples = 2410
accuracy = 0.905809
precision class 0 = 0.911966
precision class 1 = 0.7
recall class 0 = 0.990255
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.009745
positive prediction rate = 0.029046
AUC of ROC = 0.805481
AUC of PRC = 0.423707
min(+P, Se) = 0.406977

-------------------------------

confusion matrix:
[[1164   15]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09030099958181381
difference in average predicted and observed risk = -0.0006780004181861921
number samples = 1297
accuracy = 0.912876
precision class 0 = 0.922345
precision class 1 = 0.571429
recall class 0 = 0.987277
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.012723
positive prediction rate = 0.026985
AUC of ROC = 0.821013
AUC of PRC = 0.388049
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[645  11]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0990770012140274
difference in average predicted and observed risk = -0.002292998785972597
number samples = 730
accuracy = 0.90411
precision class 0 = 0.916193
precision class 1 = 0.576923
recall class 0 = 0.983232
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.016768
positive prediction rate = 0.035616
AUC of ROC = 0.798657
AUC of PRC = 0.421055
min(+P, Se) = 0.413333

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1124430000782013
difference in average predicted and observed risk = -0.013210999921798694
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.900699
AUC of PRC = 0.731147
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2450   24]
 [ 207   48]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09094399958848953
difference in average predicted and observed risk = -0.002497000411510464
number samples = 2729
accuracy = 0.915354
precision class 0 = 0.922093
precision class 1 = 0.666667
recall class 0 = 0.990299
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.009701
positive prediction rate = 0.026383
AUC of ROC = 0.801452
AUC of PRC = 0.388148
min(+P, Se) = 0.388235

-------------------------------

confusion matrix:
[[1658   25]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1063850000500679
difference in average predicted and observed risk = -0.007358999949932096
number samples = 1899
accuracy = 0.897841
precision class 0 = 0.907499
precision class 1 = 0.652778
recall class 0 = 0.985146
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.014854
positive prediction rate = 0.037915
AUC of ROC = 0.82732
AUC of PRC = 0.483764
min(+P, Se) = 0.444954

-------------------------------

confusion matrix:
[[541   8]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11253800243139267
difference in average predicted and observed risk = -0.010464997568607332
number samples = 626
accuracy = 0.884984
precision class 0 = 0.894215
precision class 1 = 0.619048
recall class 0 = 0.985428
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.014572
positive prediction rate = 0.033546
AUC of ROC = 0.810352
AUC of PRC = 0.420165
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[2234   15]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08334600180387497
difference in average predicted and observed risk = -0.0013099981961250257
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.926971
precision class 1 = 0.680851
recall class 0 = 0.99333
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.00667
positive prediction rate = 0.019129
AUC of ROC = 0.807237
AUC of PRC = 0.36574
min(+P, Se) = 0.355769

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10022400319576263
difference in average predicted and observed risk = -0.0005819968042373724
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.743677
AUC of PRC = 0.22599
min(+P, Se) = 0.321429

-------------------------------

confusion matrix:
[[471  10]
 [ 52  30]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13135799765586853
difference in average predicted and observed risk = -0.01429000234413147
number samples = 563
accuracy = 0.889876
precision class 0 = 0.900574
precision class 1 = 0.75
recall class 0 = 0.97921
recall class 1 = 0.365854
false negative rate = 0.634146
false positive rate = 0.02079
positive prediction rate = 0.071048
AUC of ROC = 0.841616
AUC of PRC = 0.626528
min(+P, Se) = 0.52439

-------------------------------

confusion matrix:
[[644  11]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10377799719572067
difference in average predicted and observed risk = -0.00385100280427933
number samples = 734
accuracy = 0.904632
precision class 0 = 0.916074
precision class 1 = 0.645161
recall class 0 = 0.983206
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.016794
positive prediction rate = 0.042234
AUC of ROC = 0.813914
AUC of PRC = 0.440748
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4108   49]
 [ 376   95]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09728000313043594
difference in average predicted and observed risk = -0.004491996869564058
number samples = 4628
accuracy = 0.908168
precision class 0 = 0.916146
precision class 1 = 0.659722
recall class 0 = 0.988213
recall class 1 = 0.201699
false negative rate = 0.798301
false positive rate = 0.011787
positive prediction rate = 0.031115
AUC of ROC = 0.813759
AUC of PRC = 0.43233
min(+P, Se) = 0.409938

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08778899908065796
difference in average predicted and observed risk = 0.007619999080657955
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.838242
AUC of PRC = 0.383325
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09551099687814713
difference in average predicted and observed risk = -0.013285003121852879
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.790163
AUC of PRC = 0.400452
min(+P, Se) = 0.408163

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11411000043153763
difference in average predicted and observed risk = 0.003941000431537625
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.906227
AUC of PRC = 0.538993
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1357250064611435
difference in average predicted and observed risk = 0.0023920064611434866
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10542400181293488
difference in average predicted and observed risk = -0.009619998187065118
number samples = 339
accuracy = 0.882006
precision class 0 = 0.889222
precision class 1 = 0.4
recall class 0 = 0.99
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.01
positive prediction rate = 0.014749
AUC of ROC = 0.801709
AUC of PRC = 0.332331
min(+P, Se) = 0.418605

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09176699817180634
difference in average predicted and observed risk = -0.00028300182819367137
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.85332
AUC of PRC = 0.539084
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08126000314950943
difference in average predicted and observed risk = -0.007941996850490574
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.827184
AUC of PRC = 0.452669
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11810299754142761
difference in average predicted and observed risk = 0.00045599754142761073
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.934259
AUC of PRC = 0.6632
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10717500001192093
difference in average predicted and observed risk = 0.018465000011920932
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.823009
AUC of PRC = 0.234326
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11342400312423706
difference in average predicted and observed risk = -0.03618199687576293
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.804094
AUC of PRC = 0.537996
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13805299997329712
difference in average predicted and observed risk = 0.059105999973297116
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.496032
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09743399918079376
difference in average predicted and observed risk = -0.0041570008192062385
number samples = 817
accuracy = 0.908201
precision class 0 = 0.91239
precision class 1 = 0.722222
recall class 0 = 0.993188
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.006812
positive prediction rate = 0.022032
AUC of ROC = 0.833886
AUC of PRC = 0.451297
min(+P, Se) = 0.471264

-------------------------------

Epoch 00040: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch40.state
Epoch 41/100
 - 323s - loss: 0.2699 - val_loss: 0.2559

==>predicting on train



confusion matrix:
[[2140   15]
 [ 218   37]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0759819969534874
difference in average predicted and observed risk = -0.029827003046512604
number samples = 2410
accuracy = 0.903319
precision class 0 = 0.907549
precision class 1 = 0.711538
recall class 0 = 0.993039
recall class 1 = 0.145098
false negative rate = 0.854902
false positive rate = 0.006961
positive prediction rate = 0.021577
AUC of ROC = 0.813382
AUC of PRC = 0.437148
min(+P, Se) = 0.420233

-------------------------------

confusion matrix:
[[1172    7]
 [ 104   14]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07050599902868271
difference in average predicted and observed risk = -0.020473000971317296
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.918495
precision class 1 = 0.666667
recall class 0 = 0.994063
recall class 1 = 0.118644
false negative rate = 0.881356
false positive rate = 0.005937
positive prediction rate = 0.016191
AUC of ROC = 0.817966
AUC of PRC = 0.387329
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[654   2]
 [ 65   9]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.07982199639081955
difference in average predicted and observed risk = -0.021548003609180452
number samples = 730
accuracy = 0.908219
precision class 0 = 0.909597
precision class 1 = 0.818182
recall class 0 = 0.996951
recall class 1 = 0.121622
false negative rate = 0.878378
false positive rate = 0.003049
positive prediction rate = 0.015068
AUC of ROC = 0.81526
AUC of PRC = 0.448642
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09264799952507019
difference in average predicted and observed risk = -0.0330060004749298
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.907685
AUC of PRC = 0.725817
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2460   14]
 [ 225   30]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07027799636125565
difference in average predicted and observed risk = -0.02316300363874435
number samples = 2729
accuracy = 0.912422
precision class 0 = 0.916201
precision class 1 = 0.681818
recall class 0 = 0.994341
recall class 1 = 0.117647
false negative rate = 0.882353
false positive rate = 0.005659
positive prediction rate = 0.016123
AUC of ROC = 0.812294
AUC of PRC = 0.393905
min(+P, Se) = 0.390625

-------------------------------

confusion matrix:
[[1671   12]
 [ 175   41]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08359099924564362
difference in average predicted and observed risk = -0.030153000754356382
number samples = 1899
accuracy = 0.901527
precision class 0 = 0.9052
precision class 1 = 0.773585
recall class 0 = 0.99287
recall class 1 = 0.189815
false negative rate = 0.810185
false positive rate = 0.00713
positive prediction rate = 0.027909
AUC of ROC = 0.828291
AUC of PRC = 0.492968
min(+P, Se) = 0.442396

-------------------------------

confusion matrix:
[[545   4]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.08768299967050552
difference in average predicted and observed risk = -0.03532000032949448
number samples = 626
accuracy = 0.883387
precision class 0 = 0.887622
precision class 1 = 0.666667
recall class 0 = 0.992714
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.007286
positive prediction rate = 0.019169
AUC of ROC = 0.819814
AUC of PRC = 0.431538
min(+P, Se) = 0.448718

-------------------------------

confusion matrix:
[[2240    9]
 [ 186   22]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06395100057125092
difference in average predicted and observed risk = -0.02070499942874908
number samples = 2457
accuracy = 0.920635
precision class 0 = 0.923331
precision class 1 = 0.709677
recall class 0 = 0.995998
recall class 1 = 0.105769
false negative rate = 0.894231
false positive rate = 0.004002
positive prediction rate = 0.012617
AUC of ROC = 0.815025
AUC of PRC = 0.376175
min(+P, Se) = 0.361502

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0791810005903244
difference in average predicted and observed risk = -0.021624999409675605
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.722511
AUC of PRC = 0.219446
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[477   4]
 [ 56  26]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.10512799769639969
difference in average predicted and observed risk = -0.04052000230360031
number samples = 563
accuracy = 0.893428
precision class 0 = 0.894934
precision class 1 = 0.866667
recall class 0 = 0.991684
recall class 1 = 0.317073
false negative rate = 0.682927
false positive rate = 0.008316
positive prediction rate = 0.053286
AUC of ROC = 0.85016
AUC of PRC = 0.63159
min(+P, Se) = 0.531915

-------------------------------

confusion matrix:
[[649   6]
 [ 64  15]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08131899684667587
difference in average predicted and observed risk = -0.02631000315332413
number samples = 734
accuracy = 0.904632
precision class 0 = 0.910238
precision class 1 = 0.714286
recall class 0 = 0.99084
recall class 1 = 0.189873
false negative rate = 0.810127
false positive rate = 0.00916
positive prediction rate = 0.02861
AUC of ROC = 0.819248
AUC of PRC = 0.452324
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4131   26]
 [ 400   71]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0757410004734993
difference in average predicted and observed risk = -0.026030999526500703
number samples = 4628
accuracy = 0.907952
precision class 0 = 0.911719
precision class 1 = 0.731959
recall class 0 = 0.993746
recall class 1 = 0.150743
false negative rate = 0.849257
false positive rate = 0.006255
positive prediction rate = 0.020959
AUC of ROC = 0.819926
AUC of PRC = 0.44084
min(+P, Se) = 0.413223

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.06747999787330627
difference in average predicted and observed risk = -0.01268900212669373
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.84283
AUC of PRC = 0.340064
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07096900045871735
difference in average predicted and observed risk = -0.03782699954128266
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.798453
AUC of PRC = 0.432556
min(+P, Se) = 0.425532

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09342599660158157
difference in average predicted and observed risk = -0.01674300339841843
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.904762
AUC of PRC = 0.532559
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11396200209856033
difference in average predicted and observed risk = -0.019370997901439674
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08026900142431259
difference in average predicted and observed risk = -0.0347749985756874
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.808205
AUC of PRC = 0.347181
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07088600099086761
difference in average predicted and observed risk = -0.021163999009132392
number samples = 478
accuracy = 0.922594
precision class 0 = 0.923241
precision class 1 = 0.888889
recall class 0 = 0.997696
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.002304
positive prediction rate = 0.018828
AUC of ROC = 0.854001
AUC of PRC = 0.544271
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06101299822330475
difference in average predicted and observed risk = -0.028189001776695255
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.831593
AUC of PRC = 0.458067
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09330599755048752
difference in average predicted and observed risk = -0.024341002449512483
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.938889
AUC of PRC = 0.698718
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.07924599945545197
difference in average predicted and observed risk = -0.009464000544548032
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.831054
AUC of PRC = 0.228383
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09249400347471237
difference in average predicted and observed risk = -0.05711199652528762
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.796784
AUC of PRC = 0.549622
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.10559800267219543
difference in average predicted and observed risk = 0.02665100267219543
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.551786
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[731   3]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.07477899640798569
difference in average predicted and observed risk = -0.026812003592014313
number samples = 817
accuracy = 0.906977
precision class 0 = 0.909204
precision class 1 = 0.769231
recall class 0 = 0.995913
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.004087
positive prediction rate = 0.015912
AUC of ROC = 0.83666
AUC of PRC = 0.461173
min(+P, Se) = 0.458824

-------------------------------

Epoch 00041: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch41.state
Epoch 42/100
 - 318s - loss: 0.2740 - val_loss: 0.2495

==>predicting on train



confusion matrix:
[[2135   20]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08958099782466888
difference in average predicted and observed risk = -0.016228002175331116
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.913174
precision class 1 = 0.722222
recall class 0 = 0.990719
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.009281
positive prediction rate = 0.029876
AUC of ROC = 0.821255
AUC of PRC = 0.444074
min(+P, Se) = 0.435294

-------------------------------

confusion matrix:
[[1166   13]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08424100279808044
difference in average predicted and observed risk = -0.00673799720191956
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.922468
precision class 1 = 0.606061
recall class 0 = 0.988974
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.011026
positive prediction rate = 0.025443
AUC of ROC = 0.828798
AUC of PRC = 0.39897
min(+P, Se) = 0.372881

-------------------------------

confusion matrix:
[[646  10]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09403599798679352
difference in average predicted and observed risk = -0.007334002013206484
number samples = 730
accuracy = 0.908219
precision class 0 = 0.918919
precision class 1 = 0.62963
recall class 0 = 0.984756
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.015244
positive prediction rate = 0.036986
AUC of ROC = 0.829268
AUC of PRC = 0.454548
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10260099917650223
difference in average predicted and observed risk = -0.02305300082349776
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.9249
AUC of PRC = 0.756299
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2453   21]
 [ 202   53]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08453399688005447
difference in average predicted and observed risk = -0.008907003119945522
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.923917
precision class 1 = 0.716216
recall class 0 = 0.991512
recall class 1 = 0.207843
false negative rate = 0.792157
false positive rate = 0.008488
positive prediction rate = 0.027116
AUC of ROC = 0.822564
AUC of PRC = 0.406287
min(+P, Se) = 0.403922

-------------------------------

confusion matrix:
[[1659   24]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09620899707078934
difference in average predicted and observed risk = -0.01753500292921066
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.907549
precision class 1 = 0.661972
recall class 0 = 0.98574
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.01426
positive prediction rate = 0.037388
AUC of ROC = 0.836854
AUC of PRC = 0.498456
min(+P, Se) = 0.438356

-------------------------------

confusion matrix:
[[541   8]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09987799823284149
difference in average predicted and observed risk = -0.02312500176715851
number samples = 626
accuracy = 0.886581
precision class 0 = 0.895695
precision class 1 = 0.636364
recall class 0 = 0.985428
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.014572
positive prediction rate = 0.035144
AUC of ROC = 0.82859
AUC of PRC = 0.437567
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[2233   16]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07659000158309937
difference in average predicted and observed risk = -0.00806599841690063
number samples = 2457
accuracy = 0.92267
precision class 0 = 0.927711
precision class 1 = 0.68
recall class 0 = 0.992886
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.007114
positive prediction rate = 0.02035
AUC of ROC = 0.825301
AUC of PRC = 0.377732
min(+P, Se) = 0.365385

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0927010029554367
difference in average predicted and observed risk = -0.0081049970445633
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.735964
AUC of PRC = 0.229042
min(+P, Se) = 0.322581

-------------------------------

confusion matrix:
[[473   8]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1238899976015091
difference in average predicted and observed risk = -0.021758002398490905
number samples = 563
accuracy = 0.895204
precision class 0 = 0.902672
precision class 1 = 0.794872
recall class 0 = 0.983368
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.016632
positive prediction rate = 0.069272
AUC of ROC = 0.858856
AUC of PRC = 0.641116
min(+P, Se) = 0.52439

-------------------------------

confusion matrix:
[[647   8]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09529700130224228
difference in average predicted and observed risk = -0.012331998697757723
number samples = 734
accuracy = 0.908719
precision class 0 = 0.916431
precision class 1 = 0.714286
recall class 0 = 0.987786
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.012214
positive prediction rate = 0.038147
AUC of ROC = 0.827172
AUC of PRC = 0.471156
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[4112   45]
 [ 371  100]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0893239974975586
difference in average predicted and observed risk = -0.012448002502441408
number samples = 4628
accuracy = 0.910112
precision class 0 = 0.917243
precision class 1 = 0.689655
recall class 0 = 0.989175
recall class 1 = 0.212314
false negative rate = 0.787686
false positive rate = 0.010825
positive prediction rate = 0.031331
AUC of ROC = 0.829529
AUC of PRC = 0.449015
min(+P, Se) = 0.424116

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08041899651288986
difference in average predicted and observed risk = 0.0002499965128898579
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.868662
AUC of PRC = 0.397758
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0838870033621788
difference in average predicted and observed risk = -0.0249089966378212
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.815474
AUC of PRC = 0.444078
min(+P, Se) = 0.468085

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11040999740362167
difference in average predicted and observed risk = 0.00024099740362167055
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.909158
AUC of PRC = 0.528344
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11979000270366669
difference in average predicted and observed risk = -0.01354299729633332
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09341699630022049
difference in average predicted and observed risk = -0.021627003699779504
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.823077
AUC of PRC = 0.339875
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08421000093221664
difference in average predicted and observed risk = -0.007839999067783363
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.868664
AUC of PRC = 0.566823
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07390300184488297
difference in average predicted and observed risk = -0.015298998155117038
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.853364
AUC of PRC = 0.469687
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11205799877643585
difference in average predicted and observed risk = -0.0055890012235641495
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.939815
AUC of PRC = 0.698716
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08778700232505798
difference in average predicted and observed risk = -0.0009229976749420138
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.843926
AUC of PRC = 0.239275
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10662399977445602
difference in average predicted and observed risk = -0.042982000225543965
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.810429
AUC of PRC = 0.573411
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12055899947881699
difference in average predicted and observed risk = 0.04161199947881698
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08803000301122665
difference in average predicted and observed risk = -0.013560996988773347
number samples = 817
accuracy = 0.909425
precision class 0 = 0.913534
precision class 1 = 0.736842
recall class 0 = 0.993188
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.006812
positive prediction rate = 0.023256
AUC of ROC = 0.851843
AUC of PRC = 0.470797
min(+P, Se) = 0.506024

-------------------------------

Epoch 00042: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch42.state
Epoch 43/100
 - 312s - loss: 0.2686 - val_loss: 0.2473

==>predicting on train



confusion matrix:
[[2131   24]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10544999688863754
difference in average predicted and observed risk = -0.00035900311136245755
number samples = 2410
accuracy = 0.905809
precision class 0 = 0.913025
precision class 1 = 0.684211
recall class 0 = 0.988863
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.011137
positive prediction rate = 0.031535
AUC of ROC = 0.816969
AUC of PRC = 0.437516
min(+P, Se) = 0.39604

-------------------------------

confusion matrix:
[[1163   16]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09731999784708023
difference in average predicted and observed risk = 0.006340997847080226
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.923749
precision class 1 = 0.578947
recall class 0 = 0.986429
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.013571
positive prediction rate = 0.029298
AUC of ROC = 0.83145
AUC of PRC = 0.405657
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[642  14]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10859200358390808
difference in average predicted and observed risk = 0.007222003583908079
number samples = 730
accuracy = 0.90274
precision class 0 = 0.918455
precision class 1 = 0.548387
recall class 0 = 0.978659
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.021341
positive prediction rate = 0.042466
AUC of ROC = 0.826199
AUC of PRC = 0.451198
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11479999870061874
difference in average predicted and observed risk = -0.010854001299381244
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.916417
AUC of PRC = 0.745001
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2445   29]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09841199964284897
difference in average predicted and observed risk = 0.004970999642848972
number samples = 2729
accuracy = 0.91572
precision class 0 = 0.924036
precision class 1 = 0.650602
recall class 0 = 0.988278
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.011722
positive prediction rate = 0.030414
AUC of ROC = 0.819731
AUC of PRC = 0.407462
min(+P, Se) = 0.378906

-------------------------------

confusion matrix:
[[1656   27]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11215999722480774
difference in average predicted and observed risk = -0.0015840027751922586
number samples = 1899
accuracy = 0.897314
precision class 0 = 0.907895
precision class 1 = 0.64
recall class 0 = 0.983957
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.016043
positive prediction rate = 0.039494
AUC of ROC = 0.836161
AUC of PRC = 0.492714
min(+P, Se) = 0.437788

-------------------------------

confusion matrix:
[[541   8]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11821799725294113
difference in average predicted and observed risk = -0.00478500274705887
number samples = 626
accuracy = 0.884984
precision class 0 = 0.894215
precision class 1 = 0.619048
recall class 0 = 0.985428
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.014572
positive prediction rate = 0.033546
AUC of ROC = 0.822274
AUC of PRC = 0.433563
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2229   20]
 [ 175   33]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09010100364685059
difference in average predicted and observed risk = 0.005445003646850591
number samples = 2457
accuracy = 0.920635
precision class 0 = 0.927205
precision class 1 = 0.622642
recall class 0 = 0.991107
recall class 1 = 0.158654
false negative rate = 0.841346
false positive rate = 0.008893
positive prediction rate = 0.021571
AUC of ROC = 0.823377
AUC of PRC = 0.372612
min(+P, Se) = 0.356522

-------------------------------

confusion matrix:
[[218   5]
 [ 21   4]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10857000201940536
difference in average predicted and observed risk = 0.007764002019405358
number samples = 248
accuracy = 0.895161
precision class 0 = 0.912134
precision class 1 = 0.444444
recall class 0 = 0.977578
recall class 1 = 0.16
false negative rate = 0.84
false positive rate = 0.022422
positive prediction rate = 0.03629
AUC of ROC = 0.751749
AUC of PRC = 0.254139
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[470  11]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.138823002576828
difference in average predicted and observed risk = -0.006824997423171997
number samples = 563
accuracy = 0.891652
precision class 0 = 0.903846
precision class 1 = 0.744186
recall class 0 = 0.977131
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.022869
positive prediction rate = 0.076377
AUC of ROC = 0.860758
AUC of PRC = 0.650729
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[643  12]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11048000305891037
difference in average predicted and observed risk = 0.0028510030589103674
number samples = 734
accuracy = 0.90327
precision class 0 = 0.915954
precision class 1 = 0.625
recall class 0 = 0.981679
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.018321
positive prediction rate = 0.043597
AUC of ROC = 0.820002
AUC of PRC = 0.460927
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4101   56]
 [ 369  102]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10405299812555313
difference in average predicted and observed risk = 0.0022809981255531298
number samples = 4628
accuracy = 0.908168
precision class 0 = 0.91745
precision class 1 = 0.64557
recall class 0 = 0.986529
recall class 1 = 0.216561
false negative rate = 0.78344
false positive rate = 0.013471
positive prediction rate = 0.03414
AUC of ROC = 0.827707
AUC of PRC = 0.447191
min(+P, Se) = 0.409766

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.095660001039505
difference in average predicted and observed risk = 0.015491001039505
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.855625
AUC of PRC = 0.391051
min(+P, Se) = 0.434783

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10053200274705887
difference in average predicted and observed risk = -0.008263997252941135
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.811826
AUC of PRC = 0.42333
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12693199515342712
difference in average predicted and observed risk = 0.01676299515342712
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.920879
AUC of PRC = 0.529221
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13758200407028198
difference in average predicted and observed risk = 0.004249004070281975
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11343999952077866
difference in average predicted and observed risk = -0.0016040004792213375
number samples = 339
accuracy = 0.890855
precision class 0 = 0.897281
precision class 1 = 0.625
recall class 0 = 0.99
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.01
positive prediction rate = 0.023599
AUC of ROC = 0.81906
AUC of PRC = 0.34829
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[431   3]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09780500084161758
difference in average predicted and observed risk = 0.005755000841617577
number samples = 478
accuracy = 0.926778
precision class 0 = 0.930886
precision class 1 = 0.8
recall class 0 = 0.993088
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.006912
positive prediction rate = 0.031381
AUC of ROC = 0.86924
AUC of PRC = 0.548344
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 31   7]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08756700158119202
difference in average predicted and observed risk = -0.001634998418807987
number samples = 426
accuracy = 0.924883
precision class 0 = 0.925837
precision class 1 = 0.875
recall class 0 = 0.997423
recall class 1 = 0.184211
false negative rate = 0.815789
false positive rate = 0.002577
positive prediction rate = 0.018779
AUC of ROC = 0.842716
AUC of PRC = 0.438214
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12838299572467804
difference in average predicted and observed risk = 0.010735995724678038
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.943519
AUC of PRC = 0.682889
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11025600135326385
difference in average predicted and observed risk = 0.021546001353263858
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.845535
AUC of PRC = 0.247063
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12178300321102142
difference in average predicted and observed risk = -0.027822996788978566
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.808967
AUC of PRC = 0.566534
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14920899271965027
difference in average predicted and observed risk = 0.07026199271965027
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[728   6]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10429199784994125
difference in average predicted and observed risk = 0.002700997849941253
number samples = 817
accuracy = 0.911873
precision class 0 = 0.916877
precision class 1 = 0.73913
recall class 0 = 0.991826
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.008174
positive prediction rate = 0.028152
AUC of ROC = 0.848905
AUC of PRC = 0.462785
min(+P, Se) = 0.488095

-------------------------------

Epoch 00043: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch43.state
Epoch 44/100
 - 314s - loss: 0.2727 - val_loss: 0.2491

==>predicting on train



confusion matrix:
[[2137   18]
 [ 213   42]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10858500003814697
difference in average predicted and observed risk = 0.0027760000381469724
number samples = 2410
accuracy = 0.904149
precision class 0 = 0.909362
precision class 1 = 0.7
recall class 0 = 0.991647
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.008353
positive prediction rate = 0.024896
AUC of ROC = 0.820156
AUC of PRC = 0.445885
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[1165   14]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10061600059270859
difference in average predicted and observed risk = 0.009637000592708583
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.922407
precision class 1 = 0.588235
recall class 0 = 0.988126
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.011874
positive prediction rate = 0.026214
AUC of ROC = 0.832248
AUC of PRC = 0.402528
min(+P, Se) = 0.368852

-------------------------------

confusion matrix:
[[646  10]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10909000039100647
difference in average predicted and observed risk = 0.007720000391006468
number samples = 730
accuracy = 0.906849
precision class 0 = 0.917614
precision class 1 = 0.615385
recall class 0 = 0.984756
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.015244
positive prediction rate = 0.035616
AUC of ROC = 0.845686
AUC of PRC = 0.466414
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11878100037574768
difference in average predicted and observed risk = -0.006872999624252307
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.919162
AUC of PRC = 0.738169
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2449   25]
 [ 208   47]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10188200324773788
difference in average predicted and observed risk = 0.008441003247737888
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.921716
precision class 1 = 0.652778
recall class 0 = 0.989895
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.010105
positive prediction rate = 0.026383
AUC of ROC = 0.82877
AUC of PRC = 0.412874
min(+P, Se) = 0.407843

-------------------------------

confusion matrix:
[[1664   19]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11399500072002411
difference in average predicted and observed risk = 0.000251000720024111
number samples = 1899
accuracy = 0.898368
precision class 0 = 0.905332
precision class 1 = 0.688525
recall class 0 = 0.988711
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.011289
positive prediction rate = 0.032122
AUC of ROC = 0.836824
AUC of PRC = 0.498446
min(+P, Se) = 0.453704

-------------------------------

confusion matrix:
[[543   6]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12487799674272537
difference in average predicted and observed risk = 0.001874996742725371
number samples = 626
accuracy = 0.881789
precision class 0 = 0.888707
precision class 1 = 0.6
recall class 0 = 0.989071
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.010929
positive prediction rate = 0.023962
AUC of ROC = 0.83318
AUC of PRC = 0.437654
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2235   14]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09259899705648422
difference in average predicted and observed risk = 0.007942997056484227
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.926617
precision class 1 = 0.688889
recall class 0 = 0.993775
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.006225
positive prediction rate = 0.018315
AUC of ROC = 0.826363
AUC of PRC = 0.383759
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11811800301074982
difference in average predicted and observed risk = 0.01731200301074981
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.745112
AUC of PRC = 0.238992
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[472   9]
 [ 53  29]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14075300097465515
difference in average predicted and observed risk = -0.004894999025344848
number samples = 563
accuracy = 0.889876
precision class 0 = 0.899048
precision class 1 = 0.763158
recall class 0 = 0.981289
recall class 1 = 0.353659
false negative rate = 0.646341
false positive rate = 0.018711
positive prediction rate = 0.067496
AUC of ROC = 0.871229
AUC of PRC = 0.649715
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[644  11]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.1093830019235611
difference in average predicted and observed risk = 0.0017540019235610937
number samples = 734
accuracy = 0.90327
precision class 0 = 0.914773
precision class 1 = 0.633333
recall class 0 = 0.983206
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.016794
positive prediction rate = 0.040872
AUC of ROC = 0.824543
AUC of PRC = 0.462168
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4113   44]
 [ 382   89]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10685200244188309
difference in average predicted and observed risk = 0.005080002441883086
number samples = 4628
accuracy = 0.907952
precision class 0 = 0.915017
precision class 1 = 0.669173
recall class 0 = 0.989415
recall class 1 = 0.18896
false negative rate = 0.81104
false positive rate = 0.010585
positive prediction rate = 0.028738
AUC of ROC = 0.832619
AUC of PRC = 0.451704
min(+P, Se) = 0.425847

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09880799800157547
difference in average predicted and observed risk = 0.018638998001575466
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.852487
AUC of PRC = 0.387694
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.1023619994521141
difference in average predicted and observed risk = -0.006434000547885899
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.809671
AUC of PRC = 0.434356
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12568199634552002
difference in average predicted and observed risk = 0.015512996345520016
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.924542
AUC of PRC = 0.534947
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13948699831962585
difference in average predicted and observed risk = 0.006153998319625847
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11276700347661972
difference in average predicted and observed risk = -0.002276996523380273
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.819487
AUC of PRC = 0.355289
min(+P, Se) = 0.465116

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10130800306797028
difference in average predicted and observed risk = 0.009258003067970269
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.86725
AUC of PRC = 0.54748
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0881590023636818
difference in average predicted and observed risk = -0.0010429976363182103
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.836815
AUC of PRC = 0.442433
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12906600534915924
difference in average predicted and observed risk = 0.01141900534915924
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.931481
AUC of PRC = 0.673885
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11542599648237228
difference in average predicted and observed risk = 0.026715996482372287
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.875302
AUC of PRC = 0.278799
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1241379976272583
difference in average predicted and observed risk = -0.025468002372741688
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.823587
AUC of PRC = 0.586908
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.15405899286270142
difference in average predicted and observed risk = 0.07511199286270141
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.87619
AUC of PRC = 0.487518
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10606300085783005
difference in average predicted and observed risk = 0.004472000857830047
number samples = 817
accuracy = 0.908201
precision class 0 = 0.913425
precision class 1 = 0.7
recall class 0 = 0.991826
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.008174
positive prediction rate = 0.02448
AUC of ROC = 0.847887
AUC of PRC = 0.470102
min(+P, Se) = 0.505882

-------------------------------

Epoch 00044: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch44.state
Epoch 45/100
 - 317s - loss: 0.2692 - val_loss: 0.2446

==>predicting on train



confusion matrix:
[[2138   17]
 [ 217   38]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08560100197792053
difference in average predicted and observed risk = -0.020207998022079468
number samples = 2410
accuracy = 0.902905
precision class 0 = 0.907856
precision class 1 = 0.690909
recall class 0 = 0.992111
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.007889
positive prediction rate = 0.022822
AUC of ROC = 0.82443
AUC of PRC = 0.441461
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[1169   10]
 [ 101   17]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07873199880123138
difference in average predicted and observed risk = -0.01224700119876862
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.920472
precision class 1 = 0.62963
recall class 0 = 0.991518
recall class 1 = 0.144068
false negative rate = 0.855932
false positive rate = 0.008482
positive prediction rate = 0.020817
AUC of ROC = 0.835662
AUC of PRC = 0.397816
min(+P, Se) = 0.389831

-------------------------------

confusion matrix:
[[654   2]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08743699640035629
difference in average predicted and observed risk = -0.013933003599643709
number samples = 730
accuracy = 0.916438
precision class 0 = 0.917251
precision class 1 = 0.882353
recall class 0 = 0.996951
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.003049
positive prediction rate = 0.023288
AUC of ROC = 0.840639
AUC of PRC = 0.467496
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09981100261211395
difference in average predicted and observed risk = -0.025842997387886035
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.927395
AUC of PRC = 0.745305
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2456   18]
 [ 213   42]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08031299710273743
difference in average predicted and observed risk = -0.01312800289726257
number samples = 2729
accuracy = 0.915354
precision class 0 = 0.920195
precision class 1 = 0.7
recall class 0 = 0.992724
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.007276
positive prediction rate = 0.021986
AUC of ROC = 0.828042
AUC of PRC = 0.409557
min(+P, Se) = 0.411321

-------------------------------

confusion matrix:
[[1670   13]
 [ 177   39]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.0906430035829544
difference in average predicted and observed risk = -0.02310099641704559
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.904169
precision class 1 = 0.75
recall class 0 = 0.992276
recall class 1 = 0.180556
false negative rate = 0.819444
false positive rate = 0.007724
positive prediction rate = 0.027383
AUC of ROC = 0.843068
AUC of PRC = 0.500316
min(+P, Se) = 0.458716

-------------------------------

confusion matrix:
[[545   4]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09756900370121002
difference in average predicted and observed risk = -0.02543399629878998
number samples = 626
accuracy = 0.881789
precision class 0 = 0.886179
precision class 1 = 0.636364
recall class 0 = 0.992714
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.007286
positive prediction rate = 0.017572
AUC of ROC = 0.836468
AUC of PRC = 0.437012
min(+P, Se) = 0.440476

-------------------------------

confusion matrix:
[[2239   10]
 [ 181   27]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07114700227975845
difference in average predicted and observed risk = -0.013508997720241542
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.925207
precision class 1 = 0.72973
recall class 0 = 0.995554
recall class 1 = 0.129808
false negative rate = 0.870192
false positive rate = 0.004446
positive prediction rate = 0.015059
AUC of ROC = 0.828689
AUC of PRC = 0.378802
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08941300213336945
difference in average predicted and observed risk = -0.011392997866630561
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.755874
AUC of PRC = 0.247619
min(+P, Se) = 0.346154

-------------------------------

confusion matrix:
[[473   8]
 [ 54  28]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12031300365924835
difference in average predicted and observed risk = -0.025334996340751648
number samples = 563
accuracy = 0.889876
precision class 0 = 0.897533
precision class 1 = 0.777778
recall class 0 = 0.983368
recall class 1 = 0.341463
false negative rate = 0.658537
false positive rate = 0.016632
positive prediction rate = 0.063943
AUC of ROC = 0.868845
AUC of PRC = 0.644446
min(+P, Se) = 0.55914

-------------------------------

confusion matrix:
[[649   6]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08924899995326996
difference in average predicted and observed risk = -0.018380000046730044
number samples = 734
accuracy = 0.910082
precision class 0 = 0.915374
precision class 1 = 0.76
recall class 0 = 0.99084
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.00916
positive prediction rate = 0.03406
AUC of ROC = 0.828582
AUC of PRC = 0.466316
min(+P, Se) = 0.4625

-------------------------------

confusion matrix:
[[4126   31]
 [ 390   81]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08455199748277664
difference in average predicted and observed risk = -0.01722000251722336
number samples = 4628
accuracy = 0.909032
precision class 0 = 0.91364
precision class 1 = 0.723214
recall class 0 = 0.992543
recall class 1 = 0.171975
false negative rate = 0.828025
false positive rate = 0.007457
positive prediction rate = 0.024201
AUC of ROC = 0.83541
AUC of PRC = 0.450807
min(+P, Se) = 0.437367

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0764869973063469
difference in average predicted and observed risk = -0.003682002693653111
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.874698
AUC of PRC = 0.400431
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07920599728822708
difference in average predicted and observed risk = -0.029590002711772923
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.818016
AUC of PRC = 0.454408
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10577099770307541
difference in average predicted and observed risk = -0.004398002296924594
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.917949
AUC of PRC = 0.604215
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1207059994339943
difference in average predicted and observed risk = -0.012627000566005714
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08872900158166885
difference in average predicted and observed risk = -0.02631499841833114
number samples = 339
accuracy = 0.882006
precision class 0 = 0.889222
precision class 1 = 0.4
recall class 0 = 0.99
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.01
positive prediction rate = 0.014749
AUC of ROC = 0.825385
AUC of PRC = 0.38386
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08026699721813202
difference in average predicted and observed risk = -0.011783002781867988
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.874895
AUC of PRC = 0.5708
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0677030012011528
difference in average predicted and observed risk = -0.021498998798847202
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.853364
AUC of PRC = 0.481443
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10553199797868729
difference in average predicted and observed risk = -0.012115002021312715
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.934259
AUC of PRC = 0.682395
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08850300312042236
difference in average predicted and observed risk = -0.0002069968795776339
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.859212
AUC of PRC = 0.26727
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10438700020313263
difference in average predicted and observed risk = -0.04521899979686736
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.823099
AUC of PRC = 0.586167
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12129800021648407
difference in average predicted and observed risk = 0.04235100021648407
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.538889
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[729   5]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0837780013680458
difference in average predicted and observed risk = -0.017812998631954194
number samples = 817
accuracy = 0.908201
precision class 0 = 0.91239
precision class 1 = 0.722222
recall class 0 = 0.993188
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.006812
positive prediction rate = 0.022032
AUC of ROC = 0.855996
AUC of PRC = 0.489329
min(+P, Se) = 0.482353

-------------------------------

Epoch 00045: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch45.state
Epoch 46/100
 - 319s - loss: 0.2680 - val_loss: 0.2444

==>predicting on train



confusion matrix:
[[2146    9]
 [ 221   34]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09626100212335587
difference in average predicted and observed risk = -0.009547997876644135
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.906633
precision class 1 = 0.790698
recall class 0 = 0.995824
recall class 1 = 0.133333
false negative rate = 0.866667
false positive rate = 0.004176
positive prediction rate = 0.017842
AUC of ROC = 0.829509
AUC of PRC = 0.449848
min(+P, Se) = 0.434944

-------------------------------

confusion matrix:
[[1170    9]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08740200102329254
difference in average predicted and observed risk = -0.003576998976707463
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.919089
precision class 1 = 0.625
recall class 0 = 0.992366
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.007634
positive prediction rate = 0.018504
AUC of ROC = 0.842469
AUC of PRC = 0.405752
min(+P, Se) = 0.391667

-------------------------------

confusion matrix:
[[654   2]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09748999774456024
difference in average predicted and observed risk = -0.00388000225543976
number samples = 730
accuracy = 0.915069
precision class 0 = 0.915966
precision class 1 = 0.875
recall class 0 = 0.996951
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.003049
positive prediction rate = 0.021918
AUC of ROC = 0.841175
AUC of PRC = 0.471597
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10693100094795227
difference in average predicted and observed risk = -0.018722999052047717
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.927645
AUC of PRC = 0.753304
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2460   14]
 [ 219   36]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0899519994854927
difference in average predicted and observed risk = -0.00348900051450729
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.918253
precision class 1 = 0.72
recall class 0 = 0.994341
recall class 1 = 0.141176
false negative rate = 0.858824
false positive rate = 0.005659
positive prediction rate = 0.018322
AUC of ROC = 0.833175
AUC of PRC = 0.412244
min(+P, Se) = 0.419608

-------------------------------

confusion matrix:
[[1675    8]
 [ 178   38]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10082200169563293
difference in average predicted and observed risk = -0.012921998304367063
number samples = 1899
accuracy = 0.902054
precision class 0 = 0.90394
precision class 1 = 0.826087
recall class 0 = 0.995247
recall class 1 = 0.175926
false negative rate = 0.824074
false positive rate = 0.004753
positive prediction rate = 0.024223
AUC of ROC = 0.846603
AUC of PRC = 0.507808
min(+P, Se) = 0.461883

-------------------------------

confusion matrix:
[[546   3]
 [ 73   4]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10639599710702896
difference in average predicted and observed risk = -0.01660700289297104
number samples = 626
accuracy = 0.878594
precision class 0 = 0.882068
precision class 1 = 0.571429
recall class 0 = 0.994536
recall class 1 = 0.051948
false negative rate = 0.948052
false positive rate = 0.005464
positive prediction rate = 0.011182
AUC of ROC = 0.838029
AUC of PRC = 0.442885
min(+P, Se) = 0.47191

-------------------------------

confusion matrix:
[[2242    7]
 [ 182   26]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08205000311136246
difference in average predicted and observed risk = -0.002605996888637538
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.924918
precision class 1 = 0.787879
recall class 0 = 0.996888
recall class 1 = 0.125
false negative rate = 0.875
false positive rate = 0.003112
positive prediction rate = 0.013431
AUC of ROC = 0.834901
AUC of PRC = 0.38756
min(+P, Se) = 0.380282

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10086999833583832
difference in average predicted and observed risk = 6.399833583831116e-05
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.766637
AUC of PRC = 0.249829
min(+P, Se) = 0.357143

-------------------------------

confusion matrix:
[[477   4]
 [ 55  27]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1267929971218109
difference in average predicted and observed risk = -0.018855002878189087
number samples = 563
accuracy = 0.895204
precision class 0 = 0.896617
precision class 1 = 0.870968
recall class 0 = 0.991684
recall class 1 = 0.329268
false negative rate = 0.670732
false positive rate = 0.008316
positive prediction rate = 0.055062
AUC of ROC = 0.869834
AUC of PRC = 0.6455
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[650   5]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.0985570028424263
difference in average predicted and observed risk = -0.009071997157573702
number samples = 734
accuracy = 0.908719
precision class 0 = 0.912921
precision class 1 = 0.772727
recall class 0 = 0.992366
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.007634
positive prediction rate = 0.029973
AUC of ROC = 0.834399
AUC of PRC = 0.473747
min(+P, Se) = 0.436782

-------------------------------

confusion matrix:
[[4135   22]
 [ 397   74]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09441299736499786
difference in average predicted and observed risk = -0.007359002635002138
number samples = 4628
accuracy = 0.909464
precision class 0 = 0.912401
precision class 1 = 0.770833
recall class 0 = 0.994708
recall class 1 = 0.157113
false negative rate = 0.842887
false positive rate = 0.005292
positive prediction rate = 0.020743
AUC of ROC = 0.839796
AUC of PRC = 0.456596
min(+P, Se) = 0.441614

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08535800129175186
difference in average predicted and observed risk = 0.005189001291751857
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.875905
AUC of PRC = 0.410031
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09085100144147873
difference in average predicted and observed risk = -0.017944998558521275
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.823487
AUC of PRC = 0.465368
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11498299986124039
difference in average predicted and observed risk = 0.004813999861240384
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.915751
AUC of PRC = 0.542692
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12758900225162506
difference in average predicted and observed risk = -0.005743997748374946
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09932299703359604
difference in average predicted and observed risk = -0.015721002966403955
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.831026
AUC of PRC = 0.375203
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09038200229406357
difference in average predicted and observed risk = -0.0016679977059364387
number samples = 478
accuracy = 0.92887
precision class 0 = 0.929185
precision class 1 = 0.916667
recall class 0 = 0.997696
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.002304
positive prediction rate = 0.025105
AUC of ROC = 0.878142
AUC of PRC = 0.575872
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07831300050020218
difference in average predicted and observed risk = -0.010888999499797825
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.85818
AUC of PRC = 0.482443
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1122480034828186
difference in average predicted and observed risk = -0.005398996517181398
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.942593
AUC of PRC = 0.719869
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0988759994506836
difference in average predicted and observed risk = 0.010165999450683597
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.856798
AUC of PRC = 0.261471
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11616799980401993
difference in average predicted and observed risk = -0.03343800019598006
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.822612
AUC of PRC = 0.585862
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13285300135612488
difference in average predicted and observed risk = 0.053906001356124875
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.528704
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[731   3]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09409199655056
difference in average predicted and observed risk = -0.007499003449440003
number samples = 817
accuracy = 0.910649
precision class 0 = 0.912609
precision class 1 = 0.8125
recall class 0 = 0.995913
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.004087
positive prediction rate = 0.019584
AUC of ROC = 0.860494
AUC of PRC = 0.495178
min(+P, Se) = 0.493976

-------------------------------

Epoch 00046: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch46.state
Epoch 47/100
 - 315s - loss: 0.2661 - val_loss: 0.2419

==>predicting on train



confusion matrix:
[[2143   12]
 [ 218   37]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10480800271034241
difference in average predicted and observed risk = -0.001000997289657593
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.907666
precision class 1 = 0.755102
recall class 0 = 0.994432
recall class 1 = 0.145098
false negative rate = 0.854902
false positive rate = 0.005568
positive prediction rate = 0.020332
AUC of ROC = 0.819961
AUC of PRC = 0.437787
min(+P, Se) = 0.423358

-------------------------------

confusion matrix:
[[1172    7]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09516800194978714
difference in average predicted and observed risk = 0.004189001949787136
number samples = 1297
accuracy = 0.915189
precision class 0 = 0.919216
precision class 1 = 0.681818
recall class 0 = 0.994063
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.005937
positive prediction rate = 0.016962
AUC of ROC = 0.840651
AUC of PRC = 0.404513
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[654   2]
 [ 62  12]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10868900269269943
difference in average predicted and observed risk = 0.007319002692699431
number samples = 730
accuracy = 0.912329
precision class 0 = 0.913408
precision class 1 = 0.857143
recall class 0 = 0.996951
recall class 1 = 0.162162
false negative rate = 0.837838
false positive rate = 0.003049
positive prediction rate = 0.019178
AUC of ROC = 0.820184
AUC of PRC = 0.44915
min(+P, Se) = 0.418919

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11166299879550934
difference in average predicted and observed risk = -0.01399100120449065
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.924152
AUC of PRC = 0.759632
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2459   15]
 [ 219   36]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09753099828958511
difference in average predicted and observed risk = 0.004089998289585117
number samples = 2729
accuracy = 0.914254
precision class 0 = 0.918223
precision class 1 = 0.705882
recall class 0 = 0.993937
recall class 1 = 0.141176
false negative rate = 0.858824
false positive rate = 0.006063
positive prediction rate = 0.018688
AUC of ROC = 0.820703
AUC of PRC = 0.401249
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1675    8]
 [ 177   39]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11086300015449524
difference in average predicted and observed risk = -0.0028809998455047586
number samples = 1899
accuracy = 0.90258
precision class 0 = 0.904428
precision class 1 = 0.829787
recall class 0 = 0.995247
recall class 1 = 0.180556
false negative rate = 0.819444
false positive rate = 0.004753
positive prediction rate = 0.02475
AUC of ROC = 0.841773
AUC of PRC = 0.50354
min(+P, Se) = 0.435185

-------------------------------

confusion matrix:
[[547   2]
 [ 72   5]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11693800240755081
difference in average predicted and observed risk = -0.0060649975924491895
number samples = 626
accuracy = 0.881789
precision class 0 = 0.883683
precision class 1 = 0.714286
recall class 0 = 0.996357
recall class 1 = 0.064935
false negative rate = 0.935065
false positive rate = 0.003643
positive prediction rate = 0.011182
AUC of ROC = 0.826651
AUC of PRC = 0.433923
min(+P, Se) = 0.45122

-------------------------------

confusion matrix:
[[2241    8]
 [ 183   25]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08782000094652176
difference in average predicted and observed risk = 0.003164000946521764
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.924505
precision class 1 = 0.757576
recall class 0 = 0.996443
recall class 1 = 0.120192
false negative rate = 0.879808
false positive rate = 0.003557
positive prediction rate = 0.013431
AUC of ROC = 0.826453
AUC of PRC = 0.384255
min(+P, Se) = 0.370192

-------------------------------

confusion matrix:
[[221   2]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.1098560020327568
difference in average predicted and observed risk = 0.009050002032756799
number samples = 248
accuracy = 0.891129
precision class 0 = 0.898374
precision class 1 = 0.0
recall class 0 = 0.991031
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.008969
positive prediction rate = 0.008065
AUC of ROC = 0.757848
AUC of PRC = 0.247804
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[476   5]
 [ 53  29]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14004600048065186
difference in average predicted and observed risk = -0.005601999519348144
number samples = 563
accuracy = 0.89698
precision class 0 = 0.899811
precision class 1 = 0.852941
recall class 0 = 0.989605
recall class 1 = 0.353659
false negative rate = 0.646341
false positive rate = 0.010395
positive prediction rate = 0.060391
AUC of ROC = 0.86522
AUC of PRC = 0.638735
min(+P, Se) = 0.52439

-------------------------------

confusion matrix:
[[649   6]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11120200157165527
difference in average predicted and observed risk = 0.003573001571655271
number samples = 734
accuracy = 0.905995
precision class 0 = 0.911517
precision class 1 = 0.727273
recall class 0 = 0.99084
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.00916
positive prediction rate = 0.029973
AUC of ROC = 0.820466
AUC of PRC = 0.459595
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4134   23]
 [ 396   75]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10300099849700928
difference in average predicted and observed risk = 0.001228998497009276
number samples = 4628
accuracy = 0.909464
precision class 0 = 0.912583
precision class 1 = 0.765306
recall class 0 = 0.994467
recall class 1 = 0.159236
false negative rate = 0.840764
false positive rate = 0.005533
positive prediction rate = 0.021175
AUC of ROC = 0.830931
AUC of PRC = 0.450155
min(+P, Se) = 0.42348

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09206199645996094
difference in average predicted and observed risk = 0.011892996459960933
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.868662
AUC of PRC = 0.406155
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09971600025892258
difference in average predicted and observed risk = -0.009079999741077427
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.821442
AUC of PRC = 0.448708
min(+P, Se) = 0.42

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12802599370479584
difference in average predicted and observed risk = 0.017856993704795834
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.925275
AUC of PRC = 0.556742
min(+P, Se) = 0.611111

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13480700552463531
difference in average predicted and observed risk = 0.0014740055246353079
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10998799651861191
difference in average predicted and observed risk = -0.0050560034813880855
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.833248
AUC of PRC = 0.372002
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0978270024061203
difference in average predicted and observed risk = 0.0057770024061202935
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.875105
AUC of PRC = 0.570513
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08354700356721878
difference in average predicted and observed risk = -0.005654996432781223
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.864148
AUC of PRC = 0.499143
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12492399662733078
difference in average predicted and observed risk = 0.0072769966273307785
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.942593
AUC of PRC = 0.691011
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11321700364351273
difference in average predicted and observed risk = 0.02450700364351273
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.851971
AUC of PRC = 0.257705
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12528599798679352
difference in average predicted and observed risk = -0.02432000201320647
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.809942
AUC of PRC = 0.576502
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.15167999267578125
difference in average predicted and observed risk = 0.07273299267578125
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.518849
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[731   3]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10287299752235413
difference in average predicted and observed risk = 0.0012819975223541252
number samples = 817
accuracy = 0.909425
precision class 0 = 0.911471
precision class 1 = 0.8
recall class 0 = 0.995913
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.004087
positive prediction rate = 0.01836
AUC of ROC = 0.85923
AUC of PRC = 0.494399
min(+P, Se) = 0.482353

-------------------------------

Epoch 00047: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch47.state
Epoch 48/100
 - 317s - loss: 0.2712 - val_loss: 0.2425

==>predicting on train



confusion matrix:
[[2139   16]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0916379988193512
difference in average predicted and observed risk = -0.014171001180648804
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.909052
precision class 1 = 0.719298
recall class 0 = 0.992575
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.007425
positive prediction rate = 0.023651
AUC of ROC = 0.827339
AUC of PRC = 0.446494
min(+P, Se) = 0.43295

-------------------------------

confusion matrix:
[[1167   12]
 [ 103   15]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0872189998626709
difference in average predicted and observed risk = -0.003760000137329106
number samples = 1297
accuracy = 0.911334
precision class 0 = 0.918898
precision class 1 = 0.555556
recall class 0 = 0.989822
recall class 1 = 0.127119
false negative rate = 0.872881
false positive rate = 0.010178
positive prediction rate = 0.020817
AUC of ROC = 0.838997
AUC of PRC = 0.39123
min(+P, Se) = 0.386555

-------------------------------

confusion matrix:
[[652   4]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09756799787282944
difference in average predicted and observed risk = -0.0038020021271705645
number samples = 730
accuracy = 0.912329
precision class 0 = 0.91573
precision class 1 = 0.777778
recall class 0 = 0.993902
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.006098
positive prediction rate = 0.024658
AUC of ROC = 0.839445
AUC of PRC = 0.46467
min(+P, Se) = 0.44

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10641899704933167
difference in average predicted and observed risk = -0.019235002950668323
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.931637
AUC of PRC = 0.768682
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2456   18]
 [ 217   38]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08602999895811081
difference in average predicted and observed risk = -0.007411001041889187
number samples = 2729
accuracy = 0.913888
precision class 0 = 0.918818
precision class 1 = 0.678571
recall class 0 = 0.992724
recall class 1 = 0.14902
false negative rate = 0.85098
false positive rate = 0.007276
positive prediction rate = 0.02052
AUC of ROC = 0.830288
AUC of PRC = 0.408347
min(+P, Se) = 0.407692

-------------------------------

confusion matrix:
[[1667   16]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10044500231742859
difference in average predicted and observed risk = -0.013298997682571409
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905978
precision class 1 = 0.728814
recall class 0 = 0.990493
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.009507
positive prediction rate = 0.031069
AUC of ROC = 0.845445
AUC of PRC = 0.505478
min(+P, Se) = 0.445415

-------------------------------

confusion matrix:
[[544   5]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10554300248622894
difference in average predicted and observed risk = -0.01745999751377106
number samples = 626
accuracy = 0.881789
precision class 0 = 0.887439
precision class 1 = 0.615385
recall class 0 = 0.990893
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.009107
positive prediction rate = 0.020767
AUC of ROC = 0.831666
AUC of PRC = 0.428505
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2240    9]
 [ 183   25]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07732299715280533
difference in average predicted and observed risk = -0.007333002847194667
number samples = 2457
accuracy = 0.921856
precision class 0 = 0.924474
precision class 1 = 0.735294
recall class 0 = 0.995998
recall class 1 = 0.120192
false negative rate = 0.879808
false positive rate = 0.004002
positive prediction rate = 0.013838
AUC of ROC = 0.837169
AUC of PRC = 0.395258
min(+P, Se) = 0.394231

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09738200157880783
difference in average predicted and observed risk = -0.003423998421192176
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.739013
AUC of PRC = 0.241594
min(+P, Se) = 0.322581

-------------------------------

confusion matrix:
[[473   8]
 [ 52  30]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12907999753952026
difference in average predicted and observed risk = -0.016568002460479736
number samples = 563
accuracy = 0.893428
precision class 0 = 0.900952
precision class 1 = 0.789474
recall class 0 = 0.983368
recall class 1 = 0.365854
false negative rate = 0.634146
false positive rate = 0.016632
positive prediction rate = 0.067496
AUC of ROC = 0.867426
AUC of PRC = 0.639969
min(+P, Se) = 0.559524

-------------------------------

confusion matrix:
[[648   7]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09897299855947495
difference in average predicted and observed risk = -0.008656001440525057
number samples = 734
accuracy = 0.907357
precision class 0 = 0.913963
precision class 1 = 0.72
recall class 0 = 0.989313
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.010687
positive prediction rate = 0.03406
AUC of ROC = 0.829761
AUC of PRC = 0.472616
min(+P, Se) = 0.45679

-------------------------------

confusion matrix:
[[4123   34]
 [ 390   81]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09194499999284744
difference in average predicted and observed risk = -0.009827000007152559
number samples = 4628
accuracy = 0.908384
precision class 0 = 0.913583
precision class 1 = 0.704348
recall class 0 = 0.991821
recall class 1 = 0.171975
false negative rate = 0.828025
false positive rate = 0.008179
positive prediction rate = 0.024849
AUC of ROC = 0.83771
AUC of PRC = 0.454892
min(+P, Se) = 0.430672

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08510500192642212
difference in average predicted and observed risk = 0.004936001926422115
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.882907
AUC of PRC = 0.424515
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08572600036859512
difference in average predicted and observed risk = -0.02306999963140488
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.820834
AUC of PRC = 0.428476
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1171410009264946
difference in average predicted and observed risk = 0.006972000926494595
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.92381
AUC of PRC = 0.604714
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12430600076913834
difference in average predicted and observed risk = -0.009026999230861671
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09827200323343277
difference in average predicted and observed risk = -0.016771996766567224
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.836923
AUC of PRC = 0.391131
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08669699728488922
difference in average predicted and observed risk = -0.005353002715110786
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.875628
AUC of PRC = 0.557114
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0736669972538948
difference in average predicted and observed risk = -0.015535002746105198
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.864555
AUC of PRC = 0.494455
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11658299714326859
difference in average predicted and observed risk = -0.0010640028567314164
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.936111
AUC of PRC = 0.66671
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09729500114917755
difference in average predicted and observed risk = 0.008585001149177554
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.865648
AUC of PRC = 0.282873
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11333300173282623
difference in average predicted and observed risk = -0.036272998267173756
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.823099
AUC of PRC = 0.555955
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13221199810504913
difference in average predicted and observed risk = 0.05326499810504913
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.551786
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[730   4]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09149999916553497
difference in average predicted and observed risk = -0.010091000834465028
number samples = 817
accuracy = 0.909425
precision class 0 = 0.9125
precision class 1 = 0.764706
recall class 0 = 0.99455
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.00545
positive prediction rate = 0.020808
AUC of ROC = 0.861659
AUC of PRC = 0.484543
min(+P, Se) = 0.457831

-------------------------------

Epoch 00048: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch48.state
Epoch 49/100
 - 319s - loss: 0.2653 - val_loss: 0.2403

==>predicting on train



confusion matrix:
[[2134   21]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08131299912929535
difference in average predicted and observed risk = -0.02449600087070465
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.912746
precision class 1 = 0.708333
recall class 0 = 0.990255
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.009745
positive prediction rate = 0.029876
AUC of ROC = 0.829365
AUC of PRC = 0.454151
min(+P, Se) = 0.424125

-------------------------------

confusion matrix:
[[1163   16]
 [  90   28]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07866799831390381
difference in average predicted and observed risk = -0.012311001686096196
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.928172
precision class 1 = 0.636364
recall class 0 = 0.986429
recall class 1 = 0.237288
false negative rate = 0.762712
false positive rate = 0.013571
positive prediction rate = 0.033924
AUC of ROC = 0.841276
AUC of PRC = 0.398933
min(+P, Se) = 0.386555

-------------------------------

confusion matrix:
[[645  11]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08885800093412399
difference in average predicted and observed risk = -0.012511999065876009
number samples = 730
accuracy = 0.906849
precision class 0 = 0.918803
precision class 1 = 0.607143
recall class 0 = 0.983232
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.016768
positive prediction rate = 0.038356
AUC of ROC = 0.836416
AUC of PRC = 0.465165
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10459200292825699
difference in average predicted and observed risk = -0.021061997071743
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.925399
AUC of PRC = 0.758878
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2447   27]
 [ 196   59]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0764790028333664
difference in average predicted and observed risk = -0.016961997166633602
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.925842
precision class 1 = 0.686047
recall class 0 = 0.989087
recall class 1 = 0.231373
false negative rate = 0.768627
false positive rate = 0.010914
positive prediction rate = 0.031513
AUC of ROC = 0.831073
AUC of PRC = 0.418335
min(+P, Se) = 0.401544

-------------------------------

confusion matrix:
[[1660   23]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09169500321149826
difference in average predicted and observed risk = -0.022048996788501737
number samples = 1899
accuracy = 0.899421
precision class 0 = 0.908096
precision class 1 = 0.676056
recall class 0 = 0.986334
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.013666
positive prediction rate = 0.037388
AUC of ROC = 0.846402
AUC of PRC = 0.507467
min(+P, Se) = 0.438914

-------------------------------

confusion matrix:
[[540   9]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10007599741220474
difference in average predicted and observed risk = -0.02292700258779526
number samples = 626
accuracy = 0.886581
precision class 0 = 0.89701
precision class 1 = 0.625
recall class 0 = 0.983607
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.016393
positive prediction rate = 0.038339
AUC of ROC = 0.838218
AUC of PRC = 0.441776
min(+P, Se) = 0.436782

-------------------------------

confusion matrix:
[[2233   16]
 [ 175   33]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06504400074481964
difference in average predicted and observed risk = -0.019611999255180354
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.927326
precision class 1 = 0.673469
recall class 0 = 0.992886
recall class 1 = 0.158654
false negative rate = 0.841346
false positive rate = 0.007114
positive prediction rate = 0.019943
AUC of ROC = 0.837718
AUC of PRC = 0.397522
min(+P, Se) = 0.382775

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0856110006570816
difference in average predicted and observed risk = -0.015194999342918403
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.741704
AUC of PRC = 0.235702
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[470  11]
 [ 46  36]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12829600274562836
difference in average predicted and observed risk = -0.017351997254371643
number samples = 563
accuracy = 0.898757
precision class 0 = 0.910853
precision class 1 = 0.765957
recall class 0 = 0.977131
recall class 1 = 0.439024
false negative rate = 0.560976
false positive rate = 0.022869
positive prediction rate = 0.083481
AUC of ROC = 0.871279
AUC of PRC = 0.651674
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[646   9]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09116800129413605
difference in average predicted and observed risk = -0.016460998705863955
number samples = 734
accuracy = 0.908719
precision class 0 = 0.917614
precision class 1 = 0.7
recall class 0 = 0.98626
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.01374
positive prediction rate = 0.040872
AUC of ROC = 0.82895
AUC of PRC = 0.468682
min(+P, Se) = 0.468354

-------------------------------

confusion matrix:
[[4107   50]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0827220007777214
difference in average predicted and observed risk = -0.019049999222278596
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.918586
precision class 1 = 0.681529
recall class 0 = 0.987972
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.012028
positive prediction rate = 0.033924
AUC of ROC = 0.838665
AUC of PRC = 0.459861
min(+P, Se) = 0.424947

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07458899915218353
difference in average predicted and observed risk = -0.005580000847816471
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.885563
AUC of PRC = 0.412747
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0755390003323555
difference in average predicted and observed risk = -0.033256999667644505
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.826692
AUC of PRC = 0.440383
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.112185999751091
difference in average predicted and observed risk = 0.0020169997510910004
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.92381
AUC of PRC = 0.678147
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12329400330781937
difference in average predicted and observed risk = -0.01003899669218064
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08939500153064728
difference in average predicted and observed risk = -0.025648998469352716
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.836581
AUC of PRC = 0.401163
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07728499919176102
difference in average predicted and observed risk = -0.01476500080823899
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.87788
AUC of PRC = 0.562236
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.062408000230789185
difference in average predicted and observed risk = -0.02679399976921082
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.874864
AUC of PRC = 0.492569
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11386299878358841
difference in average predicted and observed risk = -0.003784001216411592
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.941667
AUC of PRC = 0.685708
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08868599683046341
difference in average predicted and observed risk = -2.4003169536587765e-05
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.854385
AUC of PRC = 0.263518
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10579799860715866
difference in average predicted and observed risk = -0.04380800139284133
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.823587
AUC of PRC = 0.592894
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12142699956893921
difference in average predicted and observed risk = 0.042479999568939206
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.933333
AUC of PRC = 0.568651
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08230999857187271
difference in average predicted and observed risk = -0.01928100142812729
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.863416
AUC of PRC = 0.495204
min(+P, Se) = 0.494118

-------------------------------

Epoch 00049: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch49.state
Epoch 50/100
 - 314s - loss: 0.2659 - val_loss: 0.2395

==>predicting on train



confusion matrix:
[[2137   18]
 [ 211   44]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09873100370168686
difference in average predicted and observed risk = -0.007077996298313141
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.910136
precision class 1 = 0.709677
recall class 0 = 0.991647
recall class 1 = 0.172549
false negative rate = 0.827451
false positive rate = 0.008353
positive prediction rate = 0.025726
AUC of ROC = 0.827513
AUC of PRC = 0.449024
min(+P, Se) = 0.429688

-------------------------------

confusion matrix:
[[1168   11]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09040100127458572
difference in average predicted and observed risk = -0.0005779987254142804
number samples = 1297
accuracy = 0.915189
precision class 0 = 0.921863
precision class 1 = 0.633333
recall class 0 = 0.99067
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.00933
positive prediction rate = 0.02313
AUC of ROC = 0.84505
AUC of PRC = 0.422057
min(+P, Se) = 0.391667

-------------------------------

confusion matrix:
[[651   5]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10101199895143509
difference in average predicted and observed risk = -0.00035800104856491266
number samples = 730
accuracy = 0.909589
precision class 0 = 0.914326
precision class 1 = 0.722222
recall class 0 = 0.992378
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.007622
positive prediction rate = 0.024658
AUC of ROC = 0.832296
AUC of PRC = 0.461868
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1171249970793724
difference in average predicted and observed risk = -0.008529002920627582
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.922904
AUC of PRC = 0.765286
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2455   19]
 [ 211   44]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08855900168418884
difference in average predicted and observed risk = -0.0048819983158111535
number samples = 2729
accuracy = 0.91572
precision class 0 = 0.920855
precision class 1 = 0.698413
recall class 0 = 0.99232
recall class 1 = 0.172549
false negative rate = 0.827451
false positive rate = 0.00768
positive prediction rate = 0.023085
AUC of ROC = 0.828828
AUC of PRC = 0.413762
min(+P, Se) = 0.410156

-------------------------------

confusion matrix:
[[1666   17]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11038699746131897
difference in average predicted and observed risk = -0.003357002538681028
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.905927
precision class 1 = 0.716667
recall class 0 = 0.989899
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.010101
positive prediction rate = 0.031596
AUC of ROC = 0.849074
AUC of PRC = 0.511544
min(+P, Se) = 0.454936

-------------------------------

confusion matrix:
[[543   6]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11529099941253662
difference in average predicted and observed risk = -0.00771200058746338
number samples = 626
accuracy = 0.880192
precision class 0 = 0.887255
precision class 1 = 0.571429
recall class 0 = 0.989071
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.010929
positive prediction rate = 0.022364
AUC of ROC = 0.831287
AUC of PRC = 0.44515
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[2240    9]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08154699951410294
difference in average predicted and observed risk = -0.0031090004858970594
number samples = 2457
accuracy = 0.923891
precision class 0 = 0.926385
precision class 1 = 0.769231
recall class 0 = 0.995998
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.004002
positive prediction rate = 0.015873
AUC of ROC = 0.837349
AUC of PRC = 0.397494
min(+P, Se) = 0.376147

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10682199895381927
difference in average predicted and observed risk = 0.006015998953819268
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.748341
AUC of PRC = 0.242741
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[473   8]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1344670057296753
difference in average predicted and observed risk = -0.011180994270324707
number samples = 563
accuracy = 0.89698
precision class 0 = 0.904398
precision class 1 = 0.8
recall class 0 = 0.983368
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.016632
positive prediction rate = 0.071048
AUC of ROC = 0.867755
AUC of PRC = 0.644599
min(+P, Se) = 0.551724

-------------------------------

confusion matrix:
[[647   8]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10432200133800507
difference in average predicted and observed risk = -0.0033069986619949365
number samples = 734
accuracy = 0.904632
precision class 0 = 0.912553
precision class 1 = 0.68
recall class 0 = 0.987786
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.012214
positive prediction rate = 0.03406
AUC of ROC = 0.828177
AUC of PRC = 0.474402
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4121   36]
 [ 384   87]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09751500189304352
difference in average predicted and observed risk = -0.004256998106956483
number samples = 4628
accuracy = 0.909248
precision class 0 = 0.914761
precision class 1 = 0.707317
recall class 0 = 0.99134
recall class 1 = 0.184713
false negative rate = 0.815287
false positive rate = 0.00866
positive prediction rate = 0.026577
AUC of ROC = 0.838016
AUC of PRC = 0.460151
min(+P, Se) = 0.437367

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08737300336360931
difference in average predicted and observed risk = 0.00720400336360931
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.885321
AUC of PRC = 0.411223
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09371399879455566
difference in average predicted and observed risk = -0.01508200120544434
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.824095
AUC of PRC = 0.447104
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11715000122785568
difference in average predicted and observed risk = 0.006981001227855679
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.920879
AUC of PRC = 0.608933
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13622500002384186
difference in average predicted and observed risk = 0.002892000023841851
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10784400254487991
difference in average predicted and observed risk = -0.00719999745512008
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.835043
AUC of PRC = 0.396355
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[432   2]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08900299668312073
difference in average predicted and observed risk = -0.0030470033168792793
number samples = 478
accuracy = 0.924686
precision class 0 = 0.927039
precision class 1 = 0.833333
recall class 0 = 0.995392
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.004608
positive prediction rate = 0.025105
AUC of ROC = 0.878561
AUC of PRC = 0.570631
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07858800143003464
difference in average predicted and observed risk = -0.010613998569965366
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.869167
AUC of PRC = 0.493368
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11811000108718872
difference in average predicted and observed risk = 0.00046300108718871913
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.940741
AUC of PRC = 0.695625
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1064700037240982
difference in average predicted and observed risk = 0.01776000372409821
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.86243
AUC of PRC = 0.264244
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11790599673986435
difference in average predicted and observed risk = -0.03170000326013564
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.814327
AUC of PRC = 0.547547
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14212100207805634
difference in average predicted and observed risk = 0.06317400207805633
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.551786
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[730   4]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09682100266218185
difference in average predicted and observed risk = -0.0047699973378181465
number samples = 817
accuracy = 0.910649
precision class 0 = 0.913642
precision class 1 = 0.777778
recall class 0 = 0.99455
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.00545
positive prediction rate = 0.022032
AUC of ROC = 0.862595
AUC of PRC = 0.493925
min(+P, Se) = 0.493976

-------------------------------

Epoch 00050: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch50.state
Epoch 51/100
 - 312s - loss: 0.2644 - val_loss: 0.2385

==>predicting on train



confusion matrix:
[[2140   15]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08591199666261673
difference in average predicted and observed risk = -0.01989700333738327
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.909091
precision class 1 = 0.732143
recall class 0 = 0.993039
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.006961
positive prediction rate = 0.023237
AUC of ROC = 0.825557
AUC of PRC = 0.455668
min(+P, Se) = 0.414062

-------------------------------

confusion matrix:
[[1169   10]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07816199958324432
difference in average predicted and observed risk = -0.01281700041675568
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.919748
precision class 1 = 0.615385
recall class 0 = 0.991518
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.008482
positive prediction rate = 0.020046
AUC of ROC = 0.845193
AUC of PRC = 0.42619
min(+P, Se) = 0.408

-------------------------------

confusion matrix:
[[654   2]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.086497001349926
difference in average predicted and observed risk = -0.014872998650074007
number samples = 730
accuracy = 0.913699
precision class 0 = 0.914685
precision class 1 = 0.866667
recall class 0 = 0.996951
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.003049
positive prediction rate = 0.020548
AUC of ROC = 0.833532
AUC of PRC = 0.468578
min(+P, Se) = 0.44

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09865099936723709
difference in average predicted and observed risk = -0.027003000632762897
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.927146
AUC of PRC = 0.76354
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2457   17]
 [ 216   39]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07844000309705734
difference in average predicted and observed risk = -0.015000996902942654
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.919192
precision class 1 = 0.696429
recall class 0 = 0.993129
recall class 1 = 0.152941
false negative rate = 0.847059
false positive rate = 0.006871
positive prediction rate = 0.02052
AUC of ROC = 0.827278
AUC of PRC = 0.419568
min(+P, Se) = 0.411765

-------------------------------

confusion matrix:
[[1671   12]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09286200255155563
difference in average predicted and observed risk = -0.020881997448444364
number samples = 1899
accuracy = 0.902054
precision class 0 = 0.905691
precision class 1 = 0.777778
recall class 0 = 0.99287
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.00713
positive prediction rate = 0.028436
AUC of ROC = 0.848897
AUC of PRC = 0.514297
min(+P, Se) = 0.468182

-------------------------------

confusion matrix:
[[545   4]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09475699812173843
difference in average predicted and observed risk = -0.028246001878261567
number samples = 626
accuracy = 0.883387
precision class 0 = 0.887622
precision class 1 = 0.666667
recall class 0 = 0.992714
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.007286
positive prediction rate = 0.019169
AUC of ROC = 0.835663
AUC of PRC = 0.446698
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2241    8]
 [ 181   27]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07195500284433365
difference in average predicted and observed risk = -0.012700997155666346
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.925268
precision class 1 = 0.771429
recall class 0 = 0.996443
recall class 1 = 0.129808
false negative rate = 0.870192
false positive rate = 0.003557
positive prediction rate = 0.014245
AUC of ROC = 0.834907
AUC of PRC = 0.404277
min(+P, Se) = 0.382775

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08873400092124939
difference in average predicted and observed risk = -0.012071999078750617
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.744036
AUC of PRC = 0.240886
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[475   6]
 [ 53  29]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11825499683618546
difference in average predicted and observed risk = -0.027393003163814544
number samples = 563
accuracy = 0.895204
precision class 0 = 0.899621
precision class 1 = 0.828571
recall class 0 = 0.987526
recall class 1 = 0.353659
false negative rate = 0.646341
false positive rate = 0.012474
positive prediction rate = 0.062167
AUC of ROC = 0.876173
AUC of PRC = 0.659498
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[648   7]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08952700346708298
difference in average predicted and observed risk = -0.018101996532917025
number samples = 734
accuracy = 0.905995
precision class 0 = 0.912676
precision class 1 = 0.708333
recall class 0 = 0.989313
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.010687
positive prediction rate = 0.032698
AUC of ROC = 0.822031
AUC of PRC = 0.454841
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4128   29]
 [ 390   81]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08435799926519394
difference in average predicted and observed risk = -0.017414000734806062
number samples = 4628
accuracy = 0.909464
precision class 0 = 0.913679
precision class 1 = 0.736364
recall class 0 = 0.993024
recall class 1 = 0.171975
false negative rate = 0.828025
false positive rate = 0.006976
positive prediction rate = 0.023768
AUC of ROC = 0.837751
AUC of PRC = 0.465448
min(+P, Se) = 0.428875

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07590799778699875
difference in average predicted and observed risk = -0.004261002213001255
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.883148
AUC of PRC = 0.416422
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07933700084686279
difference in average predicted and observed risk = -0.02945899915313721
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.832661
AUC of PRC = 0.458101
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1041480004787445
difference in average predicted and observed risk = -0.006020999521255496
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.92674
AUC of PRC = 0.55025
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11944799870252609
difference in average predicted and observed risk = -0.013885001297473915
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.0910789966583252
difference in average predicted and observed risk = -0.023965003341674798
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.851368
AUC of PRC = 0.390202
min(+P, Se) = 0.44186

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07795199751853943
difference in average predicted and observed risk = -0.014098002481460578
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.877671
AUC of PRC = 0.563353
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06796199828386307
difference in average predicted and observed risk = -0.021240001716136936
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.874661
AUC of PRC = 0.499497
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10029199719429016
difference in average predicted and observed risk = -0.01735500280570984
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.946296
AUC of PRC = 0.705635
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08780399709939957
difference in average predicted and observed risk = -0.0009060029006004305
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.859212
AUC of PRC = 0.265347
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1050029993057251
difference in average predicted and observed risk = -0.04460300069427489
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.823587
AUC of PRC = 0.570268
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12452799826860428
difference in average predicted and observed risk = 0.045580998268604275
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08339899778366089
difference in average predicted and observed risk = -0.018192002216339112
number samples = 817
accuracy = 0.908201
precision class 0 = 0.910336
precision class 1 = 0.785714
recall class 0 = 0.995913
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.004087
positive prediction rate = 0.017136
AUC of ROC = 0.869128
AUC of PRC = 0.499221
min(+P, Se) = 0.493976

-------------------------------

Epoch 00051: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch51.state
Epoch 52/100
 - 326s - loss: 0.2612 - val_loss: 0.2407

==>predicting on train



confusion matrix:
[[2139   16]
 [ 215   40]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09461899846792221
difference in average predicted and observed risk = -0.01119000153207779
number samples = 2410
accuracy = 0.904149
precision class 0 = 0.908666
precision class 1 = 0.714286
recall class 0 = 0.992575
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.007425
positive prediction rate = 0.023237
AUC of ROC = 0.833269
AUC of PRC = 0.463597
min(+P, Se) = 0.444867

-------------------------------

confusion matrix:
[[1168   11]
 [ 101   17]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08798299729824066
difference in average predicted and observed risk = -0.0029960027017593427
number samples = 1297
accuracy = 0.913647
precision class 0 = 0.92041
precision class 1 = 0.607143
recall class 0 = 0.99067
recall class 1 = 0.144068
false negative rate = 0.855932
false positive rate = 0.00933
positive prediction rate = 0.021588
AUC of ROC = 0.844532
AUC of PRC = 0.42335
min(+P, Se) = 0.41129

-------------------------------

confusion matrix:
[[653   3]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09673900157213211
difference in average predicted and observed risk = -0.004630998427867891
number samples = 730
accuracy = 0.913699
precision class 0 = 0.915849
precision class 1 = 0.823529
recall class 0 = 0.995427
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.004573
positive prediction rate = 0.023288
AUC of ROC = 0.840907
AUC of PRC = 0.478792
min(+P, Se) = 0.460526

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10799600183963776
difference in average predicted and observed risk = -0.01765799816036223
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.933633
AUC of PRC = 0.780601
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2457   17]
 [ 214   41]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0863649994134903
difference in average predicted and observed risk = -0.007076000586509701
number samples = 2729
accuracy = 0.915354
precision class 0 = 0.91988
precision class 1 = 0.706897
recall class 0 = 0.993129
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.006871
positive prediction rate = 0.021253
AUC of ROC = 0.83347
AUC of PRC = 0.424963
min(+P, Se) = 0.423529

-------------------------------

confusion matrix:
[[1668   15]
 [ 175   41]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10410799831151962
difference in average predicted and observed risk = -0.009636001688480375
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.905046
precision class 1 = 0.732143
recall class 0 = 0.991087
recall class 1 = 0.189815
false negative rate = 0.810185
false positive rate = 0.008913
positive prediction rate = 0.029489
AUC of ROC = 0.853318
AUC of PRC = 0.518826
min(+P, Se) = 0.470046

-------------------------------

confusion matrix:
[[544   5]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10430499911308289
difference in average predicted and observed risk = -0.018698000886917115
number samples = 626
accuracy = 0.880192
precision class 0 = 0.885993
precision class 1 = 0.583333
recall class 0 = 0.990893
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.009107
positive prediction rate = 0.019169
AUC of ROC = 0.838431
AUC of PRC = 0.448102
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2241    8]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0808899998664856
difference in average predicted and observed risk = -0.0037660001335143994
number samples = 2457
accuracy = 0.923891
precision class 0 = 0.926033
precision class 1 = 0.783784
recall class 0 = 0.996443
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.003557
positive prediction rate = 0.015059
AUC of ROC = 0.842819
AUC of PRC = 0.417378
min(+P, Se) = 0.403846

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09694100171327591
difference in average predicted and observed risk = -0.0038649982867240973
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.745112
AUC of PRC = 0.242658
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[474   7]
 [ 54  28]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12859000265598297
difference in average predicted and observed risk = -0.01705799734401703
number samples = 563
accuracy = 0.891652
precision class 0 = 0.897727
precision class 1 = 0.8
recall class 0 = 0.985447
recall class 1 = 0.341463
false negative rate = 0.658537
false positive rate = 0.014553
positive prediction rate = 0.062167
AUC of ROC = 0.874119
AUC of PRC = 0.654634
min(+P, Se) = 0.585366

-------------------------------

confusion matrix:
[[647   8]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09933499991893768
difference in average predicted and observed risk = -0.00829400008106232
number samples = 734
accuracy = 0.905995
precision class 0 = 0.913842
precision class 1 = 0.692308
recall class 0 = 0.987786
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.012214
positive prediction rate = 0.035422
AUC of ROC = 0.829143
AUC of PRC = 0.464828
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4125   32]
 [ 389   82]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09364599734544754
difference in average predicted and observed risk = -0.008126002654552461
number samples = 4628
accuracy = 0.909032
precision class 0 = 0.913824
precision class 1 = 0.719298
recall class 0 = 0.992302
recall class 1 = 0.174098
false negative rate = 0.825902
false positive rate = 0.007698
positive prediction rate = 0.024633
AUC of ROC = 0.842767
AUC of PRC = 0.470462
min(+P, Se) = 0.451271

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08563300222158432
difference in average predicted and observed risk = 0.005464002221584316
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.887494
AUC of PRC = 0.415026
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08758299797773361
difference in average predicted and observed risk = -0.021213002022266392
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.831169
AUC of PRC = 0.473995
min(+P, Se) = 0.45614

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11274199932813644
difference in average predicted and observed risk = 0.002572999328136441
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.92967
AUC of PRC = 0.607303
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1280509978532791
difference in average predicted and observed risk = -0.005282002146720893
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10069900006055832
difference in average predicted and observed risk = -0.014344999939441674
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.843162
AUC of PRC = 0.410824
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08606500178575516
difference in average predicted and observed risk = -0.005984998214244849
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.881755
AUC of PRC = 0.570301
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07667800039052963
difference in average predicted and observed risk = -0.012523999609470371
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.868353
AUC of PRC = 0.506421
min(+P, Se) = 0.447368

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11343300342559814
difference in average predicted and observed risk = -0.004213996574401857
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.948148
AUC of PRC = 0.712176
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0941459983587265
difference in average predicted and observed risk = 0.005435998358726504
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.861625
AUC of PRC = 0.261943
min(+P, Se) = 0.296296

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11531800031661987
difference in average predicted and observed risk = -0.034287999683380116
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.82846
AUC of PRC = 0.575511
min(+P, Se) = 0.619048

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12425199896097183
difference in average predicted and observed risk = 0.04530499896097183
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09213700145483017
difference in average predicted and observed risk = -0.009453998545169831
number samples = 817
accuracy = 0.911873
precision class 0 = 0.91375
precision class 1 = 0.823529
recall class 0 = 0.995913
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.004087
positive prediction rate = 0.020808
AUC of ROC = 0.867585
AUC of PRC = 0.502756
min(+P, Se) = 0.488095

-------------------------------

Epoch 00052: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch52.state
Epoch 53/100
 - 325s - loss: 0.2625 - val_loss: 0.2374

==>predicting on train



confusion matrix:
[[2137   18]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09337799996137619
difference in average predicted and observed risk = -0.01243100003862381
number samples = 2410
accuracy = 0.903734
precision class 0 = 0.908975
precision class 1 = 0.694915
recall class 0 = 0.991647
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.008353
positive prediction rate = 0.024481
AUC of ROC = 0.833589
AUC of PRC = 0.459898
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[1170    9]
 [ 102   16]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08516199886798859
difference in average predicted and observed risk = -0.005817001132011418
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.919811
precision class 1 = 0.64
recall class 0 = 0.992366
recall class 1 = 0.135593
false negative rate = 0.864407
false positive rate = 0.007634
positive prediction rate = 0.019275
AUC of ROC = 0.849089
AUC of PRC = 0.422346
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[653   3]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09254799783229828
difference in average predicted and observed risk = -0.008822002167701723
number samples = 730
accuracy = 0.912329
precision class 0 = 0.914566
precision class 1 = 0.8125
recall class 0 = 0.995427
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.004573
positive prediction rate = 0.021918
AUC of ROC = 0.845439
AUC of PRC = 0.460558
min(+P, Se) = 0.426667

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10585200041532516
difference in average predicted and observed risk = -0.019801999584674823
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.939122
AUC of PRC = 0.771729
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2458   16]
 [ 218   37]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08373399823904037
difference in average predicted and observed risk = -0.009707001760959622
number samples = 2729
accuracy = 0.914254
precision class 0 = 0.918535
precision class 1 = 0.698113
recall class 0 = 0.993533
recall class 1 = 0.145098
false negative rate = 0.854902
false positive rate = 0.006467
positive prediction rate = 0.019421
AUC of ROC = 0.836786
AUC of PRC = 0.423341
min(+P, Se) = 0.396078

-------------------------------

confusion matrix:
[[1667   16]
 [ 172   44]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10256200283765793
difference in average predicted and observed risk = -0.01118199716234207
number samples = 1899
accuracy = 0.901
precision class 0 = 0.906471
precision class 1 = 0.733333
recall class 0 = 0.990493
recall class 1 = 0.203704
false negative rate = 0.796296
false positive rate = 0.009507
positive prediction rate = 0.031596
AUC of ROC = 0.853302
AUC of PRC = 0.515058
min(+P, Se) = 0.477477

-------------------------------

confusion matrix:
[[543   6]
 [ 67  10]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10146699845790863
difference in average predicted and observed risk = -0.02153600154209137
number samples = 626
accuracy = 0.883387
precision class 0 = 0.890164
precision class 1 = 0.625
recall class 0 = 0.989071
recall class 1 = 0.12987
false negative rate = 0.87013
false positive rate = 0.010929
positive prediction rate = 0.025559
AUC of ROC = 0.835498
AUC of PRC = 0.443047
min(+P, Se) = 0.448718

-------------------------------

confusion matrix:
[[2240    9]
 [ 183   25]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0791729986667633
difference in average predicted and observed risk = -0.0054830013332366895
number samples = 2457
accuracy = 0.921856
precision class 0 = 0.924474
precision class 1 = 0.735294
recall class 0 = 0.995998
recall class 1 = 0.120192
false negative rate = 0.879808
false positive rate = 0.004002
positive prediction rate = 0.013838
AUC of ROC = 0.842701
AUC of PRC = 0.409892
min(+P, Se) = 0.394231

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09500899910926819
difference in average predicted and observed risk = -0.005797000890731818
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.766816
AUC of PRC = 0.252305
min(+P, Se) = 0.357143

-------------------------------

confusion matrix:
[[475   6]
 [ 53  29]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12479300051927567
difference in average predicted and observed risk = -0.020854999480724334
number samples = 563
accuracy = 0.895204
precision class 0 = 0.899621
precision class 1 = 0.828571
recall class 0 = 0.987526
recall class 1 = 0.353659
false negative rate = 0.646341
false positive rate = 0.012474
positive prediction rate = 0.062167
AUC of ROC = 0.879139
AUC of PRC = 0.652878
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[648   7]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09728500247001648
difference in average predicted and observed risk = -0.010343997529983523
number samples = 734
accuracy = 0.905995
precision class 0 = 0.912676
precision class 1 = 0.708333
recall class 0 = 0.989313
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.010687
positive prediction rate = 0.032698
AUC of ROC = 0.833027
AUC of PRC = 0.47128
min(+P, Se) = 0.45122

-------------------------------

confusion matrix:
[[4125   32]
 [ 390   81]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09145999699831009
difference in average predicted and observed risk = -0.010312003001689912
number samples = 4628
accuracy = 0.908816
precision class 0 = 0.913621
precision class 1 = 0.716814
recall class 0 = 0.992302
recall class 1 = 0.171975
false negative rate = 0.828025
false positive rate = 0.007698
positive prediction rate = 0.024417
AUC of ROC = 0.844894
AUC of PRC = 0.467599
min(+P, Se) = 0.437367

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08361800014972687
difference in average predicted and observed risk = 0.0034490001497268635
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.892564
AUC of PRC = 0.436439
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0874909982085228
difference in average predicted and observed risk = -0.021305001791477207
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.827521
AUC of PRC = 0.458022
min(+P, Se) = 0.448276

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1101280003786087
difference in average predicted and observed risk = -4.0999621391299423e-05
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.924542
AUC of PRC = 0.594815
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12724900245666504
difference in average predicted and observed risk = -0.006083997543334968
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1012289971113205
difference in average predicted and observed risk = -0.013815002888679498
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.836752
AUC of PRC = 0.405309
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[433   1]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0839110016822815
difference in average predicted and observed risk = -0.008138998317718513
number samples = 478
accuracy = 0.924686
precision class 0 = 0.925214
precision class 1 = 0.9
recall class 0 = 0.997696
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.002304
positive prediction rate = 0.020921
AUC of ROC = 0.888039
AUC of PRC = 0.579243
min(+P, Se) = 0.529412

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07558999955654144
difference in average predicted and observed risk = -0.01361200044345856
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.871948
AUC of PRC = 0.518454
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11223500221967697
difference in average predicted and observed risk = -0.00541199778032303
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.942593
AUC of PRC = 0.693019
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09290000051259995
difference in average predicted and observed risk = 0.004190000512599948
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.875302
AUC of PRC = 0.282695
min(+P, Se) = 0.368421

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1127920001745224
difference in average predicted and observed risk = -0.03681399982547759
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.816764
AUC of PRC = 0.564418
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12980300188064575
difference in average predicted and observed risk = 0.05085600188064575
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.496032
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09109699726104736
difference in average predicted and observed risk = -0.010494002738952637
number samples = 817
accuracy = 0.909425
precision class 0 = 0.911471
precision class 1 = 0.8
recall class 0 = 0.995913
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.004087
positive prediction rate = 0.01836
AUC of ROC = 0.868225
AUC of PRC = 0.502644
min(+P, Se) = 0.482353

-------------------------------

Epoch 00053: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch53.state
Epoch 54/100
 - 322s - loss: 0.2632 - val_loss: 0.2367

==>predicting on train



confusion matrix:
[[2140   15]
 [ 214   41]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09526299685239792
difference in average predicted and observed risk = -0.010546003147602082
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.909091
precision class 1 = 0.732143
recall class 0 = 0.993039
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.006961
positive prediction rate = 0.023237
AUC of ROC = 0.831547
AUC of PRC = 0.46006
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[1166   13]
 [  93   25]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08783400058746338
difference in average predicted and observed risk = -0.0031449994125366254
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.926132
precision class 1 = 0.657895
recall class 0 = 0.988974
recall class 1 = 0.211864
false negative rate = 0.788136
false positive rate = 0.011026
positive prediction rate = 0.029298
AUC of ROC = 0.851167
AUC of PRC = 0.420407
min(+P, Se) = 0.403361

-------------------------------

confusion matrix:
[[651   5]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09810899943113327
difference in average predicted and observed risk = -0.0032610005688667315
number samples = 730
accuracy = 0.913699
precision class 0 = 0.918195
precision class 1 = 0.761905
recall class 0 = 0.992378
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.007622
positive prediction rate = 0.028767
AUC of ROC = 0.836375
AUC of PRC = 0.464277
min(+P, Se) = 0.432432

-------------------------------

confusion matrix:
[[166   1]
 [ 14  10]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10343199968338013
difference in average predicted and observed risk = -0.02222200031661986
number samples = 191
accuracy = 0.921466
precision class 0 = 0.922222
precision class 1 = 0.909091
recall class 0 = 0.994012
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.005988
positive prediction rate = 0.057592
AUC of ROC = 0.932136
AUC of PRC = 0.75744
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2454   20]
 [ 204   51]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08943500369787216
difference in average predicted and observed risk = -0.004005996302127834
number samples = 2729
accuracy = 0.917919
precision class 0 = 0.923251
precision class 1 = 0.71831
recall class 0 = 0.991916
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.008084
positive prediction rate = 0.026017
AUC of ROC = 0.832636
AUC of PRC = 0.419295
min(+P, Se) = 0.411765

-------------------------------

confusion matrix:
[[1669   14]
 [ 175   41]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10047999769449234
difference in average predicted and observed risk = -0.013264002305507658
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.905098
precision class 1 = 0.745455
recall class 0 = 0.991682
recall class 1 = 0.189815
false negative rate = 0.810185
false positive rate = 0.008318
positive prediction rate = 0.028963
AUC of ROC = 0.853552
AUC of PRC = 0.513085
min(+P, Se) = 0.462963

-------------------------------

confusion matrix:
[[543   6]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10728199779987335
difference in average predicted and observed risk = -0.01572100220012665
number samples = 626
accuracy = 0.888179
precision class 0 = 0.894563
precision class 1 = 0.684211
recall class 0 = 0.989071
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.010929
positive prediction rate = 0.030351
AUC of ROC = 0.838644
AUC of PRC = 0.447542
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[2242    7]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07997100055217743
difference in average predicted and observed risk = -0.004684999447822566
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.926064
precision class 1 = 0.805556
recall class 0 = 0.996888
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.003112
positive prediction rate = 0.014652
AUC of ROC = 0.842096
AUC of PRC = 0.406102
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0978349968791008
difference in average predicted and observed risk = -0.002971003120899207
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.758924
AUC of PRC = 0.249492
min(+P, Se) = 0.344828

-------------------------------

confusion matrix:
[[473   8]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1325960010290146
difference in average predicted and observed risk = -0.013051998970985412
number samples = 563
accuracy = 0.89698
precision class 0 = 0.904398
precision class 1 = 0.8
recall class 0 = 0.983368
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.016632
positive prediction rate = 0.071048
AUC of ROC = 0.874651
AUC of PRC = 0.6512
min(+P, Se) = 0.585366

-------------------------------

confusion matrix:
[[647   8]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09852500259876251
difference in average predicted and observed risk = -0.00910399740123749
number samples = 734
accuracy = 0.905995
precision class 0 = 0.913842
precision class 1 = 0.692308
recall class 0 = 0.987786
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.012214
positive prediction rate = 0.035422
AUC of ROC = 0.828254
AUC of PRC = 0.465505
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4123   34]
 [ 379   92]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0939669981598854
difference in average predicted and observed risk = -0.007805001840114595
number samples = 4628
accuracy = 0.910761
precision class 0 = 0.915815
precision class 1 = 0.730159
recall class 0 = 0.991821
recall class 1 = 0.195329
false negative rate = 0.804671
false positive rate = 0.008179
positive prediction rate = 0.027226
AUC of ROC = 0.842975
AUC of PRC = 0.465189
min(+P, Se) = 0.431174

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08542799949645996
difference in average predicted and observed risk = 0.005258999496459957
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.880975
AUC of PRC = 0.418669
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08758600056171417
difference in average predicted and observed risk = -0.02120999943828583
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.836916
AUC of PRC = 0.467309
min(+P, Se) = 0.468085

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11749699711799622
difference in average predicted and observed risk = 0.007327997117996213
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.931136
AUC of PRC = 0.620869
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1260329931974411
difference in average predicted and observed risk = -0.007300006802558906
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09825699776411057
difference in average predicted and observed risk = -0.01678700223588943
number samples = 339
accuracy = 0.882006
precision class 0 = 0.889222
precision class 1 = 0.4
recall class 0 = 0.99
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.01
positive prediction rate = 0.014749
AUC of ROC = 0.849145
AUC of PRC = 0.412479
min(+P, Se) = 0.465116

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08874499797821045
difference in average predicted and observed risk = -0.0033050020217895576
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.881598
AUC of PRC = 0.570715
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07477500289678574
difference in average predicted and observed risk = -0.014426997103214267
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.876831
AUC of PRC = 0.516925
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11479900032281876
difference in average predicted and observed risk = -0.0028479996771812455
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.951852
AUC of PRC = 0.720203
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09988299757242203
difference in average predicted and observed risk = 0.01117299757242203
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.864039
AUC of PRC = 0.27421
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11581999808549881
difference in average predicted and observed risk = -0.03378600191450118
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.820175
AUC of PRC = 0.560691
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13344499468803406
difference in average predicted and observed risk = 0.054497994688034054
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.495767
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09269200265407562
difference in average predicted and observed risk = -0.008898997345924378
number samples = 817
accuracy = 0.908201
precision class 0 = 0.91239
precision class 1 = 0.722222
recall class 0 = 0.993188
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.006812
positive prediction rate = 0.022032
AUC of ROC = 0.870983
AUC of PRC = 0.50362
min(+P, Se) = 0.494118

-------------------------------

Epoch 00054: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch54.state
Epoch 55/100
 - 328s - loss: 0.2635 - val_loss: 0.2370

==>predicting on train



confusion matrix:
[[2136   19]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09506300091743469
difference in average predicted and observed risk = -0.010745999082565308
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.911652
precision class 1 = 0.716418
recall class 0 = 0.991183
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.008817
positive prediction rate = 0.027801
AUC of ROC = 0.832128
AUC of PRC = 0.45289
min(+P, Se) = 0.424812

-------------------------------

confusion matrix:
[[1161   18]
 [  91   27]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09116700291633606
difference in average predicted and observed risk = 0.00018800291633605526
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.927316
precision class 1 = 0.6
recall class 0 = 0.984733
recall class 1 = 0.228814
false negative rate = 0.771186
false positive rate = 0.015267
positive prediction rate = 0.034695
AUC of ROC = 0.850987
AUC of PRC = 0.427043
min(+P, Se) = 0.403361

-------------------------------

confusion matrix:
[[646  10]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.1019589975476265
difference in average predicted and observed risk = 0.0005889975476264936
number samples = 730
accuracy = 0.909589
precision class 0 = 0.920228
precision class 1 = 0.642857
recall class 0 = 0.984756
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.015244
positive prediction rate = 0.038356
AUC of ROC = 0.836684
AUC of PRC = 0.462171
min(+P, Se) = 0.434211

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10647500306367874
difference in average predicted and observed risk = -0.019178996936321246
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.937375
AUC of PRC = 0.774816
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2447   27]
 [ 198   57]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09139599651098251
difference in average predicted and observed risk = -0.002045003489017483
number samples = 2729
accuracy = 0.917552
precision class 0 = 0.925142
precision class 1 = 0.678571
recall class 0 = 0.989087
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.010914
positive prediction rate = 0.030781
AUC of ROC = 0.83373
AUC of PRC = 0.426844
min(+P, Se) = 0.402985

-------------------------------

confusion matrix:
[[1661   22]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10147099941968918
difference in average predicted and observed risk = -0.01227300058031082
number samples = 1899
accuracy = 0.899421
precision class 0 = 0.90765
precision class 1 = 0.681159
recall class 0 = 0.986928
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.013072
positive prediction rate = 0.036335
AUC of ROC = 0.85342
AUC of PRC = 0.507908
min(+P, Se) = 0.460829

-------------------------------

confusion matrix:
[[537  12]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11198800057172775
difference in average predicted and observed risk = -0.011014999428272249
number samples = 626
accuracy = 0.883387
precision class 0 = 0.897993
precision class 1 = 0.571429
recall class 0 = 0.978142
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.021858
positive prediction rate = 0.044728
AUC of ROC = 0.838478
AUC of PRC = 0.437254
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2236   13]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07929699867963791
difference in average predicted and observed risk = -0.005359001320362086
number samples = 2457
accuracy = 0.92267
precision class 0 = 0.926647
precision class 1 = 0.704545
recall class 0 = 0.99422
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.00578
positive prediction rate = 0.017908
AUC of ROC = 0.841083
AUC of PRC = 0.399228
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09939900040626526
difference in average predicted and observed risk = -0.001406999593734748
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.771659
AUC of PRC = 0.257174
min(+P, Se) = 0.37037

-------------------------------

confusion matrix:
[[471  10]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13852499425411224
difference in average predicted and observed risk = -0.007123005745887756
number samples = 563
accuracy = 0.898757
precision class 0 = 0.909266
precision class 1 = 0.777778
recall class 0 = 0.97921
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.02079
positive prediction rate = 0.079929
AUC of ROC = 0.877491
AUC of PRC = 0.66416
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[646   9]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10154400020837784
difference in average predicted and observed risk = -0.006084999791622164
number samples = 734
accuracy = 0.907357
precision class 0 = 0.916312
precision class 1 = 0.689655
recall class 0 = 0.98626
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.01374
positive prediction rate = 0.03951
AUC of ROC = 0.829375
AUC of PRC = 0.473128
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[4108   49]
 [ 367  104]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09553000330924988
difference in average predicted and observed risk = -0.006241996690750123
number samples = 4628
accuracy = 0.910112
precision class 0 = 0.917989
precision class 1 = 0.679739
recall class 0 = 0.988213
recall class 1 = 0.220807
false negative rate = 0.779193
false positive rate = 0.011787
positive prediction rate = 0.03306
AUC of ROC = 0.843372
AUC of PRC = 0.465191
min(+P, Se) = 0.43129

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08872699737548828
difference in average predicted and observed risk = 0.008557997375488277
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.887494
AUC of PRC = 0.409428
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08970700204372406
difference in average predicted and observed risk = -0.019088997956275944
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.825366
AUC of PRC = 0.441731
min(+P, Se) = 0.468085

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1254359930753708
difference in average predicted and observed risk = 0.015266993075370786
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.92381
AUC of PRC = 0.609487
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13040299713611603
difference in average predicted and observed risk = -0.0029300028638839792
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10112100094556808
difference in average predicted and observed risk = -0.013922999054431909
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.837692
AUC of PRC = 0.394527
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09250099956989288
difference in average predicted and observed risk = 0.0004509995698928765
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.884007
AUC of PRC = 0.566011
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07651100307703018
difference in average predicted and observed risk = -0.012690996922969822
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.875746
AUC of PRC = 0.512369
min(+P, Se) = 0.458333

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1235940009355545
difference in average predicted and observed risk = 0.005947000935554503
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.936111
AUC of PRC = 0.656858
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10233999788761139
difference in average predicted and observed risk = 0.013629997887611392
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.854385
AUC of PRC = 0.263465
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12079499661922455
difference in average predicted and observed risk = -0.02881100338077544
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.822612
AUC of PRC = 0.569236
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1385360062122345
difference in average predicted and observed risk = 0.059589006212234494
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.518849
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09607800096273422
difference in average predicted and observed risk = -0.005512999037265778
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.866469
AUC of PRC = 0.484844
min(+P, Se) = 0.482353

-------------------------------

Epoch 00055: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch55.state
Epoch 56/100
 - 321s - loss: 0.2579 - val_loss: 0.2375

==>predicting on train



confusion matrix:
[[2136   19]
 [ 209   46]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08976700156927109
difference in average predicted and observed risk = -0.016041998430728913
number samples = 2410
accuracy = 0.905394
precision class 0 = 0.910874
precision class 1 = 0.707692
recall class 0 = 0.991183
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.008817
positive prediction rate = 0.026971
AUC of ROC = 0.83392
AUC of PRC = 0.463879
min(+P, Se) = 0.433594

-------------------------------

confusion matrix:
[[1164   15]
 [  91   27]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0851060003042221
difference in average predicted and observed risk = -0.005872999695777897
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.92749
precision class 1 = 0.642857
recall class 0 = 0.987277
recall class 1 = 0.228814
false negative rate = 0.771186
false positive rate = 0.012723
positive prediction rate = 0.032382
AUC of ROC = 0.849456
AUC of PRC = 0.424868
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[646  10]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09488999843597412
difference in average predicted and observed risk = -0.006480001564025881
number samples = 730
accuracy = 0.910959
precision class 0 = 0.921541
precision class 1 = 0.655172
recall class 0 = 0.984756
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.015244
positive prediction rate = 0.039726
AUC of ROC = 0.845192
AUC of PRC = 0.483275
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10065600275993347
difference in average predicted and observed risk = -0.024997997240066516
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.934631
AUC of PRC = 0.763542
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2450   24]
 [ 200   55]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08511000126600266
difference in average predicted and observed risk = -0.008330998733997341
number samples = 2729
accuracy = 0.917919
precision class 0 = 0.924528
precision class 1 = 0.696203
recall class 0 = 0.990299
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.009701
positive prediction rate = 0.028948
AUC of ROC = 0.834995
AUC of PRC = 0.430067
min(+P, Se) = 0.420233

-------------------------------

confusion matrix:
[[1661   22]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09634000062942505
difference in average predicted and observed risk = -0.01740399937057495
number samples = 1899
accuracy = 0.899947
precision class 0 = 0.908147
precision class 1 = 0.685714
recall class 0 = 0.986928
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.013072
positive prediction rate = 0.036862
AUC of ROC = 0.855842
AUC of PRC = 0.522116
min(+P, Se) = 0.472222

-------------------------------

confusion matrix:
[[539  10]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10310199856758118
difference in average predicted and observed risk = -0.019901001432418824
number samples = 626
accuracy = 0.886581
precision class 0 = 0.898333
precision class 1 = 0.615385
recall class 0 = 0.981785
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.018215
positive prediction rate = 0.041534
AUC of ROC = 0.842062
AUC of PRC = 0.447296
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[2237   12]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07558699697256088
difference in average predicted and observed risk = -0.009069003027439113
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.926678
precision class 1 = 0.72093
recall class 0 = 0.994664
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.005336
positive prediction rate = 0.017501
AUC of ROC = 0.843343
AUC of PRC = 0.408503
min(+P, Se) = 0.373206

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09445600211620331
difference in average predicted and observed risk = -0.006349997883796699
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.752825
AUC of PRC = 0.25673
min(+P, Se) = 0.354839

-------------------------------

confusion matrix:
[[472   9]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12660600244998932
difference in average predicted and observed risk = -0.01904199755001068
number samples = 563
accuracy = 0.89698
precision class 0 = 0.90595
precision class 1 = 0.785714
recall class 0 = 0.981289
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.018711
positive prediction rate = 0.0746
AUC of ROC = 0.87924
AUC of PRC = 0.669205
min(+P, Se) = 0.578313

-------------------------------

confusion matrix:
[[645  10]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09571299701929092
difference in average predicted and observed risk = -0.011916002980709078
number samples = 734
accuracy = 0.907357
precision class 0 = 0.917496
precision class 1 = 0.677419
recall class 0 = 0.984733
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.015267
positive prediction rate = 0.042234
AUC of ROC = 0.835578
AUC of PRC = 0.488862
min(+P, Se) = 0.45679

-------------------------------

confusion matrix:
[[4111   46]
 [ 368  103]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08971799910068512
difference in average predicted and observed risk = -0.012054000899314882
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.917839
precision class 1 = 0.691275
recall class 0 = 0.988934
recall class 1 = 0.218684
false negative rate = 0.781316
false positive rate = 0.011066
positive prediction rate = 0.032195
AUC of ROC = 0.845162
AUC of PRC = 0.473412
min(+P, Se) = 0.44

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08209100365638733
difference in average predicted and observed risk = 0.001922003656387325
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.882907
AUC of PRC = 0.39652
min(+P, Se) = 0.409091

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08298899978399277
difference in average predicted and observed risk = -0.025807000216007236
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.835314
AUC of PRC = 0.464024
min(+P, Se) = 0.45098

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11574099957942963
difference in average predicted and observed risk = 0.005571999579429623
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.912821
AUC of PRC = 0.528774
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12518000602722168
difference in average predicted and observed risk = -0.008152993972778327
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09416300058364868
difference in average predicted and observed risk = -0.020880999416351312
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.843504
AUC of PRC = 0.37931
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08535300195217133
difference in average predicted and observed risk = -0.006696998047828681
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.881336
AUC of PRC = 0.560995
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07142700254917145
difference in average predicted and observed risk = -0.017774997450828556
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.877509
AUC of PRC = 0.507168
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11306899785995483
difference in average predicted and observed risk = -0.004578002140045168
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.936111
AUC of PRC = 0.691035
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09237600117921829
difference in average predicted and observed risk = 0.003666001179218295
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.851167
AUC of PRC = 0.248579
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11445199698209763
difference in average predicted and observed risk = -0.03515400301790236
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.818226
AUC of PRC = 0.565363
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1254969984292984
difference in average predicted and observed risk = 0.0465499984292984
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08900800347328186
difference in average predicted and observed risk = -0.01258299652671814
number samples = 817
accuracy = 0.908201
precision class 0 = 0.913425
precision class 1 = 0.7
recall class 0 = 0.991826
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.008174
positive prediction rate = 0.02448
AUC of ROC = 0.867437
AUC of PRC = 0.478796
min(+P, Se) = 0.481928

-------------------------------

Epoch 00056: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch56.state
Epoch 57/100
 - 321s - loss: 0.2609 - val_loss: 0.2394

==>predicting on train



confusion matrix:
[[2140   15]
 [ 215   40]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08656000345945358
difference in average predicted and observed risk = -0.019248996540546418
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.908705
precision class 1 = 0.727273
recall class 0 = 0.993039
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.006961
positive prediction rate = 0.022822
AUC of ROC = 0.833363
AUC of PRC = 0.460293
min(+P, Se) = 0.436293

-------------------------------

confusion matrix:
[[1170    9]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08268900215625763
difference in average predicted and observed risk = -0.008289997843742375
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.923441
precision class 1 = 0.7
recall class 0 = 0.992366
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.007634
positive prediction rate = 0.02313
AUC of ROC = 0.847918
AUC of PRC = 0.422985
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[651   5]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09329099953174591
difference in average predicted and observed risk = -0.008079000468254091
number samples = 730
accuracy = 0.910959
precision class 0 = 0.915612
precision class 1 = 0.736842
recall class 0 = 0.992378
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.007622
positive prediction rate = 0.026027
AUC of ROC = 0.837343
AUC of PRC = 0.476664
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09617599844932556
difference in average predicted and observed risk = -0.029478001550674426
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.931138
AUC of PRC = 0.756214
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2456   18]
 [ 214   41]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0825750008225441
difference in average predicted and observed risk = -0.010865999177455898
number samples = 2729
accuracy = 0.914987
precision class 0 = 0.91985
precision class 1 = 0.694915
recall class 0 = 0.992724
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.007276
positive prediction rate = 0.02162
AUC of ROC = 0.833982
AUC of PRC = 0.422291
min(+P, Se) = 0.410156

-------------------------------

confusion matrix:
[[1670   13]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09319800138473511
difference in average predicted and observed risk = -0.02054599861526489
number samples = 1899
accuracy = 0.903107
precision class 0 = 0.907116
precision class 1 = 0.775862
recall class 0 = 0.992276
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.007724
positive prediction rate = 0.030542
AUC of ROC = 0.852333
AUC of PRC = 0.518509
min(+P, Se) = 0.465438

-------------------------------

confusion matrix:
[[542   7]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09967800229787827
difference in average predicted and observed risk = -0.023324997702121736
number samples = 626
accuracy = 0.883387
precision class 0 = 0.891447
precision class 1 = 0.611111
recall class 0 = 0.98725
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.01275
positive prediction rate = 0.028754
AUC of ROC = 0.839496
AUC of PRC = 0.443596
min(+P, Se) = 0.445783

-------------------------------

confusion matrix:
[[2241    8]
 [ 183   25]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07328599691390991
difference in average predicted and observed risk = -0.011370003086090083
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.924505
precision class 1 = 0.757576
recall class 0 = 0.996443
recall class 1 = 0.120192
false negative rate = 0.879808
false positive rate = 0.003557
positive prediction rate = 0.013431
AUC of ROC = 0.842088
AUC of PRC = 0.403328
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09337099641561508
difference in average predicted and observed risk = -0.007435003584384925
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.754439
AUC of PRC = 0.253596
min(+P, Se) = 0.344828

-------------------------------

confusion matrix:
[[476   5]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12125399708747864
difference in average predicted and observed risk = -0.024394002912521362
number samples = 563
accuracy = 0.900533
precision class 0 = 0.903226
precision class 1 = 0.861111
recall class 0 = 0.989605
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.010395
positive prediction rate = 0.063943
AUC of ROC = 0.877111
AUC of PRC = 0.661506
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[648   7]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09325099736452103
difference in average predicted and observed risk = -0.014378002635478976
number samples = 734
accuracy = 0.907357
precision class 0 = 0.913963
precision class 1 = 0.72
recall class 0 = 0.989313
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.010687
positive prediction rate = 0.03406
AUC of ROC = 0.83065
AUC of PRC = 0.481035
min(+P, Se) = 0.445783

-------------------------------

confusion matrix:
[[4126   31]
 [ 385   86]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08693400025367737
difference in average predicted and observed risk = -0.014837999746322633
number samples = 4628
accuracy = 0.910112
precision class 0 = 0.914653
precision class 1 = 0.735043
recall class 0 = 0.992543
recall class 1 = 0.18259
false negative rate = 0.81741
false positive rate = 0.007457
positive prediction rate = 0.025281
AUC of ROC = 0.843075
AUC of PRC = 0.467518
min(+P, Se) = 0.43129

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07993099838495255
difference in average predicted and observed risk = -0.00023800161504745898
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.87832
AUC of PRC = 0.398681
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 44   3]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07957000285387039
difference in average predicted and observed risk = -0.029225997146129612
number samples = 432
accuracy = 0.898148
precision class 0 = 0.897436
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.06383
false negative rate = 0.93617
false positive rate = 0.0
positive prediction rate = 0.006944
AUC of ROC = 0.836861
AUC of PRC = 0.462549
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11141200363636017
difference in average predicted and observed risk = 0.0012430036363601654
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.915751
AUC of PRC = 0.530556
min(+P, Se) = 0.5625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11745099723339081
difference in average predicted and observed risk = -0.0158820027666092
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09098900109529495
difference in average predicted and observed risk = -0.02405499890470504
number samples = 339
accuracy = 0.882006
precision class 0 = 0.889222
precision class 1 = 0.4
recall class 0 = 0.99
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.01
positive prediction rate = 0.014749
AUC of ROC = 0.845043
AUC of PRC = 0.377955
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08188799768686295
difference in average predicted and observed risk = -0.010162002313137061
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.879975
AUC of PRC = 0.561172
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[388   0]
 [ 35   3]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06871999800205231
difference in average predicted and observed risk = -0.020482001997947696
number samples = 426
accuracy = 0.91784
precision class 0 = 0.917258
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.078947
false negative rate = 0.921053
false positive rate = 0.0
positive prediction rate = 0.007042
AUC of ROC = 0.878866
AUC of PRC = 0.504767
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10543999820947647
difference in average predicted and observed risk = -0.01220700179052353
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.942593
AUC of PRC = 0.697487
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0911329984664917
difference in average predicted and observed risk = 0.002422998466491702
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.843926
AUC of PRC = 0.23684
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10933300107717514
difference in average predicted and observed risk = -0.04027299892282485
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.815302
AUC of PRC = 0.549178
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1255899965763092
difference in average predicted and observed risk = 0.0466429965763092
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[730   4]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08566399663686752
difference in average predicted and observed risk = -0.015927003363132478
number samples = 817
accuracy = 0.908201
precision class 0 = 0.911361
precision class 1 = 0.75
recall class 0 = 0.99455
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.00545
positive prediction rate = 0.019584
AUC of ROC = 0.867125
AUC of PRC = 0.484714
min(+P, Se) = 0.46988

-------------------------------

Epoch 00057: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch57.state
Epoch 58/100
 - 324s - loss: 0.2609 - val_loss: 0.2371

==>predicting on train



confusion matrix:
[[2135   20]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09366899728775024
difference in average predicted and observed risk = -0.012140002712249756
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.912003
precision class 1 = 0.710145
recall class 0 = 0.990719
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.009281
positive prediction rate = 0.028631
AUC of ROC = 0.838704
AUC of PRC = 0.468588
min(+P, Se) = 0.447059

-------------------------------

confusion matrix:
[[1167   12]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08363500237464905
difference in average predicted and observed risk = -0.0073439976253509565
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.924723
precision class 1 = 0.657143
recall class 0 = 0.989822
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.010178
positive prediction rate = 0.026985
AUC of ROC = 0.850397
AUC of PRC = 0.434822
min(+P, Se) = 0.389831

-------------------------------

confusion matrix:
[[649   7]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09083099663257599
difference in average predicted and observed risk = -0.010539003367424013
number samples = 730
accuracy = 0.909589
precision class 0 = 0.916667
precision class 1 = 0.681818
recall class 0 = 0.989329
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.010671
positive prediction rate = 0.030137
AUC of ROC = 0.85061
AUC of PRC = 0.487733
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10063199698925018
difference in average predicted and observed risk = -0.025022003010749805
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.938872
AUC of PRC = 0.769095
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2452   22]
 [ 205   50]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08623500168323517
difference in average predicted and observed risk = -0.007205998316764828
number samples = 2729
accuracy = 0.916819
precision class 0 = 0.922845
precision class 1 = 0.694444
recall class 0 = 0.991108
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.008892
positive prediction rate = 0.026383
AUC of ROC = 0.840997
AUC of PRC = 0.43812
min(+P, Se) = 0.429688

-------------------------------

confusion matrix:
[[1664   19]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09710899740457535
difference in average predicted and observed risk = -0.01663500259542465
number samples = 1899
accuracy = 0.901527
precision class 0 = 0.908297
precision class 1 = 0.716418
recall class 0 = 0.988711
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.011289
positive prediction rate = 0.035282
AUC of ROC = 0.856052
AUC of PRC = 0.524104
min(+P, Se) = 0.466063

-------------------------------

confusion matrix:
[[541   8]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1020750030875206
difference in average predicted and observed risk = -0.020927996912479402
number samples = 626
accuracy = 0.884984
precision class 0 = 0.894215
precision class 1 = 0.619048
recall class 0 = 0.985428
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.014572
positive prediction rate = 0.033546
AUC of ROC = 0.842003
AUC of PRC = 0.450379
min(+P, Se) = 0.45122

-------------------------------

confusion matrix:
[[2237   12]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07762999832630157
difference in average predicted and observed risk = -0.0070260016736984204
number samples = 2457
accuracy = 0.92267
precision class 0 = 0.926294
precision class 1 = 0.714286
recall class 0 = 0.994664
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.005336
positive prediction rate = 0.017094
AUC of ROC = 0.846693
AUC of PRC = 0.412754
min(+P, Se) = 0.380952

-------------------------------

confusion matrix:
[[219   4]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09290000051259995
difference in average predicted and observed risk = -0.007905999487400062
number samples = 248
accuracy = 0.895161
precision class 0 = 0.908714
precision class 1 = 0.428571
recall class 0 = 0.982063
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.017937
positive prediction rate = 0.028226
AUC of ROC = 0.769507
AUC of PRC = 0.264143
min(+P, Se) = 0.321429

-------------------------------

confusion matrix:
[[473   8]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12934300303459167
difference in average predicted and observed risk = -0.016304996965408325
number samples = 563
accuracy = 0.898757
precision class 0 = 0.90613
precision class 1 = 0.804878
recall class 0 = 0.983368
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.016632
positive prediction rate = 0.072824
AUC of ROC = 0.883196
AUC of PRC = 0.678764
min(+P, Se) = 0.578313

-------------------------------

confusion matrix:
[[646   9]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09434700012207031
difference in average predicted and observed risk = -0.01328199987792969
number samples = 734
accuracy = 0.905995
precision class 0 = 0.915014
precision class 1 = 0.678571
recall class 0 = 0.98626
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.01374
positive prediction rate = 0.038147
AUC of ROC = 0.839501
AUC of PRC = 0.479914
min(+P, Se) = 0.481013

-------------------------------

confusion matrix:
[[4116   41]
 [ 373   98]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09069699794054031
difference in average predicted and observed risk = -0.011075002059459688
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.916908
precision class 1 = 0.705036
recall class 0 = 0.990137
recall class 1 = 0.208068
false negative rate = 0.791932
false positive rate = 0.009863
positive prediction rate = 0.030035
AUC of ROC = 0.848439
AUC of PRC = 0.478108
min(+P, Se) = 0.444676

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07981699705123901
difference in average predicted and observed risk = -0.0003520029487609905
number samples = 237
accuracy = 0.911392
precision class 0 = 0.926407
precision class 1 = 0.333333
recall class 0 = 0.981651
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018349
positive prediction rate = 0.025316
AUC of ROC = 0.884355
AUC of PRC = 0.399654
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08490700274705887
difference in average predicted and observed risk = -0.023888997252941135
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.842166
AUC of PRC = 0.474793
min(+P, Se) = 0.489362

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10745300352573395
difference in average predicted and observed risk = -0.0027159964742660553
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.912821
AUC of PRC = 0.499014
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11670999974012375
difference in average predicted and observed risk = -0.01662300025987626
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09366100281476974
difference in average predicted and observed risk = -0.02138299718523025
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.84906
AUC of PRC = 0.380266
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[432   2]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08373700082302094
difference in average predicted and observed risk = -0.008312999176979072
number samples = 478
accuracy = 0.91841
precision class 0 = 0.921109
precision class 1 = 0.777778
recall class 0 = 0.995392
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.004608
positive prediction rate = 0.018828
AUC of ROC = 0.886049
AUC of PRC = 0.551132
min(+P, Se) = 0.510638

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07245499640703201
difference in average predicted and observed risk = -0.01674700359296799
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.880697
AUC of PRC = 0.462928
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11066500097513199
difference in average predicted and observed risk = -0.006981999024868013
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.925926
AUC of PRC = 0.645333
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08998200297355652
difference in average predicted and observed risk = 0.0012720029735565214
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.872084
AUC of PRC = 0.273858
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10860899835824966
difference in average predicted and observed risk = -0.040997001641750325
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.824561
AUC of PRC = 0.565366
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12295900285243988
difference in average predicted and observed risk = 0.04401200285243988
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08785499632358551
difference in average predicted and observed risk = -0.01373600367641449
number samples = 817
accuracy = 0.905753
precision class 0 = 0.910112
precision class 1 = 0.6875
recall class 0 = 0.993188
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.006812
positive prediction rate = 0.019584
AUC of ROC = 0.871902
AUC of PRC = 0.478761
min(+P, Se) = 0.481928

-------------------------------

Epoch 00058: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch58.state
Epoch 59/100
 - 330s - loss: 0.2614 - val_loss: 0.2367

==>predicting on train



confusion matrix:
[[2136   19]
 [ 205   50]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09451200067996979
difference in average predicted and observed risk = -0.011296999320030213
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.912431
precision class 1 = 0.724638
recall class 0 = 0.991183
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.008817
positive prediction rate = 0.028631
AUC of ROC = 0.837773
AUC of PRC = 0.465378
min(+P, Se) = 0.447059

-------------------------------

confusion matrix:
[[1164   15]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08714800328016281
difference in average predicted and observed risk = -0.003830996719837193
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.925278
precision class 1 = 0.615385
recall class 0 = 0.987277
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.012723
positive prediction rate = 0.030069
AUC of ROC = 0.851964
AUC of PRC = 0.434086
min(+P, Se) = 0.390244

-------------------------------

confusion matrix:
[[648   8]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09657900035381317
difference in average predicted and observed risk = -0.00479099964618683
number samples = 730
accuracy = 0.910959
precision class 0 = 0.919149
precision class 1 = 0.68
recall class 0 = 0.987805
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.012195
positive prediction rate = 0.034247
AUC of ROC = 0.843688
AUC of PRC = 0.478492
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1035040020942688
difference in average predicted and observed risk = -0.02214999790573119
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.937126
AUC of PRC = 0.776093
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2451   23]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08808500319719315
difference in average predicted and observed risk = -0.0053559968028068505
number samples = 2729
accuracy = 0.917919
precision class 0 = 0.924208
precision class 1 = 0.701299
recall class 0 = 0.990703
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.009297
positive prediction rate = 0.028215
AUC of ROC = 0.839271
AUC of PRC = 0.432112
min(+P, Se) = 0.420233

-------------------------------

confusion matrix:
[[1662   21]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10041800141334534
difference in average predicted and observed risk = -0.013325998586654661
number samples = 1899
accuracy = 0.900474
precision class 0 = 0.908197
precision class 1 = 0.695652
recall class 0 = 0.987522
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.012478
positive prediction rate = 0.036335
AUC of ROC = 0.856487
AUC of PRC = 0.526279
min(+P, Se) = 0.472727

-------------------------------

confusion matrix:
[[542   7]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10291499644517899
difference in average predicted and observed risk = -0.020088003554821016
number samples = 626
accuracy = 0.884984
precision class 0 = 0.892916
precision class 1 = 0.631579
recall class 0 = 0.98725
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.01275
positive prediction rate = 0.030351
AUC of ROC = 0.842287
AUC of PRC = 0.449205
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2236   13]
 [ 175   33]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07946900278329849
difference in average predicted and observed risk = -0.005186997216701503
number samples = 2457
accuracy = 0.923484
precision class 0 = 0.927416
precision class 1 = 0.717391
recall class 0 = 0.99422
recall class 1 = 0.158654
false negative rate = 0.841346
false positive rate = 0.00578
positive prediction rate = 0.018722
AUC of ROC = 0.84681
AUC of PRC = 0.417164
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09975700080394745
difference in average predicted and observed risk = -0.001048999196052558
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.768251
AUC of PRC = 0.254933
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[471  10]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13045799732208252
difference in average predicted and observed risk = -0.01519000267791748
number samples = 563
accuracy = 0.898757
precision class 0 = 0.909266
precision class 1 = 0.777778
recall class 0 = 0.97921
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.02079
positive prediction rate = 0.079929
AUC of ROC = 0.880052
AUC of PRC = 0.667276
min(+P, Se) = 0.54878

-------------------------------

confusion matrix:
[[645  10]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09974200278520584
difference in average predicted and observed risk = -0.007886997214794161
number samples = 734
accuracy = 0.907357
precision class 0 = 0.917496
precision class 1 = 0.677419
recall class 0 = 0.984733
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.015267
positive prediction rate = 0.042234
AUC of ROC = 0.835346
AUC of PRC = 0.485489
min(+P, Se) = 0.45679

-------------------------------

confusion matrix:
[[4113   44]
 [ 369  102]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09314599633216858
difference in average predicted and observed risk = -0.008626003667831422
number samples = 4628
accuracy = 0.910761
precision class 0 = 0.917671
precision class 1 = 0.69863
recall class 0 = 0.989415
recall class 1 = 0.216561
false negative rate = 0.78344
false positive rate = 0.010585
positive prediction rate = 0.031547
AUC of ROC = 0.847714
AUC of PRC = 0.4768
min(+P, Se) = 0.445378

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08336299657821655
difference in average predicted and observed risk = 0.0031939965782165486
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.885563
AUC of PRC = 0.419636
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08620999753475189
difference in average predicted and observed risk = -0.02258600246524811
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.837966
AUC of PRC = 0.455938
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11614199727773666
difference in average predicted and observed risk = 0.005972997277736661
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.918681
AUC of PRC = 0.531361
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12227100133895874
difference in average predicted and observed risk = -0.011061998661041267
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09739500284194946
difference in average predicted and observed risk = -0.01764899715805053
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.841795
AUC of PRC = 0.368427
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[432   2]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08651900291442871
difference in average predicted and observed risk = -0.005530997085571296
number samples = 478
accuracy = 0.926778
precision class 0 = 0.929032
precision class 1 = 0.846154
recall class 0 = 0.995392
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.004608
positive prediction rate = 0.027197
AUC of ROC = 0.88694
AUC of PRC = 0.557149
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0738769993185997
difference in average predicted and observed risk = -0.015325000681400303
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.877916
AUC of PRC = 0.481809
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11443199962377548
difference in average predicted and observed risk = -0.0032150003762245194
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.935185
AUC of PRC = 0.661044
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09351199865341187
difference in average predicted and observed risk = 0.004801998653411868
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.86243
AUC of PRC = 0.275826
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11444400250911713
difference in average predicted and observed risk = -0.03516199749088286
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.827485
AUC of PRC = 0.56783
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13419300317764282
difference in average predicted and observed risk = 0.05524600317764282
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0910319983959198
difference in average predicted and observed risk = -0.010559001604080201
number samples = 817
accuracy = 0.910649
precision class 0 = 0.91468
precision class 1 = 0.75
recall class 0 = 0.993188
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.006812
positive prediction rate = 0.02448
AUC of ROC = 0.870113
AUC of PRC = 0.475469
min(+P, Se) = 0.5

-------------------------------

Epoch 00059: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch59.state
Epoch 60/100
 - 318s - loss: 0.2617 - val_loss: 0.2371

==>predicting on train



confusion matrix:
[[2137   18]
 [ 212   43]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0850519984960556
difference in average predicted and observed risk = -0.020757001503944397
number samples = 2410
accuracy = 0.904564
precision class 0 = 0.909749
precision class 1 = 0.704918
recall class 0 = 0.991647
recall class 1 = 0.168627
false negative rate = 0.831373
false positive rate = 0.008353
positive prediction rate = 0.025311
AUC of ROC = 0.840746
AUC of PRC = 0.471624
min(+P, Se) = 0.435294

-------------------------------

confusion matrix:
[[1170    9]
 [ 100   18]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0764089971780777
difference in average predicted and observed risk = -0.014570002821922307
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.92126
precision class 1 = 0.666667
recall class 0 = 0.992366
recall class 1 = 0.152542
false negative rate = 0.847458
false positive rate = 0.007634
positive prediction rate = 0.020817
AUC of ROC = 0.853546
AUC of PRC = 0.441754
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[655   1]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08214099705219269
difference in average predicted and observed risk = -0.019229002947807314
number samples = 730
accuracy = 0.916438
precision class 0 = 0.916084
precision class 1 = 0.933333
recall class 0 = 0.998476
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.001524
positive prediction rate = 0.020548
AUC of ROC = 0.847376
AUC of PRC = 0.491174
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.09503500163555145
difference in average predicted and observed risk = -0.030618998364448535
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.936128
AUC of PRC = 0.767425
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2457   17]
 [ 213   42]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0780780017375946
difference in average predicted and observed risk = -0.015362998262405392
number samples = 2729
accuracy = 0.91572
precision class 0 = 0.920225
precision class 1 = 0.711864
recall class 0 = 0.993129
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.006871
positive prediction rate = 0.02162
AUC of ROC = 0.84157
AUC of PRC = 0.435776
min(+P, Se) = 0.42471

-------------------------------

confusion matrix:
[[1670   13]
 [ 172   44]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08905699849128723
difference in average predicted and observed risk = -0.024687001508712766
number samples = 1899
accuracy = 0.90258
precision class 0 = 0.906623
precision class 1 = 0.77193
recall class 0 = 0.992276
recall class 1 = 0.203704
false negative rate = 0.796296
false positive rate = 0.007724
positive prediction rate = 0.030016
AUC of ROC = 0.858787
AUC of PRC = 0.532648
min(+P, Se) = 0.481818

-------------------------------

confusion matrix:
[[544   5]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09100600332021713
difference in average predicted and observed risk = -0.03199699667978287
number samples = 626
accuracy = 0.880192
precision class 0 = 0.885993
precision class 1 = 0.583333
recall class 0 = 0.990893
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.009107
positive prediction rate = 0.019169
AUC of ROC = 0.845173
AUC of PRC = 0.463475
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2240    9]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07029999792575836
difference in average predicted and observed risk = -0.014356002074241633
number samples = 2457
accuracy = 0.923484
precision class 0 = 0.926003
precision class 1 = 0.763158
recall class 0 = 0.995998
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.004002
positive prediction rate = 0.015466
AUC of ROC = 0.849625
AUC of PRC = 0.420528
min(+P, Se) = 0.399038

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08442699909210205
difference in average predicted and observed risk = -0.016379000907897956
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.763946
AUC of PRC = 0.253259
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[476   5]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.11841099709272385
difference in average predicted and observed risk = -0.027237002907276153
number samples = 563
accuracy = 0.902309
precision class 0 = 0.904943
precision class 1 = 0.864865
recall class 0 = 0.989605
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.010395
positive prediction rate = 0.065719
AUC of ROC = 0.882334
AUC of PRC = 0.670532
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[647   8]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08841100335121155
difference in average predicted and observed risk = -0.019217996648788455
number samples = 734
accuracy = 0.905995
precision class 0 = 0.913842
precision class 1 = 0.692308
recall class 0 = 0.987786
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.012214
positive prediction rate = 0.035422
AUC of ROC = 0.837298
AUC of PRC = 0.492495
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4127   30]
 [ 385   86]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0825830027461052
difference in average predicted and observed risk = -0.019188997253894807
number samples = 4628
accuracy = 0.910328
precision class 0 = 0.914672
precision class 1 = 0.741379
recall class 0 = 0.992783
recall class 1 = 0.18259
false negative rate = 0.81741
false positive rate = 0.007217
positive prediction rate = 0.025065
AUC of ROC = 0.850049
AUC of PRC = 0.482287
min(+P, Se) = 0.445148

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07333599776029587
difference in average predicted and observed risk = -0.006833002239704136
number samples = 237
accuracy = 0.911392
precision class 0 = 0.926407
precision class 1 = 0.333333
recall class 0 = 0.981651
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018349
positive prediction rate = 0.025316
AUC of ROC = 0.887977
AUC of PRC = 0.405943
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07865399867296219
difference in average predicted and observed risk = -0.030142001327037815
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.844045
AUC of PRC = 0.468447
min(+P, Se) = 0.469388

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10019999742507935
difference in average predicted and observed risk = -0.009969002574920657
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.909158
AUC of PRC = 0.524786
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.10999800264835358
difference in average predicted and observed risk = -0.02333499735164643
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08648999780416489
difference in average predicted and observed risk = -0.028554002195835107
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.849487
AUC of PRC = 0.378061
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[432   2]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07774599641561508
difference in average predicted and observed risk = -0.014304003584384925
number samples = 478
accuracy = 0.91841
precision class 0 = 0.921109
precision class 1 = 0.777778
recall class 0 = 0.995392
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.004608
positive prediction rate = 0.018828
AUC of ROC = 0.885159
AUC of PRC = 0.559541
min(+P, Se) = 0.510638

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06508400291204453
difference in average predicted and observed risk = -0.02411799708795548
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.887751
AUC of PRC = 0.485456
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10388399660587311
difference in average predicted and observed risk = -0.013763003394126894
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.92037
AUC of PRC = 0.660517
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08292700350284576
difference in average predicted and observed risk = -0.005782996497154233
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.860821
AUC of PRC = 0.259558
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10524000227451324
difference in average predicted and observed risk = -0.044365997725486744
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.828947
AUC of PRC = 0.564916
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11874199658632278
difference in average predicted and observed risk = 0.03979499658632278
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.866667
AUC of PRC = 0.478241
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08137399703264236
difference in average predicted and observed risk = -0.020217002967357636
number samples = 817
accuracy = 0.904529
precision class 0 = 0.908978
precision class 1 = 0.666667
recall class 0 = 0.993188
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.006812
positive prediction rate = 0.01836
AUC of ROC = 0.872509
AUC of PRC = 0.484395
min(+P, Se) = 0.481928

-------------------------------

Epoch 00060: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch60.state
Epoch 61/100
 - 322s - loss: 0.2617 - val_loss: 0.2388

==>predicting on train



confusion matrix:
[[2139   16]
 [ 209   46]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09281300008296967
difference in average predicted and observed risk = -0.012995999917030335
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.910988
precision class 1 = 0.741935
recall class 0 = 0.992575
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.007425
positive prediction rate = 0.025726
AUC of ROC = 0.843765
AUC of PRC = 0.475525
min(+P, Se) = 0.435294

-------------------------------

confusion matrix:
[[1167   12]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08504500240087509
difference in average predicted and observed risk = -0.005933997599124913
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.921801
precision class 1 = 0.612903
recall class 0 = 0.989822
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.010178
positive prediction rate = 0.023901
AUC of ROC = 0.852669
AUC of PRC = 0.439698
min(+P, Se) = 0.41129

-------------------------------

confusion matrix:
[[652   4]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09092800319194794
difference in average predicted and observed risk = -0.010441996808052065
number samples = 730
accuracy = 0.913699
precision class 0 = 0.917018
precision class 1 = 0.789474
recall class 0 = 0.993902
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.006098
positive prediction rate = 0.026027
AUC of ROC = 0.848591
AUC of PRC = 0.488597
min(+P, Se) = 0.448718

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10520800203084946
difference in average predicted and observed risk = -0.02044599796915053
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.938623
AUC of PRC = 0.775612
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2452   22]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08514899760484695
difference in average predicted and observed risk = -0.008292002395153042
number samples = 2729
accuracy = 0.915354
precision class 0 = 0.921458
precision class 1 = 0.676471
recall class 0 = 0.991108
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.008892
positive prediction rate = 0.024918
AUC of ROC = 0.844217
AUC of PRC = 0.436477
min(+P, Se) = 0.416988

-------------------------------

confusion matrix:
[[1671   12]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09904199838638306
difference in average predicted and observed risk = -0.014702001613616941
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.907166
precision class 1 = 0.789474
recall class 0 = 0.99287
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.00713
positive prediction rate = 0.030016
AUC of ROC = 0.859876
AUC of PRC = 0.534778
min(+P, Se) = 0.481481

-------------------------------

confusion matrix:
[[544   5]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10298900306224823
difference in average predicted and observed risk = -0.02001399693775177
number samples = 626
accuracy = 0.883387
precision class 0 = 0.888889
precision class 1 = 0.642857
recall class 0 = 0.990893
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.009107
positive prediction rate = 0.022364
AUC of ROC = 0.842571
AUC of PRC = 0.449873
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2242    7]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07689999788999557
difference in average predicted and observed risk = -0.00775600211000442
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.927213
precision class 1 = 0.820513
recall class 0 = 0.996888
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.003112
positive prediction rate = 0.015873
AUC of ROC = 0.852133
AUC of PRC = 0.427192
min(+P, Se) = 0.389423

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09638500213623047
difference in average predicted and observed risk = -0.004420997863769538
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.769507
AUC of PRC = 0.252841
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[472   9]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12759800255298615
difference in average predicted and observed risk = -0.018049997447013855
number samples = 563
accuracy = 0.895204
precision class 0 = 0.904215
precision class 1 = 0.780488
recall class 0 = 0.981289
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.018711
positive prediction rate = 0.072824
AUC of ROC = 0.884108
AUC of PRC = 0.669229
min(+P, Se) = 0.573171

-------------------------------

confusion matrix:
[[646   9]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09713499993085861
difference in average predicted and observed risk = -0.01049400006914139
number samples = 734
accuracy = 0.904632
precision class 0 = 0.91372
precision class 1 = 0.666667
recall class 0 = 0.98626
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.01374
positive prediction rate = 0.036785
AUC of ROC = 0.838902
AUC of PRC = 0.486237
min(+P, Se) = 0.4625

-------------------------------

confusion matrix:
[[4123   34]
 [ 380   91]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09085000306367874
difference in average predicted and observed risk = -0.01092199693632126
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.915612
precision class 1 = 0.728
recall class 0 = 0.991821
recall class 1 = 0.193206
false negative rate = 0.806794
false positive rate = 0.008179
positive prediction rate = 0.02701
AUC of ROC = 0.851906
AUC of PRC = 0.483333
min(+P, Se) = 0.447983

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08179699629545212
difference in average predicted and observed risk = 0.0016279962954521138
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.886287
AUC of PRC = 0.413358
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08548799902200699
difference in average predicted and observed risk = -0.023308000977993015
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.840785
AUC of PRC = 0.454806
min(+P, Se) = 0.479167

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10993999987840652
difference in average predicted and observed risk = -0.00022900012159347838
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.909158
AUC of PRC = 0.515492
min(+P, Se) = 0.533333

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11923400312662125
difference in average predicted and observed risk = -0.01409899687337876
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09541700035333633
difference in average predicted and observed risk = -0.01962699964666366
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.843675
AUC of PRC = 0.378851
min(+P, Se) = 0.44186

-------------------------------

confusion matrix:
[[432   2]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08477000147104263
difference in average predicted and observed risk = -0.007279998528957374
number samples = 478
accuracy = 0.922594
precision class 0 = 0.925054
precision class 1 = 0.818182
recall class 0 = 0.995392
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.004608
positive prediction rate = 0.023013
AUC of ROC = 0.88584
AUC of PRC = 0.558859
min(+P, Se) = 0.55102

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07113499939441681
difference in average predicted and observed risk = -0.018067000605583194
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.885852
AUC of PRC = 0.476768
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11261700093746185
difference in average predicted and observed risk = -0.0050299990625381485
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.923148
AUC of PRC = 0.655654
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09412000328302383
difference in average predicted and observed risk = 0.005410003283023837
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.860821
AUC of PRC = 0.258604
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11319400370121002
difference in average predicted and observed risk = -0.03641199629878997
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.82115
AUC of PRC = 0.562962
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1323460042476654
difference in average predicted and observed risk = 0.0533990042476654
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08918800204992294
difference in average predicted and observed risk = -0.012402997950077058
number samples = 817
accuracy = 0.906977
precision class 0 = 0.91125
precision class 1 = 0.705882
recall class 0 = 0.993188
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.006812
positive prediction rate = 0.020808
AUC of ROC = 0.870523
AUC of PRC = 0.483284
min(+P, Se) = 0.48913

-------------------------------

Epoch 00061: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch61.state
Epoch 62/100
 - 315s - loss: 0.2621 - val_loss: 0.2421

==>predicting on train



confusion matrix:
[[2139   16]
 [ 213   42]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.07012700289487839
difference in average predicted and observed risk = -0.03568199710512161
number samples = 2410
accuracy = 0.904979
precision class 0 = 0.909439
precision class 1 = 0.724138
recall class 0 = 0.992575
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.007425
positive prediction rate = 0.024066
AUC of ROC = 0.842113
AUC of PRC = 0.469595
min(+P, Se) = 0.439689

-------------------------------

confusion matrix:
[[1165   14]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.06813299655914307
difference in average predicted and observed risk = -0.022846003440856938
number samples = 1297
accuracy = 0.915189
precision class 0 = 0.92387
precision class 1 = 0.611111
recall class 0 = 0.988126
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.011874
positive prediction rate = 0.027756
AUC of ROC = 0.845122
AUC of PRC = 0.424223
min(+P, Se) = 0.398305

-------------------------------

confusion matrix:
[[653   3]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0721220001578331
difference in average predicted and observed risk = -0.029247999842166902
number samples = 730
accuracy = 0.913699
precision class 0 = 0.915849
precision class 1 = 0.823529
recall class 0 = 0.995427
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.004573
positive prediction rate = 0.023288
AUC of ROC = 0.845192
AUC of PRC = 0.48347
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.0908920019865036
difference in average predicted and observed risk = -0.03476199801349639
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.93014
AUC of PRC = 0.756418
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[2452   22]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0664990022778511
difference in average predicted and observed risk = -0.02694199772214889
number samples = 2729
accuracy = 0.915354
precision class 0 = 0.921458
precision class 1 = 0.676471
recall class 0 = 0.991108
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.008892
positive prediction rate = 0.024918
AUC of ROC = 0.840289
AUC of PRC = 0.42575
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1670   13]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.07683499902486801
difference in average predicted and observed risk = -0.036909000975131986
number samples = 1899
accuracy = 0.902054
precision class 0 = 0.906131
precision class 1 = 0.767857
recall class 0 = 0.992276
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.007724
positive prediction rate = 0.029489
AUC of ROC = 0.854856
AUC of PRC = 0.523546
min(+P, Se) = 0.481651

-------------------------------

confusion matrix:
[[543   6]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.0805400013923645
difference in average predicted and observed risk = -0.0424629986076355
number samples = 626
accuracy = 0.881789
precision class 0 = 0.888707
precision class 1 = 0.6
recall class 0 = 0.989071
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.010929
positive prediction rate = 0.023962
AUC of ROC = 0.833392
AUC of PRC = 0.429182
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2241    8]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.05713700130581856
difference in average predicted and observed risk = -0.027518998694181437
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.927182
precision class 1 = 0.8
recall class 0 = 0.996443
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.003557
positive prediction rate = 0.01628
AUC of ROC = 0.849048
AUC of PRC = 0.421251
min(+P, Se) = 0.389344

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0737290009856224
difference in average predicted and observed risk = -0.0270769990143776
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.74565
AUC of PRC = 0.236431
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[470  11]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.10974200069904327
difference in average predicted and observed risk = -0.035905999300956726
number samples = 563
accuracy = 0.889876
precision class 0 = 0.902111
precision class 1 = 0.738095
recall class 0 = 0.977131
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.022869
positive prediction rate = 0.0746
AUC of ROC = 0.882359
AUC of PRC = 0.662017
min(+P, Se) = 0.561798

-------------------------------

confusion matrix:
[[649   6]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.07698900252580643
difference in average predicted and observed risk = -0.030639997474193575
number samples = 734
accuracy = 0.907357
precision class 0 = 0.912799
precision class 1 = 0.73913
recall class 0 = 0.99084
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.00916
positive prediction rate = 0.031335
AUC of ROC = 0.834206
AUC of PRC = 0.479498
min(+P, Se) = 0.44186

-------------------------------

confusion matrix:
[[4122   35]
 [ 382   89]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0707399994134903
difference in average predicted and observed risk = -0.031032000586509706
number samples = 4628
accuracy = 0.909896
precision class 0 = 0.915187
precision class 1 = 0.717742
recall class 0 = 0.99158
recall class 1 = 0.18896
false negative rate = 0.81104
false positive rate = 0.00842
positive prediction rate = 0.026793
AUC of ROC = 0.847546
AUC of PRC = 0.473596
min(+P, Se) = 0.444915

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.06554699689149857
difference in average predicted and observed risk = -0.014622003108501438
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.892805
AUC of PRC = 0.4155
min(+P, Se) = 0.47619

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.06255599856376648
difference in average predicted and observed risk = -0.046240001436233524
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.845758
AUC of PRC = 0.442835
min(+P, Se) = 0.479167

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.09296400099992752
difference in average predicted and observed risk = -0.017204999000072482
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.917949
AUC of PRC = 0.531223
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.10385700315237045
difference in average predicted and observed risk = -0.029475996847629554
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.07417599856853485
difference in average predicted and observed risk = -0.04086800143146514
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.855214
AUC of PRC = 0.389399
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[432   2]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.06589700281620026
difference in average predicted and observed risk = -0.02615299718379975
number samples = 478
accuracy = 0.922594
precision class 0 = 0.925054
precision class 1 = 0.818182
recall class 0 = 0.995392
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.004608
positive prediction rate = 0.023013
AUC of ROC = 0.888196
AUC of PRC = 0.546282
min(+P, Se) = 0.543478

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.05259200185537338
difference in average predicted and observed risk = -0.03660999814462662
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.896636
AUC of PRC = 0.497148
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09510699659585953
difference in average predicted and observed risk = -0.022540003404140474
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.922222
AUC of PRC = 0.637187
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.07039300352334976
difference in average predicted and observed risk = -0.018316996476650235
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.866452
AUC of PRC = 0.268166
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.09128300100564957
difference in average predicted and observed risk = -0.05832299899435042
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.828947
AUC of PRC = 0.56363
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.11098799854516983
difference in average predicted and observed risk = 0.03204099854516983
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[729   5]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.06933200359344482
difference in average predicted and observed risk = -0.032258996406555177
number samples = 817
accuracy = 0.906977
precision class 0 = 0.91125
precision class 1 = 0.705882
recall class 0 = 0.993188
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.006812
positive prediction rate = 0.020808
AUC of ROC = 0.876202
AUC of PRC = 0.478499
min(+P, Se) = 0.489796

-------------------------------

Epoch 00062: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch62.state
Epoch 63/100
 - 318s - loss: 0.2593 - val_loss: 0.2382

==>predicting on train



confusion matrix:
[[2143   12]
 [ 213   42]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09803300350904465
difference in average predicted and observed risk = -0.007775996490955353
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.909593
precision class 1 = 0.777778
recall class 0 = 0.994432
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.005568
positive prediction rate = 0.022407
AUC of ROC = 0.841012
AUC of PRC = 0.469779
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1168   11]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08702600002288818
difference in average predicted and observed risk = -0.003952999977111821
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.922591
precision class 1 = 0.645161
recall class 0 = 0.99067
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.00933
positive prediction rate = 0.023901
AUC of ROC = 0.852626
AUC of PRC = 0.433709
min(+P, Se) = 0.398305

-------------------------------

confusion matrix:
[[653   3]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09472600370645523
difference in average predicted and observed risk = -0.006643996293544771
number samples = 730
accuracy = 0.913699
precision class 0 = 0.915849
precision class 1 = 0.823529
recall class 0 = 0.995427
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.004573
positive prediction rate = 0.023288
AUC of ROC = 0.843111
AUC of PRC = 0.488998
min(+P, Se) = 0.457831

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10741499811410904
difference in average predicted and observed risk = -0.01823900188589095
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.942864
AUC of PRC = 0.768466
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2455   19]
 [ 210   45]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08833599835634232
difference in average predicted and observed risk = -0.005105001643657681
number samples = 2729
accuracy = 0.916086
precision class 0 = 0.921201
precision class 1 = 0.703125
recall class 0 = 0.99232
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.00768
positive prediction rate = 0.023452
AUC of ROC = 0.841097
AUC of PRC = 0.428684
min(+P, Se) = 0.414815

-------------------------------

confusion matrix:
[[1674    9]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10412400215864182
difference in average predicted and observed risk = -0.009619997841358183
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.905844
precision class 1 = 0.823529
recall class 0 = 0.994652
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.005348
positive prediction rate = 0.026856
AUC of ROC = 0.860379
AUC of PRC = 0.534716
min(+P, Se) = 0.490909

-------------------------------

confusion matrix:
[[544   5]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10515400022268295
difference in average predicted and observed risk = -0.01784899977731705
number samples = 626
accuracy = 0.881789
precision class 0 = 0.887439
precision class 1 = 0.615385
recall class 0 = 0.990893
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.009107
positive prediction rate = 0.020767
AUC of ROC = 0.843754
AUC of PRC = 0.441513
min(+P, Se) = 0.45679

-------------------------------

confusion matrix:
[[2242    7]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08212199807167053
difference in average predicted and observed risk = -0.002534001928329463
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.926829
precision class 1 = 0.815789
recall class 0 = 0.996888
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.003112
positive prediction rate = 0.015466
AUC of ROC = 0.847787
AUC of PRC = 0.419035
min(+P, Se) = 0.399083

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09708099812269211
difference in average predicted and observed risk = -0.0037250018773078986
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.763767
AUC of PRC = 0.249379
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[474   7]
 [ 51  31]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1300719976425171
difference in average predicted and observed risk = -0.01557600235748291
number samples = 563
accuracy = 0.89698
precision class 0 = 0.902857
precision class 1 = 0.815789
recall class 0 = 0.985447
recall class 1 = 0.378049
false negative rate = 0.621951
false positive rate = 0.014553
positive prediction rate = 0.067496
AUC of ROC = 0.88492
AUC of PRC = 0.665719
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[650   5]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10067100077867508
difference in average predicted and observed risk = -0.006957999221324923
number samples = 734
accuracy = 0.908719
precision class 0 = 0.912921
precision class 1 = 0.772727
recall class 0 = 0.992366
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.007634
positive prediction rate = 0.029973
AUC of ROC = 0.840893
AUC of PRC = 0.493948
min(+P, Se) = 0.47561

-------------------------------

confusion matrix:
[[4129   28]
 [ 384   87]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0948140025138855
difference in average predicted and observed risk = -0.006957997486114503
number samples = 4628
accuracy = 0.910977
precision class 0 = 0.914912
precision class 1 = 0.756522
recall class 0 = 0.993264
recall class 1 = 0.184713
false negative rate = 0.815287
false positive rate = 0.006736
positive prediction rate = 0.024849
AUC of ROC = 0.850084
AUC of PRC = 0.47875
min(+P, Se) = 0.454352

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08175300061702728
difference in average predicted and observed risk = 0.0015840006170272786
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.892323
AUC of PRC = 0.428444
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09142299741506577
difference in average predicted and observed risk = -0.01737300258493424
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.830671
AUC of PRC = 0.455613
min(+P, Se) = 0.471698

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11447399854660034
difference in average predicted and observed risk = 0.004304998546600339
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.904029
AUC of PRC = 0.513507
min(+P, Se) = 0.5625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12666399776935577
difference in average predicted and observed risk = -0.006669002230644233
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 37   2]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10120200365781784
difference in average predicted and observed risk = -0.013841996342182153
number samples = 339
accuracy = 0.884956
precision class 0 = 0.889552
precision class 1 = 0.5
recall class 0 = 0.993333
recall class 1 = 0.051282
false negative rate = 0.948718
false positive rate = 0.006667
positive prediction rate = 0.011799
AUC of ROC = 0.835641
AUC of PRC = 0.389606
min(+P, Se) = 0.45098

-------------------------------

confusion matrix:
[[432   2]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08759500086307526
difference in average predicted and observed risk = -0.0044549991369247505
number samples = 478
accuracy = 0.922594
precision class 0 = 0.925054
precision class 1 = 0.818182
recall class 0 = 0.995392
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.004608
positive prediction rate = 0.023013
AUC of ROC = 0.886154
AUC of PRC = 0.56375
min(+P, Se) = 0.568182

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07638300210237503
difference in average predicted and observed risk = -0.012818997897624973
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.882122
AUC of PRC = 0.509226
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11360599845647812
difference in average predicted and observed risk = -0.004041001543521883
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.919444
AUC of PRC = 0.691492
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09915599972009659
difference in average predicted and observed risk = 0.010445999720096591
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.868061
AUC of PRC = 0.293121
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11623699963092804
difference in average predicted and observed risk = -0.03336900036907195
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.81384
AUC of PRC = 0.551084
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13140900433063507
difference in average predicted and observed risk = 0.05246200433063507
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[730   4]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09324099868535995
difference in average predicted and observed risk = -0.008350001314640046
number samples = 817
accuracy = 0.906977
precision class 0 = 0.910224
precision class 1 = 0.733333
recall class 0 = 0.99455
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.00545
positive prediction rate = 0.01836
AUC of ROC = 0.867453
AUC of PRC = 0.493568
min(+P, Se) = 0.511364

-------------------------------

Epoch 00063: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch63.state
Epoch 64/100
 - 318s - loss: 0.2610 - val_loss: 0.2389

==>predicting on train



confusion matrix:
[[2131   24]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09060599654912949
difference in average predicted and observed risk = -0.015203003450870514
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.913808
precision class 1 = 0.692308
recall class 0 = 0.988863
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.011137
positive prediction rate = 0.032365
AUC of ROC = 0.833724
AUC of PRC = 0.453762
min(+P, Se) = 0.435798

-------------------------------

confusion matrix:
[[1161   18]
 [  92   26]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08416999876499176
difference in average predicted and observed risk = -0.006809001235008244
number samples = 1297
accuracy = 0.915189
precision class 0 = 0.926576
precision class 1 = 0.590909
recall class 0 = 0.984733
recall class 1 = 0.220339
false negative rate = 0.779661
false positive rate = 0.015267
positive prediction rate = 0.033924
AUC of ROC = 0.846875
AUC of PRC = 0.425031
min(+P, Se) = 0.381356

-------------------------------

confusion matrix:
[[648   8]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09473200142383575
difference in average predicted and observed risk = -0.006637998576164247
number samples = 730
accuracy = 0.910959
precision class 0 = 0.919149
precision class 1 = 0.68
recall class 0 = 0.987805
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.012195
positive prediction rate = 0.034247
AUC of ROC = 0.833986
AUC of PRC = 0.475631
min(+P, Se) = 0.453333

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10739299654960632
difference in average predicted and observed risk = -0.018261003450393665
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.942116
AUC of PRC = 0.779302
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2444   30]
 [ 197   58]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08301399648189545
difference in average predicted and observed risk = -0.01042700351810455
number samples = 2729
accuracy = 0.916819
precision class 0 = 0.925407
precision class 1 = 0.659091
recall class 0 = 0.987874
recall class 1 = 0.227451
false negative rate = 0.772549
false positive rate = 0.012126
positive prediction rate = 0.032246
AUC of ROC = 0.835743
AUC of PRC = 0.418787
min(+P, Se) = 0.407843

-------------------------------

confusion matrix:
[[1661   22]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10039500147104263
difference in average predicted and observed risk = -0.013348998528957365
number samples = 1899
accuracy = 0.901
precision class 0 = 0.909141
precision class 1 = 0.694444
recall class 0 = 0.986928
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.013072
positive prediction rate = 0.037915
AUC of ROC = 0.851362
AUC of PRC = 0.519675
min(+P, Se) = 0.463964

-------------------------------

confusion matrix:
[[541   8]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10379999876022339
difference in average predicted and observed risk = -0.019203001239776613
number samples = 626
accuracy = 0.886581
precision class 0 = 0.895695
precision class 1 = 0.636364
recall class 0 = 0.985428
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.014572
positive prediction rate = 0.035144
AUC of ROC = 0.838124
AUC of PRC = 0.435926
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[2232   17]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07376699894666672
difference in average predicted and observed risk = -0.010889001053333278
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.928453
precision class 1 = 0.679245
recall class 0 = 0.992441
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.007559
positive prediction rate = 0.021571
AUC of ROC = 0.841102
AUC of PRC = 0.401206
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09093999862670898
difference in average predicted and observed risk = -0.009866001373291022
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.753543
AUC of PRC = 0.245307
min(+P, Se) = 0.321429

-------------------------------

confusion matrix:
[[468  13]
 [ 48  34]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13249799609184265
difference in average predicted and observed risk = -0.013150003908157348
number samples = 563
accuracy = 0.891652
precision class 0 = 0.906977
precision class 1 = 0.723404
recall class 0 = 0.972973
recall class 1 = 0.414634
false negative rate = 0.585366
false positive rate = 0.027027
positive prediction rate = 0.083481
AUC of ROC = 0.87919
AUC of PRC = 0.664579
min(+P, Se) = 0.554217

-------------------------------

confusion matrix:
[[646   9]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10057699680328369
difference in average predicted and observed risk = -0.007052003196716311
number samples = 734
accuracy = 0.910082
precision class 0 = 0.918919
precision class 1 = 0.709677
recall class 0 = 0.98626
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.01374
positive prediction rate = 0.042234
AUC of ROC = 0.829491
AUC of PRC = 0.47472
min(+P, Se) = 0.468354

-------------------------------

confusion matrix:
[[4105   52]
 [ 363  108]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09014599770307541
difference in average predicted and observed risk = -0.011626002296924592
number samples = 4628
accuracy = 0.910328
precision class 0 = 0.918756
precision class 1 = 0.675
recall class 0 = 0.987491
recall class 1 = 0.229299
false negative rate = 0.770701
false positive rate = 0.012509
positive prediction rate = 0.034572
AUC of ROC = 0.843081
AUC of PRC = 0.466674
min(+P, Se) = 0.437367

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08076799660921097
difference in average predicted and observed risk = 0.0005989966092109639
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.892805
AUC of PRC = 0.403976
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08455300331115723
difference in average predicted and observed risk = -0.024242996688842777
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.817574
AUC of PRC = 0.43383
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11745300143957138
difference in average predicted and observed risk = 0.007284001439571378
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.901099
AUC of PRC = 0.534517
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12051299959421158
difference in average predicted and observed risk = -0.012820000405788429
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09861099720001221
difference in average predicted and observed risk = -0.016433002799987786
number samples = 339
accuracy = 0.890855
precision class 0 = 0.897281
precision class 1 = 0.625
recall class 0 = 0.99
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.01
positive prediction rate = 0.023599
AUC of ROC = 0.819402
AUC of PRC = 0.355532
min(+P, Se) = 0.386364

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08308500051498413
difference in average predicted and observed risk = -0.008964999485015876
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.882698
AUC of PRC = 0.559171
min(+P, Se) = 0.565217

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07016800343990326
difference in average predicted and observed risk = -0.019033996560096744
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.869574
AUC of PRC = 0.44973
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[88  2]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11678899824619293
difference in average predicted and observed risk = -0.0008580017538070694
number samples = 102
accuracy = 0.911765
precision class 0 = 0.926316
precision class 1 = 0.714286
recall class 0 = 0.977778
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.022222
positive prediction rate = 0.068627
AUC of ROC = 0.918519
AUC of PRC = 0.658395
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09454900026321411
difference in average predicted and observed risk = 0.005839000263214114
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.849558
AUC of PRC = 0.267075
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11541400104761124
difference in average predicted and observed risk = -0.03419199895238875
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.807018
AUC of PRC = 0.545234
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13046999275684357
difference in average predicted and observed risk = 0.051522992756843564
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[728   6]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08952700346708298
difference in average predicted and observed risk = -0.012063996532917023
number samples = 817
accuracy = 0.910649
precision class 0 = 0.915723
precision class 1 = 0.727273
recall class 0 = 0.991826
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.008174
positive prediction rate = 0.026928
AUC of ROC = 0.859066
AUC of PRC = 0.471575
min(+P, Se) = 0.471264

-------------------------------

Epoch 00064: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch64.state
Epoch 65/100
 - 320s - loss: 0.2545 - val_loss: 0.2358

==>predicting on train



confusion matrix:
[[2134   21]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0954120010137558
difference in average predicted and observed risk = -0.010396998986244202
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.912746
precision class 1 = 0.708333
recall class 0 = 0.990255
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.009745
positive prediction rate = 0.029876
AUC of ROC = 0.841443
AUC of PRC = 0.471417
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1163   16]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08798299729824066
difference in average predicted and observed risk = -0.0029960027017593427
number samples = 1297
accuracy = 0.915189
precision class 0 = 0.925219
precision class 1 = 0.6
recall class 0 = 0.986429
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.013571
positive prediction rate = 0.03084
AUC of ROC = 0.857147
AUC of PRC = 0.437256
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[649   7]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09607499837875366
difference in average predicted and observed risk = -0.00529500162124634
number samples = 730
accuracy = 0.910959
precision class 0 = 0.917963
precision class 1 = 0.695652
recall class 0 = 0.989329
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.010671
positive prediction rate = 0.031507
AUC of ROC = 0.855059
AUC of PRC = 0.493186
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10804600268602371
difference in average predicted and observed risk = -0.017607997313976276
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.952096
AUC of PRC = 0.793424
min(+P, Se) = 0.692308

-------------------------------

confusion matrix:
[[2450   24]
 [ 199   56]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08708299696445465
difference in average predicted and observed risk = -0.006358003035545345
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.924877
precision class 1 = 0.7
recall class 0 = 0.990299
recall class 1 = 0.219608
false negative rate = 0.780392
false positive rate = 0.009701
positive prediction rate = 0.029315
AUC of ROC = 0.848322
AUC of PRC = 0.437968
min(+P, Se) = 0.420849

-------------------------------

confusion matrix:
[[1661   22]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10383299738168716
difference in average predicted and observed risk = -0.009911002618312834
number samples = 1899
accuracy = 0.898894
precision class 0 = 0.907155
precision class 1 = 0.676471
recall class 0 = 0.986928
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.013072
positive prediction rate = 0.035808
AUC of ROC = 0.859362
AUC of PRC = 0.532565
min(+P, Se) = 0.481818

-------------------------------

confusion matrix:
[[542   7]
 [ 64  13]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10956399887800217
difference in average predicted and observed risk = -0.013439001121997834
number samples = 626
accuracy = 0.886581
precision class 0 = 0.894389
precision class 1 = 0.65
recall class 0 = 0.98725
recall class 1 = 0.168831
false negative rate = 0.831169
false positive rate = 0.01275
positive prediction rate = 0.031949
AUC of ROC = 0.847752
AUC of PRC = 0.456434
min(+P, Se) = 0.457831

-------------------------------

confusion matrix:
[[2235   14]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07819899916648865
difference in average predicted and observed risk = -0.006457000833511348
number samples = 2457
accuracy = 0.923484
precision class 0 = 0.927771
precision class 1 = 0.708333
recall class 0 = 0.993775
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.006225
positive prediction rate = 0.019536
AUC of ROC = 0.852674
AUC of PRC = 0.425401
min(+P, Se) = 0.400943

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10145699977874756
difference in average predicted and observed risk = 0.0006509997787475519
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.759821
AUC of PRC = 0.249148
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[470  11]
 [ 48  34]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1333959996700287
difference in average predicted and observed risk = -0.012252000329971313
number samples = 563
accuracy = 0.895204
precision class 0 = 0.907336
precision class 1 = 0.755556
recall class 0 = 0.977131
recall class 1 = 0.414634
false negative rate = 0.585366
false positive rate = 0.022869
positive prediction rate = 0.079929
AUC of ROC = 0.889534
AUC of PRC = 0.676847
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[646   9]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10060299932956696
difference in average predicted and observed risk = -0.007026000670433047
number samples = 734
accuracy = 0.907357
precision class 0 = 0.916312
precision class 1 = 0.689655
recall class 0 = 0.98626
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.01374
positive prediction rate = 0.03951
AUC of ROC = 0.839231
AUC of PRC = 0.474414
min(+P, Se) = 0.469136

-------------------------------

confusion matrix:
[[4111   46]
 [ 369  102]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09395600110292435
difference in average predicted and observed risk = -0.007815998897075654
number samples = 4628
accuracy = 0.910328
precision class 0 = 0.917634
precision class 1 = 0.689189
recall class 0 = 0.988934
recall class 1 = 0.216561
false negative rate = 0.78344
false positive rate = 0.011066
positive prediction rate = 0.031979
AUC of ROC = 0.853503
AUC of PRC = 0.482762
min(+P, Se) = 0.454352

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08431600034236908
difference in average predicted and observed risk = 0.0041470003423690754
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.889184
AUC of PRC = 0.411048
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08745600283145905
difference in average predicted and observed risk = -0.02133999716854096
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.836364
AUC of PRC = 0.466753
min(+P, Se) = 0.489362

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11796800047159195
difference in average predicted and observed risk = 0.007799000471591946
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.912821
AUC of PRC = 0.524549
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11986500024795532
difference in average predicted and observed risk = -0.013467999752044685
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10010799765586853
difference in average predicted and observed risk = -0.014936002344131463
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.835812
AUC of PRC = 0.372171
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[432   2]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08649200201034546
difference in average predicted and observed risk = -0.005557997989654548
number samples = 478
accuracy = 0.924686
precision class 0 = 0.927039
precision class 1 = 0.833333
recall class 0 = 0.995392
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.004608
positive prediction rate = 0.025105
AUC of ROC = 0.887359
AUC of PRC = 0.572218
min(+P, Se) = 0.568627

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07290799915790558
difference in average predicted and observed risk = -0.016294000842094425
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.879002
AUC of PRC = 0.475835
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11849799752235413
difference in average predicted and observed risk = 0.0008509975223541244
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.922222
AUC of PRC = 0.658174
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09874700009822845
difference in average predicted and observed risk = 0.010037000098228457
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.864843
AUC of PRC = 0.277136
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11626599729061127
difference in average predicted and observed risk = -0.03334000270938872
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.827485
AUC of PRC = 0.580264
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13483700156211853
difference in average predicted and observed risk = 0.05589000156211853
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0921420007944107
difference in average predicted and observed risk = -0.009448999205589295
number samples = 817
accuracy = 0.909425
precision class 0 = 0.913534
precision class 1 = 0.736842
recall class 0 = 0.993188
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.006812
positive prediction rate = 0.023256
AUC of ROC = 0.868455
AUC of PRC = 0.487295
min(+P, Se) = 0.506024

-------------------------------

Epoch 00065: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch65.state
Epoch 66/100
 - 323s - loss: 0.2556 - val_loss: 0.2399

==>predicting on train



confusion matrix:
[[2138   17]
 [ 207   48]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11107700318098068
difference in average predicted and observed risk = 0.005268003180980682
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.911727
precision class 1 = 0.738462
recall class 0 = 0.992111
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.007889
positive prediction rate = 0.026971
AUC of ROC = 0.83841
AUC of PRC = 0.471346
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[1169   10]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09635300189256668
difference in average predicted and observed risk = 0.005374001892566677
number samples = 1297
accuracy = 0.916731
precision class 0 = 0.922652
precision class 1 = 0.666667
recall class 0 = 0.991518
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.008482
positive prediction rate = 0.02313
AUC of ROC = 0.858376
AUC of PRC = 0.447511
min(+P, Se) = 0.432203

-------------------------------

confusion matrix:
[[655   1]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10628200322389603
difference in average predicted and observed risk = 0.004912003223896025
number samples = 730
accuracy = 0.915069
precision class 0 = 0.914804
precision class 1 = 0.928571
recall class 0 = 0.998476
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.001524
positive prediction rate = 0.019178
AUC of ROC = 0.846655
AUC of PRC = 0.49405
min(+P, Se) = 0.4625

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11737100034952164
difference in average predicted and observed risk = -0.008282999650478351
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.951098
AUC of PRC = 0.802973
min(+P, Se) = 0.730769

-------------------------------

confusion matrix:
[[2455   19]
 [ 207   48]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09701299667358398
difference in average predicted and observed risk = 0.003571996673583988
number samples = 2729
accuracy = 0.917186
precision class 0 = 0.922239
precision class 1 = 0.716418
recall class 0 = 0.99232
recall class 1 = 0.188235
false negative rate = 0.811765
false positive rate = 0.00768
positive prediction rate = 0.024551
AUC of ROC = 0.845291
AUC of PRC = 0.44035
min(+P, Se) = 0.429119

-------------------------------

confusion matrix:
[[1672   11]
 [ 172   44]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.12002100050449371
difference in average predicted and observed risk = 0.0062770005044937155
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.906725
precision class 1 = 0.8
recall class 0 = 0.993464
recall class 1 = 0.203704
false negative rate = 0.796296
false positive rate = 0.006536
positive prediction rate = 0.028963
AUC of ROC = 0.859117
AUC of PRC = 0.535042
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[544   5]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12144400179386139
difference in average predicted and observed risk = -0.001558998206138612
number samples = 626
accuracy = 0.883387
precision class 0 = 0.888889
precision class 1 = 0.642857
recall class 0 = 0.990893
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.009107
positive prediction rate = 0.022364
AUC of ROC = 0.83985
AUC of PRC = 0.451984
min(+P, Se) = 0.480519

-------------------------------

confusion matrix:
[[2240    9]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09188199788331985
difference in average predicted and observed risk = 0.00722599788331986
number samples = 2457
accuracy = 0.923891
precision class 0 = 0.926385
precision class 1 = 0.769231
recall class 0 = 0.995998
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.004002
positive prediction rate = 0.015873
AUC of ROC = 0.851119
AUC of PRC = 0.42296
min(+P, Se) = 0.409524

-------------------------------

confusion matrix:
[[221   2]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11506800353527069
difference in average predicted and observed risk = 0.014262003535270684
number samples = 248
accuracy = 0.891129
precision class 0 = 0.898374
precision class 1 = 0.0
recall class 0 = 0.991031
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.008969
positive prediction rate = 0.008065
AUC of ROC = 0.754798
AUC of PRC = 0.25615
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[474   7]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1417829990386963
difference in average predicted and observed risk = -0.0038650009613037106
number samples = 563
accuracy = 0.904085
precision class 0 = 0.909789
precision class 1 = 0.833333
recall class 0 = 0.985447
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.014553
positive prediction rate = 0.0746
AUC of ROC = 0.88388
AUC of PRC = 0.674032
min(+P, Se) = 0.585366

-------------------------------

confusion matrix:
[[648   7]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11243899911642075
difference in average predicted and observed risk = 0.004809999116420743
number samples = 734
accuracy = 0.907357
precision class 0 = 0.913963
precision class 1 = 0.72
recall class 0 = 0.989313
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.010687
positive prediction rate = 0.03406
AUC of ROC = 0.842961
AUC of PRC = 0.491727
min(+P, Se) = 0.482353

-------------------------------

confusion matrix:
[[4127   30]
 [ 379   92]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10645399987697601
difference in average predicted and observed risk = 0.004681999876976012
number samples = 4628
accuracy = 0.911625
precision class 0 = 0.91589
precision class 1 = 0.754098
recall class 0 = 0.992783
recall class 1 = 0.195329
false negative rate = 0.804671
false positive rate = 0.007217
positive prediction rate = 0.026361
AUC of ROC = 0.851283
AUC of PRC = 0.485865
min(+P, Se) = 0.466245

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09282500296831131
difference in average predicted and observed risk = 0.012656002968311306
number samples = 237
accuracy = 0.911392
precision class 0 = 0.926407
precision class 1 = 0.333333
recall class 0 = 0.981651
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018349
positive prediction rate = 0.025316
AUC of ROC = 0.894978
AUC of PRC = 0.430356
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10487599670886993
difference in average predicted and observed risk = -0.00392000329113007
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.813982
AUC of PRC = 0.444789
min(+P, Se) = 0.458333

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12868499755859375
difference in average predicted and observed risk = 0.018515997558593747
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.906227
AUC of PRC = 0.522678
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13027800619602203
difference in average predicted and observed risk = -0.0030549938039779734
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11892200261354446
difference in average predicted and observed risk = 0.0038780026135444706
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.828462
AUC of PRC = 0.380759
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[431   3]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09641099721193314
difference in average predicted and observed risk = 0.004360997211933129
number samples = 478
accuracy = 0.922594
precision class 0 = 0.926882
precision class 1 = 0.769231
recall class 0 = 0.993088
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.006912
positive prediction rate = 0.027197
AUC of ROC = 0.879294
AUC of PRC = 0.559019
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08736799657344818
difference in average predicted and observed risk = -0.0018340034265518224
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.86252
AUC of PRC = 0.504696
min(+P, Se) = 0.475

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12640899419784546
difference in average predicted and observed risk = 0.008761994197845457
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.921296
AUC of PRC = 0.673268
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11555399745702744
difference in average predicted and observed risk = 0.026843997457027438
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.848753
AUC of PRC = 0.261961
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12734800577163696
difference in average predicted and observed risk = -0.022257994228363026
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.824561
AUC of PRC = 0.562516
min(+P, Se) = 0.631579

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1522269994020462
difference in average predicted and observed risk = 0.0732799994020462
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10575199872255325
difference in average predicted and observed risk = 0.004160998722553252
number samples = 817
accuracy = 0.908201
precision class 0 = 0.913425
precision class 1 = 0.7
recall class 0 = 0.991826
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.008174
positive prediction rate = 0.02448
AUC of ROC = 0.860412
AUC of PRC = 0.488531
min(+P, Se) = 0.506024

-------------------------------

Epoch 00066: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch66.state
Epoch 67/100
 - 321s - loss: 0.2555 - val_loss: 0.2358

==>predicting on train



confusion matrix:
[[2132   23]
 [ 199   56]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09705600142478943
difference in average predicted and observed risk = -0.008752998575210572
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.914629
precision class 1 = 0.708861
recall class 0 = 0.989327
recall class 1 = 0.219608
false negative rate = 0.780392
false positive rate = 0.010673
positive prediction rate = 0.03278
AUC of ROC = 0.842488
AUC of PRC = 0.468523
min(+P, Se) = 0.443182

-------------------------------

confusion matrix:
[[1163   16]
 [  90   28]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09263800084590912
difference in average predicted and observed risk = 0.0016590008459091143
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.928172
precision class 1 = 0.636364
recall class 0 = 0.986429
recall class 1 = 0.237288
false negative rate = 0.762712
false positive rate = 0.013571
positive prediction rate = 0.033924
AUC of ROC = 0.860762
AUC of PRC = 0.442922
min(+P, Se) = 0.398374

-------------------------------

confusion matrix:
[[650   6]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10520599782466888
difference in average predicted and observed risk = 0.0038359978246688825
number samples = 730
accuracy = 0.913699
precision class 0 = 0.919378
precision class 1 = 0.73913
recall class 0 = 0.990854
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.009146
positive prediction rate = 0.031507
AUC of ROC = 0.855822
AUC of PRC = 0.493771
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10671400278806686
difference in average predicted and observed risk = -0.018939997211933124
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.953593
AUC of PRC = 0.806011
min(+P, Se) = 0.68

-------------------------------

confusion matrix:
[[2448   26]
 [ 193   62]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09239500015974045
difference in average predicted and observed risk = -0.0010459998402595483
number samples = 2729
accuracy = 0.919751
precision class 0 = 0.926922
precision class 1 = 0.704545
recall class 0 = 0.989491
recall class 1 = 0.243137
false negative rate = 0.756863
false positive rate = 0.010509
positive prediction rate = 0.032246
AUC of ROC = 0.848658
AUC of PRC = 0.442222
min(+P, Se) = 0.429658

-------------------------------

confusion matrix:
[[1662   21]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10484100133180618
difference in average predicted and observed risk = -0.008902998668193815
number samples = 1899
accuracy = 0.901527
precision class 0 = 0.90919
precision class 1 = 0.704225
recall class 0 = 0.987522
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.012478
positive prediction rate = 0.037388
AUC of ROC = 0.861851
AUC of PRC = 0.530642
min(+P, Se) = 0.477477

-------------------------------

confusion matrix:
[[543   6]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11186099797487259
difference in average predicted and observed risk = -0.011142002025127412
number samples = 626
accuracy = 0.891374
precision class 0 = 0.897521
precision class 1 = 0.714286
recall class 0 = 0.989071
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.010929
positive prediction rate = 0.033546
AUC of ROC = 0.847349
AUC of PRC = 0.45656
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2236   13]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08031199872493744
difference in average predicted and observed risk = -0.004344001275062556
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.928571
precision class 1 = 0.734694
recall class 0 = 0.99422
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.00578
positive prediction rate = 0.019943
AUC of ROC = 0.858696
AUC of PRC = 0.423118
min(+P, Se) = 0.390698

-------------------------------

confusion matrix:
[[218   5]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10467600077390671
difference in average predicted and observed risk = 0.003870000773906701
number samples = 248
accuracy = 0.883065
precision class 0 = 0.900826
precision class 1 = 0.166667
recall class 0 = 0.977578
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.022422
positive prediction rate = 0.024194
AUC of ROC = 0.752466
AUC of PRC = 0.250716
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[469  12]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14312300086021423
difference in average predicted and observed risk = -0.0025249991397857663
number samples = 563
accuracy = 0.900533
precision class 0 = 0.91423
precision class 1 = 0.76
recall class 0 = 0.975052
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.024948
positive prediction rate = 0.08881
AUC of ROC = 0.888951
AUC of PRC = 0.681906
min(+P, Se) = 0.560976

-------------------------------

confusion matrix:
[[644  11]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10538099706172943
difference in average predicted and observed risk = -0.0022480029382705713
number samples = 734
accuracy = 0.907357
precision class 0 = 0.918688
precision class 1 = 0.666667
recall class 0 = 0.983206
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.016794
positive prediction rate = 0.044959
AUC of ROC = 0.835888
AUC of PRC = 0.481663
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4110   47]
 [ 359  112]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09750200062990189
difference in average predicted and observed risk = -0.004269999370098115
number samples = 4628
accuracy = 0.912273
precision class 0 = 0.919669
precision class 1 = 0.704403
recall class 0 = 0.988694
recall class 1 = 0.237792
false negative rate = 0.762208
false positive rate = 0.011306
positive prediction rate = 0.034356
AUC of ROC = 0.854907
AUC of PRC = 0.483242
min(+P, Se) = 0.449153

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08871100097894669
difference in average predicted and observed risk = 0.008542000978946682
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.888701
AUC of PRC = 0.418204
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09000399708747864
difference in average predicted and observed risk = -0.018792002912521366
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.8294
AUC of PRC = 0.453619
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.13120000064373016
difference in average predicted and observed risk = 0.02103100064373016
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.918681
AUC of PRC = 0.584828
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12110800296068192
difference in average predicted and observed risk = -0.012224997039318092
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10327500104904175
difference in average predicted and observed risk = -0.011768998950958245
number samples = 339
accuracy = 0.890855
precision class 0 = 0.897281
precision class 1 = 0.625
recall class 0 = 0.99
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.01
positive prediction rate = 0.023599
AUC of ROC = 0.833846
AUC of PRC = 0.379676
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[429   5]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09207399934530258
difference in average predicted and observed risk = 2.399934530257497e-05
number samples = 478
accuracy = 0.922594
precision class 0 = 0.930586
precision class 1 = 0.705882
recall class 0 = 0.988479
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.011521
positive prediction rate = 0.035565
AUC of ROC = 0.883274
AUC of PRC = 0.552378
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07597500085830688
difference in average predicted and observed risk = -0.013226999141693119
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.877374
AUC of PRC = 0.513635
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[86  4]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12884199619293213
difference in average predicted and observed risk = 0.011194996192932127
number samples = 102
accuracy = 0.892157
precision class 0 = 0.924731
precision class 1 = 0.555556
recall class 0 = 0.955556
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.044444
positive prediction rate = 0.088235
AUC of ROC = 0.928704
AUC of PRC = 0.616627
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10418900102376938
difference in average predicted and observed risk = 0.015479001023769381
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.861625
AUC of PRC = 0.279629
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1201310008764267
difference in average predicted and observed risk = -0.029474999123573292
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.814327
AUC of PRC = 0.560056
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14047199487686157
difference in average predicted and observed risk = 0.06152499487686157
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.549206
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[726   8]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09672100096940994
difference in average predicted and observed risk = -0.004869999030590058
number samples = 817
accuracy = 0.909425
precision class 0 = 0.916667
precision class 1 = 0.68
recall class 0 = 0.989101
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.010899
positive prediction rate = 0.0306
AUC of ROC = 0.865221
AUC of PRC = 0.484092
min(+P, Se) = 0.493976

-------------------------------

Epoch 00067: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch67.state
Epoch 68/100
 - 324s - loss: 0.2555 - val_loss: 0.2403

==>predicting on train



confusion matrix:
[[2141   14]
 [ 213   42]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09260299801826477
difference in average predicted and observed risk = -0.01320600198173523
number samples = 2410
accuracy = 0.905809
precision class 0 = 0.909516
precision class 1 = 0.75
recall class 0 = 0.993503
recall class 1 = 0.164706
false negative rate = 0.835294
false positive rate = 0.006497
positive prediction rate = 0.023237
AUC of ROC = 0.839137
AUC of PRC = 0.464592
min(+P, Se) = 0.44697

-------------------------------

confusion matrix:
[[1172    7]
 [ 100   18]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08664599806070328
difference in average predicted and observed risk = -0.004333001939296727
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.921384
precision class 1 = 0.72
recall class 0 = 0.994063
recall class 1 = 0.152542
false negative rate = 0.847458
false positive rate = 0.005937
positive prediction rate = 0.019275
AUC of ROC = 0.859303
AUC of PRC = 0.450916
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[655   1]
 [ 63  11]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09795399755239487
difference in average predicted and observed risk = -0.003416002447605135
number samples = 730
accuracy = 0.912329
precision class 0 = 0.912256
precision class 1 = 0.916667
recall class 0 = 0.998476
recall class 1 = 0.148649
false negative rate = 0.851351
false positive rate = 0.001524
positive prediction rate = 0.016438
AUC of ROC = 0.849065
AUC of PRC = 0.500849
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10316699743270874
difference in average predicted and observed risk = -0.022487002567291248
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.946856
AUC of PRC = 0.795262
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2456   18]
 [ 215   40]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08802299946546555
difference in average predicted and observed risk = -0.005418000534534451
number samples = 2729
accuracy = 0.914621
precision class 0 = 0.919506
precision class 1 = 0.689655
recall class 0 = 0.992724
recall class 1 = 0.156863
false negative rate = 0.843137
false positive rate = 0.007276
positive prediction rate = 0.021253
AUC of ROC = 0.844218
AUC of PRC = 0.44198
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[1677    6]
 [ 174   42]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09823600202798843
difference in average predicted and observed risk = -0.015507997972011564
number samples = 1899
accuracy = 0.905213
precision class 0 = 0.905997
precision class 1 = 0.875
recall class 0 = 0.996435
recall class 1 = 0.194444
false negative rate = 0.805556
false positive rate = 0.003565
positive prediction rate = 0.025276
AUC of ROC = 0.859494
AUC of PRC = 0.533217
min(+P, Se) = 0.486111

-------------------------------

confusion matrix:
[[545   4]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10683300346136093
difference in average predicted and observed risk = -0.01616999653863907
number samples = 626
accuracy = 0.881789
precision class 0 = 0.886179
precision class 1 = 0.636364
recall class 0 = 0.992714
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.007286
positive prediction rate = 0.017572
AUC of ROC = 0.845433
AUC of PRC = 0.468306
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2242    7]
 [ 180   28]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07711900025606155
difference in average predicted and observed risk = -0.007536999743938441
number samples = 2457
accuracy = 0.923891
precision class 0 = 0.925681
precision class 1 = 0.8
recall class 0 = 0.996888
recall class 1 = 0.134615
false negative rate = 0.865385
false positive rate = 0.003112
positive prediction rate = 0.014245
AUC of ROC = 0.852253
AUC of PRC = 0.422247
min(+P, Se) = 0.389671

-------------------------------

confusion matrix:
[[221   2]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09806200116872787
difference in average predicted and observed risk = -0.002743998831272132
number samples = 248
accuracy = 0.891129
precision class 0 = 0.898374
precision class 1 = 0.0
recall class 0 = 0.991031
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.008969
positive prediction rate = 0.008065
AUC of ROC = 0.75157
AUC of PRC = 0.24968
min(+P, Se) = 0.346154

-------------------------------

confusion matrix:
[[474   7]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1310189962387085
difference in average predicted and observed risk = -0.014629003761291504
number samples = 563
accuracy = 0.900533
precision class 0 = 0.90631
precision class 1 = 0.825
recall class 0 = 0.985447
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.014553
positive prediction rate = 0.071048
AUC of ROC = 0.884666
AUC of PRC = 0.676284
min(+P, Se) = 0.586207

-------------------------------

confusion matrix:
[[651   4]
 [ 65  14]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09853299707174301
difference in average predicted and observed risk = -0.009096002928256991
number samples = 734
accuracy = 0.905995
precision class 0 = 0.909218
precision class 1 = 0.777778
recall class 0 = 0.993893
recall class 1 = 0.177215
false negative rate = 0.822785
false positive rate = 0.006107
positive prediction rate = 0.024523
AUC of ROC = 0.839018
AUC of PRC = 0.494481
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[4133   24]
 [ 389   82]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09221400320529938
difference in average predicted and observed risk = -0.009557996794700624
number samples = 4628
accuracy = 0.910761
precision class 0 = 0.913976
precision class 1 = 0.773585
recall class 0 = 0.994227
recall class 1 = 0.174098
false negative rate = 0.825902
false positive rate = 0.005773
positive prediction rate = 0.022904
AUC of ROC = 0.85186
AUC of PRC = 0.485884
min(+P, Se) = 0.459794

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08313000202178955
difference in average predicted and observed risk = 0.0029610020217895466
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.889667
AUC of PRC = 0.397884
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0877939984202385
difference in average predicted and observed risk = -0.02100200157976151
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.822161
AUC of PRC = 0.449329
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[104   1]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11985400319099426
difference in average predicted and observed risk = 0.00968500319099426
number samples = 118
accuracy = 0.923729
precision class 0 = 0.928571
precision class 1 = 0.833333
recall class 0 = 0.990476
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.009524
positive prediction rate = 0.050847
AUC of ROC = 0.90989
AUC of PRC = 0.597681
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12014999985694885
difference in average predicted and observed risk = -0.013183000143051155
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09743300080299377
difference in average predicted and observed risk = -0.01761099919700622
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.832051
AUC of PRC = 0.384502
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08859100192785263
difference in average predicted and observed risk = -0.003458998072147376
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.877461
AUC of PRC = 0.555095
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07273200154304504
difference in average predicted and observed risk = -0.01646999845695496
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.870863
AUC of PRC = 0.496359
min(+P, Se) = 0.475

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11681400239467621
difference in average predicted and observed risk = -0.0008329976053237931
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.922222
AUC of PRC = 0.657506
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10130699723958969
difference in average predicted and observed risk = 0.012596997239589694
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.843926
AUC of PRC = 0.261561
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1158600002527237
difference in average predicted and observed risk = -0.033745999747276295
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.816277
AUC of PRC = 0.544086
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13686999678611755
difference in average predicted and observed risk = 0.05792299678611755
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.255952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09226000308990479
difference in average predicted and observed risk = -0.009330996910095216
number samples = 817
accuracy = 0.909425
precision class 0 = 0.9125
precision class 1 = 0.764706
recall class 0 = 0.99455
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.00545
positive prediction rate = 0.020808
AUC of ROC = 0.860346
AUC of PRC = 0.477001
min(+P, Se) = 0.46988

-------------------------------

Epoch 00068: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch68.state
Epoch 69/100
 - 321s - loss: 0.2577 - val_loss: 0.2389

==>predicting on train



confusion matrix:
[[2138   17]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09755600243806839
difference in average predicted and observed risk = -0.00825299756193161
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.912116
precision class 1 = 0.742424
recall class 0 = 0.992111
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.007889
positive prediction rate = 0.027386
AUC of ROC = 0.843862
AUC of PRC = 0.475284
min(+P, Se) = 0.442308

-------------------------------

confusion matrix:
[[1166   13]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09123200178146362
difference in average predicted and observed risk = 0.00025300178146361874
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.922468
precision class 1 = 0.606061
recall class 0 = 0.988974
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.011026
positive prediction rate = 0.025443
AUC of ROC = 0.85967
AUC of PRC = 0.446711
min(+P, Se) = 0.440678

-------------------------------

confusion matrix:
[[652   4]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10154300183057785
difference in average predicted and observed risk = 0.00017300183057784857
number samples = 730
accuracy = 0.910959
precision class 0 = 0.914446
precision class 1 = 0.764706
recall class 0 = 0.993902
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.006098
positive prediction rate = 0.023288
AUC of ROC = 0.85887
AUC of PRC = 0.498644
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11228799819946289
difference in average predicted and observed risk = -0.013366001800537097
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.957834
AUC of PRC = 0.835031
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2454   20]
 [ 208   47]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09139099717140198
difference in average predicted and observed risk = -0.0020500028285980187
number samples = 2729
accuracy = 0.916453
precision class 0 = 0.921863
precision class 1 = 0.701493
recall class 0 = 0.991916
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.008084
positive prediction rate = 0.024551
AUC of ROC = 0.850606
AUC of PRC = 0.448784
min(+P, Se) = 0.42803

-------------------------------

confusion matrix:
[[1667   16]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1051120012998581
difference in average predicted and observed risk = -0.008631998700141905
number samples = 1899
accuracy = 0.902054
precision class 0 = 0.907458
precision class 1 = 0.741935
recall class 0 = 0.990493
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.009507
positive prediction rate = 0.032649
AUC of ROC = 0.862429
AUC of PRC = 0.534029
min(+P, Se) = 0.490741

-------------------------------

confusion matrix:
[[544   5]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11058899760246277
difference in average predicted and observed risk = -0.012414002397537233
number samples = 626
accuracy = 0.886581
precision class 0 = 0.891803
precision class 1 = 0.6875
recall class 0 = 0.990893
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.009107
positive prediction rate = 0.025559
AUC of ROC = 0.84761
AUC of PRC = 0.467731
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2239   10]
 [ 178   30]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08218300342559814
difference in average predicted and observed risk = -0.0024729965744018506
number samples = 2457
accuracy = 0.923484
precision class 0 = 0.926355
precision class 1 = 0.75
recall class 0 = 0.995554
recall class 1 = 0.144231
false negative rate = 0.855769
false positive rate = 0.004446
positive prediction rate = 0.01628
AUC of ROC = 0.85823
AUC of PRC = 0.433694
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[218   5]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10448300093412399
difference in average predicted and observed risk = 0.003677000934123986
number samples = 248
accuracy = 0.879032
precision class 0 = 0.897119
precision class 1 = 0.0
recall class 0 = 0.977578
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.022422
positive prediction rate = 0.020161
AUC of ROC = 0.750314
AUC of PRC = 0.248538
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[474   7]
 [ 48  34]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13765700161457062
difference in average predicted and observed risk = -0.007990998385429382
number samples = 563
accuracy = 0.902309
precision class 0 = 0.908046
precision class 1 = 0.829268
recall class 0 = 0.985447
recall class 1 = 0.414634
false negative rate = 0.585366
false positive rate = 0.014553
positive prediction rate = 0.072824
AUC of ROC = 0.892196
AUC of PRC = 0.683544
min(+P, Se) = 0.638554

-------------------------------

confusion matrix:
[[646   9]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10142699629068375
difference in average predicted and observed risk = -0.006202003709316256
number samples = 734
accuracy = 0.904632
precision class 0 = 0.91372
precision class 1 = 0.666667
recall class 0 = 0.98626
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.01374
positive prediction rate = 0.036785
AUC of ROC = 0.841531
AUC of PRC = 0.492951
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4121   36]
 [ 378   93]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09702099859714508
difference in average predicted and observed risk = -0.004751001402854921
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.915981
precision class 1 = 0.72093
recall class 0 = 0.99134
recall class 1 = 0.197452
false negative rate = 0.802548
false positive rate = 0.00866
positive prediction rate = 0.027874
AUC of ROC = 0.856526
AUC of PRC = 0.490963
min(+P, Se) = 0.458947

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0876929983496666
difference in average predicted and observed risk = 0.007523998349666591
number samples = 237
accuracy = 0.911392
precision class 0 = 0.926407
precision class 1 = 0.333333
recall class 0 = 0.981651
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018349
positive prediction rate = 0.025316
AUC of ROC = 0.896185
AUC of PRC = 0.435166
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0901539996266365
difference in average predicted and observed risk = -0.0186420003733635
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.829511
AUC of PRC = 0.440611
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12415599822998047
difference in average predicted and observed risk = 0.013986998229980466
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.920147
AUC of PRC = 0.529873
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12424299865961075
difference in average predicted and observed risk = -0.009090001340389259
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10110700130462646
difference in average predicted and observed risk = -0.013936998695373529
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.837692
AUC of PRC = 0.371535
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[430   4]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0917000025510788
difference in average predicted and observed risk = -0.00034999744892121043
number samples = 478
accuracy = 0.920502
precision class 0 = 0.926724
precision class 1 = 0.714286
recall class 0 = 0.990783
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.009217
positive prediction rate = 0.029289
AUC of ROC = 0.884426
AUC of PRC = 0.558717
min(+P, Se) = 0.533333

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07598999887704849
difference in average predicted and observed risk = -0.013212001122951511
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.879069
AUC of PRC = 0.514478
min(+P, Se) = 0.434783

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12428700178861618
difference in average predicted and observed risk = 0.006640001788616179
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.907407
AUC of PRC = 0.587688
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10214199870824814
difference in average predicted and observed risk = 0.013431998708248141
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.86243
AUC of PRC = 0.291138
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11921799927949905
difference in average predicted and observed risk = -0.030388000720500935
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.824561
AUC of PRC = 0.57067
min(+P, Se) = 0.590909

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13822400569915771
difference in average predicted and observed risk = 0.05927700569915771
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.904762
AUC of PRC = 0.519444
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[727   7]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09560299664735794
difference in average predicted and observed risk = -0.00598800335264206
number samples = 817
accuracy = 0.905753
precision class 0 = 0.912171
precision class 1 = 0.65
recall class 0 = 0.990463
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.009537
positive prediction rate = 0.02448
AUC of ROC = 0.866797
AUC of PRC = 0.479069
min(+P, Se) = 0.493976

-------------------------------

Epoch 00069: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch69.state
Epoch 70/100
 - 329s - loss: 0.2525 - val_loss: 0.2356

==>predicting on train



confusion matrix:
[[2135   20]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09690099954605103
difference in average predicted and observed risk = -0.008908000453948975
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.913174
precision class 1 = 0.722222
recall class 0 = 0.990719
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.009281
positive prediction rate = 0.029876
AUC of ROC = 0.841068
AUC of PRC = 0.466621
min(+P, Se) = 0.447059

-------------------------------

confusion matrix:
[[1165   14]
 [  91   27]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0894009992480278
difference in average predicted and observed risk = -0.0015780007519722028
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.927548
precision class 1 = 0.658537
recall class 0 = 0.988126
recall class 1 = 0.228814
false negative rate = 0.771186
false positive rate = 0.011874
positive prediction rate = 0.031611
AUC of ROC = 0.85839
AUC of PRC = 0.446904
min(+P, Se) = 0.415254

-------------------------------

confusion matrix:
[[650   6]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10337799787521362
difference in average predicted and observed risk = 0.0020079978752136213
number samples = 730
accuracy = 0.913699
precision class 0 = 0.919378
precision class 1 = 0.73913
recall class 0 = 0.990854
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.009146
positive prediction rate = 0.031507
AUC of ROC = 0.851619
AUC of PRC = 0.493976
min(+P, Se) = 0.45122

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11446800082921982
difference in average predicted and observed risk = -0.01118599917078017
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.951098
AUC of PRC = 0.807883
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2452   22]
 [ 200   55]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09036699682474136
difference in average predicted and observed risk = -0.0030740031752586328
number samples = 2729
accuracy = 0.918652
precision class 0 = 0.924585
precision class 1 = 0.714286
recall class 0 = 0.991108
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.008892
positive prediction rate = 0.028215
AUC of ROC = 0.846569
AUC of PRC = 0.442242
min(+P, Se) = 0.435294

-------------------------------

confusion matrix:
[[1663   20]
 [ 164   52]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10542400181293488
difference in average predicted and observed risk = -0.008319998187065122
number samples = 1899
accuracy = 0.903107
precision class 0 = 0.910235
precision class 1 = 0.722222
recall class 0 = 0.988116
recall class 1 = 0.240741
false negative rate = 0.759259
false positive rate = 0.011884
positive prediction rate = 0.037915
AUC of ROC = 0.860404
AUC of PRC = 0.530963
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[543   6]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10854999721050262
difference in average predicted and observed risk = -0.014453002789497377
number samples = 626
accuracy = 0.891374
precision class 0 = 0.897521
precision class 1 = 0.714286
recall class 0 = 0.989071
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.010929
positive prediction rate = 0.033546
AUC of ROC = 0.841956
AUC of PRC = 0.458068
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[2238   11]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08114700019359589
difference in average predicted and observed risk = -0.003508999806404109
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.927861
precision class 1 = 0.755556
recall class 0 = 0.995109
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.004891
positive prediction rate = 0.018315
AUC of ROC = 0.854878
AUC of PRC = 0.42239
min(+P, Se) = 0.394231

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.1011819988489151
difference in average predicted and observed risk = 0.0003759988489150934
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.761973
AUC of PRC = 0.255263
min(+P, Se) = 0.346154

-------------------------------

confusion matrix:
[[470  11]
 [ 48  34]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1384039968252182
difference in average predicted and observed risk = -0.007244003174781799
number samples = 563
accuracy = 0.895204
precision class 0 = 0.907336
precision class 1 = 0.755556
recall class 0 = 0.977131
recall class 1 = 0.414634
false negative rate = 0.585366
false positive rate = 0.022869
positive prediction rate = 0.079929
AUC of ROC = 0.888976
AUC of PRC = 0.677324
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[646   9]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.1041790023446083
difference in average predicted and observed risk = -0.0034499976553916956
number samples = 734
accuracy = 0.910082
precision class 0 = 0.918919
precision class 1 = 0.709677
recall class 0 = 0.98626
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.01374
positive prediction rate = 0.042234
AUC of ROC = 0.837975
AUC of PRC = 0.494095
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[4115   42]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09654500335454941
difference in average predicted and observed risk = -0.005226996645450593
number samples = 4628
accuracy = 0.912273
precision class 0 = 0.918732
precision class 1 = 0.718121
recall class 0 = 0.989897
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.010103
positive prediction rate = 0.032195
AUC of ROC = 0.8534
AUC of PRC = 0.485083
min(+P, Se) = 0.454545

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08546900004148483
difference in average predicted and observed risk = 0.005300000041484829
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.889908
AUC of PRC = 0.420584
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09042699635028839
difference in average predicted and observed risk = -0.018369003649711613
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.830837
AUC of PRC = 0.441651
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12817099690437317
difference in average predicted and observed risk = 0.018001996904373166
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.915751
AUC of PRC = 0.545789
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12929999828338623
difference in average predicted and observed risk = -0.004033001716613777
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10390699654817581
difference in average predicted and observed risk = -0.011137003451824182
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.837094
AUC of PRC = 0.372813
min(+P, Se) = 0.42

-------------------------------

confusion matrix:
[[430   4]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09016600251197815
difference in average predicted and observed risk = -0.0018839974880218574
number samples = 478
accuracy = 0.922594
precision class 0 = 0.928726
precision class 1 = 0.733333
recall class 0 = 0.990783
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.009217
positive prediction rate = 0.031381
AUC of ROC = 0.883902
AUC of PRC = 0.560627
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07587999850511551
difference in average predicted and observed risk = -0.013322001494884494
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.874729
AUC of PRC = 0.509533
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12187600135803223
difference in average predicted and observed risk = 0.004229001358032225
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.916667
AUC of PRC = 0.622774
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10163799673318863
difference in average predicted and observed risk = 0.012927996733188632
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.848753
AUC of PRC = 0.25233
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12284299731254578
difference in average predicted and observed risk = -0.026763002687454213
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.827973
AUC of PRC = 0.567575
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14114299416542053
difference in average predicted and observed risk = 0.06219599416542053
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.278704
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[727   7]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09586700052022934
difference in average predicted and observed risk = -0.005723999479770661
number samples = 817
accuracy = 0.908201
precision class 0 = 0.914465
precision class 1 = 0.681818
recall class 0 = 0.990463
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.009537
positive prediction rate = 0.026928
AUC of ROC = 0.866009
AUC of PRC = 0.481052
min(+P, Se) = 0.46875

-------------------------------

Epoch 00070: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch70.state
Epoch 71/100
 - 329s - loss: 0.2619 - val_loss: 0.2353

==>predicting on train



confusion matrix:
[[2134   21]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09325899928808212
difference in average predicted and observed risk = -0.012550000711917877
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.913919
precision class 1 = 0.72
recall class 0 = 0.990255
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.009745
positive prediction rate = 0.03112
AUC of ROC = 0.837975
AUC of PRC = 0.462275
min(+P, Se) = 0.424125

-------------------------------

confusion matrix:
[[1164   15]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0879959985613823
difference in average predicted and observed risk = -0.0029830014386177106
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.925278
precision class 1 = 0.615385
recall class 0 = 0.987277
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.012723
positive prediction rate = 0.030069
AUC of ROC = 0.85678
AUC of PRC = 0.444804
min(+P, Se) = 0.423729

-------------------------------

confusion matrix:
[[650   6]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09920399636030197
difference in average predicted and observed risk = -0.0021660036396980303
number samples = 730
accuracy = 0.910959
precision class 0 = 0.916784
precision class 1 = 0.714286
recall class 0 = 0.990854
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.009146
positive prediction rate = 0.028767
AUC of ROC = 0.845213
AUC of PRC = 0.488602
min(+P, Se) = 0.460526

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10715000331401825
difference in average predicted and observed risk = -0.01850399668598174
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.95509
AUC of PRC = 0.815856
min(+P, Se) = 0.730769

-------------------------------

confusion matrix:
[[2448   26]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08852999657392502
difference in average predicted and observed risk = -0.004911003426074978
number samples = 2729
accuracy = 0.916819
precision class 0 = 0.924122
precision class 1 = 0.675
recall class 0 = 0.989491
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.010509
positive prediction rate = 0.029315
AUC of ROC = 0.845268
AUC of PRC = 0.44496
min(+P, Se) = 0.412214

-------------------------------

confusion matrix:
[[1665   18]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10014399886131287
difference in average predicted and observed risk = -0.013600001138687132
number samples = 1899
accuracy = 0.903107
precision class 0 = 0.909339
precision class 1 = 0.735294
recall class 0 = 0.989305
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.010695
positive prediction rate = 0.035808
AUC of ROC = 0.855764
AUC of PRC = 0.522096
min(+P, Se) = 0.465753

-------------------------------

confusion matrix:
[[542   7]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10330799967050552
difference in average predicted and observed risk = -0.019695000329494478
number samples = 626
accuracy = 0.888179
precision class 0 = 0.895868
precision class 1 = 0.666667
recall class 0 = 0.98725
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.01275
positive prediction rate = 0.033546
AUC of ROC = 0.840158
AUC of PRC = 0.457576
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2237   12]
 [ 175   33]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07812099903821945
difference in average predicted and observed risk = -0.006535000961780543
number samples = 2457
accuracy = 0.923891
precision class 0 = 0.927446
precision class 1 = 0.733333
recall class 0 = 0.994664
recall class 1 = 0.158654
false negative rate = 0.841346
false positive rate = 0.005336
positive prediction rate = 0.018315
AUC of ROC = 0.85097
AUC of PRC = 0.416546
min(+P, Se) = 0.391509

-------------------------------

confusion matrix:
[[218   5]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09614100307226181
difference in average predicted and observed risk = -0.004664996927738196
number samples = 248
accuracy = 0.887097
precision class 0 = 0.904564
precision class 1 = 0.285714
recall class 0 = 0.977578
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.022422
positive prediction rate = 0.028226
AUC of ROC = 0.767534
AUC of PRC = 0.263101
min(+P, Se) = 0.392857

-------------------------------

confusion matrix:
[[469  12]
 [ 46  36]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13933800160884857
difference in average predicted and observed risk = -0.006309998391151428
number samples = 563
accuracy = 0.89698
precision class 0 = 0.91068
precision class 1 = 0.75
recall class 0 = 0.975052
recall class 1 = 0.439024
false negative rate = 0.560976
false positive rate = 0.024948
positive prediction rate = 0.085258
AUC of ROC = 0.885984
AUC of PRC = 0.676495
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[647   8]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.0992719978094101
difference in average predicted and observed risk = -0.008357002190589907
number samples = 734
accuracy = 0.907357
precision class 0 = 0.915134
precision class 1 = 0.703704
recall class 0 = 0.987786
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.012214
positive prediction rate = 0.036785
AUC of ROC = 0.835888
AUC of PRC = 0.489182
min(+P, Se) = 0.43038

-------------------------------

confusion matrix:
[[4113   44]
 [ 367  104]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09329500049352646
difference in average predicted and observed risk = -0.008476999506473543
number samples = 4628
accuracy = 0.911193
precision class 0 = 0.91808
precision class 1 = 0.702703
recall class 0 = 0.989415
recall class 1 = 0.220807
false negative rate = 0.779193
false positive rate = 0.010585
positive prediction rate = 0.031979
AUC of ROC = 0.850619
AUC of PRC = 0.481096
min(+P, Se) = 0.437367

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08489000052213669
difference in average predicted and observed risk = 0.004721000522136684
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.895461
AUC of PRC = 0.383535
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08944900333881378
difference in average predicted and observed risk = -0.019346996661186222
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.825366
AUC of PRC = 0.441388
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12363000214099884
difference in average predicted and observed risk = 0.013461002140998837
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.904762
AUC of PRC = 0.584545
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12575900554656982
difference in average predicted and observed risk = -0.007573994453430183
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 1.0
AUC of PRC = 1.0
min(+P, Se) = 1.0

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10094200074672699
difference in average predicted and observed risk = -0.014101999253273004
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.827607
AUC of PRC = 0.363474
min(+P, Se) = 0.396226

-------------------------------

confusion matrix:
[[429   5]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08975400030612946
difference in average predicted and observed risk = -0.0022959996938705513
number samples = 478
accuracy = 0.922594
precision class 0 = 0.930586
precision class 1 = 0.705882
recall class 0 = 0.988479
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.011521
positive prediction rate = 0.035565
AUC of ROC = 0.886311
AUC of PRC = 0.563365
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07465700060129166
difference in average predicted and observed risk = -0.014544999398708347
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.877849
AUC of PRC = 0.54436
min(+P, Se) = 0.44186

-------------------------------

confusion matrix:
[[86  4]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12592999637126923
difference in average predicted and observed risk = 0.008282996371269225
number samples = 102
accuracy = 0.892157
precision class 0 = 0.924731
precision class 1 = 0.555556
recall class 0 = 0.955556
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.044444
positive prediction rate = 0.088235
AUC of ROC = 0.908333
AUC of PRC = 0.56027
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09613300114870071
difference in average predicted and observed risk = 0.007423001148700717
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.832663
AUC of PRC = 0.23073
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11862099915742874
difference in average predicted and observed risk = -0.030985000842571248
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.820175
AUC of PRC = 0.55641
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14441299438476562
difference in average predicted and observed risk = 0.06546599438476562
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.241667
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[726   8]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09439600259065628
difference in average predicted and observed risk = -0.00719499740934372
number samples = 817
accuracy = 0.908201
precision class 0 = 0.915511
precision class 1 = 0.666667
recall class 0 = 0.989101
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.010899
positive prediction rate = 0.029376
AUC of ROC = 0.863514
AUC of PRC = 0.478658
min(+P, Se) = 0.46988

-------------------------------

Epoch 00071: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch71.state
Epoch 72/100
 - 325s - loss: 0.2565 - val_loss: 0.2409

==>predicting on train



confusion matrix:
[[2137   18]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.1092199981212616
difference in average predicted and observed risk = 0.0034109981212615964
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.912079
precision class 1 = 0.731343
recall class 0 = 0.991647
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.008353
positive prediction rate = 0.027801
AUC of ROC = 0.84022
AUC of PRC = 0.46346
min(+P, Se) = 0.436293

-------------------------------

confusion matrix:
[[1166   13]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10119699686765671
difference in average predicted and observed risk = 0.010217996867656703
number samples = 1297
accuracy = 0.914418
precision class 0 = 0.922468
precision class 1 = 0.606061
recall class 0 = 0.988974
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.011026
positive prediction rate = 0.025443
AUC of ROC = 0.858901
AUC of PRC = 0.445288
min(+P, Se) = 0.398305

-------------------------------

confusion matrix:
[[653   3]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11343599855899811
difference in average predicted and observed risk = 0.012065998558998106
number samples = 730
accuracy = 0.912329
precision class 0 = 0.914566
precision class 1 = 0.8125
recall class 0 = 0.995427
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.004573
positive prediction rate = 0.021918
AUC of ROC = 0.851496
AUC of PRC = 0.488092
min(+P, Se) = 0.445946

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12150199711322784
difference in average predicted and observed risk = -0.004152002886772144
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.956836
AUC of PRC = 0.810303
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2453   21]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.1023930013179779
difference in average predicted and observed risk = 0.008952001317977909
number samples = 2729
accuracy = 0.91572
precision class 0 = 0.921488
precision class 1 = 0.686567
recall class 0 = 0.991512
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.008488
positive prediction rate = 0.024551
AUC of ROC = 0.847328
AUC of PRC = 0.435357
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[1668   15]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11640699952840805
difference in average predicted and observed risk = 0.0026629995284080527
number samples = 1899
accuracy = 0.903107
precision class 0 = 0.908002
precision class 1 = 0.758065
recall class 0 = 0.991087
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.008913
positive prediction rate = 0.032649
AUC of ROC = 0.860382
AUC of PRC = 0.531815
min(+P, Se) = 0.471111

-------------------------------

confusion matrix:
[[544   5]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1187790036201477
difference in average predicted and observed risk = -0.004223996379852296
number samples = 626
accuracy = 0.886581
precision class 0 = 0.891803
precision class 1 = 0.6875
recall class 0 = 0.990893
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.009107
positive prediction rate = 0.025559
AUC of ROC = 0.843044
AUC of PRC = 0.456874
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2240    9]
 [ 177   31]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09408000111579895
difference in average predicted and observed risk = 0.009424001115798955
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.926769
precision class 1 = 0.775
recall class 0 = 0.995998
recall class 1 = 0.149038
false negative rate = 0.850962
false positive rate = 0.004002
positive prediction rate = 0.01628
AUC of ROC = 0.853858
AUC of PRC = 0.419026
min(+P, Se) = 0.373206

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.1147719994187355
difference in average predicted and observed risk = 0.013965999418735497
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.76861
AUC of PRC = 0.262543
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[472   9]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1456110030412674
difference in average predicted and observed risk = -3.699695873260467e-05
number samples = 563
accuracy = 0.89698
precision class 0 = 0.90595
precision class 1 = 0.785714
recall class 0 = 0.981289
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.018711
positive prediction rate = 0.0746
AUC of ROC = 0.889483
AUC of PRC = 0.675199
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[646   9]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.115167997777462
difference in average predicted and observed risk = 0.007538997777462003
number samples = 734
accuracy = 0.90327
precision class 0 = 0.912429
precision class 1 = 0.653846
recall class 0 = 0.98626
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.01374
positive prediction rate = 0.035422
AUC of ROC = 0.839347
AUC of PRC = 0.492685
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4121   36]
 [ 378   93]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10814300179481506
difference in average predicted and observed risk = 0.006371001794815062
number samples = 4628
accuracy = 0.910545
precision class 0 = 0.915981
precision class 1 = 0.72093
recall class 0 = 0.99134
recall class 1 = 0.197452
false negative rate = 0.802548
false positive rate = 0.00866
positive prediction rate = 0.027874
AUC of ROC = 0.85353
AUC of PRC = 0.481671
min(+P, Se) = 0.438559

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09631600230932236
difference in average predicted and observed risk = 0.016147002309322353
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.88846
AUC of PRC = 0.411701
min(+P, Se) = 0.434783

-------------------------------

confusion matrix:
[[384   1]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10382899641990662
difference in average predicted and observed risk = -0.004967003580093388
number samples = 432
accuracy = 0.898148
precision class 0 = 0.899297
precision class 1 = 0.8
recall class 0 = 0.997403
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.002597
positive prediction rate = 0.011574
AUC of ROC = 0.822935
AUC of PRC = 0.410056
min(+P, Se) = 0.376812

-------------------------------

confusion matrix:
[[103   2]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.13525499403476715
difference in average predicted and observed risk = 0.025085994034767148
number samples = 118
accuracy = 0.898305
precision class 0 = 0.911504
precision class 1 = 0.6
recall class 0 = 0.980952
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.019048
positive prediction rate = 0.042373
AUC of ROC = 0.904762
AUC of PRC = 0.498695
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13548199832439423
difference in average predicted and observed risk = 0.002148998324394219
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11513800173997879
difference in average predicted and observed risk = 9.40017399787968e-05
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.83188
AUC of PRC = 0.355575
min(+P, Se) = 0.384615

-------------------------------

confusion matrix:
[[430   4]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.10182700306177139
difference in average predicted and observed risk = 0.009777003061771386
number samples = 478
accuracy = 0.91841
precision class 0 = 0.924731
precision class 1 = 0.692308
recall class 0 = 0.990783
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.009217
positive prediction rate = 0.027197
AUC of ROC = 0.880341
AUC of PRC = 0.530355
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08754300326108932
difference in average predicted and observed risk = -0.0016589967389106786
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.870591
AUC of PRC = 0.492474
min(+P, Se) = 0.475

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13119199872016907
difference in average predicted and observed risk = 0.013544998720169066
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.900926
AUC of PRC = 0.579195
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1143139973282814
difference in average predicted and observed risk = 0.025603997328281405
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.847949
AUC of PRC = 0.24361
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.132859006524086
difference in average predicted and observed risk = -0.01674699347591399
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.812865
AUC of PRC = 0.535935
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.15743200480937958
difference in average predicted and observed risk = 0.07848500480937957
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.92381
AUC of PRC = 0.551786
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[727   7]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10735099762678146
difference in average predicted and observed risk = 0.005759997626781463
number samples = 817
accuracy = 0.904529
precision class 0 = 0.911028
precision class 1 = 0.631579
recall class 0 = 0.990463
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.009537
positive prediction rate = 0.023256
AUC of ROC = 0.861101
AUC of PRC = 0.460714
min(+P, Se) = 0.433735

-------------------------------

Epoch 00072: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch72.state
Epoch 73/100
 - 328s - loss: 0.2624 - val_loss: 0.2391

==>predicting on train



confusion matrix:
[[2140   15]
 [ 210   45]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08654200285673141
difference in average predicted and observed risk = -0.019266997143268585
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.910638
precision class 1 = 0.75
recall class 0 = 0.993039
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.006961
positive prediction rate = 0.024896
AUC of ROC = 0.845004
AUC of PRC = 0.474158
min(+P, Se) = 0.443137

-------------------------------

confusion matrix:
[[1169   10]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07925599813461304
difference in average predicted and observed risk = -0.011723001865386967
number samples = 1297
accuracy = 0.91596
precision class 0 = 0.921924
precision class 1 = 0.655172
recall class 0 = 0.991518
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.008482
positive prediction rate = 0.022359
AUC of ROC = 0.857801
AUC of PRC = 0.449279
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[654   2]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08827099949121475
difference in average predicted and observed risk = -0.01309900050878525
number samples = 730
accuracy = 0.913699
precision class 0 = 0.914685
precision class 1 = 0.866667
recall class 0 = 0.996951
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.003049
positive prediction rate = 0.020548
AUC of ROC = 0.86128
AUC of PRC = 0.513582
min(+P, Se) = 0.460674

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10646200180053711
difference in average predicted and observed risk = -0.01919199819946288
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.954341
AUC of PRC = 0.81162
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2455   19]
 [ 210   45]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.081216000020504
difference in average predicted and observed risk = -0.012224999979495998
number samples = 2729
accuracy = 0.916086
precision class 0 = 0.921201
precision class 1 = 0.703125
recall class 0 = 0.99232
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.00768
positive prediction rate = 0.023452
AUC of ROC = 0.850665
AUC of PRC = 0.449839
min(+P, Se) = 0.427451

-------------------------------

confusion matrix:
[[1673   10]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09188699722290039
difference in average predicted and observed risk = -0.021857002777099607
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.906284
precision class 1 = 0.811321
recall class 0 = 0.994058
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.005942
positive prediction rate = 0.027909
AUC of ROC = 0.863733
AUC of PRC = 0.53421
min(+P, Se) = 0.476852

-------------------------------

confusion matrix:
[[545   4]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09485100209712982
difference in average predicted and observed risk = -0.02815199790287018
number samples = 626
accuracy = 0.881789
precision class 0 = 0.886179
precision class 1 = 0.636364
recall class 0 = 0.992714
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.007286
positive prediction rate = 0.017572
AUC of ROC = 0.848698
AUC of PRC = 0.458568
min(+P, Se) = 0.467532

-------------------------------

confusion matrix:
[[2239   10]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0722540020942688
difference in average predicted and observed risk = -0.012401997905731196
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.925972
precision class 1 = 0.74359
recall class 0 = 0.995554
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.004446
positive prediction rate = 0.015873
AUC of ROC = 0.856996
AUC of PRC = 0.428859
min(+P, Se) = 0.394231

-------------------------------

confusion matrix:
[[221   2]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08924099802970886
difference in average predicted and observed risk = -0.011565001970291144
number samples = 248
accuracy = 0.891129
precision class 0 = 0.898374
precision class 1 = 0.0
recall class 0 = 0.991031
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.008969
positive prediction rate = 0.008065
AUC of ROC = 0.768789
AUC of PRC = 0.26256
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[473   8]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1247820034623146
difference in average predicted and observed risk = -0.020865996537685394
number samples = 563
accuracy = 0.902309
precision class 0 = 0.909615
precision class 1 = 0.813953
recall class 0 = 0.983368
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.016632
positive prediction rate = 0.076377
AUC of ROC = 0.894224
AUC of PRC = 0.68907
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[650   5]
 [ 62  17]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09106799960136414
difference in average predicted and observed risk = -0.016561000398635867
number samples = 734
accuracy = 0.908719
precision class 0 = 0.912921
precision class 1 = 0.772727
recall class 0 = 0.992366
recall class 1 = 0.21519
false negative rate = 0.78481
false positive rate = 0.007634
positive prediction rate = 0.029973
AUC of ROC = 0.842536
AUC of PRC = 0.505255
min(+P, Se) = 0.455696

-------------------------------

confusion matrix:
[[4128   29]
 [ 383   88]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08559499680995941
difference in average predicted and observed risk = -0.01617700319004059
number samples = 4628
accuracy = 0.910977
precision class 0 = 0.915096
precision class 1 = 0.752137
recall class 0 = 0.993024
recall class 1 = 0.186837
false negative rate = 0.813163
false positive rate = 0.006976
positive prediction rate = 0.025281
AUC of ROC = 0.857181
AUC of PRC = 0.49117
min(+P, Se) = 0.450106

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07615099847316742
difference in average predicted and observed risk = -0.004018001526832585
number samples = 237
accuracy = 0.911392
precision class 0 = 0.926407
precision class 1 = 0.333333
recall class 0 = 0.981651
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018349
positive prediction rate = 0.025316
AUC of ROC = 0.895703
AUC of PRC = 0.426172
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07987099885940552
difference in average predicted and observed risk = -0.028925001140594486
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.836585
AUC of PRC = 0.434173
min(+P, Se) = 0.404255

-------------------------------

confusion matrix:
[[102   3]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11094100028276443
difference in average predicted and observed risk = 0.0007720002827644318
number samples = 118
accuracy = 0.889831
precision class 0 = 0.910714
precision class 1 = 0.5
recall class 0 = 0.971429
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.028571
positive prediction rate = 0.050847
AUC of ROC = 0.894505
AUC of PRC = 0.451879
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11283399909734726
difference in average predicted and observed risk = -0.020499000902652748
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09034299850463867
difference in average predicted and observed risk = -0.02470100149536132
number samples = 339
accuracy = 0.884956
precision class 0 = 0.891892
precision class 1 = 0.5
recall class 0 = 0.99
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.01
positive prediction rate = 0.017699
AUC of ROC = 0.846581
AUC of PRC = 0.374605
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[430   4]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08033899962902069
difference in average predicted and observed risk = -0.011711000370979316
number samples = 478
accuracy = 0.916318
precision class 0 = 0.922747
precision class 1 = 0.666667
recall class 0 = 0.990783
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.009217
positive prediction rate = 0.025105
AUC of ROC = 0.880446
AUC of PRC = 0.527136
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06686200201511383
difference in average predicted and observed risk = -0.022339997984886173
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.886666
AUC of PRC = 0.505777
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10885100066661835
difference in average predicted and observed risk = -0.008795999333381654
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.896296
AUC of PRC = 0.561353
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08847499638795853
difference in average predicted and observed risk = -0.00023500361204147058
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.85358
AUC of PRC = 0.256512
min(+P, Se) = 0.347826

-------------------------------

confusion matrix:
[[106   2]
 [ 16   3]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1061519980430603
difference in average predicted and observed risk = -0.043454001956939686
number samples = 127
accuracy = 0.858268
precision class 0 = 0.868852
precision class 1 = 0.6
recall class 0 = 0.981481
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018519
positive prediction rate = 0.03937
AUC of ROC = 0.833821
AUC of PRC = 0.561188
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13131499290466309
difference in average predicted and observed risk = 0.05236799290466308
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.914286
AUC of PRC = 0.532341
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[727   7]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08449000120162964
difference in average predicted and observed risk = -0.017100998798370362
number samples = 817
accuracy = 0.903305
precision class 0 = 0.909887
precision class 1 = 0.611111
recall class 0 = 0.990463
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.009537
positive prediction rate = 0.022032
AUC of ROC = 0.869111
AUC of PRC = 0.463124
min(+P, Se) = 0.464286

-------------------------------

Epoch 00073: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch73.state
Epoch 74/100
 - 326s - loss: 0.2595 - val_loss: 0.2381

==>predicting on train



confusion matrix:
[[2144   11]
 [ 212   43]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09419800341129303
difference in average predicted and observed risk = -0.01161099658870697
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.910017
precision class 1 = 0.796296
recall class 0 = 0.994896
recall class 1 = 0.168627
false negative rate = 0.831373
false positive rate = 0.005104
positive prediction rate = 0.022407
AUC of ROC = 0.846664
AUC of PRC = 0.478667
min(+P, Se) = 0.457364

-------------------------------

confusion matrix:
[[1171    8]
 [  99   19]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0831499993801117
difference in average predicted and observed risk = -0.00782900061988831
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.922047
precision class 1 = 0.703704
recall class 0 = 0.993215
recall class 1 = 0.161017
false negative rate = 0.838983
false positive rate = 0.006785
positive prediction rate = 0.020817
AUC of ROC = 0.859009
AUC of PRC = 0.467844
min(+P, Se) = 0.440678

-------------------------------

confusion matrix:
[[655   1]
 [ 63  11]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0911789983510971
difference in average predicted and observed risk = -0.010191001648902895
number samples = 730
accuracy = 0.912329
precision class 0 = 0.912256
precision class 1 = 0.916667
recall class 0 = 0.998476
recall class 1 = 0.148649
false negative rate = 0.851351
false positive rate = 0.001524
positive prediction rate = 0.016438
AUC of ROC = 0.858603
AUC of PRC = 0.519614
min(+P, Se) = 0.460526

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10884899646043777
difference in average predicted and observed risk = -0.016805003539562213
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.956587
AUC of PRC = 0.815082
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2460   14]
 [ 214   41]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08464600145816803
difference in average predicted and observed risk = -0.008794998541831966
number samples = 2729
accuracy = 0.916453
precision class 0 = 0.91997
precision class 1 = 0.745455
recall class 0 = 0.994341
recall class 1 = 0.160784
false negative rate = 0.839216
false positive rate = 0.005659
positive prediction rate = 0.020154
AUC of ROC = 0.851551
AUC of PRC = 0.45559
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[1675    8]
 [ 173   43]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1006930023431778
difference in average predicted and observed risk = -0.013050997656822202
number samples = 1899
accuracy = 0.904687
precision class 0 = 0.906385
precision class 1 = 0.843137
recall class 0 = 0.995247
recall class 1 = 0.199074
false negative rate = 0.800926
false positive rate = 0.004753
positive prediction rate = 0.026856
AUC of ROC = 0.864888
AUC of PRC = 0.546942
min(+P, Se) = 0.479263

-------------------------------

confusion matrix:
[[545   4]
 [ 70   7]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10324999690055847
difference in average predicted and observed risk = -0.01975300309944153
number samples = 626
accuracy = 0.881789
precision class 0 = 0.886179
precision class 1 = 0.636364
recall class 0 = 0.992714
recall class 1 = 0.090909
false negative rate = 0.909091
false positive rate = 0.007286
positive prediction rate = 0.017572
AUC of ROC = 0.849975
AUC of PRC = 0.471107
min(+P, Se) = 0.480519

-------------------------------

confusion matrix:
[[2242    7]
 [ 179   29]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07861000299453735
difference in average predicted and observed risk = -0.006045997005462642
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.926064
precision class 1 = 0.805556
recall class 0 = 0.996888
recall class 1 = 0.139423
false negative rate = 0.860577
false positive rate = 0.003112
positive prediction rate = 0.014652
AUC of ROC = 0.85519
AUC of PRC = 0.434547
min(+P, Se) = 0.408654

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09788200259208679
difference in average predicted and observed risk = -0.0029239974079132147
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.768969
AUC of PRC = 0.262101
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[475   6]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12539899349212646
difference in average predicted and observed risk = -0.020249006507873535
number samples = 563
accuracy = 0.902309
precision class 0 = 0.906489
precision class 1 = 0.846154
recall class 0 = 0.987526
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.012474
positive prediction rate = 0.069272
AUC of ROC = 0.897977
AUC of PRC = 0.697583
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[651   4]
 [ 64  15]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09476800262928009
difference in average predicted and observed risk = -0.012860997370719912
number samples = 734
accuracy = 0.907357
precision class 0 = 0.910489
precision class 1 = 0.789474
recall class 0 = 0.993893
recall class 1 = 0.189873
false negative rate = 0.810127
false positive rate = 0.006107
positive prediction rate = 0.025886
AUC of ROC = 0.844951
AUC of PRC = 0.512611
min(+P, Se) = 0.468354

-------------------------------

confusion matrix:
[[4135   22]
 [ 387   84]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09122999757528305
difference in average predicted and observed risk = -0.01054200242471695
number samples = 4628
accuracy = 0.911625
precision class 0 = 0.914418
precision class 1 = 0.792453
recall class 0 = 0.994708
recall class 1 = 0.178344
false negative rate = 0.821656
false positive rate = 0.005292
positive prediction rate = 0.022904
AUC of ROC = 0.858067
AUC of PRC = 0.50001
min(+P, Se) = 0.462845

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07943899929523468
difference in average predicted and observed risk = -0.000730000704765324
number samples = 237
accuracy = 0.919831
precision class 0 = 0.927039
precision class 1 = 0.5
recall class 0 = 0.990826
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.009174
positive prediction rate = 0.016878
AUC of ROC = 0.899565
AUC of PRC = 0.434665
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08860799670219421
difference in average predicted and observed risk = -0.02018800329780579
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.829898
AUC of PRC = 0.438886
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11119499802589417
difference in average predicted and observed risk = 0.001025998025894162
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.889377
AUC of PRC = 0.485876
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11745599657297134
difference in average predicted and observed risk = -0.015877003427028663
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09918700158596039
difference in average predicted and observed risk = -0.015856998414039605
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.837009
AUC of PRC = 0.373058
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[433   1]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08394499868154526
difference in average predicted and observed risk = -0.00810500131845475
number samples = 478
accuracy = 0.920502
precision class 0 = 0.921277
precision class 1 = 0.875
recall class 0 = 0.997696
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.002304
positive prediction rate = 0.016736
AUC of ROC = 0.881808
AUC of PRC = 0.549575
min(+P, Se) = 0.519231

-------------------------------

confusion matrix:
[[388   0]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07343699783086777
difference in average predicted and observed risk = -0.015765002169132236
number samples = 426
accuracy = 0.920188
precision class 0 = 0.919431
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.0
positive prediction rate = 0.00939
AUC of ROC = 0.879544
AUC of PRC = 0.510842
min(+P, Se) = 0.488889

-------------------------------

confusion matrix:
[[90  0]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10928600281476974
difference in average predicted and observed risk = -0.008360997185230257
number samples = 102
accuracy = 0.921569
precision class 0 = 0.918367
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.0
positive prediction rate = 0.039216
AUC of ROC = 0.896296
AUC of PRC = 0.639183
min(+P, Se) = 0.529412

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09662099927663803
difference in average predicted and observed risk = 0.007910999276638034
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.851971
AUC of PRC = 0.256055
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 17   2]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11039900034666061
difference in average predicted and observed risk = -0.039206999653339375
number samples = 127
accuracy = 0.850394
precision class 0 = 0.861789
precision class 1 = 0.5
recall class 0 = 0.981481
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.018519
positive prediction rate = 0.031496
AUC of ROC = 0.834308
AUC of PRC = 0.56647
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13992400467395782
difference in average predicted and observed risk = 0.06097700467395782
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[731   3]
 [ 73  10]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09026999771595001
difference in average predicted and observed risk = -0.011321002284049989
number samples = 817
accuracy = 0.906977
precision class 0 = 0.909204
precision class 1 = 0.769231
recall class 0 = 0.995913
recall class 1 = 0.120482
false negative rate = 0.879518
false positive rate = 0.004087
positive prediction rate = 0.015912
AUC of ROC = 0.865517
AUC of PRC = 0.475071
min(+P, Se) = 0.46988

-------------------------------

Epoch 00074: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch74.state
Epoch 75/100
 - 323s - loss: 0.2523 - val_loss: 0.2402

==>predicting on train



confusion matrix:
[[2140   15]
 [ 210   45]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0808899998664856
difference in average predicted and observed risk = -0.024919000133514405
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.910638
precision class 1 = 0.75
recall class 0 = 0.993039
recall class 1 = 0.176471
false negative rate = 0.823529
false positive rate = 0.006961
positive prediction rate = 0.024896
AUC of ROC = 0.843958
AUC of PRC = 0.474453
min(+P, Se) = 0.447059

-------------------------------

confusion matrix:
[[1167   12]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07383900135755539
difference in average predicted and observed risk = -0.017139998642444615
number samples = 1297
accuracy = 0.916731
precision class 0 = 0.92399
precision class 1 = 0.647059
recall class 0 = 0.989822
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.010178
positive prediction rate = 0.026214
AUC of ROC = 0.860015
AUC of PRC = 0.464729
min(+P, Se) = 0.423729

-------------------------------

confusion matrix:
[[652   4]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08259499818086624
difference in average predicted and observed risk = -0.01877500181913376
number samples = 730
accuracy = 0.916438
precision class 0 = 0.919605
precision class 1 = 0.809524
recall class 0 = 0.993902
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.006098
positive prediction rate = 0.028767
AUC of ROC = 0.855492
AUC of PRC = 0.510529
min(+P, Se) = 0.472973

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.0986580029129982
difference in average predicted and observed risk = -0.02699599708700179
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.955838
AUC of PRC = 0.804038
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2453   21]
 [ 206   49]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07386700063943863
difference in average predicted and observed risk = -0.019573999360561367
number samples = 2729
accuracy = 0.916819
precision class 0 = 0.922527
precision class 1 = 0.7
recall class 0 = 0.991512
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.008488
positive prediction rate = 0.02565
AUC of ROC = 0.849725
AUC of PRC = 0.449823
min(+P, Se) = 0.414062

-------------------------------

confusion matrix:
[[1671   12]
 [ 170   46]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08860799670219421
difference in average predicted and observed risk = -0.025136003297805784
number samples = 1899
accuracy = 0.90416
precision class 0 = 0.907659
precision class 1 = 0.793103
recall class 0 = 0.99287
recall class 1 = 0.212963
false negative rate = 0.787037
false positive rate = 0.00713
positive prediction rate = 0.030542
AUC of ROC = 0.862649
AUC of PRC = 0.541104
min(+P, Se) = 0.490741

-------------------------------

confusion matrix:
[[544   5]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.091730996966362
difference in average predicted and observed risk = -0.031272003033638
number samples = 626
accuracy = 0.881789
precision class 0 = 0.887439
precision class 1 = 0.615385
recall class 0 = 0.990893
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.009107
positive prediction rate = 0.020767
AUC of ROC = 0.850708
AUC of PRC = 0.460207
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[2240    9]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06649500131607056
difference in average predicted and observed risk = -0.01816099868392944
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.92792
precision class 1 = 0.790698
recall class 0 = 0.995998
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.004002
positive prediction rate = 0.017501
AUC of ROC = 0.853151
AUC of PRC = 0.431249
min(+P, Se) = 0.389423

-------------------------------

confusion matrix:
[[220   3]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08442100137472153
difference in average predicted and observed risk = -0.01638499862527848
number samples = 248
accuracy = 0.887097
precision class 0 = 0.897959
precision class 1 = 0.0
recall class 0 = 0.986547
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.013453
positive prediction rate = 0.012097
AUC of ROC = 0.761614
AUC of PRC = 0.257363
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[472   9]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1171329990029335
difference in average predicted and observed risk = -0.028515000997066497
number samples = 563
accuracy = 0.89698
precision class 0 = 0.90595
precision class 1 = 0.785714
recall class 0 = 0.981289
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.018711
positive prediction rate = 0.0746
AUC of ROC = 0.895391
AUC of PRC = 0.689779
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[648   7]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08469600230455399
difference in average predicted and observed risk = -0.022932997695446017
number samples = 734
accuracy = 0.910082
precision class 0 = 0.916549
precision class 1 = 0.740741
recall class 0 = 0.989313
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.010687
positive prediction rate = 0.036785
AUC of ROC = 0.843328
AUC of PRC = 0.503731
min(+P, Se) = 0.468354

-------------------------------

confusion matrix:
[[4124   33]
 [ 376   95]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.07991600036621094
difference in average predicted and observed risk = -0.021855999633789064
number samples = 4628
accuracy = 0.911625
precision class 0 = 0.916444
precision class 1 = 0.742188
recall class 0 = 0.992062
recall class 1 = 0.201699
false negative rate = 0.798301
false positive rate = 0.007938
positive prediction rate = 0.027658
AUC of ROC = 0.856121
AUC of PRC = 0.495326
min(+P, Se) = 0.460722

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07107599824666977
difference in average predicted and observed risk = -0.009093001753330235
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.898841
AUC of PRC = 0.43543
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07489600032567978
difference in average predicted and observed risk = -0.033899999674320225
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.819674
AUC of PRC = 0.435087
min(+P, Se) = 0.41791

-------------------------------

confusion matrix:
[[104   1]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10346800088882446
difference in average predicted and observed risk = -0.00670099911117554
number samples = 118
accuracy = 0.915254
precision class 0 = 0.920354
precision class 1 = 0.8
recall class 0 = 0.990476
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.009524
positive prediction rate = 0.042373
AUC of ROC = 0.888645
AUC of PRC = 0.502649
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11259400099515915
difference in average predicted and observed risk = -0.020738999004840858
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08603200316429138
difference in average predicted and observed risk = -0.02901199683570861
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.825214
AUC of PRC = 0.372184
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[432   2]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07452300190925598
difference in average predicted and observed risk = -0.017526998090744025
number samples = 478
accuracy = 0.924686
precision class 0 = 0.927039
precision class 1 = 0.833333
recall class 0 = 0.995392
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.004608
positive prediction rate = 0.025105
AUC of ROC = 0.880917
AUC of PRC = 0.56081
min(+P, Se) = 0.510204

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06240300089120865
difference in average predicted and observed risk = -0.026798999108791355
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.872355
AUC of PRC = 0.510844
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.09981100261211395
difference in average predicted and observed risk = -0.01783599738788605
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.902778
AUC of PRC = 0.648711
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08382400125265121
difference in average predicted and observed risk = -0.004885998747348783
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.845535
AUC of PRC = 0.253304
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10136999934911728
difference in average predicted and observed risk = -0.04823600065088271
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.824561
AUC of PRC = 0.558777
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12512099742889404
difference in average predicted and observed risk = 0.04617399742889404
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.509259
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.07929900288581848
difference in average predicted and observed risk = -0.02229199711418152
number samples = 817
accuracy = 0.909425
precision class 0 = 0.913534
precision class 1 = 0.736842
recall class 0 = 0.993188
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.006812
positive prediction rate = 0.023256
AUC of ROC = 0.859607
AUC of PRC = 0.478355
min(+P, Se) = 0.464286

-------------------------------

Epoch 00075: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch75.state
Epoch 76/100
 - 322s - loss: 0.2530 - val_loss: 0.2402

==>predicting on train



confusion matrix:
[[2136   19]
 [ 205   50]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08178099989891052
difference in average predicted and observed risk = -0.024028000101089478
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.912431
precision class 1 = 0.724638
recall class 0 = 0.991183
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.008817
positive prediction rate = 0.028631
AUC of ROC = 0.837471
AUC of PRC = 0.471026
min(+P, Se) = 0.440613

-------------------------------

confusion matrix:
[[1168   11]
 [  93   25]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07225300371646881
difference in average predicted and observed risk = -0.018725996283531193
number samples = 1297
accuracy = 0.919815
precision class 0 = 0.926249
precision class 1 = 0.694444
recall class 0 = 0.99067
recall class 1 = 0.211864
false negative rate = 0.788136
false positive rate = 0.00933
positive prediction rate = 0.027756
AUC of ROC = 0.859411
AUC of PRC = 0.46807
min(+P, Se) = 0.411765

-------------------------------

confusion matrix:
[[646  10]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08343199640512466
difference in average predicted and observed risk = -0.017938003594875337
number samples = 730
accuracy = 0.910959
precision class 0 = 0.921541
precision class 1 = 0.655172
recall class 0 = 0.984756
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.015244
positive prediction rate = 0.039726
AUC of ROC = 0.851949
AUC of PRC = 0.507696
min(+P, Se) = 0.480519

-------------------------------

confusion matrix:
[[165   2]
 [ 11  13]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10638999938964844
difference in average predicted and observed risk = -0.01926400061035155
number samples = 191
accuracy = 0.931937
precision class 0 = 0.9375
precision class 1 = 0.866667
recall class 0 = 0.988024
recall class 1 = 0.541667
false negative rate = 0.458333
false positive rate = 0.011976
positive prediction rate = 0.078534
AUC of ROC = 0.952345
AUC of PRC = 0.800905
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2449   25]
 [ 198   57]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07479699701070786
difference in average predicted and observed risk = -0.01864400298929214
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.925198
precision class 1 = 0.695122
recall class 0 = 0.989895
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.010105
positive prediction rate = 0.030048
AUC of ROC = 0.846663
AUC of PRC = 0.44612
min(+P, Se) = 0.423529

-------------------------------

confusion matrix:
[[1666   17]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.08841899782419205
difference in average predicted and observed risk = -0.02532500217580795
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.909389
precision class 1 = 0.746269
recall class 0 = 0.989899
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.010101
positive prediction rate = 0.035282
AUC of ROC = 0.858107
AUC of PRC = 0.543019
min(+P, Se) = 0.474654

-------------------------------

confusion matrix:
[[541   8]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09091900289058685
difference in average predicted and observed risk = -0.03208399710941315
number samples = 626
accuracy = 0.881789
precision class 0 = 0.891269
precision class 1 = 0.578947
recall class 0 = 0.985428
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.014572
positive prediction rate = 0.030351
AUC of ROC = 0.841648
AUC of PRC = 0.462149
min(+P, Se) = 0.441558

-------------------------------

confusion matrix:
[[2237   12]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06539600342512131
difference in average predicted and observed risk = -0.019259996574878688
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.928601
precision class 1 = 0.75
recall class 0 = 0.994664
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.005336
positive prediction rate = 0.019536
AUC of ROC = 0.851793
AUC of PRC = 0.417149
min(+P, Se) = 0.379808

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.0797009989619255
difference in average predicted and observed risk = -0.0211050010380745
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.754978
AUC of PRC = 0.257901
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[469  12]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1288509964942932
difference in average predicted and observed risk = -0.016797003505706787
number samples = 563
accuracy = 0.900533
precision class 0 = 0.91423
precision class 1 = 0.76
recall class 0 = 0.975052
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.024948
positive prediction rate = 0.08881
AUC of ROC = 0.88994
AUC of PRC = 0.697525
min(+P, Se) = 0.634146

-------------------------------

confusion matrix:
[[649   6]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08464399725198746
difference in average predicted and observed risk = -0.022985002748012545
number samples = 734
accuracy = 0.914169
precision class 0 = 0.919263
precision class 1 = 0.785714
recall class 0 = 0.99084
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.00916
positive prediction rate = 0.038147
AUC of ROC = 0.842014
AUC of PRC = 0.520708
min(+P, Se) = 0.481013

-------------------------------

confusion matrix:
[[4115   42]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08038700371980667
difference in average predicted and observed risk = -0.02138499628019333
number samples = 4628
accuracy = 0.912273
precision class 0 = 0.918732
precision class 1 = 0.718121
recall class 0 = 0.989897
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.010103
positive prediction rate = 0.032195
AUC of ROC = 0.852392
AUC of PRC = 0.493756
min(+P, Se) = 0.452229

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07029999792575836
difference in average predicted and observed risk = -0.009869002074241642
number samples = 237
accuracy = 0.919831
precision class 0 = 0.934498
precision class 1 = 0.5
recall class 0 = 0.981651
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018349
positive prediction rate = 0.033755
AUC of ROC = 0.8817
AUC of PRC = 0.444176
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07573600113391876
difference in average predicted and observed risk = -0.03305999886608124
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.823598
AUC of PRC = 0.448442
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[102   3]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.10681500285863876
difference in average predicted and observed risk = -0.0033539971413612396
number samples = 118
accuracy = 0.898305
precision class 0 = 0.918919
precision class 1 = 0.571429
recall class 0 = 0.971429
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.028571
positive prediction rate = 0.059322
AUC of ROC = 0.90696
AUC of PRC = 0.485332
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1179720014333725
difference in average predicted and observed risk = -0.01536099856662751
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08776599913835526
difference in average predicted and observed risk = -0.02727800086164474
number samples = 339
accuracy = 0.890855
precision class 0 = 0.897281
precision class 1 = 0.625
recall class 0 = 0.99
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.01
positive prediction rate = 0.023599
AUC of ROC = 0.842735
AUC of PRC = 0.402025
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[430   4]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0748319998383522
difference in average predicted and observed risk = -0.017218000161647803
number samples = 478
accuracy = 0.924686
precision class 0 = 0.930736
precision class 1 = 0.75
recall class 0 = 0.990783
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.009217
positive prediction rate = 0.033473
AUC of ROC = 0.868978
AUC of PRC = 0.54229
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 31   7]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.060047000646591187
difference in average predicted and observed risk = -0.029154999353408817
number samples = 426
accuracy = 0.924883
precision class 0 = 0.925837
precision class 1 = 0.875
recall class 0 = 0.997423
recall class 1 = 0.184211
false negative rate = 0.815789
false positive rate = 0.002577
positive prediction rate = 0.018779
AUC of ROC = 0.85879
AUC of PRC = 0.505527
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[87  3]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11235900223255157
difference in average predicted and observed risk = -0.005287997767448427
number samples = 102
accuracy = 0.901961
precision class 0 = 0.925532
precision class 1 = 0.625
recall class 0 = 0.966667
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.033333
positive prediction rate = 0.078431
AUC of ROC = 0.92963
AUC of PRC = 0.645679
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0860000029206276
difference in average predicted and observed risk = -0.002709997079372403
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.848753
AUC of PRC = 0.246455
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1028050035238266
difference in average predicted and observed risk = -0.04680099647617339
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.825049
AUC of PRC = 0.543866
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12530399858951569
difference in average predicted and observed risk = 0.04635699858951568
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[727   7]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08019900321960449
difference in average predicted and observed risk = -0.02139199678039551
number samples = 817
accuracy = 0.910649
precision class 0 = 0.916772
precision class 1 = 0.708333
recall class 0 = 0.990463
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.009537
positive prediction rate = 0.029376
AUC of ROC = 0.86028
AUC of PRC = 0.485199
min(+P, Se) = 0.482353

-------------------------------

Epoch 00076: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch76.state
Epoch 77/100
 - 327s - loss: 0.2564 - val_loss: 0.2363

==>predicting on train



confusion matrix:
[[2138   17]
 [ 208   47]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09270700067281723
difference in average predicted and observed risk = -0.01310199932718277
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.911338
precision class 1 = 0.734375
recall class 0 = 0.992111
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.007889
positive prediction rate = 0.026556
AUC of ROC = 0.852209
AUC of PRC = 0.494511
min(+P, Se) = 0.470588

-------------------------------

confusion matrix:
[[1169   10]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0830330029129982
difference in average predicted and observed risk = -0.007945997087001805
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.924842
precision class 1 = 0.69697
recall class 0 = 0.991518
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.008482
positive prediction rate = 0.025443
AUC of ROC = 0.865075
AUC of PRC = 0.470455
min(+P, Se) = 0.449153

-------------------------------

confusion matrix:
[[648   8]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09431900084018707
difference in average predicted and observed risk = -0.007050999159812929
number samples = 730
accuracy = 0.912329
precision class 0 = 0.920455
precision class 1 = 0.692308
recall class 0 = 0.987805
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.012195
positive prediction rate = 0.035616
AUC of ROC = 0.863608
AUC of PRC = 0.515932
min(+P, Se) = 0.457831

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11328200250864029
difference in average predicted and observed risk = -0.012371997491359699
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.96008
AUC of PRC = 0.81303
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2451   23]
 [ 203   52]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08501499891281128
difference in average predicted and observed risk = -0.008426001087188717
number samples = 2729
accuracy = 0.917186
precision class 0 = 0.923512
precision class 1 = 0.693333
recall class 0 = 0.990703
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.009297
positive prediction rate = 0.027483
AUC of ROC = 0.856576
AUC of PRC = 0.457215
min(+P, Se) = 0.427451

-------------------------------

confusion matrix:
[[1669   14]
 [ 169   47]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09984199702739716
difference in average predicted and observed risk = -0.013902002972602842
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.908052
precision class 1 = 0.770492
recall class 0 = 0.991682
recall class 1 = 0.217593
false negative rate = 0.782407
false positive rate = 0.008318
positive prediction rate = 0.032122
AUC of ROC = 0.870992
AUC of PRC = 0.55787
min(+P, Se) = 0.509174

-------------------------------

confusion matrix:
[[543   6]
 [ 67  10]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10114800184965134
difference in average predicted and observed risk = -0.021854998150348665
number samples = 626
accuracy = 0.883387
precision class 0 = 0.890164
precision class 1 = 0.625
recall class 0 = 0.989071
recall class 1 = 0.12987
false negative rate = 0.87013
false positive rate = 0.010929
positive prediction rate = 0.025559
AUC of ROC = 0.857758
AUC of PRC = 0.473657
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2238   11]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07767800241708755
difference in average predicted and observed risk = -0.00697799758291244
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.927861
precision class 1 = 0.755556
recall class 0 = 0.995109
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.004891
positive prediction rate = 0.018315
AUC of ROC = 0.860134
AUC of PRC = 0.439459
min(+P, Se) = 0.410377

-------------------------------

confusion matrix:
[[219   4]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09557099640369415
difference in average predicted and observed risk = -0.005235003596305854
number samples = 248
accuracy = 0.883065
precision class 0 = 0.897541
precision class 1 = 0.0
recall class 0 = 0.982063
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.017937
positive prediction rate = 0.016129
AUC of ROC = 0.775964
AUC of PRC = 0.266342
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[472   9]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13245199620723724
difference in average predicted and observed risk = -0.013196003792762756
number samples = 563
accuracy = 0.900533
precision class 0 = 0.909441
precision class 1 = 0.795455
recall class 0 = 0.981289
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.018711
positive prediction rate = 0.078153
AUC of ROC = 0.904848
AUC of PRC = 0.707449
min(+P, Se) = 0.634146

-------------------------------

confusion matrix:
[[648   7]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09422300010919571
difference in average predicted and observed risk = -0.013405999890804293
number samples = 734
accuracy = 0.910082
precision class 0 = 0.916549
precision class 1 = 0.740741
recall class 0 = 0.989313
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.010687
positive prediction rate = 0.036785
AUC of ROC = 0.849937
AUC of PRC = 0.520092
min(+P, Se) = 0.493671

-------------------------------

confusion matrix:
[[4120   37]
 [ 372   99]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09109900146722794
difference in average predicted and observed risk = -0.010672998532772066
number samples = 4628
accuracy = 0.911625
precision class 0 = 0.917186
precision class 1 = 0.727941
recall class 0 = 0.991099
recall class 1 = 0.210191
false negative rate = 0.789809
false positive rate = 0.008901
positive prediction rate = 0.029386
AUC of ROC = 0.863405
AUC of PRC = 0.507484
min(+P, Se) = 0.473461

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08035100251436234
difference in average predicted and observed risk = 0.00018200251436233106
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.897151
AUC of PRC = 0.433234
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08434899896383286
difference in average predicted and observed risk = -0.02444700103616715
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.828074
AUC of PRC = 0.446418
min(+P, Se) = 0.44898

-------------------------------

confusion matrix:
[[102   3]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11527899652719498
difference in average predicted and observed risk = 0.005109996527194974
number samples = 118
accuracy = 0.898305
precision class 0 = 0.918919
precision class 1 = 0.571429
recall class 0 = 0.971429
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.028571
positive prediction rate = 0.059322
AUC of ROC = 0.887912
AUC of PRC = 0.461619
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12374600023031235
difference in average predicted and observed risk = -0.00958699976968766
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09638399630784988
difference in average predicted and observed risk = -0.01866000369215011
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.838034
AUC of PRC = 0.387929
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[430   4]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08393999934196472
difference in average predicted and observed risk = -0.008110000658035285
number samples = 478
accuracy = 0.922594
precision class 0 = 0.928726
precision class 1 = 0.733333
recall class 0 = 0.990783
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.009217
positive prediction rate = 0.031381
AUC of ROC = 0.881022
AUC of PRC = 0.54375
min(+P, Se) = 0.522727

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07093799859285355
difference in average predicted and observed risk = -0.018264001407146457
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.882325
AUC of PRC = 0.528969
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11711999773979187
difference in average predicted and observed risk = -0.0005270022602081315
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.876852
AUC of PRC = 0.588654
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.0925230011343956
difference in average predicted and observed risk = 0.003813001134395602
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.865648
AUC of PRC = 0.277535
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11155500262975693
difference in average predicted and observed risk = -0.03805099737024306
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.834795
AUC of PRC = 0.554851
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13134199380874634
difference in average predicted and observed risk = 0.052394993808746335
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.505952
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[727   7]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08910299837589264
difference in average predicted and observed risk = -0.012488001624107362
number samples = 817
accuracy = 0.908201
precision class 0 = 0.914465
precision class 1 = 0.681818
recall class 0 = 0.990463
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.009537
positive prediction rate = 0.026928
AUC of ROC = 0.864794
AUC of PRC = 0.477941
min(+P, Se) = 0.481928

-------------------------------

Epoch 00077: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch77.state
Epoch 78/100
 - 319s - loss: 0.2546 - val_loss: 0.2396

==>predicting on train



confusion matrix:
[[2133   22]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09396100044250488
difference in average predicted and observed risk = -0.011847999557495117
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.913882
precision class 1 = 0.710526
recall class 0 = 0.989791
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.010209
positive prediction rate = 0.031535
AUC of ROC = 0.841541
AUC of PRC = 0.469276
min(+P, Se) = 0.445312

-------------------------------

confusion matrix:
[[1163   16]
 [  91   27]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.085316002368927
difference in average predicted and observed risk = -0.005662997631073002
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.927432
precision class 1 = 0.627907
recall class 0 = 0.986429
recall class 1 = 0.228814
false negative rate = 0.771186
false positive rate = 0.013571
positive prediction rate = 0.033153
AUC of ROC = 0.862998
AUC of PRC = 0.45784
min(+P, Se) = 0.411765

-------------------------------

confusion matrix:
[[643  13]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09788700193166733
difference in average predicted and observed risk = -0.003482998068332674
number samples = 730
accuracy = 0.906849
precision class 0 = 0.921203
precision class 1 = 0.59375
recall class 0 = 0.980183
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.019817
positive prediction rate = 0.043836
AUC of ROC = 0.84958
AUC of PRC = 0.493531
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1140189990401268
difference in average predicted and observed risk = -0.011635000959873187
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.956337
AUC of PRC = 0.816603
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2446   28]
 [ 198   57]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08610600233078003
difference in average predicted and observed risk = -0.007334997669219967
number samples = 2729
accuracy = 0.917186
precision class 0 = 0.925113
precision class 1 = 0.670588
recall class 0 = 0.988682
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.011318
positive prediction rate = 0.031147
AUC of ROC = 0.847495
AUC of PRC = 0.441444
min(+P, Se) = 0.415686

-------------------------------

confusion matrix:
[[1658   25]
 [ 162   54]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10287199914455414
difference in average predicted and observed risk = -0.01087200085544586
number samples = 1899
accuracy = 0.901527
precision class 0 = 0.910989
precision class 1 = 0.683544
recall class 0 = 0.985146
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.014854
positive prediction rate = 0.041601
AUC of ROC = 0.863766
AUC of PRC = 0.540044
min(+P, Se) = 0.476852

-------------------------------

confusion matrix:
[[540   9]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10605300217866898
difference in average predicted and observed risk = -0.016949997821331025
number samples = 626
accuracy = 0.886581
precision class 0 = 0.89701
precision class 1 = 0.625
recall class 0 = 0.983607
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.016393
positive prediction rate = 0.038339
AUC of ROC = 0.846995
AUC of PRC = 0.459382
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[2230   19]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07762700319290161
difference in average predicted and observed risk = -0.007028996807098384
number samples = 2457
accuracy = 0.922263
precision class 0 = 0.928393
precision class 1 = 0.654545
recall class 0 = 0.991552
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.008448
positive prediction rate = 0.022385
AUC of ROC = 0.853174
AUC of PRC = 0.418428
min(+P, Se) = 0.391509

-------------------------------

confusion matrix:
[[218   5]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09868200123310089
difference in average predicted and observed risk = -0.0021239987668991156
number samples = 248
accuracy = 0.891129
precision class 0 = 0.908333
precision class 1 = 0.375
recall class 0 = 0.977578
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.022422
positive prediction rate = 0.032258
AUC of ROC = 0.762332
AUC of PRC = 0.267605
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[469  12]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13553200662136078
difference in average predicted and observed risk = -0.010115993378639221
number samples = 563
accuracy = 0.895204
precision class 0 = 0.908915
precision class 1 = 0.744681
recall class 0 = 0.975052
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.024948
positive prediction rate = 0.083481
AUC of ROC = 0.89501
AUC of PRC = 0.69144
min(+P, Se) = 0.621951

-------------------------------

confusion matrix:
[[647   8]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09869000315666199
difference in average predicted and observed risk = -0.008938996843338015
number samples = 734
accuracy = 0.911444
precision class 0 = 0.919034
precision class 1 = 0.733333
recall class 0 = 0.987786
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.012214
positive prediction rate = 0.040872
AUC of ROC = 0.841975
AUC of PRC = 0.501959
min(+P, Se) = 0.443038

-------------------------------

confusion matrix:
[[4104   53]
 [ 360  111]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09298499673604965
difference in average predicted and observed risk = -0.00878700326395035
number samples = 4628
accuracy = 0.910761
precision class 0 = 0.919355
precision class 1 = 0.676829
recall class 0 = 0.98725
recall class 1 = 0.235669
false negative rate = 0.764331
false positive rate = 0.01275
positive prediction rate = 0.035436
AUC of ROC = 0.855297
AUC of PRC = 0.489813
min(+P, Se) = 0.455508

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 14   5]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0829320028424263
difference in average predicted and observed risk = 0.002763002842426296
number samples = 237
accuracy = 0.924051
precision class 0 = 0.938596
precision class 1 = 0.555556
recall class 0 = 0.981651
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018349
positive prediction rate = 0.037975
AUC of ROC = 0.881941
AUC of PRC = 0.410094
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0873590037226677
difference in average predicted and observed risk = -0.02143699627733231
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.817684
AUC of PRC = 0.414878
min(+P, Se) = 0.403509

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11863800138235092
difference in average predicted and observed risk = 0.008469001382350919
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.882784
AUC of PRC = 0.465399
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12752200663089752
difference in average predicted and observed risk = -0.005810993369102485
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 33   6]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10147599875926971
difference in average predicted and observed risk = -0.01356800124073028
number samples = 339
accuracy = 0.893805
precision class 0 = 0.9
precision class 1 = 0.666667
recall class 0 = 0.99
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.01
positive prediction rate = 0.026549
AUC of ROC = 0.832051
AUC of PRC = 0.369119
min(+P, Se) = 0.425

-------------------------------

confusion matrix:
[[429   5]
 [ 31  13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08539500087499619
difference in average predicted and observed risk = -0.0066549991250038215
number samples = 478
accuracy = 0.924686
precision class 0 = 0.932609
precision class 1 = 0.722222
recall class 0 = 0.988479
recall class 1 = 0.295455
false negative rate = 0.704545
false positive rate = 0.011521
positive prediction rate = 0.037657
AUC of ROC = 0.868821
AUC of PRC = 0.537
min(+P, Se) = 0.52

-------------------------------

confusion matrix:
[[387   1]
 [ 30   8]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07224500179290771
difference in average predicted and observed risk = -0.01695699820709229
number samples = 426
accuracy = 0.92723
precision class 0 = 0.928058
precision class 1 = 0.888889
recall class 0 = 0.997423
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.002577
positive prediction rate = 0.021127
AUC of ROC = 0.864759
AUC of PRC = 0.493407
min(+P, Se) = 0.47619

-------------------------------

confusion matrix:
[[86  4]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1181040033698082
difference in average predicted and observed risk = 0.00045700336980819545
number samples = 102
accuracy = 0.892157
precision class 0 = 0.924731
precision class 1 = 0.555556
recall class 0 = 0.955556
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.044444
positive prediction rate = 0.088235
AUC of ROC = 0.881481
AUC of PRC = 0.578265
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09949100017547607
difference in average predicted and observed risk = 0.010781000175476077
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.851971
AUC of PRC = 0.256261
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11524499952793121
difference in average predicted and observed risk = -0.034361000472068776
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.825049
AUC of PRC = 0.556468
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14271500706672668
difference in average predicted and observed risk = 0.06376800706672668
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.895238
AUC of PRC = 0.268849
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[726   8]
 [ 64  19]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09206700325012207
difference in average predicted and observed risk = -0.00952399674987793
number samples = 817
accuracy = 0.911873
precision class 0 = 0.918987
precision class 1 = 0.703704
recall class 0 = 0.989101
recall class 1 = 0.228916
false negative rate = 0.771084
false positive rate = 0.010899
positive prediction rate = 0.033048
AUC of ROC = 0.856226
AUC of PRC = 0.460086
min(+P, Se) = 0.470588

-------------------------------

Epoch 00078: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch78.state
Epoch 79/100
 - 318s - loss: 0.2541 - val_loss: 0.2371

==>predicting on train



confusion matrix:
[[2138   17]
 [ 206   49]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09108400344848633
difference in average predicted and observed risk = -0.014724996551513672
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.912116
precision class 1 = 0.742424
recall class 0 = 0.992111
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.007889
positive prediction rate = 0.027386
AUC of ROC = 0.849122
AUC of PRC = 0.485814
min(+P, Se) = 0.460938

-------------------------------

confusion matrix:
[[1166   13]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08394499868154526
difference in average predicted and observed risk = -0.007034001318454747
number samples = 1297
accuracy = 0.916731
precision class 0 = 0.924663
precision class 1 = 0.638889
recall class 0 = 0.988974
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.011026
positive prediction rate = 0.027756
AUC of ROC = 0.867081
AUC of PRC = 0.471314
min(+P, Se) = 0.457627

-------------------------------

confusion matrix:
[[647   9]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09558399766683578
difference in average predicted and observed risk = -0.005786002333164217
number samples = 730
accuracy = 0.910959
precision class 0 = 0.920341
precision class 1 = 0.666667
recall class 0 = 0.986281
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.01372
positive prediction rate = 0.036986
AUC of ROC = 0.856234
AUC of PRC = 0.50984
min(+P, Se) = 0.459459

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10929899662733078
difference in average predicted and observed risk = -0.016355003372669208
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.957834
AUC of PRC = 0.826244
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2450   24]
 [ 204   51]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08402799814939499
difference in average predicted and observed risk = -0.009413001850605007
number samples = 2729
accuracy = 0.916453
precision class 0 = 0.923135
precision class 1 = 0.68
recall class 0 = 0.990299
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.009701
positive prediction rate = 0.027483
AUC of ROC = 0.85435
AUC of PRC = 0.456887
min(+P, Se) = 0.431373

-------------------------------

confusion matrix:
[[1666   17]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09990999847650528
difference in average predicted and observed risk = -0.013834001523494718
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.909389
precision class 1 = 0.746269
recall class 0 = 0.989899
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.010101
positive prediction rate = 0.035282
AUC of ROC = 0.86839
AUC of PRC = 0.551516
min(+P, Se) = 0.506912

-------------------------------

confusion matrix:
[[542   7]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10521700233221054
difference in average predicted and observed risk = -0.01778599766778946
number samples = 626
accuracy = 0.883387
precision class 0 = 0.891447
precision class 1 = 0.611111
recall class 0 = 0.98725
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.01275
positive prediction rate = 0.028754
AUC of ROC = 0.853997
AUC of PRC = 0.48012
min(+P, Se) = 0.506494

-------------------------------

confusion matrix:
[[2235   14]
 [ 175   33]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07569500058889389
difference in average predicted and observed risk = -0.008960999411106105
number samples = 2457
accuracy = 0.923077
precision class 0 = 0.927386
precision class 1 = 0.702128
recall class 0 = 0.993775
recall class 1 = 0.158654
false negative rate = 0.841346
false positive rate = 0.006225
positive prediction rate = 0.019129
AUC of ROC = 0.860789
AUC of PRC = 0.438803
min(+P, Se) = 0.406699

-------------------------------

confusion matrix:
[[218   5]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09639699757099152
difference in average predicted and observed risk = -0.004409002429008491
number samples = 248
accuracy = 0.891129
precision class 0 = 0.908333
precision class 1 = 0.375
recall class 0 = 0.977578
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.022422
positive prediction rate = 0.032258
AUC of ROC = 0.766637
AUC of PRC = 0.266752
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[472   9]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13090799748897552
difference in average predicted and observed risk = -0.014740002511024475
number samples = 563
accuracy = 0.900533
precision class 0 = 0.909441
precision class 1 = 0.795455
recall class 0 = 0.981289
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.018711
positive prediction rate = 0.078153
AUC of ROC = 0.896633
AUC of PRC = 0.697201
min(+P, Se) = 0.616279

-------------------------------

confusion matrix:
[[649   6]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09480299800634384
difference in average predicted and observed risk = -0.012826001993656161
number samples = 734
accuracy = 0.910082
precision class 0 = 0.915374
precision class 1 = 0.76
recall class 0 = 0.99084
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.00916
positive prediction rate = 0.03406
AUC of ROC = 0.847831
AUC of PRC = 0.517993
min(+P, Se) = 0.481013

-------------------------------

confusion matrix:
[[4116   41]
 [ 370  101]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09054499864578247
difference in average predicted and observed risk = -0.01122700135421753
number samples = 4628
accuracy = 0.911193
precision class 0 = 0.917521
precision class 1 = 0.711268
recall class 0 = 0.990137
recall class 1 = 0.214437
false negative rate = 0.785563
false positive rate = 0.009863
positive prediction rate = 0.030683
AUC of ROC = 0.861265
AUC of PRC = 0.50426
min(+P, Se) = 0.473573

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08199500292539597
difference in average predicted and observed risk = 0.0018260029253959614
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.901255
AUC of PRC = 0.460884
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08292700350284576
difference in average predicted and observed risk = -0.02586899649715424
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.824924
AUC of PRC = 0.434175
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11949799954891205
difference in average predicted and observed risk = 0.009328999548912045
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.887912
AUC of PRC = 0.509849
min(+P, Se) = 0.588235

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11965499818325043
difference in average predicted and observed risk = -0.01367800181674958
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09748099744319916
difference in average predicted and observed risk = -0.017563002556800836
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.839487
AUC of PRC = 0.388703
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0834759995341301
difference in average predicted and observed risk = -0.00857400046586991
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.875524
AUC of PRC = 0.545947
min(+P, Se) = 0.510204

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07001599669456482
difference in average predicted and observed risk = -0.019186003305435184
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.87812
AUC of PRC = 0.514942
min(+P, Se) = 0.487805

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11053299903869629
difference in average predicted and observed risk = -0.0071140009613037125
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.874074
AUC of PRC = 0.568156
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09796799719333649
difference in average predicted and observed risk = 0.00925799719333649
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.851167
AUC of PRC = 0.25878
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11380299925804138
difference in average predicted and observed risk = -0.03580300074195861
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.832846
AUC of PRC = 0.570318
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13803599774837494
difference in average predicted and observed risk = 0.059088997748374936
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.87619
AUC of PRC = 0.246032
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08928699791431427
difference in average predicted and observed risk = -0.01230400208568573
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.862972
AUC of PRC = 0.477213
min(+P, Se) = 0.464286

-------------------------------

Epoch 00079: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch79.state
Epoch 80/100
 - 322s - loss: 0.2547 - val_loss: 0.2362

==>predicting on train



confusion matrix:
[[2136   19]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0839340016245842
difference in average predicted and observed risk = -0.021874998375415802
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.913211
precision class 1 = 0.732394
recall class 0 = 0.991183
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.008817
positive prediction rate = 0.029461
AUC of ROC = 0.847119
AUC of PRC = 0.482747
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1168   11]
 [  95   23]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07553499937057495
difference in average predicted and observed risk = -0.015444000629425053
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.924782
precision class 1 = 0.676471
recall class 0 = 0.99067
recall class 1 = 0.194915
false negative rate = 0.805085
false positive rate = 0.00933
positive prediction rate = 0.026214
AUC of ROC = 0.863537
AUC of PRC = 0.469042
min(+P, Se) = 0.432203

-------------------------------

confusion matrix:
[[651   5]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08489400148391724
difference in average predicted and observed risk = -0.016475998516082765
number samples = 730
accuracy = 0.915069
precision class 0 = 0.919492
precision class 1 = 0.772727
recall class 0 = 0.992378
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.007622
positive prediction rate = 0.030137
AUC of ROC = 0.855121
AUC of PRC = 0.51388
min(+P, Se) = 0.48

-------------------------------

confusion matrix:
[[165   2]
 [ 12  12]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10551799833774567
difference in average predicted and observed risk = -0.02013600166225432
number samples = 191
accuracy = 0.926702
precision class 0 = 0.932203
precision class 1 = 0.857143
recall class 0 = 0.988024
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.011976
positive prediction rate = 0.073298
AUC of ROC = 0.953094
AUC of PRC = 0.807394
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2454   20]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07744800299406052
difference in average predicted and observed risk = -0.01599299700593948
number samples = 2729
accuracy = 0.919018
precision class 0 = 0.924294
precision class 1 = 0.72973
recall class 0 = 0.991916
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.008084
positive prediction rate = 0.027116
AUC of ROC = 0.85267
AUC of PRC = 0.455334
min(+P, Se) = 0.428016

-------------------------------

confusion matrix:
[[1666   17]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09005899727344513
difference in average predicted and observed risk = -0.02368500272655487
number samples = 1899
accuracy = 0.903633
precision class 0 = 0.909389
precision class 1 = 0.746269
recall class 0 = 0.989899
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.010101
positive prediction rate = 0.035282
AUC of ROC = 0.865364
AUC of PRC = 0.549905
min(+P, Se) = 0.50463

-------------------------------

confusion matrix:
[[543   6]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09490499645471573
difference in average predicted and observed risk = -0.028098003545284272
number samples = 626
accuracy = 0.884984
precision class 0 = 0.891626
precision class 1 = 0.647059
recall class 0 = 0.989071
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.010929
positive prediction rate = 0.027157
AUC of ROC = 0.84981
AUC of PRC = 0.479242
min(+P, Se) = 0.487805

-------------------------------

confusion matrix:
[[2238   11]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06797599792480469
difference in average predicted and observed risk = -0.016680002075195308
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.928631
precision class 1 = 0.765957
recall class 0 = 0.995109
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.004891
positive prediction rate = 0.019129
AUC of ROC = 0.85755
AUC of PRC = 0.432293
min(+P, Se) = 0.403846

-------------------------------

confusion matrix:
[[218   5]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08411899954080582
difference in average predicted and observed risk = -0.01668700045919419
number samples = 248
accuracy = 0.891129
precision class 0 = 0.908333
precision class 1 = 0.375
recall class 0 = 0.977578
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.022422
positive prediction rate = 0.032258
AUC of ROC = 0.766637
AUC of PRC = 0.271711
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[474   7]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1259640008211136
difference in average predicted and observed risk = -0.019683999178886413
number samples = 563
accuracy = 0.904085
precision class 0 = 0.909789
precision class 1 = 0.833333
recall class 0 = 0.985447
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.014553
positive prediction rate = 0.0746
AUC of ROC = 0.896912
AUC of PRC = 0.703715
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[647   8]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.08742599934339523
difference in average predicted and observed risk = -0.02020300065660477
number samples = 734
accuracy = 0.907357
precision class 0 = 0.915134
precision class 1 = 0.703704
recall class 0 = 0.987786
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.012214
positive prediction rate = 0.036785
AUC of ROC = 0.84412
AUC of PRC = 0.511043
min(+P, Se) = 0.481481

-------------------------------

confusion matrix:
[[4120   37]
 [ 367  104]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0826219990849495
difference in average predicted and observed risk = -0.019150000915050508
number samples = 4628
accuracy = 0.912705
precision class 0 = 0.918208
precision class 1 = 0.737589
recall class 0 = 0.991099
recall class 1 = 0.220807
false negative rate = 0.779193
false positive rate = 0.008901
positive prediction rate = 0.030467
AUC of ROC = 0.858858
AUC of PRC = 0.502012
min(+P, Se) = 0.466102

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0738300010561943
difference in average predicted and observed risk = -0.006338998943805699
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.900531
AUC of PRC = 0.461635
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07652200013399124
difference in average predicted and observed risk = -0.03227399986600876
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.827577
AUC of PRC = 0.42924
min(+P, Se) = 0.40678

-------------------------------

confusion matrix:
[[103   2]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1088389977812767
difference in average predicted and observed risk = -0.0013300022187233002
number samples = 118
accuracy = 0.898305
precision class 0 = 0.911504
precision class 1 = 0.6
recall class 0 = 0.980952
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.019048
positive prediction rate = 0.042373
AUC of ROC = 0.898168
AUC of PRC = 0.520013
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11459299921989441
difference in average predicted and observed risk = -0.018740000780105598
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08938200026750565
difference in average predicted and observed risk = -0.025661999732494348
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.845897
AUC of PRC = 0.400402
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[431   3]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07643300294876099
difference in average predicted and observed risk = -0.01561699705123902
number samples = 478
accuracy = 0.922594
precision class 0 = 0.926882
precision class 1 = 0.769231
recall class 0 = 0.993088
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.006912
positive prediction rate = 0.027197
AUC of ROC = 0.878613
AUC of PRC = 0.552477
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06315899640321732
difference in average predicted and observed risk = -0.026043003596782688
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.878256
AUC of PRC = 0.517913
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[88  2]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1062690019607544
difference in average predicted and observed risk = -0.011377998039245607
number samples = 102
accuracy = 0.892157
precision class 0 = 0.907216
precision class 1 = 0.6
recall class 0 = 0.977778
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.022222
positive prediction rate = 0.04902
AUC of ROC = 0.903704
AUC of PRC = 0.616934
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08702900260686874
difference in average predicted and observed risk = -0.0016809973931312533
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.849558
AUC of PRC = 0.249004
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10511499643325806
difference in average predicted and observed risk = -0.04449100356674193
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.828947
AUC of PRC = 0.562981
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13023899495601654
difference in average predicted and observed risk = 0.05129199495601654
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.241667
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0818059965968132
difference in average predicted and observed risk = -0.0197850034031868
number samples = 817
accuracy = 0.908201
precision class 0 = 0.913425
precision class 1 = 0.7
recall class 0 = 0.991826
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.008174
positive prediction rate = 0.02448
AUC of ROC = 0.866748
AUC of PRC = 0.481874
min(+P, Se) = 0.46988

-------------------------------

Epoch 00080: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch80.state
Epoch 81/100
 - 322s - loss: 0.2503 - val_loss: 0.2426

==>predicting on train



confusion matrix:
[[2137   18]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09224499762058258
difference in average predicted and observed risk = -0.01356400237941742
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.912858
precision class 1 = 0.73913
recall class 0 = 0.991647
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.008353
positive prediction rate = 0.028631
AUC of ROC = 0.838422
AUC of PRC = 0.474369
min(+P, Se) = 0.441406

-------------------------------

confusion matrix:
[[1170    9]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08463100343942642
difference in average predicted and observed risk = -0.006347996560573582
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.922713
precision class 1 = 0.689655
recall class 0 = 0.992366
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.007634
positive prediction rate = 0.022359
AUC of ROC = 0.855213
AUC of PRC = 0.469032
min(+P, Se) = 0.445378

-------------------------------

confusion matrix:
[[653   3]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09380900114774704
difference in average predicted and observed risk = -0.007560998852252962
number samples = 730
accuracy = 0.917808
precision class 0 = 0.919718
precision class 1 = 0.85
recall class 0 = 0.995427
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.004573
positive prediction rate = 0.027397
AUC of ROC = 0.866513
AUC of PRC = 0.5312
min(+P, Se) = 0.448718

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10857000201940536
difference in average predicted and observed risk = -0.017083997980594623
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.961577
AUC of PRC = 0.831793
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2454   20]
 [ 205   50]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08555299788713455
difference in average predicted and observed risk = -0.007888002112865444
number samples = 2729
accuracy = 0.917552
precision class 0 = 0.922903
precision class 1 = 0.714286
recall class 0 = 0.991916
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.008084
positive prediction rate = 0.02565
AUC of ROC = 0.849918
AUC of PRC = 0.458567
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[1671   12]
 [ 167   49]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09890499711036682
difference in average predicted and observed risk = -0.014839002889633177
number samples = 1899
accuracy = 0.90574
precision class 0 = 0.90914
precision class 1 = 0.803279
recall class 0 = 0.99287
recall class 1 = 0.226852
false negative rate = 0.773148
false positive rate = 0.00713
positive prediction rate = 0.032122
AUC of ROC = 0.858201
AUC of PRC = 0.544133
min(+P, Se) = 0.486111

-------------------------------

confusion matrix:
[[544   5]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10664000362157822
difference in average predicted and observed risk = -0.016362996378421785
number samples = 626
accuracy = 0.888179
precision class 0 = 0.893268
precision class 1 = 0.705882
recall class 0 = 0.990893
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.009107
positive prediction rate = 0.027157
AUC of ROC = 0.848674
AUC of PRC = 0.481934
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[2239   10]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07615199685096741
difference in average predicted and observed risk = -0.008504003149032588
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.927891
precision class 1 = 0.772727
recall class 0 = 0.995554
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.004446
positive prediction rate = 0.017908
AUC of ROC = 0.849234
AUC of PRC = 0.4233
min(+P, Se) = 0.394231

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10084199905395508
difference in average predicted and observed risk = 3.5999053955071414e-05
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.769686
AUC of PRC = 0.266544
min(+P, Se) = 0.37037

-------------------------------

confusion matrix:
[[474   7]
 [ 48  34]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12922999262809753
difference in average predicted and observed risk = -0.016418007371902466
number samples = 563
accuracy = 0.902309
precision class 0 = 0.908046
precision class 1 = 0.829268
recall class 0 = 0.985447
recall class 1 = 0.414634
false negative rate = 0.585366
false positive rate = 0.014553
positive prediction rate = 0.072824
AUC of ROC = 0.896937
AUC of PRC = 0.70398
min(+P, Se) = 0.634146

-------------------------------

confusion matrix:
[[649   6]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09491299837827682
difference in average predicted and observed risk = -0.012716001621723177
number samples = 734
accuracy = 0.908719
precision class 0 = 0.914084
precision class 1 = 0.75
recall class 0 = 0.99084
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.00916
positive prediction rate = 0.032698
AUC of ROC = 0.839637
AUC of PRC = 0.504595
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[4125   32]
 [ 372   99]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.0910319983959198
difference in average predicted and observed risk = -0.010740001604080202
number samples = 4628
accuracy = 0.912705
precision class 0 = 0.917278
precision class 1 = 0.755725
recall class 0 = 0.992302
recall class 1 = 0.210191
false negative rate = 0.789809
false positive rate = 0.007698
positive prediction rate = 0.028306
AUC of ROC = 0.854201
AUC of PRC = 0.500493
min(+P, Se) = 0.458947

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08275199681520462
difference in average predicted and observed risk = 0.002582996815204616
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.891115
AUC of PRC = 0.397707
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08587200194597244
difference in average predicted and observed risk = -0.02292399805402756
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.810832
AUC of PRC = 0.419579
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11664299666881561
difference in average predicted and observed risk = 0.00647399666881561
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.885714
AUC of PRC = 0.490799
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11638399958610535
difference in average predicted and observed risk = -0.01694900041389466
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09764699637889862
difference in average predicted and observed risk = -0.017397003621101373
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.823077
AUC of PRC = 0.384337
min(+P, Se) = 0.434783

-------------------------------

confusion matrix:
[[431   3]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08548499643802643
difference in average predicted and observed risk = -0.006565003561973579
number samples = 478
accuracy = 0.920502
precision class 0 = 0.924893
precision class 1 = 0.75
recall class 0 = 0.993088
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.006912
positive prediction rate = 0.025105
AUC of ROC = 0.86793
AUC of PRC = 0.518059
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.0717030018568039
difference in average predicted and observed risk = -0.01749899814319611
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.862046
AUC of PRC = 0.525333
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[88  2]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11240799725055695
difference in average predicted and observed risk = -0.005239002749443056
number samples = 102
accuracy = 0.892157
precision class 0 = 0.907216
precision class 1 = 0.6
recall class 0 = 0.977778
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.022222
positive prediction rate = 0.04902
AUC of ROC = 0.887037
AUC of PRC = 0.581785
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1010110005736351
difference in average predicted and observed risk = 0.012301000573635104
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.84634
AUC of PRC = 0.253729
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11155900359153748
difference in average predicted and observed risk = -0.03804699640846251
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.802144
AUC of PRC = 0.536643
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13841499388217926
difference in average predicted and observed risk = 0.05946799388217926
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.87619
AUC of PRC = 0.228175
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09053099900484085
difference in average predicted and observed risk = -0.01106000099515915
number samples = 817
accuracy = 0.906977
precision class 0 = 0.912281
precision class 1 = 0.684211
recall class 0 = 0.991826
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.008174
positive prediction rate = 0.023256
AUC of ROC = 0.850711
AUC of PRC = 0.461706
min(+P, Se) = 0.488095

-------------------------------

Epoch 00081: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch81.state
Epoch 82/100
 - 329s - loss: 0.2518 - val_loss: 0.2352

==>predicting on train



confusion matrix:
[[2131   24]
 [ 198   57]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09815599769353867
difference in average predicted and observed risk = -0.0076530023064613345
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.914985
precision class 1 = 0.703704
recall class 0 = 0.988863
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.011137
positive prediction rate = 0.03361
AUC of ROC = 0.849945
AUC of PRC = 0.487543
min(+P, Se) = 0.453488

-------------------------------

confusion matrix:
[[1163   16]
 [  89   29]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08897899836301804
difference in average predicted and observed risk = -0.0020000016369819684
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.928914
precision class 1 = 0.644444
recall class 0 = 0.986429
recall class 1 = 0.245763
false negative rate = 0.754237
false positive rate = 0.013571
positive prediction rate = 0.034695
AUC of ROC = 0.863451
AUC of PRC = 0.47054
min(+P, Se) = 0.466102

-------------------------------

confusion matrix:
[[651   5]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09585399925708771
difference in average predicted and observed risk = -0.005516000742912294
number samples = 730
accuracy = 0.917808
precision class 0 = 0.922096
precision class 1 = 0.791667
recall class 0 = 0.992378
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.007622
positive prediction rate = 0.032877
AUC of ROC = 0.865339
AUC of PRC = 0.533424
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11485999822616577
difference in average predicted and observed risk = -0.010794001773834216
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.955838
AUC of PRC = 0.819106
min(+P, Se) = 0.692308

-------------------------------

confusion matrix:
[[2446   28]
 [ 193   62]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09120000153779984
difference in average predicted and observed risk = -0.002240998462200161
number samples = 2729
accuracy = 0.919018
precision class 0 = 0.926866
precision class 1 = 0.688889
recall class 0 = 0.988682
recall class 1 = 0.243137
false negative rate = 0.756863
false positive rate = 0.011318
positive prediction rate = 0.032979
AUC of ROC = 0.855604
AUC of PRC = 0.467189
min(+P, Se) = 0.45098

-------------------------------

confusion matrix:
[[1664   19]
 [ 162   54]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10267999768257141
difference in average predicted and observed risk = -0.011064002317428587
number samples = 1899
accuracy = 0.904687
precision class 0 = 0.911281
precision class 1 = 0.739726
recall class 0 = 0.988711
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011289
positive prediction rate = 0.038441
AUC of ROC = 0.868885
AUC of PRC = 0.552172
min(+P, Se) = 0.49537

-------------------------------

confusion matrix:
[[541   8]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11349999904632568
difference in average predicted and observed risk = -0.009503000953674318
number samples = 626
accuracy = 0.889776
precision class 0 = 0.898671
precision class 1 = 0.666667
recall class 0 = 0.985428
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.014572
positive prediction rate = 0.038339
AUC of ROC = 0.854848
AUC of PRC = 0.498029
min(+P, Se) = 0.493506

-------------------------------

confusion matrix:
[[2237   12]
 [ 171   37]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07959499955177307
difference in average predicted and observed risk = -0.005061000448226924
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.928987
precision class 1 = 0.755102
recall class 0 = 0.994664
recall class 1 = 0.177885
false negative rate = 0.822115
false positive rate = 0.005336
positive prediction rate = 0.019943
AUC of ROC = 0.859711
AUC of PRC = 0.438203
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[219   4]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10099200159311295
difference in average predicted and observed risk = 0.00018600159311293885
number samples = 248
accuracy = 0.895161
precision class 0 = 0.908714
precision class 1 = 0.428571
recall class 0 = 0.982063
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.017937
positive prediction rate = 0.028226
AUC of ROC = 0.77991
AUC of PRC = 0.264778
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[469  12]
 [ 43  39]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14212100207805634
difference in average predicted and observed risk = -0.0035269979219436642
number samples = 563
accuracy = 0.902309
precision class 0 = 0.916016
precision class 1 = 0.764706
recall class 0 = 0.975052
recall class 1 = 0.47561
false negative rate = 0.52439
false positive rate = 0.024948
positive prediction rate = 0.090586
AUC of ROC = 0.900867
AUC of PRC = 0.708716
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[644  11]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09836199879646301
difference in average predicted and observed risk = -0.00926700120353699
number samples = 734
accuracy = 0.905995
precision class 0 = 0.917379
precision class 1 = 0.65625
recall class 0 = 0.983206
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.016794
positive prediction rate = 0.043597
AUC of ROC = 0.848642
AUC of PRC = 0.504546
min(+P, Se) = 0.47619

-------------------------------

confusion matrix:
[[4110   47]
 [ 355  116]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09591100364923477
difference in average predicted and observed risk = -0.00586099635076523
number samples = 4628
accuracy = 0.913137
precision class 0 = 0.920493
precision class 1 = 0.711656
recall class 0 = 0.988694
recall class 1 = 0.246284
false negative rate = 0.753716
false positive rate = 0.011306
positive prediction rate = 0.03522
AUC of ROC = 0.862062
AUC of PRC = 0.506873
min(+P, Se) = 0.473573

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08641500025987625
difference in average predicted and observed risk = 0.006246000259876247
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.891598
AUC of PRC = 0.432117
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08806300163269043
difference in average predicted and observed risk = -0.020732998367309574
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.832385
AUC of PRC = 0.43969
min(+P, Se) = 0.396552

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12411300092935562
difference in average predicted and observed risk = 0.013944000929355618
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.911355
AUC of PRC = 0.485193
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12163200229406357
difference in average predicted and observed risk = -0.011700997705936439
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10078199952840805
difference in average predicted and observed risk = -0.014262000471591943
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.851111
AUC of PRC = 0.396185
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[430   4]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08923199772834778
difference in average predicted and observed risk = -0.0028180022716522285
number samples = 478
accuracy = 0.924686
precision class 0 = 0.930736
precision class 1 = 0.75
recall class 0 = 0.990783
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.009217
positive prediction rate = 0.033473
AUC of ROC = 0.876152
AUC of PRC = 0.515887
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07398000359535217
difference in average predicted and observed risk = -0.01522199640464783
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.882325
AUC of PRC = 0.487191
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12182600051164627
difference in average predicted and observed risk = 0.004179000511646269
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.90463
AUC of PRC = 0.59213
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10404899716377258
difference in average predicted and observed risk = 0.015338997163772586
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.864039
AUC of PRC = 0.267308
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11433999985456467
difference in average predicted and observed risk = -0.03526600014543532
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.825536
AUC of PRC = 0.55241
min(+P, Se) = 0.590909

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14349700510501862
difference in average predicted and observed risk = 0.06455000510501861
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.857143
AUC of PRC = 0.470779
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[727   7]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09402400255203247
difference in average predicted and observed risk = -0.00756699744796753
number samples = 817
accuracy = 0.909425
precision class 0 = 0.915617
precision class 1 = 0.695652
recall class 0 = 0.990463
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.009537
positive prediction rate = 0.028152
AUC of ROC = 0.867929
AUC of PRC = 0.469921
min(+P, Se) = 0.458824

-------------------------------

Epoch 00082: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch82.state
Epoch 83/100
 - 321s - loss: 0.2516 - val_loss: 0.2372

==>predicting on train



confusion matrix:
[[2134   21]
 [ 200   55]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10498200356960297
difference in average predicted and observed risk = -0.000826996430397034
number samples = 2410
accuracy = 0.908299
precision class 0 = 0.91431
precision class 1 = 0.723684
recall class 0 = 0.990255
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.009745
positive prediction rate = 0.031535
AUC of ROC = 0.847727
AUC of PRC = 0.477401
min(+P, Se) = 0.439689

-------------------------------

confusion matrix:
[[1162   17]
 [  89   29]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.0955440029501915
difference in average predicted and observed risk = 0.0045650029501914935
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.928857
precision class 1 = 0.630435
recall class 0 = 0.985581
recall class 1 = 0.245763
false negative rate = 0.754237
false positive rate = 0.014419
positive prediction rate = 0.035466
AUC of ROC = 0.865327
AUC of PRC = 0.470466
min(+P, Se) = 0.453782

-------------------------------

confusion matrix:
[[650   6]
 [ 54  20]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10480599850416183
difference in average predicted and observed risk = 0.003435998504161833
number samples = 730
accuracy = 0.917808
precision class 0 = 0.923295
precision class 1 = 0.769231
recall class 0 = 0.990854
recall class 1 = 0.27027
false negative rate = 0.72973
false positive rate = 0.009146
positive prediction rate = 0.035616
AUC of ROC = 0.86023
AUC of PRC = 0.528516
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12032099813222885
difference in average predicted and observed risk = -0.005333001867771137
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.953094
AUC of PRC = 0.815297
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2447   27]
 [ 193   62]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09719900041818619
difference in average predicted and observed risk = 0.0037580004181861915
number samples = 2729
accuracy = 0.919384
precision class 0 = 0.926894
precision class 1 = 0.696629
recall class 0 = 0.989087
recall class 1 = 0.243137
false negative rate = 0.756863
false positive rate = 0.010914
positive prediction rate = 0.032613
AUC of ROC = 0.852214
AUC of PRC = 0.457025
min(+P, Se) = 0.421875

-------------------------------

confusion matrix:
[[1664   19]
 [ 163   53]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11119599640369415
difference in average predicted and observed risk = -0.002548003596305845
number samples = 1899
accuracy = 0.90416
precision class 0 = 0.910783
precision class 1 = 0.736111
recall class 0 = 0.988711
recall class 1 = 0.24537
false negative rate = 0.75463
false positive rate = 0.011289
positive prediction rate = 0.037915
AUC of ROC = 0.869545
AUC of PRC = 0.549521
min(+P, Se) = 0.488987

-------------------------------

confusion matrix:
[[540   9]
 [ 60  17]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12243600189685822
difference in average predicted and observed risk = -0.0005669981031417859
number samples = 626
accuracy = 0.889776
precision class 0 = 0.9
precision class 1 = 0.653846
recall class 0 = 0.983607
recall class 1 = 0.220779
false negative rate = 0.779221
false positive rate = 0.016393
positive prediction rate = 0.041534
AUC of ROC = 0.855771
AUC of PRC = 0.48569
min(+P, Se) = 0.493671

-------------------------------

confusion matrix:
[[2237   12]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08580999821424484
difference in average predicted and observed risk = 0.0011539982142448474
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.928216
precision class 1 = 0.744681
recall class 0 = 0.994664
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.005336
positive prediction rate = 0.019129
AUC of ROC = 0.857206
AUC of PRC = 0.424796
min(+P, Se) = 0.403846

-------------------------------

confusion matrix:
[[219   4]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11190100014209747
difference in average predicted and observed risk = 0.011095000142097466
number samples = 248
accuracy = 0.895161
precision class 0 = 0.908714
precision class 1 = 0.428571
recall class 0 = 0.982063
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.017937
positive prediction rate = 0.028226
AUC of ROC = 0.780987
AUC of PRC = 0.272597
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[468  13]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14764800667762756
difference in average predicted and observed risk = 0.002000006677627564
number samples = 563
accuracy = 0.898757
precision class 0 = 0.914062
precision class 1 = 0.745098
recall class 0 = 0.972973
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.027027
positive prediction rate = 0.090586
AUC of ROC = 0.892805
AUC of PRC = 0.693385
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[647   8]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10634700208902359
difference in average predicted and observed risk = -0.0012819979109764124
number samples = 734
accuracy = 0.911444
precision class 0 = 0.919034
precision class 1 = 0.733333
recall class 0 = 0.987786
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.012214
positive prediction rate = 0.040872
AUC of ROC = 0.85245
AUC of PRC = 0.513057
min(+P, Se) = 0.475

-------------------------------

confusion matrix:
[[4111   46]
 [ 356  115]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10294199734926224
difference in average predicted and observed risk = 0.0011699973492622362
number samples = 4628
accuracy = 0.913137
precision class 0 = 0.920304
precision class 1 = 0.714286
recall class 0 = 0.988934
recall class 1 = 0.244161
false negative rate = 0.755839
false positive rate = 0.011066
positive prediction rate = 0.034788
AUC of ROC = 0.860524
AUC of PRC = 0.500456
min(+P, Se) = 0.462845

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09172099828720093
difference in average predicted and observed risk = 0.011551998287200924
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.895461
AUC of PRC = 0.429886
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0975160002708435
difference in average predicted and observed risk = -0.011279999729156498
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.827079
AUC of PRC = 0.418013
min(+P, Se) = 0.431034

-------------------------------

confusion matrix:
[[102   3]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1304520070552826
difference in average predicted and observed risk = 0.02028300705528259
number samples = 118
accuracy = 0.90678
precision class 0 = 0.927273
precision class 1 = 0.625
recall class 0 = 0.971429
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.028571
positive prediction rate = 0.067797
AUC of ROC = 0.895238
AUC of PRC = 0.536798
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.1331530064344406
difference in average predicted and observed risk = -0.00017999356555939428
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10879100114107132
difference in average predicted and observed risk = -0.006252998858928674
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.848034
AUC of PRC = 0.410607
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[429   5]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09701400250196457
difference in average predicted and observed risk = 0.004964002501964562
number samples = 478
accuracy = 0.922594
precision class 0 = 0.930586
precision class 1 = 0.705882
recall class 0 = 0.988479
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.011521
positive prediction rate = 0.035565
AUC of ROC = 0.873691
AUC of PRC = 0.516754
min(+P, Se) = 0.477273

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08041699975728989
difference in average predicted and observed risk = -0.008785000242710117
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.87717
AUC of PRC = 0.493336
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[86  4]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.13232700526714325
difference in average predicted and observed risk = 0.014680005267143248
number samples = 102
accuracy = 0.882353
precision class 0 = 0.914894
precision class 1 = 0.5
recall class 0 = 0.955556
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.044444
positive prediction rate = 0.078431
AUC of ROC = 0.917593
AUC of PRC = 0.615249
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11237400025129318
difference in average predicted and observed risk = 0.023664000251293185
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.854385
AUC of PRC = 0.263462
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[106   2]
 [ 13   6]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12300900369882584
difference in average predicted and observed risk = -0.026596996301174153
number samples = 127
accuracy = 0.88189
precision class 0 = 0.890756
precision class 1 = 0.75
recall class 0 = 0.981481
recall class 1 = 0.315789
false negative rate = 0.684211
false positive rate = 0.018519
positive prediction rate = 0.062992
AUC of ROC = 0.817739
AUC of PRC = 0.544607
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.15634900331497192
difference in average predicted and observed risk = 0.07740200331497192
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.87619
AUC of PRC = 0.485847
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[726   8]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10189999639987946
difference in average predicted and observed risk = 0.0003089963998794548
number samples = 817
accuracy = 0.908201
precision class 0 = 0.915511
precision class 1 = 0.666667
recall class 0 = 0.989101
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.010899
positive prediction rate = 0.029376
AUC of ROC = 0.865517
AUC of PRC = 0.476269
min(+P, Se) = 0.457831

-------------------------------

Epoch 00083: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch83.state
Epoch 84/100
 - 322s - loss: 0.2525 - val_loss: 0.2359

==>predicting on train



confusion matrix:
[[2135   20]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.0976950004696846
difference in average predicted and observed risk = -0.0081139995303154
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.912783
precision class 1 = 0.71831
recall class 0 = 0.990719
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.009281
positive prediction rate = 0.029461
AUC of ROC = 0.853188
AUC of PRC = 0.490841
min(+P, Se) = 0.470588

-------------------------------

confusion matrix:
[[1169   10]
 [  93   25]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08819399774074554
difference in average predicted and observed risk = -0.00278500225925446
number samples = 1297
accuracy = 0.920586
precision class 0 = 0.926307
precision class 1 = 0.714286
recall class 0 = 0.991518
recall class 1 = 0.211864
false negative rate = 0.788136
false positive rate = 0.008482
positive prediction rate = 0.026985
AUC of ROC = 0.867677
AUC of PRC = 0.475391
min(+P, Se) = 0.440678

-------------------------------

confusion matrix:
[[651   5]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09545999765396118
difference in average predicted and observed risk = -0.00591000234603882
number samples = 730
accuracy = 0.917808
precision class 0 = 0.922096
precision class 1 = 0.791667
recall class 0 = 0.992378
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.007622
positive prediction rate = 0.032877
AUC of ROC = 0.860292
AUC of PRC = 0.529416
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[165   2]
 [ 12  12]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1150130033493042
difference in average predicted and observed risk = -0.010640996650695789
number samples = 191
accuracy = 0.926702
precision class 0 = 0.932203
precision class 1 = 0.857143
recall class 0 = 0.988024
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.011976
positive prediction rate = 0.073298
AUC of ROC = 0.959331
AUC of PRC = 0.829949
min(+P, Se) = 0.730769

-------------------------------

confusion matrix:
[[2452   22]
 [ 197   58]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08973699808120728
difference in average predicted and observed risk = -0.003704001918792721
number samples = 2729
accuracy = 0.919751
precision class 0 = 0.925632
precision class 1 = 0.725
recall class 0 = 0.991108
recall class 1 = 0.227451
false negative rate = 0.772549
false positive rate = 0.008892
positive prediction rate = 0.029315
AUC of ROC = 0.859096
AUC of PRC = 0.465994
min(+P, Se) = 0.435294

-------------------------------

confusion matrix:
[[1668   15]
 [ 167   49]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10352499783039093
difference in average predicted and observed risk = -0.010219002169609068
number samples = 1899
accuracy = 0.90416
precision class 0 = 0.908992
precision class 1 = 0.765625
recall class 0 = 0.991087
recall class 1 = 0.226852
false negative rate = 0.773148
false positive rate = 0.008913
positive prediction rate = 0.033702
AUC of ROC = 0.870714
AUC of PRC = 0.557711
min(+P, Se) = 0.509259

-------------------------------

confusion matrix:
[[545   4]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1132109984755516
difference in average predicted and observed risk = -0.009792001524448396
number samples = 626
accuracy = 0.888179
precision class 0 = 0.89198
precision class 1 = 0.733333
recall class 0 = 0.992714
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.007286
positive prediction rate = 0.023962
AUC of ROC = 0.858326
AUC of PRC = 0.494986
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[2237   12]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07920899987220764
difference in average predicted and observed risk = -0.0054470001277923535
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.928601
precision class 1 = 0.75
recall class 0 = 0.994664
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.005336
positive prediction rate = 0.019536
AUC of ROC = 0.864525
AUC of PRC = 0.442007
min(+P, Se) = 0.423077

-------------------------------

confusion matrix:
[[220   3]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10338599979877472
difference in average predicted and observed risk = 0.0025799997987747125
number samples = 248
accuracy = 0.891129
precision class 0 = 0.901639
precision class 1 = 0.25
recall class 0 = 0.986547
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.013453
positive prediction rate = 0.016129
AUC of ROC = 0.788341
AUC of PRC = 0.273069
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[471  10]
 [ 45  37]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13730299472808838
difference in average predicted and observed risk = -0.00834500527191162
number samples = 563
accuracy = 0.902309
precision class 0 = 0.912791
precision class 1 = 0.787234
recall class 0 = 0.97921
recall class 1 = 0.451219
false negative rate = 0.548781
false positive rate = 0.02079
positive prediction rate = 0.083481
AUC of ROC = 0.891664
AUC of PRC = 0.692139
min(+P, Se) = 0.585366

-------------------------------

confusion matrix:
[[647   8]
 [ 57  22]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09953299909830093
difference in average predicted and observed risk = -0.008096000901699069
number samples = 734
accuracy = 0.911444
precision class 0 = 0.919034
precision class 1 = 0.733333
recall class 0 = 0.987786
recall class 1 = 0.278481
false negative rate = 0.721519
false positive rate = 0.012214
positive prediction rate = 0.040872
AUC of ROC = 0.856933
AUC of PRC = 0.530965
min(+P, Se) = 0.493671

-------------------------------

confusion matrix:
[[4120   37]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09539499878883362
difference in average predicted and observed risk = -0.006377001211166383
number samples = 4628
accuracy = 0.913354
precision class 0 = 0.918822
precision class 1 = 0.743056
recall class 0 = 0.991099
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.008901
positive prediction rate = 0.031115
AUC of ROC = 0.864514
AUC of PRC = 0.509915
min(+P, Se) = 0.47983

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08507800102233887
difference in average predicted and observed risk = 0.004909001022338863
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.892805
AUC of PRC = 0.447357
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[384   1]
 [ 40   7]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09132400155067444
difference in average predicted and observed risk = -0.017471998449325565
number samples = 432
accuracy = 0.905093
precision class 0 = 0.90566
precision class 1 = 0.875
recall class 0 = 0.997403
recall class 1 = 0.148936
false negative rate = 0.851064
false positive rate = 0.002597
positive prediction rate = 0.018519
AUC of ROC = 0.827687
AUC of PRC = 0.42101
min(+P, Se) = 0.416667

-------------------------------

confusion matrix:
[[102   3]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11686599999666214
difference in average predicted and observed risk = 0.006696999996662137
number samples = 118
accuracy = 0.889831
precision class 0 = 0.910714
precision class 1 = 0.5
recall class 0 = 0.971429
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.028571
positive prediction rate = 0.050847
AUC of ROC = 0.901832
AUC of PRC = 0.468199
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12646499276161194
difference in average predicted and observed risk = -0.006868007238388069
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10103899985551834
difference in average predicted and observed risk = -0.014005000144481652
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.839744
AUC of PRC = 0.388833
min(+P, Se) = 0.435897

-------------------------------

confusion matrix:
[[429   5]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08984799683094025
difference in average predicted and observed risk = -0.0022020031690597602
number samples = 478
accuracy = 0.920502
precision class 0 = 0.928571
precision class 1 = 0.6875
recall class 0 = 0.988479
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011521
positive prediction rate = 0.033473
AUC of ROC = 0.876728
AUC of PRC = 0.53197
min(+P, Se) = 0.519231

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07352399826049805
difference in average predicted and observed risk = -0.015678001739501957
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.869778
AUC of PRC = 0.524825
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[86  4]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12106599658727646
difference in average predicted and observed risk = 0.003418996587276457
number samples = 102
accuracy = 0.882353
precision class 0 = 0.914894
precision class 1 = 0.5
recall class 0 = 0.955556
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.044444
positive prediction rate = 0.078431
AUC of ROC = 0.916667
AUC of PRC = 0.593986
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10844899713993073
difference in average predicted and observed risk = 0.019738997139930728
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.843926
AUC of PRC = 0.24578
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11556100100278854
difference in average predicted and observed risk = -0.034044998997211445
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.838694
AUC of PRC = 0.567872
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14225299656391144
difference in average predicted and observed risk = 0.06330599656391143
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.885714
AUC of PRC = 0.495767
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[726   8]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09449200332164764
difference in average predicted and observed risk = -0.007098996678352357
number samples = 817
accuracy = 0.906977
precision class 0 = 0.914358
precision class 1 = 0.652174
recall class 0 = 0.989101
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.010899
positive prediction rate = 0.028152
AUC of ROC = 0.864893
AUC of PRC = 0.479664
min(+P, Se) = 0.464286

-------------------------------

Epoch 00084: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch84.state
Epoch 85/100
 - 319s - loss: 0.2508 - val_loss: 0.2345

==>predicting on train



confusion matrix:
[[2141   14]
 [ 211   44]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09383200109004974
difference in average predicted and observed risk = -0.011976998909950257
number samples = 2410
accuracy = 0.906639
precision class 0 = 0.910289
precision class 1 = 0.758621
recall class 0 = 0.993503
recall class 1 = 0.172549
false negative rate = 0.827451
false positive rate = 0.006497
positive prediction rate = 0.024066
AUC of ROC = 0.85215
AUC of PRC = 0.492824
min(+P, Se) = 0.450704

-------------------------------

confusion matrix:
[[1170    9]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08460800349712372
difference in average predicted and observed risk = -0.006370996502876286
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.924171
precision class 1 = 0.709677
recall class 0 = 0.992366
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.007634
positive prediction rate = 0.023901
AUC of ROC = 0.867569
AUC of PRC = 0.489799
min(+P, Se) = 0.466102

-------------------------------

confusion matrix:
[[655   1]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08962299674749374
difference in average predicted and observed risk = -0.011747003252506258
number samples = 730
accuracy = 0.917808
precision class 0 = 0.917367
precision class 1 = 0.9375
recall class 0 = 0.998476
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.001524
positive prediction rate = 0.021918
AUC of ROC = 0.861342
AUC of PRC = 0.544479
min(+P, Se) = 0.506667

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10988499969244003
difference in average predicted and observed risk = -0.015769000307559955
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.954092
AUC of PRC = 0.816833
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2457   17]
 [ 208   47]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08590999990701675
difference in average predicted and observed risk = -0.007531000092983242
number samples = 2729
accuracy = 0.917552
precision class 0 = 0.921951
precision class 1 = 0.734375
recall class 0 = 0.993129
recall class 1 = 0.184314
false negative rate = 0.815686
false positive rate = 0.006871
positive prediction rate = 0.023452
AUC of ROC = 0.856154
AUC of PRC = 0.469871
min(+P, Se) = 0.439216

-------------------------------

confusion matrix:
[[1674    9]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.0989139974117279
difference in average predicted and observed risk = -0.014830002588272093
number samples = 1899
accuracy = 0.905213
precision class 0 = 0.907317
precision class 1 = 0.833333
recall class 0 = 0.994652
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.005348
positive prediction rate = 0.028436
AUC of ROC = 0.872098
AUC of PRC = 0.569096
min(+P, Se) = 0.520737

-------------------------------

confusion matrix:
[[546   3]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10696300119161606
difference in average predicted and observed risk = -0.016039998808383943
number samples = 626
accuracy = 0.886581
precision class 0 = 0.889251
precision class 1 = 0.75
recall class 0 = 0.994536
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.005464
positive prediction rate = 0.019169
AUC of ROC = 0.856528
AUC of PRC = 0.503583
min(+P, Se) = 0.506494

-------------------------------

confusion matrix:
[[2240    9]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07742200046777725
difference in average predicted and observed risk = -0.007233999532222743
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.927152
precision class 1 = 0.780488
recall class 0 = 0.995998
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.004002
positive prediction rate = 0.016687
AUC of ROC = 0.861111
AUC of PRC = 0.445816
min(+P, Se) = 0.430622

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09512799978256226
difference in average predicted and observed risk = -0.005678000217437751
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.778655
AUC of PRC = 0.271422
min(+P, Se) = 0.37037

-------------------------------

confusion matrix:
[[473   8]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1321049928665161
difference in average predicted and observed risk = -0.013543007133483886
number samples = 563
accuracy = 0.902309
precision class 0 = 0.909615
precision class 1 = 0.813953
recall class 0 = 0.983368
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.016632
positive prediction rate = 0.076377
AUC of ROC = 0.897774
AUC of PRC = 0.706736
min(+P, Se) = 0.621951

-------------------------------

confusion matrix:
[[650   5]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09146100282669067
difference in average predicted and observed risk = -0.01616799717330933
number samples = 734
accuracy = 0.907357
precision class 0 = 0.911641
precision class 1 = 0.761905
recall class 0 = 0.992366
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.007634
positive prediction rate = 0.02861
AUC of ROC = 0.856411
AUC of PRC = 0.544686
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4131   26]
 [ 379   92]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09124500304460526
difference in average predicted and observed risk = -0.010526996955394746
number samples = 4628
accuracy = 0.912489
precision class 0 = 0.915965
precision class 1 = 0.779661
recall class 0 = 0.993746
recall class 1 = 0.195329
false negative rate = 0.804671
false positive rate = 0.006255
positive prediction rate = 0.025497
AUC of ROC = 0.863677
AUC of PRC = 0.517578
min(+P, Se) = 0.477707

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08168599754571915
difference in average predicted and observed risk = 0.0015169975457191426
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.893047
AUC of PRC = 0.436051
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.085828997194767
difference in average predicted and observed risk = -0.022967002805233006
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.835314
AUC of PRC = 0.476128
min(+P, Se) = 0.421053

-------------------------------

confusion matrix:
[[103   2]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11118700355291367
difference in average predicted and observed risk = 0.0010180035529136627
number samples = 118
accuracy = 0.889831
precision class 0 = 0.903509
precision class 1 = 0.5
recall class 0 = 0.980952
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.019048
positive prediction rate = 0.033898
AUC of ROC = 0.909158
AUC of PRC = 0.520866
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11804000288248062
difference in average predicted and observed risk = -0.015292997117519386
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09697099775075912
difference in average predicted and observed risk = -0.01807300224924087
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.856752
AUC of PRC = 0.433168
min(+P, Se) = 0.425926

-------------------------------

confusion matrix:
[[432   2]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08415400236845016
difference in average predicted and observed risk = -0.007895997631549842
number samples = 478
accuracy = 0.920502
precision class 0 = 0.923077
precision class 1 = 0.8
recall class 0 = 0.995392
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.004608
positive prediction rate = 0.020921
AUC of ROC = 0.874843
AUC of PRC = 0.538655
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07061699777841568
difference in average predicted and observed risk = -0.018585002221584324
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.878798
AUC of PRC = 0.523647
min(+P, Se) = 0.454545

-------------------------------

confusion matrix:
[[88  2]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.1131419986486435
difference in average predicted and observed risk = -0.004505001351356508
number samples = 102
accuracy = 0.892157
precision class 0 = 0.907216
precision class 1 = 0.6
recall class 0 = 0.977778
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.022222
positive prediction rate = 0.04902
AUC of ROC = 0.930556
AUC of PRC = 0.639001
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10149600356817245
difference in average predicted and observed risk = 0.012786003568172458
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.866452
AUC of PRC = 0.290602
min(+P, Se) = 0.375

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10769400000572205
difference in average predicted and observed risk = -0.04191199999427794
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.823099
AUC of PRC = 0.556016
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1371760070323944
difference in average predicted and observed risk = 0.058229007032394406
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.857143
AUC of PRC = 0.208069
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08947200328111649
difference in average predicted and observed risk = -0.012118996718883515
number samples = 817
accuracy = 0.906977
precision class 0 = 0.91125
precision class 1 = 0.705882
recall class 0 = 0.993188
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.006812
positive prediction rate = 0.020808
AUC of ROC = 0.869522
AUC of PRC = 0.491672
min(+P, Se) = 0.458824

-------------------------------

Epoch 00085: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch85.state
Epoch 86/100
 - 319s - loss: 0.2506 - val_loss: 0.2359

==>predicting on train



confusion matrix:
[[2143   12]
 [ 211   44]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.1021680012345314
difference in average predicted and observed risk = -0.0036409987654685977
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.910365
precision class 1 = 0.785714
recall class 0 = 0.994432
recall class 1 = 0.172549
false negative rate = 0.827451
false positive rate = 0.005568
positive prediction rate = 0.023237
AUC of ROC = 0.851752
AUC of PRC = 0.4871
min(+P, Se) = 0.455598

-------------------------------

confusion matrix:
[[1173    6]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09230300039052963
difference in average predicted and observed risk = 0.0013240003905296283
number samples = 1297
accuracy = 0.919815
precision class 0 = 0.922895
precision class 1 = 0.769231
recall class 0 = 0.994911
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.005089
positive prediction rate = 0.020046
AUC of ROC = 0.870287
AUC of PRC = 0.498668
min(+P, Se) = 0.474576

-------------------------------

confusion matrix:
[[655   1]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09573400020599365
difference in average predicted and observed risk = -0.005635999794006349
number samples = 730
accuracy = 0.916438
precision class 0 = 0.916084
precision class 1 = 0.933333
recall class 0 = 0.998476
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.001524
positive prediction rate = 0.020548
AUC of ROC = 0.875536
AUC of PRC = 0.564858
min(+P, Se) = 0.527027

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.1167600005865097
difference in average predicted and observed risk = -0.008893999413490283
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.952844
AUC of PRC = 0.811041
min(+P, Se) = 0.708333

-------------------------------

confusion matrix:
[[2460   14]
 [ 211   44]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09507600218057632
difference in average predicted and observed risk = 0.0016350021805763282
number samples = 2729
accuracy = 0.917552
precision class 0 = 0.921003
precision class 1 = 0.758621
recall class 0 = 0.994341
recall class 1 = 0.172549
false negative rate = 0.827451
false positive rate = 0.005659
positive prediction rate = 0.021253
AUC of ROC = 0.859429
AUC of PRC = 0.471456
min(+P, Se) = 0.445736

-------------------------------

confusion matrix:
[[1676    7]
 [ 171   45]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10461500287055969
difference in average predicted and observed risk = -0.009128997129440306
number samples = 1899
accuracy = 0.906266
precision class 0 = 0.907417
precision class 1 = 0.865385
recall class 0 = 0.995841
recall class 1 = 0.208333
false negative rate = 0.791667
false positive rate = 0.004159
positive prediction rate = 0.027383
AUC of ROC = 0.874018
AUC of PRC = 0.57403
min(+P, Se) = 0.517391

-------------------------------

confusion matrix:
[[546   3]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11453600227832794
difference in average predicted and observed risk = -0.00846699772167206
number samples = 626
accuracy = 0.884984
precision class 0 = 0.887805
precision class 1 = 0.727273
recall class 0 = 0.994536
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.005464
positive prediction rate = 0.017572
AUC of ROC = 0.863104
AUC of PRC = 0.507965
min(+P, Se) = 0.506494

-------------------------------

confusion matrix:
[[2242    7]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0852620005607605
difference in average predicted and observed risk = 0.0006060005607605029
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.927213
precision class 1 = 0.820513
recall class 0 = 0.996888
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.003112
positive prediction rate = 0.015873
AUC of ROC = 0.86196
AUC of PRC = 0.449792
min(+P, Se) = 0.42381

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10439600050449371
difference in average predicted and observed risk = 0.0035900005044937067
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.77704
AUC of PRC = 0.276666
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[475   6]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14011499285697937
difference in average predicted and observed risk = -0.00553300714302063
number samples = 563
accuracy = 0.902309
precision class 0 = 0.906489
precision class 1 = 0.846154
recall class 0 = 0.987526
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.012474
positive prediction rate = 0.069272
AUC of ROC = 0.901881
AUC of PRC = 0.707353
min(+P, Se) = 0.621951

-------------------------------

confusion matrix:
[[651   4]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09831900149583817
difference in average predicted and observed risk = -0.009309998504161837
number samples = 734
accuracy = 0.908719
precision class 0 = 0.911765
precision class 1 = 0.8
recall class 0 = 0.993893
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.006107
positive prediction rate = 0.027248
AUC of ROC = 0.858286
AUC of PRC = 0.538723
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4136   21]
 [ 382   89]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09899000078439713
difference in average predicted and observed risk = -0.002781999215602876
number samples = 4628
accuracy = 0.912921
precision class 0 = 0.915449
precision class 1 = 0.809091
recall class 0 = 0.994948
recall class 1 = 0.18896
false negative rate = 0.81104
false positive rate = 0.005052
positive prediction rate = 0.023768
AUC of ROC = 0.86624
AUC of PRC = 0.520178
min(+P, Se) = 0.488372

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.088748998939991
difference in average predicted and observed risk = 0.008579998939990993
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.883873
AUC of PRC = 0.447999
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09334900230169296
difference in average predicted and observed risk = -0.015446997698307041
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.838685
AUC of PRC = 0.472669
min(+P, Se) = 0.45098

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11582700163125992
difference in average predicted and observed risk = 0.005658001631259915
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.912821
AUC of PRC = 0.543709
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12587599456310272
difference in average predicted and observed risk = -0.007457005436897285
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.990385
AUC of PRC = 0.94375
min(+P, Se) = 0.8

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10178499668836594
difference in average predicted and observed risk = -0.013259003311634057
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.857692
AUC of PRC = 0.44695
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[432   2]
 [ 37   7]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09267599880695343
difference in average predicted and observed risk = 0.0006259988069534234
number samples = 478
accuracy = 0.91841
precision class 0 = 0.921109
precision class 1 = 0.777778
recall class 0 = 0.995392
recall class 1 = 0.159091
false negative rate = 0.840909
false positive rate = 0.004608
positive prediction rate = 0.018828
AUC of ROC = 0.87102
AUC of PRC = 0.531036
min(+P, Se) = 0.480769

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07738900184631348
difference in average predicted and observed risk = -0.011812998153686527
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.876289
AUC of PRC = 0.51328
min(+P, Se) = 0.488372

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11898300051689148
difference in average predicted and observed risk = 0.001336000516891478
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.937037
AUC of PRC = 0.682481
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11126700043678284
difference in average predicted and observed risk = 0.02255700043678284
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.858407
AUC of PRC = 0.269442
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11437200009822845
difference in average predicted and observed risk = -0.035233999901771534
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.832359
AUC of PRC = 0.560883
min(+P, Se) = 0.55

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1415179967880249
difference in average predicted and observed risk = 0.0625709967880249
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.838095
AUC of PRC = 0.213973
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[730   4]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09645500034093857
difference in average predicted and observed risk = -0.005135999659061433
number samples = 817
accuracy = 0.906977
precision class 0 = 0.910224
precision class 1 = 0.733333
recall class 0 = 0.99455
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.00545
positive prediction rate = 0.01836
AUC of ROC = 0.868455
AUC of PRC = 0.496747
min(+P, Se) = 0.468085

-------------------------------

Epoch 00086: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch86.state
Epoch 87/100
 - 318s - loss: 0.2486 - val_loss: 0.2310

==>predicting on train



confusion matrix:
[[2133   22]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11386100202798843
difference in average predicted and observed risk = 0.008052002027988434
number samples = 2410
accuracy = 0.906224
precision class 0 = 0.912709
precision class 1 = 0.69863
recall class 0 = 0.989791
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.010209
positive prediction rate = 0.03029
AUC of ROC = 0.857768
AUC of PRC = 0.497287
min(+P, Se) = 0.465116

-------------------------------

confusion matrix:
[[1167   12]
 [  92   26]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09905499964952469
difference in average predicted and observed risk = 0.008075999649524684
number samples = 1297
accuracy = 0.919815
precision class 0 = 0.926926
precision class 1 = 0.684211
recall class 0 = 0.989822
recall class 1 = 0.220339
false negative rate = 0.779661
false positive rate = 0.010178
positive prediction rate = 0.029298
AUC of ROC = 0.877007
AUC of PRC = 0.493364
min(+P, Se) = 0.483051

-------------------------------

confusion matrix:
[[651   5]
 [ 55  19]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10417100042104721
difference in average predicted and observed risk = 0.002801000421047209
number samples = 730
accuracy = 0.917808
precision class 0 = 0.922096
precision class 1 = 0.791667
recall class 0 = 0.992378
recall class 1 = 0.256757
false negative rate = 0.743243
false positive rate = 0.007622
positive prediction rate = 0.032877
AUC of ROC = 0.871395
AUC of PRC = 0.559676
min(+P, Se) = 0.527027

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.13019900023937225
difference in average predicted and observed risk = 0.0045450002393722655
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.953842
AUC of PRC = 0.811933
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2446   28]
 [ 199   56]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10076600313186646
difference in average predicted and observed risk = 0.007325003131866459
number samples = 2729
accuracy = 0.916819
precision class 0 = 0.924764
precision class 1 = 0.666667
recall class 0 = 0.988682
recall class 1 = 0.219608
false negative rate = 0.780392
false positive rate = 0.011318
positive prediction rate = 0.030781
AUC of ROC = 0.862371
AUC of PRC = 0.474786
min(+P, Se) = 0.465385

-------------------------------

confusion matrix:
[[1670   13]
 [ 165   51]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.12048599869012833
difference in average predicted and observed risk = 0.0067419986901283285
number samples = 1899
accuracy = 0.906266
precision class 0 = 0.910082
precision class 1 = 0.796875
recall class 0 = 0.992276
recall class 1 = 0.236111
false negative rate = 0.763889
false positive rate = 0.007724
positive prediction rate = 0.033702
AUC of ROC = 0.880851
AUC of PRC = 0.580118
min(+P, Se) = 0.532407

-------------------------------

confusion matrix:
[[544   5]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1217230036854744
difference in average predicted and observed risk = -0.0012799963145256055
number samples = 626
accuracy = 0.888179
precision class 0 = 0.893268
precision class 1 = 0.705882
recall class 0 = 0.990893
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.009107
positive prediction rate = 0.027157
AUC of ROC = 0.866227
AUC of PRC = 0.520329
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[2235   14]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09361600130796432
difference in average predicted and observed risk = 0.00896000130796433
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.928542
precision class 1 = 0.72
recall class 0 = 0.993775
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.006225
positive prediction rate = 0.02035
AUC of ROC = 0.868386
AUC of PRC = 0.454597
min(+P, Se) = 0.430622

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10732000321149826
difference in average predicted and observed risk = 0.006514003211498254
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.78296
AUC of PRC = 0.276668
min(+P, Se) = 0.32

-------------------------------

confusion matrix:
[[465  16]
 [ 43  39]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.16315199434757233
difference in average predicted and observed risk = 0.017503994347572327
number samples = 563
accuracy = 0.895204
precision class 0 = 0.915354
precision class 1 = 0.709091
recall class 0 = 0.966736
recall class 1 = 0.47561
false negative rate = 0.52439
false positive rate = 0.033264
positive prediction rate = 0.097691
AUC of ROC = 0.901349
AUC of PRC = 0.707375
min(+P, Se) = 0.646341

-------------------------------

confusion matrix:
[[650   5]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10778100043535233
difference in average predicted and observed risk = 0.000152000435352323
number samples = 734
accuracy = 0.912807
precision class 0 = 0.916784
precision class 1 = 0.8
recall class 0 = 0.992366
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.007634
positive prediction rate = 0.03406
AUC of ROC = 0.865572
AUC of PRC = 0.57148
min(+P, Se) = 0.531646

-------------------------------

confusion matrix:
[[4116   41]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10885799676179886
difference in average predicted and observed risk = 0.007085996761798857
number samples = 4628
accuracy = 0.912489
precision class 0 = 0.91875
precision class 1 = 0.722973
recall class 0 = 0.990137
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.009863
positive prediction rate = 0.031979
AUC of ROC = 0.870836
AUC of PRC = 0.523806
min(+P, Se) = 0.492569

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09512300044298172
difference in average predicted and observed risk = 0.014954000442981716
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.903911
AUC of PRC = 0.453835
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10434199869632721
difference in average predicted and observed risk = -0.004454001303672794
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.8378
AUC of PRC = 0.485256
min(+P, Se) = 0.414286

-------------------------------

confusion matrix:
[[102   3]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1337449997663498
difference in average predicted and observed risk = 0.02357599976634979
number samples = 118
accuracy = 0.898305
precision class 0 = 0.918919
precision class 1 = 0.571429
recall class 0 = 0.971429
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.028571
positive prediction rate = 0.059322
AUC of ROC = 0.907692
AUC of PRC = 0.524591
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.14134399592876434
difference in average predicted and observed risk = 0.008010995928764336
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11890000104904175
difference in average predicted and observed risk = 0.0038560010490417546
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.858974
AUC of PRC = 0.437275
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[430   4]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09902799874544144
difference in average predicted and observed risk = 0.00697799874544143
number samples = 478
accuracy = 0.922594
precision class 0 = 0.928726
precision class 1 = 0.733333
recall class 0 = 0.990783
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.009217
positive prediction rate = 0.031381
AUC of ROC = 0.879661
AUC of PRC = 0.54657
min(+P, Se) = 0.478261

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08624900132417679
difference in average predicted and observed risk = -0.002952998675823215
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.883817
AUC of PRC = 0.532902
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[88  2]
 [ 7  5]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.14237099885940552
difference in average predicted and observed risk = 0.024723998859405516
number samples = 102
accuracy = 0.911765
precision class 0 = 0.926316
precision class 1 = 0.714286
recall class 0 = 0.977778
recall class 1 = 0.416667
false negative rate = 0.583333
false positive rate = 0.022222
positive prediction rate = 0.068627
AUC of ROC = 0.925926
AUC of PRC = 0.673069
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11653099954128265
difference in average predicted and observed risk = 0.027820999541282657
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.865648
AUC of PRC = 0.271957
min(+P, Se) = 0.388889

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12882000207901
difference in average predicted and observed risk = -0.02078599792098998
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.827485
AUC of PRC = 0.552001
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14653900265693665
difference in average predicted and observed risk = 0.06759200265693664
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.196032
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10727299749851227
difference in average predicted and observed risk = 0.005681997498512267
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.873609
AUC of PRC = 0.504881
min(+P, Se) = 0.454545

-------------------------------

Epoch 00087: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch87.state
Epoch 88/100
 - 310s - loss: 0.2506 - val_loss: 0.2370

==>predicting on train



confusion matrix:
[[2139   16]
 [ 205   50]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09070199728012085
difference in average predicted and observed risk = -0.01510700271987915
number samples = 2410
accuracy = 0.908299
precision class 0 = 0.912543
precision class 1 = 0.757576
recall class 0 = 0.992575
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.007425
positive prediction rate = 0.027386
AUC of ROC = 0.848011
AUC of PRC = 0.483432
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[1172    7]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08237399905920029
difference in average predicted and observed risk = -0.008605000940799717
number samples = 1297
accuracy = 0.920586
precision class 0 = 0.92429
precision class 1 = 0.758621
recall class 0 = 0.994063
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.005937
positive prediction rate = 0.022359
AUC of ROC = 0.868669
AUC of PRC = 0.487169
min(+P, Se) = 0.470588

-------------------------------

confusion matrix:
[[655   1]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08847100287675858
difference in average predicted and observed risk = -0.012898997123241426
number samples = 730
accuracy = 0.917808
precision class 0 = 0.917367
precision class 1 = 0.9375
recall class 0 = 0.998476
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.001524
positive prediction rate = 0.021918
AUC of ROC = 0.876875
AUC of PRC = 0.567151
min(+P, Se) = 0.513514

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10733900219202042
difference in average predicted and observed risk = -0.01831499780797957
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.962076
AUC of PRC = 0.818063
min(+P, Se) = 0.72

-------------------------------

confusion matrix:
[[2456   18]
 [ 205   50]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08273900300264359
difference in average predicted and observed risk = -0.010701996997356411
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.922961
precision class 1 = 0.735294
recall class 0 = 0.992724
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.007276
positive prediction rate = 0.024918
AUC of ROC = 0.857606
AUC of PRC = 0.474188
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1675    8]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09727299958467484
difference in average predicted and observed risk = -0.016471000415325163
number samples = 1899
accuracy = 0.90732
precision class 0 = 0.908844
precision class 1 = 0.857143
recall class 0 = 0.995247
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.004753
positive prediction rate = 0.029489
AUC of ROC = 0.871077
AUC of PRC = 0.559254
min(+P, Se) = 0.513889

-------------------------------

confusion matrix:
[[544   5]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10456299781799316
difference in average predicted and observed risk = -0.018440002182006837
number samples = 626
accuracy = 0.888179
precision class 0 = 0.893268
precision class 1 = 0.705882
recall class 0 = 0.990893
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.009107
positive prediction rate = 0.027157
AUC of ROC = 0.862655
AUC of PRC = 0.500541
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2241    8]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07401199638843536
difference in average predicted and observed risk = -0.010644003611564631
number samples = 2457
accuracy = 0.926333
precision class 0 = 0.928335
precision class 1 = 0.813953
recall class 0 = 0.996443
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.003557
positive prediction rate = 0.017501
AUC of ROC = 0.860885
AUC of PRC = 0.444025
min(+P, Se) = 0.418269

-------------------------------

confusion matrix:
[[222   1]
 [ 25   0]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08738599717617035
difference in average predicted and observed risk = -0.013420002823829658
number samples = 248
accuracy = 0.895161
precision class 0 = 0.898785
precision class 1 = 0.0
recall class 0 = 0.995516
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.004484
positive prediction rate = 0.004032
AUC of ROC = 0.761794
AUC of PRC = 0.280915
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[473   8]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13087600469589233
difference in average predicted and observed risk = -0.014771995304107666
number samples = 563
accuracy = 0.902309
precision class 0 = 0.909615
precision class 1 = 0.813953
recall class 0 = 0.983368
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.016632
positive prediction rate = 0.076377
AUC of ROC = 0.900208
AUC of PRC = 0.701718
min(+P, Se) = 0.607143

-------------------------------

confusion matrix:
[[651   4]
 [ 63  16]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09245000034570694
difference in average predicted and observed risk = -0.015178999654293063
number samples = 734
accuracy = 0.908719
precision class 0 = 0.911765
precision class 1 = 0.8
recall class 0 = 0.993893
recall class 1 = 0.202532
false negative rate = 0.797468
false positive rate = 0.006107
positive prediction rate = 0.027248
AUC of ROC = 0.85701
AUC of PRC = 0.553994
min(+P, Se) = 0.531646

-------------------------------

confusion matrix:
[[4131   26]
 [ 373   98]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08870299905538559
difference in average predicted and observed risk = -0.013069000944614412
number samples = 4628
accuracy = 0.913786
precision class 0 = 0.917185
precision class 1 = 0.790323
recall class 0 = 0.993746
recall class 1 = 0.208068
false negative rate = 0.791932
false positive rate = 0.006255
positive prediction rate = 0.026793
AUC of ROC = 0.864346
AUC of PRC = 0.515815
min(+P, Se) = 0.4862

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07904499769210815
difference in average predicted and observed risk = -0.0011240023078918499
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.910913
AUC of PRC = 0.455984
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08068899810314178
difference in average predicted and observed risk = -0.02810700189685822
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.831611
AUC of PRC = 0.455038
min(+P, Se) = 0.468085

-------------------------------

confusion matrix:
[[102   3]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11459100246429443
difference in average predicted and observed risk = 0.0044220024642944306
number samples = 118
accuracy = 0.889831
precision class 0 = 0.910714
precision class 1 = 0.5
recall class 0 = 0.971429
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.028571
positive prediction rate = 0.050847
AUC of ROC = 0.887912
AUC of PRC = 0.464153
min(+P, Se) = 0.529412

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11860600113868713
difference in average predicted and observed risk = -0.014726998861312873
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09410899877548218
difference in average predicted and observed risk = -0.020935001224517816
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.841197
AUC of PRC = 0.404581
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[431   3]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08110500127077103
difference in average predicted and observed risk = -0.01094499872922898
number samples = 478
accuracy = 0.920502
precision class 0 = 0.924893
precision class 1 = 0.75
recall class 0 = 0.993088
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.006912
positive prediction rate = 0.025105
AUC of ROC = 0.880446
AUC of PRC = 0.528381
min(+P, Se) = 0.577778

-------------------------------

confusion matrix:
[[388   0]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.068122997879982
difference in average predicted and observed risk = -0.02107900212001801
number samples = 426
accuracy = 0.922535
precision class 0 = 0.921615
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.0
positive prediction rate = 0.011737
AUC of ROC = 0.873915
AUC of PRC = 0.527925
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[87  3]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11030100286006927
difference in average predicted and observed risk = -0.007345997139930727
number samples = 102
accuracy = 0.892157
precision class 0 = 0.915789
precision class 1 = 0.571429
recall class 0 = 0.966667
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.033333
positive prediction rate = 0.068627
AUC of ROC = 0.921296
AUC of PRC = 0.636494
min(+P, Se) = 0.666667

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09714899957180023
difference in average predicted and observed risk = 0.008438999571800235
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.852776
AUC of PRC = 0.283028
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1071380004286766
difference in average predicted and observed risk = -0.042467999571323384
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.837232
AUC of PRC = 0.540466
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12492900341749191
difference in average predicted and observed risk = 0.04598200341749191
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.19418
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[728   6]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08650100231170654
difference in average predicted and observed risk = -0.015089997688293458
number samples = 817
accuracy = 0.906977
precision class 0 = 0.912281
precision class 1 = 0.684211
recall class 0 = 0.991826
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.008174
positive prediction rate = 0.023256
AUC of ROC = 0.866501
AUC of PRC = 0.475046
min(+P, Se) = 0.53012

-------------------------------

Epoch 00088: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch88.state
Epoch 89/100
 - 310s - loss: 0.2512 - val_loss: 0.2351

==>predicting on train



confusion matrix:
[[2138   17]
 [ 203   52]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11356399953365326
difference in average predicted and observed risk = 0.007754999533653259
number samples = 2410
accuracy = 0.908714
precision class 0 = 0.913285
precision class 1 = 0.753623
recall class 0 = 0.992111
recall class 1 = 0.203922
false negative rate = 0.796078
false positive rate = 0.007889
positive prediction rate = 0.028631
AUC of ROC = 0.855262
AUC of PRC = 0.498009
min(+P, Se) = 0.471264

-------------------------------

confusion matrix:
[[1169   10]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.10268399864435196
difference in average predicted and observed risk = 0.011704998644351955
number samples = 1297
accuracy = 0.919815
precision class 0 = 0.925574
precision class 1 = 0.705882
recall class 0 = 0.991518
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.008482
positive prediction rate = 0.026214
AUC of ROC = 0.87889
AUC of PRC = 0.501909
min(+P, Se) = 0.487603

-------------------------------

confusion matrix:
[[653   3]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10972999781370163
difference in average predicted and observed risk = 0.008359997813701628
number samples = 730
accuracy = 0.919178
precision class 0 = 0.921016
precision class 1 = 0.857143
recall class 0 = 0.995427
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.004573
positive prediction rate = 0.028767
AUC of ROC = 0.88359
AUC of PRC = 0.565989
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12801200151443481
difference in average predicted and observed risk = 0.0023580015144348265
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.96507
AUC of PRC = 0.837927
min(+P, Se) = 0.76

-------------------------------

confusion matrix:
[[2455   19]
 [ 202   53]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.10168799757957458
difference in average predicted and observed risk = 0.008246997579574589
number samples = 2729
accuracy = 0.919018
precision class 0 = 0.923974
precision class 1 = 0.736111
recall class 0 = 0.99232
recall class 1 = 0.207843
false negative rate = 0.792157
false positive rate = 0.00768
positive prediction rate = 0.026383
AUC of ROC = 0.865177
AUC of PRC = 0.486365
min(+P, Se) = 0.47451

-------------------------------

confusion matrix:
[[1670   13]
 [ 164   52]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.12317900359630585
difference in average predicted and observed risk = 0.00943500359630585
number samples = 1899
accuracy = 0.906793
precision class 0 = 0.910578
precision class 1 = 0.8
recall class 0 = 0.992276
recall class 1 = 0.240741
false negative rate = 0.759259
false positive rate = 0.007724
positive prediction rate = 0.034229
AUC of ROC = 0.880141
AUC of PRC = 0.577166
min(+P, Se) = 0.527778

-------------------------------

confusion matrix:
[[545   4]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12422099709510803
difference in average predicted and observed risk = 0.001217997095108031
number samples = 626
accuracy = 0.888179
precision class 0 = 0.89198
precision class 1 = 0.733333
recall class 0 = 0.992714
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.007286
positive prediction rate = 0.023962
AUC of ROC = 0.865257
AUC of PRC = 0.512519
min(+P, Se) = 0.531646

-------------------------------

confusion matrix:
[[2238   11]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09654399752616882
difference in average predicted and observed risk = 0.011887997526168828
number samples = 2457
accuracy = 0.925519
precision class 0 = 0.928631
precision class 1 = 0.765957
recall class 0 = 0.995109
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.004891
positive prediction rate = 0.019129
AUC of ROC = 0.869622
AUC of PRC = 0.459255
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[219   4]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.11562799662351608
difference in average predicted and observed risk = 0.014821996623516076
number samples = 248
accuracy = 0.891129
precision class 0 = 0.904959
precision class 1 = 0.333333
recall class 0 = 0.982063
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.017937
positive prediction rate = 0.024194
AUC of ROC = 0.77704
AUC of PRC = 0.26962
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[473   8]
 [ 46  36]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1485300064086914
difference in average predicted and observed risk = 0.0028820064086914066
number samples = 563
accuracy = 0.904085
precision class 0 = 0.911368
precision class 1 = 0.818182
recall class 0 = 0.983368
recall class 1 = 0.439024
false negative rate = 0.560976
false positive rate = 0.016632
positive prediction rate = 0.078153
AUC of ROC = 0.90647
AUC of PRC = 0.715413
min(+P, Se) = 0.634146

-------------------------------

confusion matrix:
[[650   5]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11465100198984146
difference in average predicted and observed risk = 0.007022001989841459
number samples = 734
accuracy = 0.912807
precision class 0 = 0.916784
precision class 1 = 0.8
recall class 0 = 0.992366
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.007634
positive prediction rate = 0.03406
AUC of ROC = 0.86563
AUC of PRC = 0.557272
min(+P, Se) = 0.5375

-------------------------------

confusion matrix:
[[4125   32]
 [ 366  105]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.11050599813461304
difference in average predicted and observed risk = 0.008733998134613036
number samples = 4628
accuracy = 0.914002
precision class 0 = 0.918504
precision class 1 = 0.766423
recall class 0 = 0.992302
recall class 1 = 0.22293
false negative rate = 0.77707
false positive rate = 0.007698
positive prediction rate = 0.029602
AUC of ROC = 0.87216
AUC of PRC = 0.529842
min(+P, Se) = 0.492569

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09896799921989441
difference in average predicted and observed risk = 0.018798999219894405
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.908981
AUC of PRC = 0.469217
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10383500158786774
difference in average predicted and observed risk = -0.004960998412132267
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.836916
AUC of PRC = 0.46976
min(+P, Se) = 0.464286

-------------------------------

confusion matrix:
[[102   3]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1351819932460785
difference in average predicted and observed risk = 0.025012993246078488
number samples = 118
accuracy = 0.889831
precision class 0 = 0.910714
precision class 1 = 0.5
recall class 0 = 0.971429
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.028571
positive prediction rate = 0.050847
AUC of ROC = 0.898168
AUC of PRC = 0.442871
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13959400355815887
difference in average predicted and observed risk = 0.0062610035581588674
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1212259978055954
difference in average predicted and observed risk = 0.0061819978055954045
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.852735
AUC of PRC = 0.403093
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[430   4]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0990699976682663
difference in average predicted and observed risk = 0.00701999766826629
number samples = 478
accuracy = 0.91841
precision class 0 = 0.924731
precision class 1 = 0.692308
recall class 0 = 0.990783
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.009217
positive prediction rate = 0.027197
AUC of ROC = 0.882436
AUC of PRC = 0.541554
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08886999636888504
difference in average predicted and observed risk = -0.0003320036311149632
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.874593
AUC of PRC = 0.515016
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[88  2]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12916299700737
difference in average predicted and observed risk = 0.011515997007369994
number samples = 102
accuracy = 0.892157
precision class 0 = 0.907216
precision class 1 = 0.6
recall class 0 = 0.977778
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.022222
positive prediction rate = 0.04902
AUC of ROC = 0.926852
AUC of PRC = 0.640611
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.1191129982471466
difference in average predicted and observed risk = 0.03040299824714661
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.872084
AUC of PRC = 0.294569
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1326960027217865
difference in average predicted and observed risk = -0.01690999727821349
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.844542
AUC of PRC = 0.568056
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1525149941444397
difference in average predicted and observed risk = 0.0735679941444397
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.19982
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[728   6]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1082639992237091
difference in average predicted and observed risk = 0.006672999223709106
number samples = 817
accuracy = 0.906977
precision class 0 = 0.912281
precision class 1 = 0.684211
recall class 0 = 0.991826
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.008174
positive prediction rate = 0.023256
AUC of ROC = 0.872378
AUC of PRC = 0.48657
min(+P, Se) = 0.484211

-------------------------------

Epoch 00089: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch89.state
Epoch 90/100
 - 315s - loss: 0.2528 - val_loss: 0.2353

==>predicting on train



confusion matrix:
[[2137   18]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10177700221538544
difference in average predicted and observed risk = -0.004031997784614563
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.912858
precision class 1 = 0.73913
recall class 0 = 0.991647
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.008353
positive prediction rate = 0.028631
AUC of ROC = 0.854059
AUC of PRC = 0.490953
min(+P, Se) = 0.462745

-------------------------------

confusion matrix:
[[1169   10]
 [  96   22]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08979900181293488
difference in average predicted and observed risk = -0.0011799981870651288
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.924111
precision class 1 = 0.6875
recall class 0 = 0.991518
recall class 1 = 0.186441
false negative rate = 0.813559
false positive rate = 0.008482
positive prediction rate = 0.024672
AUC of ROC = 0.87107
AUC of PRC = 0.491518
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[651   5]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09821899980306625
difference in average predicted and observed risk = -0.003151000196933748
number samples = 730
accuracy = 0.915069
precision class 0 = 0.919492
precision class 1 = 0.772727
recall class 0 = 0.992378
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.007622
positive prediction rate = 0.030137
AUC of ROC = 0.87465
AUC of PRC = 0.559376
min(+P, Se) = 0.513514

-------------------------------

confusion matrix:
[[164   3]
 [ 10  14]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11756999790668488
difference in average predicted and observed risk = -0.008084002093315112
number samples = 191
accuracy = 0.931937
precision class 0 = 0.942529
precision class 1 = 0.823529
recall class 0 = 0.982036
recall class 1 = 0.583333
false negative rate = 0.416667
false positive rate = 0.017964
positive prediction rate = 0.089005
AUC of ROC = 0.957335
AUC of PRC = 0.824944
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2456   18]
 [ 205   50]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08976799994707108
difference in average predicted and observed risk = -0.003673000052928921
number samples = 2729
accuracy = 0.918285
precision class 0 = 0.922961
precision class 1 = 0.735294
recall class 0 = 0.992724
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.007276
positive prediction rate = 0.024918
AUC of ROC = 0.858928
AUC of PRC = 0.476171
min(+P, Se) = 0.458824

-------------------------------

confusion matrix:
[[1665   18]
 [ 162   54]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11107499897480011
difference in average predicted and observed risk = -0.002669001025199888
number samples = 1899
accuracy = 0.905213
precision class 0 = 0.91133
precision class 1 = 0.75
recall class 0 = 0.989305
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.010695
positive prediction rate = 0.037915
AUC of ROC = 0.877789
AUC of PRC = 0.570602
min(+P, Se) = 0.509259

-------------------------------

confusion matrix:
[[545   4]
 [ 68   9]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11279600113630295
difference in average predicted and observed risk = -0.010206998863697053
number samples = 626
accuracy = 0.884984
precision class 0 = 0.88907
precision class 1 = 0.692308
recall class 0 = 0.992714
recall class 1 = 0.116883
false negative rate = 0.883117
false positive rate = 0.007286
positive prediction rate = 0.020767
AUC of ROC = 0.860951
AUC of PRC = 0.51311
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2236   13]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08354099839925766
difference in average predicted and observed risk = -0.0011150016007423352
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.928571
precision class 1 = 0.734694
recall class 0 = 0.99422
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.00578
positive prediction rate = 0.019943
AUC of ROC = 0.867007
AUC of PRC = 0.454458
min(+P, Se) = 0.427907

-------------------------------

confusion matrix:
[[219   4]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10218700021505356
difference in average predicted and observed risk = 0.0013810002150535516
number samples = 248
accuracy = 0.891129
precision class 0 = 0.904959
precision class 1 = 0.333333
recall class 0 = 0.982063
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.017937
positive prediction rate = 0.024194
AUC of ROC = 0.786188
AUC of PRC = 0.273032
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[473   8]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13856300711631775
difference in average predicted and observed risk = -0.007084992883682251
number samples = 563
accuracy = 0.907638
precision class 0 = 0.914894
precision class 1 = 0.826087
recall class 0 = 0.983368
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.016632
positive prediction rate = 0.081705
AUC of ROC = 0.896912
AUC of PRC = 0.70297
min(+P, Se) = 0.606742

-------------------------------

confusion matrix:
[[648   7]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10447300225496292
difference in average predicted and observed risk = -0.0031559977450370813
number samples = 734
accuracy = 0.908719
precision class 0 = 0.915254
precision class 1 = 0.730769
recall class 0 = 0.989313
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.010687
positive prediction rate = 0.035422
AUC of ROC = 0.860102
AUC of PRC = 0.547109
min(+P, Se) = 0.506329

-------------------------------

confusion matrix:
[[4121   36]
 [ 367  104]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09851100295782089
difference in average predicted and observed risk = -0.003260997042179109
number samples = 4628
accuracy = 0.912921
precision class 0 = 0.918226
precision class 1 = 0.742857
recall class 0 = 0.99134
recall class 1 = 0.220807
false negative rate = 0.779193
false positive rate = 0.00866
positive prediction rate = 0.030251
AUC of ROC = 0.868084
AUC of PRC = 0.522219
min(+P, Se) = 0.488323

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08458399772644043
difference in average predicted and observed risk = 0.0044149977264404255
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.894254
AUC of PRC = 0.454992
min(+P, Se) = 0.47619

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0941149964928627
difference in average predicted and observed risk = -0.014681003507137302
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.832937
AUC of PRC = 0.442227
min(+P, Se) = 0.446809

-------------------------------

confusion matrix:
[[103   2]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12155800312757492
difference in average predicted and observed risk = 0.011389003127574918
number samples = 118
accuracy = 0.898305
precision class 0 = 0.911504
precision class 1 = 0.6
recall class 0 = 0.980952
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.019048
positive prediction rate = 0.042373
AUC of ROC = 0.912821
AUC of PRC = 0.469389
min(+P, Se) = 0.555556

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12890399992465973
difference in average predicted and observed risk = -0.004429000075340278
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10889899730682373
difference in average predicted and observed risk = -0.006145002693176263
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.849402
AUC of PRC = 0.392766
min(+P, Se) = 0.444444

-------------------------------

confusion matrix:
[[431   3]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0878629982471466
difference in average predicted and observed risk = -0.0041870017528534
number samples = 478
accuracy = 0.91841
precision class 0 = 0.922912
precision class 1 = 0.727273
recall class 0 = 0.993088
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.006912
positive prediction rate = 0.023013
AUC of ROC = 0.876833
AUC of PRC = 0.529257
min(+P, Se) = 0.511111

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07674600183963776
difference in average predicted and observed risk = -0.012455998160362247
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.869845
AUC of PRC = 0.504541
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11507300287485123
difference in average predicted and observed risk = -0.0025739971251487748
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.927778
AUC of PRC = 0.630723
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11093399673700333
difference in average predicted and observed risk = 0.02222399673700333
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.852776
AUC of PRC = 0.249785
min(+P, Se) = 0.357143

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1200060024857521
difference in average predicted and observed risk = -0.029599997514247883
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.846979
AUC of PRC = 0.586102
min(+P, Se) = 0.631579

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1443990021944046
difference in average predicted and observed risk = 0.0654520021944046
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.195851
min(+P, Se) = 0.285714

-------------------------------

confusion matrix:
[[729   5]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09659100323915482
difference in average predicted and observed risk = -0.004999996760845185
number samples = 817
accuracy = 0.906977
precision class 0 = 0.91125
precision class 1 = 0.705882
recall class 0 = 0.993188
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.006812
positive prediction rate = 0.020808
AUC of ROC = 0.86788
AUC of PRC = 0.473722
min(+P, Se) = 0.482759

-------------------------------

Epoch 00090: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch90.state
Epoch 91/100
 - 312s - loss: 0.2511 - val_loss: 0.2380

==>predicting on train



confusion matrix:
[[2138   17]
 [ 205   50]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09057699888944626
difference in average predicted and observed risk = -0.015232001110553742
number samples = 2410
accuracy = 0.907884
precision class 0 = 0.912505
precision class 1 = 0.746269
recall class 0 = 0.992111
recall class 1 = 0.196078
false negative rate = 0.803922
false positive rate = 0.007889
positive prediction rate = 0.027801
AUC of ROC = 0.856121
AUC of PRC = 0.488995
min(+P, Se) = 0.46875

-------------------------------

confusion matrix:
[[1169   10]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08193600177764893
difference in average predicted and observed risk = -0.009042998222351079
number samples = 1297
accuracy = 0.917502
precision class 0 = 0.923381
precision class 1 = 0.677419
recall class 0 = 0.991518
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.008482
positive prediction rate = 0.023901
AUC of ROC = 0.864651
AUC of PRC = 0.473191
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[655   1]
 [ 60  14]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.08966399729251862
difference in average predicted and observed risk = -0.011706002707481386
number samples = 730
accuracy = 0.916438
precision class 0 = 0.916084
precision class 1 = 0.933333
recall class 0 = 0.998476
recall class 1 = 0.189189
false negative rate = 0.810811
false positive rate = 0.001524
positive prediction rate = 0.020548
AUC of ROC = 0.872919
AUC of PRC = 0.557622
min(+P, Se) = 0.527027

-------------------------------

confusion matrix:
[[165   2]
 [ 13  11]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10894399881362915
difference in average predicted and observed risk = -0.016710001186370838
number samples = 191
accuracy = 0.921466
precision class 0 = 0.926966
precision class 1 = 0.846154
recall class 0 = 0.988024
recall class 1 = 0.458333
false negative rate = 0.541667
false positive rate = 0.011976
positive prediction rate = 0.068063
AUC of ROC = 0.958583
AUC of PRC = 0.830376
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2457   17]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08306100219488144
difference in average predicted and observed risk = -0.010379997805118557
number samples = 2729
accuracy = 0.917186
precision class 0 = 0.921605
precision class 1 = 0.730159
recall class 0 = 0.993129
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.006871
positive prediction rate = 0.023085
AUC of ROC = 0.86009
AUC of PRC = 0.473224
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1670   13]
 [ 166   50]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.0969730019569397
difference in average predicted and observed risk = -0.0167709980430603
number samples = 1899
accuracy = 0.90574
precision class 0 = 0.909586
precision class 1 = 0.793651
recall class 0 = 0.992276
recall class 1 = 0.231481
false negative rate = 0.768519
false positive rate = 0.007724
positive prediction rate = 0.033175
AUC of ROC = 0.87486
AUC of PRC = 0.561561
min(+P, Se) = 0.513889

-------------------------------

confusion matrix:
[[545   4]
 [ 69   8]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1003739982843399
difference in average predicted and observed risk = -0.022629001715660096
number samples = 626
accuracy = 0.883387
precision class 0 = 0.887622
precision class 1 = 0.666667
recall class 0 = 0.992714
recall class 1 = 0.103896
false negative rate = 0.896104
false positive rate = 0.007286
positive prediction rate = 0.019169
AUC of ROC = 0.86204
AUC of PRC = 0.501668
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2237   12]
 [ 174   34]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07487999647855759
difference in average predicted and observed risk = -0.009776003521442408
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.927831
precision class 1 = 0.73913
recall class 0 = 0.994664
recall class 1 = 0.163462
false negative rate = 0.836538
false positive rate = 0.005336
positive prediction rate = 0.018722
AUC of ROC = 0.864833
AUC of PRC = 0.447639
min(+P, Se) = 0.427885

-------------------------------

confusion matrix:
[[220   3]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09265200048685074
difference in average predicted and observed risk = -0.008153999513149268
number samples = 248
accuracy = 0.891129
precision class 0 = 0.901639
precision class 1 = 0.25
recall class 0 = 0.986547
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.013453
positive prediction rate = 0.016129
AUC of ROC = 0.787623
AUC of PRC = 0.282557
min(+P, Se) = 0.344828

-------------------------------

confusion matrix:
[[475   6]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1275160014629364
difference in average predicted and observed risk = -0.0181319985370636
number samples = 563
accuracy = 0.905861
precision class 0 = 0.909962
precision class 1 = 0.853659
recall class 0 = 0.987526
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.012474
positive prediction rate = 0.072824
AUC of ROC = 0.89463
AUC of PRC = 0.697747
min(+P, Se) = 0.597561

-------------------------------

confusion matrix:
[[650   5]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09433399885892868
difference in average predicted and observed risk = -0.013295001141071322
number samples = 734
accuracy = 0.910082
precision class 0 = 0.914205
precision class 1 = 0.782609
recall class 0 = 0.992366
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.007634
positive prediction rate = 0.031335
AUC of ROC = 0.861822
AUC of PRC = 0.542332
min(+P, Se) = 0.506329

-------------------------------

confusion matrix:
[[4127   30]
 [ 375   96]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08876899629831314
difference in average predicted and observed risk = -0.01300300370168686
number samples = 4628
accuracy = 0.912489
precision class 0 = 0.916704
precision class 1 = 0.761905
recall class 0 = 0.992783
recall class 1 = 0.203822
false negative rate = 0.796178
false positive rate = 0.007217
positive prediction rate = 0.027226
AUC of ROC = 0.866917
AUC of PRC = 0.51527
min(+P, Se) = 0.485294

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07714799791574478
difference in average predicted and observed risk = -0.0030210020842552227
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.889425
AUC of PRC = 0.449906
min(+P, Se) = 0.47619

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.0821399986743927
difference in average predicted and observed risk = -0.026656001325607304
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.830616
AUC of PRC = 0.442078
min(+P, Se) = 0.431034

-------------------------------

confusion matrix:
[[104   1]
 [ 11   2]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11114399880170822
difference in average predicted and observed risk = 0.0009749988017082184
number samples = 118
accuracy = 0.898305
precision class 0 = 0.904348
precision class 1 = 0.666667
recall class 0 = 0.990476
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.009524
positive prediction rate = 0.025424
AUC of ROC = 0.906227
AUC of PRC = 0.530935
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11507800221443176
difference in average predicted and observed risk = -0.018254997785568244
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09396299719810486
difference in average predicted and observed risk = -0.021081002801895135
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.840769
AUC of PRC = 0.409694
min(+P, Se) = 0.439024

-------------------------------

confusion matrix:
[[432   2]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08050700277090073
difference in average predicted and observed risk = -0.01154299722909928
number samples = 478
accuracy = 0.920502
precision class 0 = 0.923077
precision class 1 = 0.8
recall class 0 = 0.995392
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.004608
positive prediction rate = 0.020921
AUC of ROC = 0.880499
AUC of PRC = 0.547406
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.06861799955368042
difference in average predicted and observed risk = -0.020584000446319584
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.868489
AUC of PRC = 0.498539
min(+P, Se) = 0.45

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10347899794578552
difference in average predicted and observed risk = -0.014168002054214479
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.932407
AUC of PRC = 0.640683
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09664099663496017
difference in average predicted and observed risk = 0.007930996634960177
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.829445
AUC of PRC = 0.225172
min(+P, Se) = 0.307692

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.10722000151872635
difference in average predicted and observed risk = -0.04238599848127364
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.845029
AUC of PRC = 0.597569
min(+P, Se) = 0.631579

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13023599982261658
difference in average predicted and observed risk = 0.051288999822616574
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.195767
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[730   4]
 [ 71  12]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08608999848365784
difference in average predicted and observed risk = -0.015501001516342164
number samples = 817
accuracy = 0.908201
precision class 0 = 0.911361
precision class 1 = 0.75
recall class 0 = 0.99455
recall class 1 = 0.144578
false negative rate = 0.855422
false positive rate = 0.00545
positive prediction rate = 0.019584
AUC of ROC = 0.865894
AUC of PRC = 0.482611
min(+P, Se) = 0.482353

-------------------------------

Epoch 00091: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch91.state
Epoch 92/100
 - 311s - loss: 0.2497 - val_loss: 0.2329

==>predicting on train



confusion matrix:
[[2136   19]
 [ 200   55]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10151699930429459
difference in average predicted and observed risk = -0.004292000695705414
number samples = 2410
accuracy = 0.909129
precision class 0 = 0.914384
precision class 1 = 0.743243
recall class 0 = 0.991183
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.008817
positive prediction rate = 0.030705
AUC of ROC = 0.860208
AUC of PRC = 0.501379
min(+P, Se) = 0.472656

-------------------------------

confusion matrix:
[[1168   11]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08950400352478027
difference in average predicted and observed risk = -0.0014749964752197309
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.925515
precision class 1 = 0.685714
recall class 0 = 0.99067
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.00933
positive prediction rate = 0.026985
AUC of ROC = 0.876166
AUC of PRC = 0.491957
min(+P, Se) = 0.463415

-------------------------------

confusion matrix:
[[654   2]
 [ 59  15]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09968800097703934
difference in average predicted and observed risk = -0.0016819990229606646
number samples = 730
accuracy = 0.916438
precision class 0 = 0.917251
precision class 1 = 0.882353
recall class 0 = 0.996951
recall class 1 = 0.202703
false negative rate = 0.797297
false positive rate = 0.003049
positive prediction rate = 0.023288
AUC of ROC = 0.886948
AUC of PRC = 0.570817
min(+P, Se) = 0.527027

-------------------------------

confusion matrix:
[[165   2]
 [ 12  12]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.11990100145339966
difference in average predicted and observed risk = -0.00575299854660033
number samples = 191
accuracy = 0.926702
precision class 0 = 0.932203
precision class 1 = 0.857143
recall class 0 = 0.988024
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.011976
positive prediction rate = 0.073298
AUC of ROC = 0.96507
AUC of PRC = 0.835926
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2456   18]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.0917230024933815
difference in average predicted and observed risk = -0.001717997506618496
number samples = 2729
accuracy = 0.919751
precision class 0 = 0.924351
precision class 1 = 0.75
recall class 0 = 0.992724
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.007276
positive prediction rate = 0.026383
AUC of ROC = 0.866963
AUC of PRC = 0.483523
min(+P, Se) = 0.472868

-------------------------------

confusion matrix:
[[1667   16]
 [ 164   52]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10853300243616104
difference in average predicted and observed risk = -0.005210997563838957
number samples = 1899
accuracy = 0.905213
precision class 0 = 0.910431
precision class 1 = 0.764706
recall class 0 = 0.990493
recall class 1 = 0.240741
false negative rate = 0.759259
false positive rate = 0.009507
positive prediction rate = 0.035808
AUC of ROC = 0.883607
AUC of PRC = 0.576174
min(+P, Se) = 0.525346

-------------------------------

confusion matrix:
[[543   6]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11724799871444702
difference in average predicted and observed risk = -0.00575500128555298
number samples = 626
accuracy = 0.886581
precision class 0 = 0.893092
precision class 1 = 0.666667
recall class 0 = 0.989071
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.010929
positive prediction rate = 0.028754
AUC of ROC = 0.867788
AUC of PRC = 0.501046
min(+P, Se) = 0.506494

-------------------------------

confusion matrix:
[[2238   11]
 [ 171   37]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08219599723815918
difference in average predicted and observed risk = -0.0024600027618408155
number samples = 2457
accuracy = 0.925926
precision class 0 = 0.929016
precision class 1 = 0.770833
recall class 0 = 0.995109
recall class 1 = 0.177885
false negative rate = 0.822115
false positive rate = 0.004891
positive prediction rate = 0.019536
AUC of ROC = 0.873093
AUC of PRC = 0.460013
min(+P, Se) = 0.430556

-------------------------------

confusion matrix:
[[219   4]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10196000337600708
difference in average predicted and observed risk = 0.0011540033760070734
number samples = 248
accuracy = 0.895161
precision class 0 = 0.908714
precision class 1 = 0.428571
recall class 0 = 0.982063
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.017937
positive prediction rate = 0.028226
AUC of ROC = 0.779552
AUC of PRC = 0.274648
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[474   7]
 [ 46  36]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14303000271320343
difference in average predicted and observed risk = -0.0026179972867965695
number samples = 563
accuracy = 0.905861
precision class 0 = 0.911538
precision class 1 = 0.837209
recall class 0 = 0.985447
recall class 1 = 0.439024
false negative rate = 0.560976
false positive rate = 0.014553
positive prediction rate = 0.076377
AUC of ROC = 0.90931
AUC of PRC = 0.723462
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[649   6]
 [ 61  18]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10252299904823303
difference in average predicted and observed risk = -0.00510600095176697
number samples = 734
accuracy = 0.908719
precision class 0 = 0.914084
precision class 1 = 0.75
recall class 0 = 0.99084
recall class 1 = 0.227848
false negative rate = 0.772152
false positive rate = 0.00916
positive prediction rate = 0.032698
AUC of ROC = 0.870171
AUC of PRC = 0.54717
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4123   34]
 [ 365  106]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09862100332975388
difference in average predicted and observed risk = -0.0031509966702461256
number samples = 4628
accuracy = 0.913786
precision class 0 = 0.918672
precision class 1 = 0.757143
recall class 0 = 0.991821
recall class 1 = 0.225053
false negative rate = 0.774947
false positive rate = 0.008179
positive prediction rate = 0.030251
AUC of ROC = 0.874971
AUC of PRC = 0.52875
min(+P, Se) = 0.492632

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08456200361251831
difference in average predicted and observed risk = 0.004393003612518306
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.897634
AUC of PRC = 0.465539
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09203699976205826
difference in average predicted and observed risk = -0.016759000237941746
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.841393
AUC of PRC = 0.477942
min(+P, Se) = 0.489796

-------------------------------

confusion matrix:
[[103   2]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1225230023264885
difference in average predicted and observed risk = 0.012354002326488492
number samples = 118
accuracy = 0.898305
precision class 0 = 0.911504
precision class 1 = 0.6
recall class 0 = 0.980952
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.019048
positive prediction rate = 0.042373
AUC of ROC = 0.916484
AUC of PRC = 0.528824
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12773700058460236
difference in average predicted and observed risk = -0.005595999415397651
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10475300252437592
difference in average predicted and observed risk = -0.010290997475624078
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.850598
AUC of PRC = 0.420436
min(+P, Se) = 0.475

-------------------------------

confusion matrix:
[[431   3]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08907900005578995
difference in average predicted and observed risk = -0.0029709999442100593
number samples = 478
accuracy = 0.922594
precision class 0 = 0.926882
precision class 1 = 0.769231
recall class 0 = 0.993088
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.006912
positive prediction rate = 0.027197
AUC of ROC = 0.887097
AUC of PRC = 0.55408
min(+P, Se) = 0.553191

-------------------------------

confusion matrix:
[[387   1]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07657600194215775
difference in average predicted and observed risk = -0.012625998057842258
number samples = 426
accuracy = 0.922535
precision class 0 = 0.923628
precision class 1 = 0.857143
recall class 0 = 0.997423
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.002577
positive prediction rate = 0.016432
AUC of ROC = 0.87561
AUC of PRC = 0.522483
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11707600206136703
difference in average predicted and observed risk = -0.0005709979386329667
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.933333
AUC of PRC = 0.648787
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10881800204515457
difference in average predicted and observed risk = 0.020108002045154574
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.83749
AUC of PRC = 0.236
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11636999994516373
difference in average predicted and observed risk = -0.03323600005483626
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.860136
AUC of PRC = 0.602886
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13831399381160736
difference in average predicted and observed risk = 0.05936699381160736
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.857143
AUC of PRC = 0.20974
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[729   5]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.0955829992890358
difference in average predicted and observed risk = -0.006008000710964204
number samples = 817
accuracy = 0.909425
precision class 0 = 0.913534
precision class 1 = 0.736842
recall class 0 = 0.993188
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.006812
positive prediction rate = 0.023256
AUC of ROC = 0.874807
AUC of PRC = 0.498247
min(+P, Se) = 0.5

-------------------------------

Epoch 00092: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch92.state
Epoch 93/100
 - 309s - loss: 0.2475 - val_loss: 0.2345

==>predicting on train



confusion matrix:
[[2141   14]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.1029369980096817
difference in average predicted and observed risk = -0.0028720019903182986
number samples = 2410
accuracy = 0.909544
precision class 0 = 0.913006
precision class 1 = 0.784615
recall class 0 = 0.993503
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.006497
positive prediction rate = 0.026971
AUC of ROC = 0.863366
AUC of PRC = 0.510076
min(+P, Se) = 0.480469

-------------------------------

confusion matrix:
[[1172    7]
 [  98   20]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08839599788188934
difference in average predicted and observed risk = -0.002583002118110661
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.922835
precision class 1 = 0.740741
recall class 0 = 0.994063
recall class 1 = 0.169492
false negative rate = 0.830508
false positive rate = 0.005937
positive prediction rate = 0.020817
AUC of ROC = 0.88127
AUC of PRC = 0.507473
min(+P, Se) = 0.474576

-------------------------------

confusion matrix:
[[654   2]
 [ 61  13]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09308700263500214
difference in average predicted and observed risk = -0.008282997364997866
number samples = 730
accuracy = 0.913699
precision class 0 = 0.914685
precision class 1 = 0.866667
recall class 0 = 0.996951
recall class 1 = 0.175676
false negative rate = 0.824324
false positive rate = 0.003049
positive prediction rate = 0.020548
AUC of ROC = 0.892345
AUC of PRC = 0.584739
min(+P, Se) = 0.533333

-------------------------------

confusion matrix:
[[164   3]
 [ 11  13]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.115167997777462
difference in average predicted and observed risk = -0.010486002222537982
number samples = 191
accuracy = 0.926702
precision class 0 = 0.937143
precision class 1 = 0.8125
recall class 0 = 0.982036
recall class 1 = 0.541667
false negative rate = 0.458333
false positive rate = 0.017964
positive prediction rate = 0.08377
AUC of ROC = 0.963074
AUC of PRC = 0.824723
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2458   16]
 [ 206   49]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08919700235128403
difference in average predicted and observed risk = -0.004243997648715969
number samples = 2729
accuracy = 0.918652
precision class 0 = 0.922673
precision class 1 = 0.753846
recall class 0 = 0.993533
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.006467
positive prediction rate = 0.023818
AUC of ROC = 0.870339
AUC of PRC = 0.49342
min(+P, Se) = 0.470588

-------------------------------

confusion matrix:
[[1673   10]
 [ 168   48]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11019600182771683
difference in average predicted and observed risk = -0.0035479981722831705
number samples = 1899
accuracy = 0.906266
precision class 0 = 0.908745
precision class 1 = 0.827586
recall class 0 = 0.994058
recall class 1 = 0.222222
false negative rate = 0.777778
false positive rate = 0.005942
positive prediction rate = 0.030542
AUC of ROC = 0.887544
AUC of PRC = 0.587248
min(+P, Se) = 0.527778

-------------------------------

confusion matrix:
[[545   4]
 [ 67  10]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11438500136137009
difference in average predicted and observed risk = -0.008617998638629915
number samples = 626
accuracy = 0.886581
precision class 0 = 0.890523
precision class 1 = 0.714286
recall class 0 = 0.992714
recall class 1 = 0.12987
false negative rate = 0.87013
false positive rate = 0.007286
positive prediction rate = 0.022364
AUC of ROC = 0.872779
AUC of PRC = 0.52568
min(+P, Se) = 0.532468

-------------------------------

confusion matrix:
[[2241    8]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.08349700272083282
difference in average predicted and observed risk = -0.0011589972791671704
number samples = 2457
accuracy = 0.926333
precision class 0 = 0.928335
precision class 1 = 0.813953
recall class 0 = 0.996443
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.003557
positive prediction rate = 0.017501
AUC of ROC = 0.875449
AUC of PRC = 0.468706
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[219   4]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10075899958610535
difference in average predicted and observed risk = -4.700041389466003e-05
number samples = 248
accuracy = 0.891129
precision class 0 = 0.904959
precision class 1 = 0.333333
recall class 0 = 0.982063
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.017937
positive prediction rate = 0.024194
AUC of ROC = 0.782242
AUC of PRC = 0.272441
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[475   6]
 [ 47  35]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1358020007610321
difference in average predicted and observed risk = -0.009845999238967895
number samples = 563
accuracy = 0.905861
precision class 0 = 0.909962
precision class 1 = 0.853659
recall class 0 = 0.987526
recall class 1 = 0.426829
false negative rate = 0.573171
false positive rate = 0.012474
positive prediction rate = 0.072824
AUC of ROC = 0.909158
AUC of PRC = 0.723842
min(+P, Se) = 0.611765

-------------------------------

confusion matrix:
[[651   4]
 [ 64  15]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10146699845790863
difference in average predicted and observed risk = -0.006162001542091372
number samples = 734
accuracy = 0.907357
precision class 0 = 0.910489
precision class 1 = 0.789474
recall class 0 = 0.993893
recall class 1 = 0.189873
false negative rate = 0.810127
false positive rate = 0.006107
positive prediction rate = 0.025886
AUC of ROC = 0.879099
AUC of PRC = 0.571158
min(+P, Se) = 0.531646

-------------------------------

confusion matrix:
[[4131   26]
 [ 374   97]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09781300276517868
difference in average predicted and observed risk = -0.003958997234821321
number samples = 4628
accuracy = 0.91357
precision class 0 = 0.916981
precision class 1 = 0.788618
recall class 0 = 0.993746
recall class 1 = 0.205945
false negative rate = 0.794055
false positive rate = 0.006255
positive prediction rate = 0.026577
AUC of ROC = 0.878451
AUC of PRC = 0.538292
min(+P, Se) = 0.504237

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08445899933576584
difference in average predicted and observed risk = 0.0042899993357658345
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.893047
AUC of PRC = 0.460789
min(+P, Se) = 0.48

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09329299628734589
difference in average predicted and observed risk = -0.015503003712654118
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.841116
AUC of PRC = 0.487214
min(+P, Se) = 0.489362

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11517500132322311
difference in average predicted and observed risk = 0.005006001323223111
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.893773
AUC of PRC = 0.499563
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12293799966573715
difference in average predicted and observed risk = -0.010395000334262855
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1062059998512268
difference in average predicted and observed risk = -0.008838000148773187
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.851453
AUC of PRC = 0.439159
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[432   2]
 [ 35   9]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0870169997215271
difference in average predicted and observed risk = -0.005033000278472907
number samples = 478
accuracy = 0.922594
precision class 0 = 0.925054
precision class 1 = 0.818182
recall class 0 = 0.995392
recall class 1 = 0.204545
false negative rate = 0.795455
false positive rate = 0.004608
positive prediction rate = 0.023013
AUC of ROC = 0.878194
AUC of PRC = 0.541614
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[387   1]
 [ 33   5]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07723499834537506
difference in average predicted and observed risk = -0.011967001654624942
number samples = 426
accuracy = 0.920188
precision class 0 = 0.921429
precision class 1 = 0.833333
recall class 0 = 0.997423
recall class 1 = 0.131579
false negative rate = 0.868421
false positive rate = 0.002577
positive prediction rate = 0.014085
AUC of ROC = 0.869303
AUC of PRC = 0.510258
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11015599966049194
difference in average predicted and observed risk = -0.007491000339508058
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.933333
AUC of PRC = 0.693393
min(+P, Se) = 0.625

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10735499858856201
difference in average predicted and observed risk = 0.018644998588562015
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.852776
AUC of PRC = 0.244727
min(+P, Se) = 0.363636

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11896300315856934
difference in average predicted and observed risk = -0.030642996841430653
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.857212
AUC of PRC = 0.601593
min(+P, Se) = 0.631579

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13262499868869781
difference in average predicted and observed risk = 0.05367799868869781
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.819048
AUC of PRC = 0.172306
min(+P, Se) = 0.272727

-------------------------------

confusion matrix:
[[730   4]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09497900307178497
difference in average predicted and observed risk = -0.006611996928215028
number samples = 817
accuracy = 0.909425
precision class 0 = 0.9125
precision class 1 = 0.764706
recall class 0 = 0.99455
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.00545
positive prediction rate = 0.020808
AUC of ROC = 0.869801
AUC of PRC = 0.499162
min(+P, Se) = 0.493976

-------------------------------

Epoch 00093: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch93.state
Epoch 94/100
 - 308s - loss: 0.2497 - val_loss: 0.2336

==>predicting on train



confusion matrix:
[[2141   14]
 [ 204   51]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09665100276470184
difference in average predicted and observed risk = -0.009157997235298157
number samples = 2410
accuracy = 0.909544
precision class 0 = 0.913006
precision class 1 = 0.784615
recall class 0 = 0.993503
recall class 1 = 0.2
false negative rate = 0.8
false positive rate = 0.006497
positive prediction rate = 0.026971
AUC of ROC = 0.859542
AUC of PRC = 0.508127
min(+P, Se) = 0.481343

-------------------------------

confusion matrix:
[[1170    9]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08434800058603287
difference in average predicted and observed risk = -0.006630999413967137
number samples = 1297
accuracy = 0.918273
precision class 0 = 0.923441
precision class 1 = 0.7
recall class 0 = 0.992366
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.007634
positive prediction rate = 0.02313
AUC of ROC = 0.87337
AUC of PRC = 0.496344
min(+P, Se) = 0.47541

-------------------------------

confusion matrix:
[[653   3]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0907839983701706
difference in average predicted and observed risk = -0.010586001629829409
number samples = 730
accuracy = 0.916438
precision class 0 = 0.918425
precision class 1 = 0.842105
recall class 0 = 0.995427
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.004573
positive prediction rate = 0.026027
AUC of ROC = 0.885733
AUC of PRC = 0.57126
min(+P, Se) = 0.527027

-------------------------------

confusion matrix:
[[164   3]
 [ 12  12]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10983200371265411
difference in average predicted and observed risk = -0.015821996287345874
number samples = 191
accuracy = 0.921466
precision class 0 = 0.931818
precision class 1 = 0.8
recall class 0 = 0.982036
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.017964
positive prediction rate = 0.078534
AUC of ROC = 0.959331
AUC of PRC = 0.828225
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2456   18]
 [ 206   49]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08562900125980377
difference in average predicted and observed risk = -0.007811998740196224
number samples = 2729
accuracy = 0.917919
precision class 0 = 0.922615
precision class 1 = 0.731343
recall class 0 = 0.992724
recall class 1 = 0.192157
false negative rate = 0.807843
false positive rate = 0.007276
positive prediction rate = 0.024551
AUC of ROC = 0.864302
AUC of PRC = 0.484268
min(+P, Se) = 0.474708

-------------------------------

confusion matrix:
[[1672   11]
 [ 165   51]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10315900295972824
difference in average predicted and observed risk = -0.010584997040271757
number samples = 1899
accuracy = 0.90732
precision class 0 = 0.91018
precision class 1 = 0.822581
recall class 0 = 0.993464
recall class 1 = 0.236111
false negative rate = 0.763889
false positive rate = 0.006536
positive prediction rate = 0.032649
AUC of ROC = 0.88301
AUC of PRC = 0.58553
min(+P, Se) = 0.541667

-------------------------------

confusion matrix:
[[545   4]
 [ 67  10]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.10542000085115433
difference in average predicted and observed risk = -0.017582999148845674
number samples = 626
accuracy = 0.886581
precision class 0 = 0.890523
precision class 1 = 0.714286
recall class 0 = 0.992714
recall class 1 = 0.12987
false negative rate = 0.87013
false positive rate = 0.007286
positive prediction rate = 0.022364
AUC of ROC = 0.867575
AUC of PRC = 0.518469
min(+P, Se) = 0.525641

-------------------------------

confusion matrix:
[[2239   10]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.07868500053882599
difference in average predicted and observed risk = -0.005970999461174006
number samples = 2457
accuracy = 0.925926
precision class 0 = 0.92866
precision class 1 = 0.782609
recall class 0 = 0.995554
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.004446
positive prediction rate = 0.018722
AUC of ROC = 0.869662
AUC of PRC = 0.464668
min(+P, Se) = 0.442857

-------------------------------

confusion matrix:
[[219   4]
 [ 24   1]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.09466399997472763
difference in average predicted and observed risk = -0.006142000025272376
number samples = 248
accuracy = 0.887097
precision class 0 = 0.901235
precision class 1 = 0.2
recall class 0 = 0.982063
recall class 1 = 0.04
false negative rate = 0.96
false positive rate = 0.017937
positive prediction rate = 0.020161
AUC of ROC = 0.78278
AUC of PRC = 0.303811
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[475   6]
 [ 49  33]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13273000717163086
difference in average predicted and observed risk = -0.01291799282836914
number samples = 563
accuracy = 0.902309
precision class 0 = 0.906489
precision class 1 = 0.846154
recall class 0 = 0.987526
recall class 1 = 0.402439
false negative rate = 0.597561
false positive rate = 0.012474
positive prediction rate = 0.069272
AUC of ROC = 0.907256
AUC of PRC = 0.724151
min(+P, Se) = 0.609756

-------------------------------

confusion matrix:
[[650   5]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09816700220108032
difference in average predicted and observed risk = -0.00946199779891968
number samples = 734
accuracy = 0.912807
precision class 0 = 0.916784
precision class 1 = 0.8
recall class 0 = 0.992366
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.007634
positive prediction rate = 0.03406
AUC of ROC = 0.869263
AUC of PRC = 0.552668
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4128   29]
 [ 371  100]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09282200038433075
difference in average predicted and observed risk = -0.008949999615669252
number samples = 4628
accuracy = 0.91357
precision class 0 = 0.917537
precision class 1 = 0.775194
recall class 0 = 0.993024
recall class 1 = 0.212314
false negative rate = 0.787686
false positive rate = 0.006976
positive prediction rate = 0.027874
AUC of ROC = 0.87321
AUC of PRC = 0.533454
min(+P, Se) = 0.503185

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08212299644947052
difference in average predicted and observed risk = 0.001953996449470516
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.893047
AUC of PRC = 0.454681
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[385   0]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08583000302314758
difference in average predicted and observed risk = -0.02296599697685242
number samples = 432
accuracy = 0.900463
precision class 0 = 0.899533
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.0
positive prediction rate = 0.009259
AUC of ROC = 0.841393
AUC of PRC = 0.472111
min(+P, Se) = 0.428571

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1149590015411377
difference in average predicted and observed risk = 0.004790001541137692
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.911355
AUC of PRC = 0.506004
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 2  2]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12205000221729279
difference in average predicted and observed risk = -0.011282997782707221
number samples = 30
accuracy = 0.933333
precision class 0 = 0.928571
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.0
positive prediction rate = 0.066667
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.09961599856615067
difference in average predicted and observed risk = -0.015428001433849328
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.856154
AUC of PRC = 0.41084
min(+P, Se) = 0.431818

-------------------------------

confusion matrix:
[[432   2]
 [ 36   8]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08367999643087387
difference in average predicted and observed risk = -0.008370003569126136
number samples = 478
accuracy = 0.920502
precision class 0 = 0.923077
precision class 1 = 0.8
recall class 0 = 0.995392
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.004608
positive prediction rate = 0.020921
AUC of ROC = 0.877828
AUC of PRC = 0.541442
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[387   1]
 [ 34   4]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07192700356245041
difference in average predicted and observed risk = -0.017274996437549595
number samples = 426
accuracy = 0.91784
precision class 0 = 0.91924
precision class 1 = 0.8
recall class 0 = 0.997423
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.002577
positive prediction rate = 0.011737
AUC of ROC = 0.879002
AUC of PRC = 0.50256
min(+P, Se) = 0.465116

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10790400207042694
difference in average predicted and observed risk = -0.00974299792957306
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.924074
AUC of PRC = 0.659722
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.09881699830293655
difference in average predicted and observed risk = 0.010106998302936557
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.858407
AUC of PRC = 0.260826
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11701499670743942
difference in average predicted and observed risk = -0.032591003292560566
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.840643
AUC of PRC = 0.567242
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.1317719966173172
difference in average predicted and observed risk = 0.052824996617317196
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.847619
AUC of PRC = 0.19418
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[730   4]
 [ 72  11]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09029199928045273
difference in average predicted and observed risk = -0.011299000719547272
number samples = 817
accuracy = 0.906977
precision class 0 = 0.910224
precision class 1 = 0.733333
recall class 0 = 0.99455
recall class 1 = 0.13253
false negative rate = 0.86747
false positive rate = 0.00545
positive prediction rate = 0.01836
AUC of ROC = 0.871656
AUC of PRC = 0.485395
min(+P, Se) = 0.481928

-------------------------------

Epoch 00094: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch94.state
Epoch 95/100
 - 316s - loss: 0.2486 - val_loss: 0.2318

==>predicting on train



confusion matrix:
[[2135   20]
 [ 199   56]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.11212699860334396
difference in average predicted and observed risk = 0.006317998603343963
number samples = 2410
accuracy = 0.909129
precision class 0 = 0.914739
precision class 1 = 0.736842
recall class 0 = 0.990719
recall class 1 = 0.219608
false negative rate = 0.780392
false positive rate = 0.009281
positive prediction rate = 0.031535
AUC of ROC = 0.862017
AUC of PRC = 0.502931
min(+P, Se) = 0.490196

-------------------------------

confusion matrix:
[[1167   12]
 [  93   25]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09607099741697311
difference in average predicted and observed risk = 0.00509199741697311
number samples = 1297
accuracy = 0.919044
precision class 0 = 0.92619
precision class 1 = 0.675676
recall class 0 = 0.989822
recall class 1 = 0.211864
false negative rate = 0.788136
false positive rate = 0.010178
positive prediction rate = 0.028527
AUC of ROC = 0.877352
AUC of PRC = 0.49922
min(+P, Se) = 0.470588

-------------------------------

confusion matrix:
[[652   4]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10157400369644165
difference in average predicted and observed risk = 0.00020400369644164862
number samples = 730
accuracy = 0.916438
precision class 0 = 0.919605
precision class 1 = 0.809524
recall class 0 = 0.993902
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.006098
positive prediction rate = 0.028767
AUC of ROC = 0.88874
AUC of PRC = 0.574929
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[163   4]
 [ 10  14]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12376400083303452
difference in average predicted and observed risk = -0.0018899991669654725
number samples = 191
accuracy = 0.926702
precision class 0 = 0.942197
precision class 1 = 0.777778
recall class 0 = 0.976048
recall class 1 = 0.583333
false negative rate = 0.416667
false positive rate = 0.023952
positive prediction rate = 0.094241
AUC of ROC = 0.966816
AUC of PRC = 0.84598
min(+P, Se) = 0.740741

-------------------------------

confusion matrix:
[[2454   20]
 [ 201   54]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09791400283575058
difference in average predicted and observed risk = 0.0044730028357505836
number samples = 2729
accuracy = 0.919018
precision class 0 = 0.924294
precision class 1 = 0.72973
recall class 0 = 0.991916
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.008084
positive prediction rate = 0.027116
AUC of ROC = 0.868681
AUC of PRC = 0.488081
min(+P, Se) = 0.462745

-------------------------------

confusion matrix:
[[1663   20]
 [ 158   58]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11869899928569794
difference in average predicted and observed risk = 0.004954999285697939
number samples = 1899
accuracy = 0.906266
precision class 0 = 0.913234
precision class 1 = 0.74359
recall class 0 = 0.988116
recall class 1 = 0.268519
false negative rate = 0.731481
false positive rate = 0.011884
positive prediction rate = 0.041074
AUC of ROC = 0.884292
AUC of PRC = 0.579406
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[542   7]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12308599799871445
difference in average predicted and observed risk = 8.29979987144458e-05
number samples = 626
accuracy = 0.888179
precision class 0 = 0.895868
precision class 1 = 0.666667
recall class 0 = 0.98725
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.01275
positive prediction rate = 0.033546
AUC of ROC = 0.869136
AUC of PRC = 0.505053
min(+P, Se) = 0.545455

-------------------------------

confusion matrix:
[[2237   12]
 [ 172   36]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.09113200008869171
difference in average predicted and observed risk = 0.006476000088691716
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.928601
precision class 1 = 0.75
recall class 0 = 0.994664
recall class 1 = 0.173077
false negative rate = 0.826923
false positive rate = 0.005336
positive prediction rate = 0.019536
AUC of ROC = 0.872418
AUC of PRC = 0.459845
min(+P, Se) = 0.447115

-------------------------------

confusion matrix:
[[219   4]
 [ 21   4]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10848800092935562
difference in average predicted and observed risk = 0.007682000929355615
number samples = 248
accuracy = 0.899194
precision class 0 = 0.9125
precision class 1 = 0.5
recall class 0 = 0.982063
recall class 1 = 0.16
false negative rate = 0.84
false positive rate = 0.017937
positive prediction rate = 0.032258
AUC of ROC = 0.790135
AUC of PRC = 0.311796
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[473   8]
 [ 45  37]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.14865699410438538
difference in average predicted and observed risk = 0.0030089941043853763
number samples = 563
accuracy = 0.905861
precision class 0 = 0.913127
precision class 1 = 0.822222
recall class 0 = 0.983368
recall class 1 = 0.451219
false negative rate = 0.548781
false positive rate = 0.016632
positive prediction rate = 0.079929
AUC of ROC = 0.910299
AUC of PRC = 0.726137
min(+P, Se) = 0.616279

-------------------------------

confusion matrix:
[[646   9]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11042899638414383
difference in average predicted and observed risk = 0.002799996384143827
number samples = 734
accuracy = 0.908719
precision class 0 = 0.917614
precision class 1 = 0.7
recall class 0 = 0.98626
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.01374
positive prediction rate = 0.040872
AUC of ROC = 0.874075
AUC of PRC = 0.559568
min(+P, Se) = 0.544304

-------------------------------

confusion matrix:
[[4117   40]
 [ 359  112]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10644300282001495
difference in average predicted and observed risk = 0.004671002820014952
number samples = 4628
accuracy = 0.913786
precision class 0 = 0.919794
precision class 1 = 0.736842
recall class 0 = 0.990378
recall class 1 = 0.237792
false negative rate = 0.762208
false positive rate = 0.009622
positive prediction rate = 0.032844
AUC of ROC = 0.876251
AUC of PRC = 0.531931
min(+P, Se) = 0.503185

-------------------------------

==>predicting on validation



confusion matrix:
[[214   4]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09309600293636322
difference in average predicted and observed risk = 0.012927002936363216
number samples = 237
accuracy = 0.915612
precision class 0 = 0.930435
precision class 1 = 0.428571
recall class 0 = 0.981651
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.018349
positive prediction rate = 0.029536
AUC of ROC = 0.89184
AUC of PRC = 0.463514
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.10056699812412262
difference in average predicted and observed risk = -0.008229001875877384
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.845593
AUC of PRC = 0.48123
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[103   2]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1250080019235611
difference in average predicted and observed risk = 0.014839001923561093
number samples = 118
accuracy = 0.898305
precision class 0 = 0.911504
precision class 1 = 0.6
recall class 0 = 0.980952
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.019048
positive prediction rate = 0.042373
AUC of ROC = 0.914286
AUC of PRC = 0.49361
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13478399813175201
difference in average predicted and observed risk = 0.001450998131752007
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11460000276565552
difference in average predicted and observed risk = -0.0004439972343444759
number samples = 339
accuracy = 0.887906
precision class 0 = 0.894578
precision class 1 = 0.571429
recall class 0 = 0.99
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.01
positive prediction rate = 0.020649
AUC of ROC = 0.861282
AUC of PRC = 0.415086
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[431   3]
 [ 33  11]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09509100019931793
difference in average predicted and observed risk = 0.0030410001993179253
number samples = 478
accuracy = 0.924686
precision class 0 = 0.928879
precision class 1 = 0.785714
recall class 0 = 0.993088
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.006912
positive prediction rate = 0.029289
AUC of ROC = 0.88008
AUC of PRC = 0.552375
min(+P, Se) = 0.543478

-------------------------------

confusion matrix:
[[387   1]
 [ 31   7]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08426699787378311
difference in average predicted and observed risk = -0.004935002126216892
number samples = 426
accuracy = 0.924883
precision class 0 = 0.925837
precision class 1 = 0.875
recall class 0 = 0.997423
recall class 1 = 0.184211
false negative rate = 0.815789
false positive rate = 0.002577
positive prediction rate = 0.018779
AUC of ROC = 0.877984
AUC of PRC = 0.526251
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[88  2]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12278100103139877
difference in average predicted and observed risk = 0.005134001031398772
number samples = 102
accuracy = 0.892157
precision class 0 = 0.907216
precision class 1 = 0.6
recall class 0 = 0.977778
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.022222
positive prediction rate = 0.04902
AUC of ROC = 0.934259
AUC of PRC = 0.661828
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11474200338125229
difference in average predicted and observed risk = 0.02603200338125229
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.861625
AUC of PRC = 0.261696
min(+P, Se) = 0.35

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12820300459861755
difference in average predicted and observed risk = -0.021402995401382435
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.846004
AUC of PRC = 0.578222
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14136900007724762
difference in average predicted and observed risk = 0.062422000077247616
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.828571
AUC of PRC = 0.177597
min(+P, Se) = 0.272727

-------------------------------

confusion matrix:
[[728   6]
 [ 68  15]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.1031859964132309
difference in average predicted and observed risk = 0.0015949964132308952
number samples = 817
accuracy = 0.909425
precision class 0 = 0.914573
precision class 1 = 0.714286
recall class 0 = 0.991826
recall class 1 = 0.180723
false negative rate = 0.819277
false positive rate = 0.008174
positive prediction rate = 0.025704
AUC of ROC = 0.874659
AUC of PRC = 0.494006
min(+P, Se) = 0.481928

-------------------------------

Epoch 00095: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch95.state
Epoch 96/100
 - 305s - loss: 0.2481 - val_loss: 0.2368

==>predicting on train



confusion matrix:
[[2143   12]
 [ 212   43]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10535400360822678
difference in average predicted and observed risk = -0.00045499639177322415
number samples = 2410
accuracy = 0.907054
precision class 0 = 0.909979
precision class 1 = 0.781818
recall class 0 = 0.994432
recall class 1 = 0.168627
false negative rate = 0.831373
false positive rate = 0.005568
positive prediction rate = 0.022822
AUC of ROC = 0.859613
AUC of PRC = 0.506845
min(+P, Se) = 0.486275

-------------------------------

confusion matrix:
[[1172    7]
 [  97   21]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09614399820566177
difference in average predicted and observed risk = 0.005164998205661769
number samples = 1297
accuracy = 0.919815
precision class 0 = 0.923562
precision class 1 = 0.75
recall class 0 = 0.994063
recall class 1 = 0.177966
false negative rate = 0.822034
false positive rate = 0.005937
positive prediction rate = 0.021588
AUC of ROC = 0.869805
AUC of PRC = 0.493602
min(+P, Se) = 0.466102

-------------------------------

confusion matrix:
[[653   3]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.11233100295066833
difference in average predicted and observed risk = 0.010961002950668333
number samples = 730
accuracy = 0.917808
precision class 0 = 0.919718
precision class 1 = 0.85
recall class 0 = 0.995427
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.004573
positive prediction rate = 0.027397
AUC of ROC = 0.867234
AUC of PRC = 0.561674
min(+P, Se) = 0.493333

-------------------------------

confusion matrix:
[[164   3]
 [  8  16]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.13060499727725983
difference in average predicted and observed risk = 0.004950997277259839
number samples = 191
accuracy = 0.942408
precision class 0 = 0.953488
precision class 1 = 0.842105
recall class 0 = 0.982036
recall class 1 = 0.666667
false negative rate = 0.333333
false positive rate = 0.017964
positive prediction rate = 0.099476
AUC of ROC = 0.96008
AUC of PRC = 0.845286
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2459   15]
 [ 209   46]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09616000205278397
difference in average predicted and observed risk = 0.0027190020527839698
number samples = 2729
accuracy = 0.917919
precision class 0 = 0.921664
precision class 1 = 0.754098
recall class 0 = 0.993937
recall class 1 = 0.180392
false negative rate = 0.819608
false positive rate = 0.006063
positive prediction rate = 0.022353
AUC of ROC = 0.86154
AUC of PRC = 0.48448
min(+P, Se) = 0.462745

-------------------------------

confusion matrix:
[[1673   10]
 [ 165   51]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.1174980029463768
difference in average predicted and observed risk = 0.0037540029463768027
number samples = 1899
accuracy = 0.907846
precision class 0 = 0.910228
precision class 1 = 0.836066
recall class 0 = 0.994058
recall class 1 = 0.236111
false negative rate = 0.763889
false positive rate = 0.005942
positive prediction rate = 0.032122
AUC of ROC = 0.878631
AUC of PRC = 0.580453
min(+P, Se) = 0.541667

-------------------------------

confusion matrix:
[[546   3]
 [ 65  12]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12240800261497498
difference in average predicted and observed risk = -0.0005949973850250256
number samples = 626
accuracy = 0.891374
precision class 0 = 0.893617
precision class 1 = 0.8
recall class 0 = 0.994536
recall class 1 = 0.155844
false negative rate = 0.844156
false positive rate = 0.005464
positive prediction rate = 0.023962
AUC of ROC = 0.867504
AUC of PRC = 0.529719
min(+P, Se) = 0.532468

-------------------------------

confusion matrix:
[[2241    8]
 [ 176   32]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0881590023636818
difference in average predicted and observed risk = 0.003503002363681798
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.927182
precision class 1 = 0.8
recall class 0 = 0.996443
recall class 1 = 0.153846
false negative rate = 0.846154
false positive rate = 0.003557
positive prediction rate = 0.01628
AUC of ROC = 0.865936
AUC of PRC = 0.45628
min(+P, Se) = 0.432692

-------------------------------

confusion matrix:
[[222   1]
 [ 23   2]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10850200057029724
difference in average predicted and observed risk = 0.0076960005702972345
number samples = 248
accuracy = 0.903226
precision class 0 = 0.906122
precision class 1 = 0.666667
recall class 0 = 0.995516
recall class 1 = 0.08
false negative rate = 0.92
false positive rate = 0.004484
positive prediction rate = 0.012097
AUC of ROC = 0.795695
AUC of PRC = 0.317532
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[475   6]
 [ 50  32]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.1454000025987625
difference in average predicted and observed risk = -0.0002479974012374875
number samples = 563
accuracy = 0.900533
precision class 0 = 0.904762
precision class 1 = 0.842105
recall class 0 = 0.987526
recall class 1 = 0.390244
false negative rate = 0.609756
false positive rate = 0.012474
positive prediction rate = 0.067496
AUC of ROC = 0.900892
AUC of PRC = 0.721849
min(+P, Se) = 0.646341

-------------------------------

confusion matrix:
[[648   7]
 [ 60  19]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.11382099986076355
difference in average predicted and observed risk = 0.006191999860763547
number samples = 734
accuracy = 0.908719
precision class 0 = 0.915254
precision class 1 = 0.730769
recall class 0 = 0.989313
recall class 1 = 0.240506
false negative rate = 0.759494
false positive rate = 0.010687
positive prediction rate = 0.035422
AUC of ROC = 0.866828
AUC of PRC = 0.55779
min(+P, Se) = 0.5125

-------------------------------

confusion matrix:
[[4132   25]
 [ 374   97]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.10491500049829483
difference in average predicted and observed risk = 0.003143000498294829
number samples = 4628
accuracy = 0.913786
precision class 0 = 0.917
precision class 1 = 0.795082
recall class 0 = 0.993986
recall class 1 = 0.205945
false negative rate = 0.794055
false positive rate = 0.006014
positive prediction rate = 0.026361
AUC of ROC = 0.869426
AUC of PRC = 0.529709
min(+P, Se) = 0.493697

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.09294000267982483
difference in average predicted and observed risk = 0.012771002679824825
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.897151
AUC of PRC = 0.444547
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[385   0]
 [ 42   5]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09756100177764893
difference in average predicted and observed risk = -0.011234998222351078
number samples = 432
accuracy = 0.902778
precision class 0 = 0.901639
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.106383
false negative rate = 0.893617
false positive rate = 0.0
positive prediction rate = 0.011574
AUC of ROC = 0.832274
AUC of PRC = 0.45267
min(+P, Se) = 0.4375

-------------------------------

confusion matrix:
[[104   1]
 [ 10   3]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.13787199556827545
difference in average predicted and observed risk = 0.02770299556827545
number samples = 118
accuracy = 0.90678
precision class 0 = 0.912281
precision class 1 = 0.75
recall class 0 = 0.990476
recall class 1 = 0.230769
false negative rate = 0.769231
false positive rate = 0.009524
positive prediction rate = 0.033898
AUC of ROC = 0.90989
AUC of PRC = 0.55385
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.14781899750232697
difference in average predicted and observed risk = 0.014485997502326958
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.11603099852800369
difference in average predicted and observed risk = 0.0009869985280036991
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.847949
AUC of PRC = 0.412
min(+P, Se) = 0.42

-------------------------------

confusion matrix:
[[433   1]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09527699649333954
difference in average predicted and observed risk = 0.0032269964933395318
number samples = 478
accuracy = 0.926778
precision class 0 = 0.927195
precision class 1 = 0.909091
recall class 0 = 0.997696
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.002304
positive prediction rate = 0.023013
AUC of ROC = 0.877409
AUC of PRC = 0.535555
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[388   0]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.08292099833488464
difference in average predicted and observed risk = -0.00628100166511536
number samples = 426
accuracy = 0.924883
precision class 0 = 0.92381
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.0
positive prediction rate = 0.014085
AUC of ROC = 0.872423
AUC of PRC = 0.496539
min(+P, Se) = 0.512195

-------------------------------

confusion matrix:
[[90  0]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12164700031280518
difference in average predicted and observed risk = 0.004000000312805174
number samples = 102
accuracy = 0.911765
precision class 0 = 0.909091
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.0
positive prediction rate = 0.029412
AUC of ROC = 0.932407
AUC of PRC = 0.665878
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11874700337648392
difference in average predicted and observed risk = 0.03003700337648392
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.839903
AUC of PRC = 0.242261
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.13314999639987946
difference in average predicted and observed risk = -0.016456003600120533
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.844542
AUC of PRC = 0.564114
min(+P, Se) = 0.565217

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14500099420547485
difference in average predicted and observed risk = 0.06605399420547485
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.8
AUC of PRC = 0.160606
min(+P, Se) = 0.25

-------------------------------

confusion matrix:
[[731   3]
 [ 69  14]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10388799756765366
difference in average predicted and observed risk = 0.0022969975676536553
number samples = 817
accuracy = 0.911873
precision class 0 = 0.91375
precision class 1 = 0.823529
recall class 0 = 0.995913
recall class 1 = 0.168675
false negative rate = 0.831325
false positive rate = 0.004087
positive prediction rate = 0.020808
AUC of ROC = 0.867388
AUC of PRC = 0.479391
min(+P, Se) = 0.452632

-------------------------------

Epoch 00096: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch96.state
Epoch 97/100
 - 310s - loss: 0.2523 - val_loss: 0.2333

==>predicting on train



confusion matrix:
[[2133   22]
 [ 198   57]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.10545500367879868
difference in average predicted and observed risk = -0.00035399632120132474
number samples = 2410
accuracy = 0.908714
precision class 0 = 0.915058
precision class 1 = 0.721519
recall class 0 = 0.989791
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.010209
positive prediction rate = 0.03278
AUC of ROC = 0.857912
AUC of PRC = 0.50276
min(+P, Se) = 0.482353

-------------------------------

confusion matrix:
[[1169   10]
 [  90   28]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.09398400038480759
difference in average predicted and observed risk = 0.0030050003848075824
number samples = 1297
accuracy = 0.922899
precision class 0 = 0.928515
precision class 1 = 0.736842
recall class 0 = 0.991518
recall class 1 = 0.237288
false negative rate = 0.762712
false positive rate = 0.008482
positive prediction rate = 0.029298
AUC of ROC = 0.874916
AUC of PRC = 0.503371
min(+P, Se) = 0.474576

-------------------------------

confusion matrix:
[[651   5]
 [ 57  17]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.10045599937438965
difference in average predicted and observed risk = -0.0009140006256103533
number samples = 730
accuracy = 0.915069
precision class 0 = 0.919492
precision class 1 = 0.772727
recall class 0 = 0.992378
recall class 1 = 0.22973
false negative rate = 0.77027
false positive rate = 0.007622
positive prediction rate = 0.030137
AUC of ROC = 0.876092
AUC of PRC = 0.563028
min(+P, Se) = 0.513514

-------------------------------

confusion matrix:
[[164   3]
 [  9  15]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12583599984645844
difference in average predicted and observed risk = 0.00018199984645844713
number samples = 191
accuracy = 0.937173
precision class 0 = 0.947977
precision class 1 = 0.833333
recall class 0 = 0.982036
recall class 1 = 0.625
false negative rate = 0.375
false positive rate = 0.017964
positive prediction rate = 0.094241
AUC of ROC = 0.965818
AUC of PRC = 0.847037
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2452   22]
 [ 197   58]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.09417100250720978
difference in average predicted and observed risk = 0.0007300025072097815
number samples = 2729
accuracy = 0.919751
precision class 0 = 0.925632
precision class 1 = 0.725
recall class 0 = 0.991108
recall class 1 = 0.227451
false negative rate = 0.772549
false positive rate = 0.008892
positive prediction rate = 0.029315
AUC of ROC = 0.864294
AUC of PRC = 0.491931
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[1665   18]
 [ 157   59]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.11396399885416031
difference in average predicted and observed risk = 0.00021999885416031095
number samples = 1899
accuracy = 0.907846
precision class 0 = 0.913831
precision class 1 = 0.766234
recall class 0 = 0.989305
recall class 1 = 0.273148
false negative rate = 0.726852
false positive rate = 0.010695
positive prediction rate = 0.040548
AUC of ROC = 0.880672
AUC of PRC = 0.575569
min(+P, Se) = 0.541667

-------------------------------

confusion matrix:
[[544   5]
 [ 62  15]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.12017100304365158
difference in average predicted and observed risk = -0.0028319969563484204
number samples = 626
accuracy = 0.892971
precision class 0 = 0.89769
precision class 1 = 0.75
recall class 0 = 0.990893
recall class 1 = 0.194805
false negative rate = 0.805195
false positive rate = 0.009107
positive prediction rate = 0.031949
AUC of ROC = 0.863506
AUC of PRC = 0.519879
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2232   17]
 [ 169   39]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0852930024266243
difference in average predicted and observed risk = 0.000637002426624303
number samples = 2457
accuracy = 0.924298
precision class 0 = 0.929613
precision class 1 = 0.696429
recall class 0 = 0.992441
recall class 1 = 0.1875
false negative rate = 0.8125
false positive rate = 0.007559
positive prediction rate = 0.022792
AUC of ROC = 0.866667
AUC of PRC = 0.451996
min(+P, Se) = 0.433333

-------------------------------

confusion matrix:
[[221   2]
 [ 21   4]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10185299813747406
difference in average predicted and observed risk = 0.0010469981374740533
number samples = 248
accuracy = 0.907258
precision class 0 = 0.913223
precision class 1 = 0.666667
recall class 0 = 0.991031
recall class 1 = 0.16
false negative rate = 0.84
false positive rate = 0.008969
positive prediction rate = 0.024194
AUC of ROC = 0.790493
AUC of PRC = 0.346674
min(+P, Se) = 0.4

-------------------------------

confusion matrix:
[[474   7]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.15137000381946564
difference in average predicted and observed risk = 0.0057220038194656375
number samples = 563
accuracy = 0.909414
precision class 0 = 0.915058
precision class 1 = 0.844444
recall class 0 = 0.985447
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.014553
positive prediction rate = 0.079929
AUC of ROC = 0.912073
AUC of PRC = 0.731511
min(+P, Se) = 0.658537

-------------------------------

confusion matrix:
[[646   9]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10645599663257599
difference in average predicted and observed risk = -0.0011730033674240137
number samples = 734
accuracy = 0.908719
precision class 0 = 0.917614
precision class 1 = 0.7
recall class 0 = 0.98626
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.01374
positive prediction rate = 0.040872
AUC of ROC = 0.868238
AUC of PRC = 0.549907
min(+P, Se) = 0.506329

-------------------------------

confusion matrix:
[[4117   40]
 [ 354  117]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.102292999625206
difference in average predicted and observed risk = 0.0005209996252059923
number samples = 4628
accuracy = 0.914866
precision class 0 = 0.920823
precision class 1 = 0.745223
recall class 0 = 0.990378
recall class 1 = 0.248408
false negative rate = 0.751592
false positive rate = 0.009622
positive prediction rate = 0.033924
AUC of ROC = 0.871812
AUC of PRC = 0.53006
min(+P, Se) = 0.496842

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.0889429971575737
difference in average predicted and observed risk = 0.008773997157573696
number samples = 237
accuracy = 0.919831
precision class 0 = 0.930736
precision class 1 = 0.5
recall class 0 = 0.986239
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.013761
positive prediction rate = 0.025316
AUC of ROC = 0.89184
AUC of PRC = 0.454486
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[385   0]
 [ 40   7]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.09712599962949753
difference in average predicted and observed risk = -0.011670000370502476
number samples = 432
accuracy = 0.907407
precision class 0 = 0.905882
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.148936
false negative rate = 0.851064
false positive rate = 0.0
positive prediction rate = 0.016204
AUC of ROC = 0.831777
AUC of PRC = 0.458485
min(+P, Se) = 0.415094

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.1259090006351471
difference in average predicted and observed risk = 0.01574000063514709
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.911355
AUC of PRC = 0.53231
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.13252800703048706
difference in average predicted and observed risk = -0.0008049929695129465
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[297   3]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.1110839992761612
difference in average predicted and observed risk = -0.0039600007238388
number samples = 339
accuracy = 0.890855
precision class 0 = 0.897281
precision class 1 = 0.625
recall class 0 = 0.99
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.01
positive prediction rate = 0.023599
AUC of ROC = 0.846496
AUC of PRC = 0.412093
min(+P, Se) = 0.414634

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.09249699860811234
difference in average predicted and observed risk = 0.0004469986081123284
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.87987
AUC of PRC = 0.555025
min(+P, Se) = 0.521739

-------------------------------

confusion matrix:
[[388   0]
 [ 30   8]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07968799769878387
difference in average predicted and observed risk = -0.009514002301216129
number samples = 426
accuracy = 0.929577
precision class 0 = 0.92823
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.0
positive prediction rate = 0.018779
AUC of ROC = 0.875475
AUC of PRC = 0.521881
min(+P, Se) = 0.487179

-------------------------------

confusion matrix:
[[88  2]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.12924300134181976
difference in average predicted and observed risk = 0.011596001341819762
number samples = 102
accuracy = 0.901961
precision class 0 = 0.916667
precision class 1 = 0.666667
recall class 0 = 0.977778
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.022222
positive prediction rate = 0.058824
AUC of ROC = 0.926852
AUC of PRC = 0.676983
min(+P, Se) = 0.6

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.11169300228357315
difference in average predicted and observed risk = 0.022983002283573153
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.833467
AUC of PRC = 0.22935
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 14   5]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12349600344896317
difference in average predicted and observed risk = -0.026109996551036824
number samples = 127
accuracy = 0.874016
precision class 0 = 0.883333
precision class 1 = 0.714286
recall class 0 = 0.981481
recall class 1 = 0.263158
false negative rate = 0.736842
false positive rate = 0.018519
positive prediction rate = 0.055118
AUC of ROC = 0.850877
AUC of PRC = 0.586109
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13703499734401703
difference in average predicted and observed risk = 0.058087997344017026
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.8
AUC of PRC = 0.157155
min(+P, Se) = 0.25

-------------------------------

confusion matrix:
[[729   5]
 [ 66  17]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.10020899772644043
difference in average predicted and observed risk = -0.001382002273559571
number samples = 817
accuracy = 0.913097
precision class 0 = 0.916981
precision class 1 = 0.772727
recall class 0 = 0.993188
recall class 1 = 0.204819
false negative rate = 0.795181
false positive rate = 0.006812
positive prediction rate = 0.026928
AUC of ROC = 0.868077
AUC of PRC = 0.490952
min(+P, Se) = 0.44898

-------------------------------

Epoch 00097: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch97.state
Epoch 98/100
 - 307s - loss: 0.2505 - val_loss: 0.2334

==>predicting on train



confusion matrix:
[[2140   15]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09671299904584885
difference in average predicted and observed risk = -0.009096000954151154
number samples = 2410
accuracy = 0.910373
precision class 0 = 0.914139
precision class 1 = 0.782609
recall class 0 = 0.993039
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.006961
positive prediction rate = 0.028631
AUC of ROC = 0.857659
AUC of PRC = 0.502282
min(+P, Se) = 0.486381

-------------------------------

confusion matrix:
[[1172    7]
 [  92   26]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08772300183773041
difference in average predicted and observed risk = -0.0032559981622695966
number samples = 1297
accuracy = 0.92367
precision class 0 = 0.927215
precision class 1 = 0.787879
recall class 0 = 0.994063
recall class 1 = 0.220339
false negative rate = 0.779661
false positive rate = 0.005937
positive prediction rate = 0.025443
AUC of ROC = 0.872802
AUC of PRC = 0.502287
min(+P, Se) = 0.449153

-------------------------------

confusion matrix:
[[651   5]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0989760011434555
difference in average predicted and observed risk = -0.0023939988565444964
number samples = 730
accuracy = 0.916438
precision class 0 = 0.920792
precision class 1 = 0.782609
recall class 0 = 0.992378
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.007622
positive prediction rate = 0.031507
AUC of ROC = 0.882128
AUC of PRC = 0.571095
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[163   4]
 [  8  16]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.12056899815797806
difference in average predicted and observed risk = -0.00508500184202193
number samples = 191
accuracy = 0.937173
precision class 0 = 0.953216
precision class 1 = 0.8
recall class 0 = 0.976048
recall class 1 = 0.666667
false negative rate = 0.333333
false positive rate = 0.023952
positive prediction rate = 0.104712
AUC of ROC = 0.959581
AUC of PRC = 0.835139
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2457   17]
 [ 200   55]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08768399804830551
difference in average predicted and observed risk = -0.005757001951694485
number samples = 2729
accuracy = 0.920484
precision class 0 = 0.924727
precision class 1 = 0.763889
recall class 0 = 0.993129
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.006871
positive prediction rate = 0.026383
AUC of ROC = 0.862789
AUC of PRC = 0.484803
min(+P, Se) = 0.462745

-------------------------------

confusion matrix:
[[1669   14]
 [ 157   59]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10681799799203873
difference in average predicted and observed risk = -0.006926002007961271
number samples = 1899
accuracy = 0.909953
precision class 0 = 0.91402
precision class 1 = 0.808219
recall class 0 = 0.991682
recall class 1 = 0.273148
false negative rate = 0.726852
false positive rate = 0.008318
positive prediction rate = 0.038441
AUC of ROC = 0.881679
AUC of PRC = 0.582246
min(+P, Se) = 0.522936

-------------------------------

confusion matrix:
[[545   4]
 [ 63  14]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.11066699773073196
difference in average predicted and observed risk = -0.012336002269268037
number samples = 626
accuracy = 0.892971
precision class 0 = 0.896382
precision class 1 = 0.777778
recall class 0 = 0.992714
recall class 1 = 0.181818
false negative rate = 0.818182
false positive rate = 0.007286
positive prediction rate = 0.028754
AUC of ROC = 0.868143
AUC of PRC = 0.531271
min(+P, Se) = 0.519481

-------------------------------

confusion matrix:
[[2240    9]
 [ 170   38]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0789090022444725
difference in average predicted and observed risk = -0.0057469977555274915
number samples = 2457
accuracy = 0.927147
precision class 0 = 0.929461
precision class 1 = 0.808511
recall class 0 = 0.995998
recall class 1 = 0.182692
false negative rate = 0.817308
false positive rate = 0.004002
positive prediction rate = 0.019129
AUC of ROC = 0.869128
AUC of PRC = 0.45894
min(+P, Se) = 0.424528

-------------------------------

confusion matrix:
[[220   3]
 [ 21   4]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.10064999759197235
difference in average predicted and observed risk = -0.00015600240802765564
number samples = 248
accuracy = 0.903226
precision class 0 = 0.912863
precision class 1 = 0.571429
recall class 0 = 0.986547
recall class 1 = 0.16
false negative rate = 0.84
false positive rate = 0.013453
positive prediction rate = 0.028226
AUC of ROC = 0.787085
AUC of PRC = 0.302321
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[474   7]
 [ 44  38]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13666999340057373
difference in average predicted and observed risk = -0.00897800659942627
number samples = 563
accuracy = 0.909414
precision class 0 = 0.915058
precision class 1 = 0.844444
recall class 0 = 0.985447
recall class 1 = 0.463415
false negative rate = 0.536585
false positive rate = 0.014553
positive prediction rate = 0.079929
AUC of ROC = 0.902363
AUC of PRC = 0.714303
min(+P, Se) = 0.621951

-------------------------------

confusion matrix:
[[647   8]
 [ 59  20]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10500100255012512
difference in average predicted and observed risk = -0.0026279974498748804
number samples = 734
accuracy = 0.908719
precision class 0 = 0.916431
precision class 1 = 0.714286
recall class 0 = 0.987786
recall class 1 = 0.253165
false negative rate = 0.746835
false positive rate = 0.012214
positive prediction rate = 0.038147
AUC of ROC = 0.867987
AUC of PRC = 0.552923
min(+P, Se) = 0.506329

-------------------------------

confusion matrix:
[[4126   31]
 [ 357  114]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09553500264883041
difference in average predicted and observed risk = -0.0062369973511695875
number samples = 4628
accuracy = 0.916162
precision class 0 = 0.920366
precision class 1 = 0.786207
recall class 0 = 0.992543
recall class 1 = 0.242038
false negative rate = 0.757962
false positive rate = 0.007457
positive prediction rate = 0.031331
AUC of ROC = 0.871533
AUC of PRC = 0.530641
min(+P, Se) = 0.4926

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 16   3]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08387300372123718
difference in average predicted and observed risk = 0.0037040037212371785
number samples = 237
accuracy = 0.924051
precision class 0 = 0.931035
precision class 1 = 0.6
recall class 0 = 0.990826
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.009174
positive prediction rate = 0.021097
AUC of ROC = 0.896427
AUC of PRC = 0.434669
min(+P, Se) = 0.473684

-------------------------------

confusion matrix:
[[385   0]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08844500035047531
difference in average predicted and observed risk = -0.020350999649524693
number samples = 432
accuracy = 0.905093
precision class 0 = 0.903756
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.0
positive prediction rate = 0.013889
AUC of ROC = 0.838574
AUC of PRC = 0.477179
min(+P, Se) = 0.433962

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12449900060892105
difference in average predicted and observed risk = 0.014330000608921048
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.908425
AUC of PRC = 0.550328
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.12982900440692902
difference in average predicted and observed risk = -0.003503995593070991
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.961538
AUC of PRC = 0.866071
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 35   4]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10421700030565262
difference in average predicted and observed risk = -0.010826999694347375
number samples = 339
accuracy = 0.890855
precision class 0 = 0.894895
precision class 1 = 0.666667
recall class 0 = 0.993333
recall class 1 = 0.102564
false negative rate = 0.897436
false positive rate = 0.006667
positive prediction rate = 0.017699
AUC of ROC = 0.850342
AUC of PRC = 0.415484
min(+P, Se) = 0.410256

-------------------------------

confusion matrix:
[[432   2]
 [ 32  12]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.08649100363254547
difference in average predicted and observed risk = -0.005558996367454536
number samples = 478
accuracy = 0.92887
precision class 0 = 0.931035
precision class 1 = 0.857143
recall class 0 = 0.995392
recall class 1 = 0.272727
false negative rate = 0.727273
false positive rate = 0.004608
positive prediction rate = 0.029289
AUC of ROC = 0.880237
AUC of PRC = 0.547197
min(+P, Se) = 0.543478

-------------------------------

confusion matrix:
[[388   0]
 [ 30   8]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07351800054311752
difference in average predicted and observed risk = -0.01568399945688248
number samples = 426
accuracy = 0.929577
precision class 0 = 0.92823
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.0
positive prediction rate = 0.018779
AUC of ROC = 0.876424
AUC of PRC = 0.51875
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 8  4]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.11753199994564056
difference in average predicted and observed risk = -0.00011500005435943761
number samples = 102
accuracy = 0.911765
precision class 0 = 0.917526
precision class 1 = 0.8
recall class 0 = 0.988889
recall class 1 = 0.333333
false negative rate = 0.666667
false positive rate = 0.011111
positive prediction rate = 0.04902
AUC of ROC = 0.940741
AUC of PRC = 0.695869
min(+P, Se) = 0.583333

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10319399833679199
difference in average predicted and observed risk = 0.014483998336791995
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.842317
AUC of PRC = 0.237421
min(+P, Se) = 0.310345

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.1215130016207695
difference in average predicted and observed risk = -0.028092998379230488
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.841618
AUC of PRC = 0.578258
min(+P, Se) = 0.571429

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.13518700003623962
difference in average predicted and observed risk = 0.05624000003623962
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.8
AUC of PRC = 0.160606
min(+P, Se) = 0.25

-------------------------------

confusion matrix:
[[730   4]
 [ 67  16]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09384600073099136
difference in average predicted and observed risk = -0.007744999269008637
number samples = 817
accuracy = 0.913097
precision class 0 = 0.915935
precision class 1 = 0.8
recall class 0 = 0.99455
recall class 1 = 0.192771
false negative rate = 0.807229
false positive rate = 0.00545
positive prediction rate = 0.02448
AUC of ROC = 0.870195
AUC of PRC = 0.489308
min(+P, Se) = 0.454545

-------------------------------

Epoch 00098: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch98.state
Epoch 99/100
 - 308s - loss: 0.2464 - val_loss: 0.2375

==>predicting on train



confusion matrix:
[[2133   22]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.08482400327920914
difference in average predicted and observed risk = -0.020984996720790863
number samples = 2410
accuracy = 0.907469
precision class 0 = 0.913882
precision class 1 = 0.710526
recall class 0 = 0.989791
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.010209
positive prediction rate = 0.031535
AUC of ROC = 0.857592
AUC of PRC = 0.503213
min(+P, Se) = 0.486275

-------------------------------

confusion matrix:
[[1170    9]
 [  91   27]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.07767999917268753
difference in average predicted and observed risk = -0.013299000827312474
number samples = 1297
accuracy = 0.922899
precision class 0 = 0.927835
precision class 1 = 0.75
recall class 0 = 0.992366
recall class 1 = 0.228814
false negative rate = 0.771186
false positive rate = 0.007634
positive prediction rate = 0.027756
AUC of ROC = 0.873313
AUC of PRC = 0.504483
min(+P, Se) = 0.474576

-------------------------------

confusion matrix:
[[652   4]
 [ 56  18]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.0845479965209961
difference in average predicted and observed risk = -0.016822003479003908
number samples = 730
accuracy = 0.917808
precision class 0 = 0.920904
precision class 1 = 0.818182
recall class 0 = 0.993902
recall class 1 = 0.243243
false negative rate = 0.756757
false positive rate = 0.006098
positive prediction rate = 0.030137
AUC of ROC = 0.886124
AUC of PRC = 0.568808
min(+P, Se) = 0.493671

-------------------------------

confusion matrix:
[[166   1]
 [ 11  13]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10782600194215775
difference in average predicted and observed risk = -0.017827998057842243
number samples = 191
accuracy = 0.937173
precision class 0 = 0.937853
precision class 1 = 0.928571
recall class 0 = 0.994012
recall class 1 = 0.541667
false negative rate = 0.458333
false positive rate = 0.005988
positive prediction rate = 0.073298
AUC of ROC = 0.965569
AUC of PRC = 0.844577
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2454   20]
 [ 198   57]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.07643000036478043
difference in average predicted and observed risk = -0.01701099963521957
number samples = 2729
accuracy = 0.920117
precision class 0 = 0.925339
precision class 1 = 0.74026
recall class 0 = 0.991916
recall class 1 = 0.223529
false negative rate = 0.776471
false positive rate = 0.008084
positive prediction rate = 0.028215
AUC of ROC = 0.865324
AUC of PRC = 0.490414
min(+P, Se) = 0.454902

-------------------------------

confusion matrix:
[[1667   16]
 [ 161   55]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.09421399980783463
difference in average predicted and observed risk = -0.019530000192165373
number samples = 1899
accuracy = 0.906793
precision class 0 = 0.911926
precision class 1 = 0.774648
recall class 0 = 0.990493
recall class 1 = 0.25463
false negative rate = 0.74537
false positive rate = 0.009507
positive prediction rate = 0.037388
AUC of ROC = 0.880298
AUC of PRC = 0.577421
min(+P, Se) = 0.532407

-------------------------------

confusion matrix:
[[542   7]
 [ 61  16]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.09913299977779388
difference in average predicted and observed risk = -0.023870000222206117
number samples = 626
accuracy = 0.891374
precision class 0 = 0.898839
precision class 1 = 0.695652
recall class 0 = 0.98725
recall class 1 = 0.207792
false negative rate = 0.792208
false positive rate = 0.01275
positive prediction rate = 0.036741
AUC of ROC = 0.866842
AUC of PRC = 0.506333
min(+P, Se) = 0.5125

-------------------------------

confusion matrix:
[[2238   11]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.06732600182294846
difference in average predicted and observed risk = -0.01732999817705154
number samples = 2457
accuracy = 0.925112
precision class 0 = 0.928246
precision class 1 = 0.76087
recall class 0 = 0.995109
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.004891
positive prediction rate = 0.018722
AUC of ROC = 0.869513
AUC of PRC = 0.465339
min(+P, Se) = 0.447619

-------------------------------

confusion matrix:
[[220   3]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.08981700241565704
difference in average predicted and observed risk = -0.010988997584342963
number samples = 248
accuracy = 0.899194
precision class 0 = 0.909091
precision class 1 = 0.5
recall class 0 = 0.986547
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.013453
positive prediction rate = 0.024194
AUC of ROC = 0.771839
AUC of PRC = 0.284153
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[474   7]
 [ 45  37]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.12374799698591232
difference in average predicted and observed risk = -0.021900003014087677
number samples = 563
accuracy = 0.907638
precision class 0 = 0.913295
precision class 1 = 0.840909
recall class 0 = 0.985447
recall class 1 = 0.451219
false negative rate = 0.548781
false positive rate = 0.014553
positive prediction rate = 0.078153
AUC of ROC = 0.903453
AUC of PRC = 0.714952
min(+P, Se) = 0.60241

-------------------------------

confusion matrix:
[[647   8]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.09273699671030045
difference in average predicted and observed risk = -0.014892003289699557
number samples = 734
accuracy = 0.910082
precision class 0 = 0.917731
precision class 1 = 0.724138
recall class 0 = 0.987786
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.012214
positive prediction rate = 0.03951
AUC of ROC = 0.8705
AUC of PRC = 0.559603
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4121   36]
 [ 359  112]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.08372700214385986
difference in average predicted and observed risk = -0.018044997856140138
number samples = 4628
accuracy = 0.91465
precision class 0 = 0.919866
precision class 1 = 0.756757
recall class 0 = 0.99134
recall class 1 = 0.237792
false negative rate = 0.762208
false positive rate = 0.00866
positive prediction rate = 0.031979
AUC of ROC = 0.872405
AUC of PRC = 0.531113
min(+P, Se) = 0.494715

-------------------------------

==>predicting on validation



confusion matrix:
[[216   2]
 [ 15   4]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.07415799796581268
difference in average predicted and observed risk = -0.006011002034187321
number samples = 237
accuracy = 0.92827
precision class 0 = 0.935065
precision class 1 = 0.666667
recall class 0 = 0.990826
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.009174
positive prediction rate = 0.025316
AUC of ROC = 0.899565
AUC of PRC = 0.465087
min(+P, Se) = 0.526316

-------------------------------

confusion matrix:
[[384   1]
 [ 41   6]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.07378199696540833
difference in average predicted and observed risk = -0.03501400303459168
number samples = 432
accuracy = 0.902778
precision class 0 = 0.903529
precision class 1 = 0.857143
recall class 0 = 0.997403
recall class 1 = 0.12766
false negative rate = 0.87234
false positive rate = 0.002597
positive prediction rate = 0.016204
AUC of ROC = 0.840398
AUC of PRC = 0.478966
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[103   2]
 [  8   5]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.11253999918699265
difference in average predicted and observed risk = 0.0023709991869926422
number samples = 118
accuracy = 0.915254
precision class 0 = 0.927928
precision class 1 = 0.714286
recall class 0 = 0.980952
recall class 1 = 0.384615
false negative rate = 0.615385
false positive rate = 0.019048
positive prediction rate = 0.059322
AUC of ROC = 0.848352
AUC of PRC = 0.512192
min(+P, Se) = 0.538462

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11433599889278412
difference in average predicted and observed risk = -0.01899700110721589
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.980769
AUC of PRC = 0.908333
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 34   5]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.08794300258159637
difference in average predicted and observed risk = -0.02710099741840362
number samples = 339
accuracy = 0.893805
precision class 0 = 0.89759
precision class 1 = 0.714286
recall class 0 = 0.993333
recall class 1 = 0.128205
false negative rate = 0.871795
false positive rate = 0.006667
positive prediction rate = 0.020649
AUC of ROC = 0.82906
AUC of PRC = 0.414088
min(+P, Se) = 0.461538

-------------------------------

confusion matrix:
[[431   3]
 [ 31  13]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.07603800296783447
difference in average predicted and observed risk = -0.016011997032165534
number samples = 478
accuracy = 0.92887
precision class 0 = 0.9329
precision class 1 = 0.8125
recall class 0 = 0.993088
recall class 1 = 0.295455
false negative rate = 0.704545
false positive rate = 0.006912
positive prediction rate = 0.033473
AUC of ROC = 0.883169
AUC of PRC = 0.556554
min(+P, Se) = 0.568182

-------------------------------

confusion matrix:
[[387   1]
 [ 30   8]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.061576999723911285
difference in average predicted and observed risk = -0.027625000276088718
number samples = 426
accuracy = 0.92723
precision class 0 = 0.928058
precision class 1 = 0.888889
recall class 0 = 0.997423
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.002577
positive prediction rate = 0.021127
AUC of ROC = 0.881579
AUC of PRC = 0.536542
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[89  1]
 [ 6  6]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10584799945354462
difference in average predicted and observed risk = -0.011799000546455385
number samples = 102
accuracy = 0.931373
precision class 0 = 0.936842
precision class 1 = 0.857143
recall class 0 = 0.988889
recall class 1 = 0.5
false negative rate = 0.5
false positive rate = 0.011111
positive prediction rate = 0.068627
AUC of ROC = 0.892593
AUC of PRC = 0.666674
min(+P, Se) = 0.615385

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.08404599875211716
difference in average predicted and observed risk = -0.00466400124788284
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.836685
AUC of PRC = 0.241513
min(+P, Se) = 0.333333

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.11077199876308441
difference in average predicted and observed risk = -0.03883400123691558
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.834795
AUC of PRC = 0.574051
min(+P, Se) = 0.578947

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.12213200330734253
difference in average predicted and observed risk = 0.043185003307342526
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.838095
AUC of PRC = 0.185847
min(+P, Se) = 0.3

-------------------------------

confusion matrix:
[[729   5]
 [ 65  18]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.08097799867391586
difference in average predicted and observed risk = -0.020613001326084138
number samples = 817
accuracy = 0.914321
precision class 0 = 0.918136
precision class 1 = 0.782609
recall class 0 = 0.993188
recall class 1 = 0.216867
false negative rate = 0.783133
false positive rate = 0.006812
positive prediction rate = 0.028152
AUC of ROC = 0.862743
AUC of PRC = 0.492153
min(+P, Se) = 0.505747

-------------------------------

Epoch 00099: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch99.state
Epoch 100/100
 - 307s - loss: 0.2481 - val_loss: 0.2337

==>predicting on train



confusion matrix:
[[2138   17]
 [ 201   54]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.105809
average predicted risk of IHM = 0.09841900318861008
difference in average predicted and observed risk = -0.007389996811389923
number samples = 2410
accuracy = 0.909544
precision class 0 = 0.914066
precision class 1 = 0.760563
recall class 0 = 0.992111
recall class 1 = 0.211765
false negative rate = 0.788235
false positive rate = 0.007889
positive prediction rate = 0.029461
AUC of ROC = 0.863782
AUC of PRC = 0.515615
min(+P, Se) = 0.490196

-------------------------------

confusion matrix:
[[1173    6]
 [  94   24]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.090979
average predicted risk of IHM = 0.08909399807453156
difference in average predicted and observed risk = -0.0018850019254684491
number samples = 1297
accuracy = 0.922899
precision class 0 = 0.925809
precision class 1 = 0.8
recall class 0 = 0.994911
recall class 1 = 0.20339
false negative rate = 0.79661
false positive rate = 0.005089
positive prediction rate = 0.02313
AUC of ROC = 0.881342
AUC of PRC = 0.519673
min(+P, Se) = 0.483051

-------------------------------

confusion matrix:
[[653   3]
 [ 58  16]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.10137
average predicted risk of IHM = 0.09588699787855148
difference in average predicted and observed risk = -0.005483002121448519
number samples = 730
accuracy = 0.916438
precision class 0 = 0.918425
precision class 1 = 0.842105
recall class 0 = 0.995427
recall class 1 = 0.216216
false negative rate = 0.783784
false positive rate = 0.004573
positive prediction rate = 0.026027
AUC of ROC = 0.895023
AUC of PRC = 0.585897
min(+P, Se) = 0.533333

-------------------------------

confusion matrix:
[[166   1]
 [ 11  13]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.125654
average predicted risk of IHM = 0.10946699976921082
difference in average predicted and observed risk = -0.016187000230789172
number samples = 191
accuracy = 0.937173
precision class 0 = 0.937853
precision class 1 = 0.928571
recall class 0 = 0.994012
recall class 1 = 0.541667
false negative rate = 0.458333
false positive rate = 0.005988
positive prediction rate = 0.073298
AUC of ROC = 0.968064
AUC of PRC = 0.847491
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[2459   15]
 [ 200   55]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.093441
average predicted risk of IHM = 0.08818600326776505
difference in average predicted and observed risk = -0.005254996732234951
number samples = 2729
accuracy = 0.921217
precision class 0 = 0.924784
precision class 1 = 0.785714
recall class 0 = 0.993937
recall class 1 = 0.215686
false negative rate = 0.784314
false positive rate = 0.006063
positive prediction rate = 0.02565
AUC of ROC = 0.874157
AUC of PRC = 0.507071
min(+P, Se) = 0.480469

-------------------------------

confusion matrix:
[[1671   12]
 [ 164   52]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.113744
average predicted risk of IHM = 0.10689400136470795
difference in average predicted and observed risk = -0.006849998635292051
number samples = 1899
accuracy = 0.90732
precision class 0 = 0.910627
precision class 1 = 0.8125
recall class 0 = 0.99287
recall class 1 = 0.240741
false negative rate = 0.759259
false positive rate = 0.00713
positive prediction rate = 0.033702
AUC of ROC = 0.885082
AUC of PRC = 0.588303
min(+P, Se) = 0.532407

-------------------------------

confusion matrix:
[[545   4]
 [ 66  11]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.123003
average predicted risk of IHM = 0.1140270009636879
difference in average predicted and observed risk = -0.008975999036312104
number samples = 626
accuracy = 0.888179
precision class 0 = 0.89198
precision class 1 = 0.733333
recall class 0 = 0.992714
recall class 1 = 0.142857
false negative rate = 0.857143
false positive rate = 0.007286
positive prediction rate = 0.023962
AUC of ROC = 0.873418
AUC of PRC = 0.526591
min(+P, Se) = 0.532468

-------------------------------

confusion matrix:
[[2237   12]
 [ 173   35]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.084656
average predicted risk of IHM = 0.0803930014371872
difference in average predicted and observed risk = -0.0042629985628128
number samples = 2457
accuracy = 0.924705
precision class 0 = 0.928216
precision class 1 = 0.744681
recall class 0 = 0.994664
recall class 1 = 0.168269
false negative rate = 0.831731
false positive rate = 0.005336
positive prediction rate = 0.019129
AUC of ROC = 0.877194
AUC of PRC = 0.476797
min(+P, Se) = 0.452381

-------------------------------

confusion matrix:
[[221   2]
 [ 22   3]]

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.100806
average predicted risk of IHM = 0.1063390001654625
difference in average predicted and observed risk = 0.005533000165462487
number samples = 248
accuracy = 0.903226
precision class 0 = 0.909465
precision class 1 = 0.6
recall class 0 = 0.991031
recall class 1 = 0.12
false negative rate = 0.88
false positive rate = 0.008969
positive prediction rate = 0.020161
AUC of ROC = 0.798924
AUC of PRC = 0.329542
min(+P, Se) = 0.36

-------------------------------

confusion matrix:
[[476   5]
 [ 45  37]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.145648
average predicted risk of IHM = 0.13113099336624146
difference in average predicted and observed risk = -0.014517006633758545
number samples = 563
accuracy = 0.91119
precision class 0 = 0.913628
precision class 1 = 0.880952
recall class 0 = 0.989605
recall class 1 = 0.451219
false negative rate = 0.548781
false positive rate = 0.010395
positive prediction rate = 0.0746
AUC of ROC = 0.913924
AUC of PRC = 0.738731
min(+P, Se) = 0.646341

-------------------------------

confusion matrix:
[[651   4]
 [ 58  21]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.107629
average predicted risk of IHM = 0.10156100243330002
difference in average predicted and observed risk = -0.006067997566699984
number samples = 734
accuracy = 0.915531
precision class 0 = 0.918195
precision class 1 = 0.84
recall class 0 = 0.993893
recall class 1 = 0.265823
false negative rate = 0.734177
false positive rate = 0.006107
positive prediction rate = 0.03406
AUC of ROC = 0.87249
AUC of PRC = 0.557586
min(+P, Se) = 0.518987

-------------------------------

confusion matrix:
[[4130   27]
 [ 364  107]]
prevalence of IHM = 0.101772
average predicted risk of IHM = 0.09586299955844879
difference in average predicted and observed risk = -0.00590900044155121
number samples = 4628
accuracy = 0.915514
precision class 0 = 0.919003
precision class 1 = 0.798507
recall class 0 = 0.993505
recall class 1 = 0.227176
false negative rate = 0.772824
false positive rate = 0.006495
positive prediction rate = 0.028954
AUC of ROC = 0.879325
AUC of PRC = 0.544824
min(+P, Se) = 0.503185

-------------------------------

==>predicting on validation



confusion matrix:
[[215   3]
 [ 17   2]]

stratified metric for:
demographic variable: Insurance
value: Private

overall metrics:
prevalence of IHM = 0.080169
average predicted risk of IHM = 0.08570399880409241
difference in average predicted and observed risk = 0.005534998804092403
number samples = 237
accuracy = 0.915612
precision class 0 = 0.926724
precision class 1 = 0.4
recall class 0 = 0.986239
recall class 1 = 0.105263
false negative rate = 0.894737
false positive rate = 0.013761
positive prediction rate = 0.021097
AUC of ROC = 0.889667
AUC of PRC = 0.461285
min(+P, Se) = 0.5

-------------------------------

confusion matrix:
[[384   1]
 [ 43   4]]

stratified metric for:
demographic variable: Insurance
value: Medicare

overall metrics:
prevalence of IHM = 0.108796
average predicted risk of IHM = 0.08739399909973145
difference in average predicted and observed risk = -0.02140200090026856
number samples = 432
accuracy = 0.898148
precision class 0 = 0.899297
precision class 1 = 0.8
recall class 0 = 0.997403
recall class 1 = 0.085106
false negative rate = 0.914894
false positive rate = 0.002597
positive prediction rate = 0.011574
AUC of ROC = 0.850511
AUC of PRC = 0.463619
min(+P, Se) = 0.490196

-------------------------------

confusion matrix:
[[103   2]
 [  9   4]]

stratified metric for:
demographic variable: Insurance
value: Medicaid

overall metrics:
prevalence of IHM = 0.110169
average predicted risk of IHM = 0.12033899873495102
difference in average predicted and observed risk = 0.010169998734951016
number samples = 118
accuracy = 0.90678
precision class 0 = 0.919643
precision class 1 = 0.666667
recall class 0 = 0.980952
recall class 1 = 0.307692
false negative rate = 0.692308
false positive rate = 0.019048
positive prediction rate = 0.050847
AUC of ROC = 0.895971
AUC of PRC = 0.532596
min(+P, Se) = 0.466667

-------------------------------

confusion matrix:
[[26  0]
 [ 1  3]]

stratified metric for:
demographic variable: Insurance
value: Other

overall metrics:
prevalence of IHM = 0.133333
average predicted risk of IHM = 0.11641799658536911
difference in average predicted and observed risk = -0.016915003414630897
number samples = 30
accuracy = 0.966667
precision class 0 = 0.962963
precision class 1 = 1.0
recall class 0 = 1.0
recall class 1 = 0.75
false negative rate = 0.25
false positive rate = 0.0
positive prediction rate = 0.1
AUC of ROC = 0.971154
AUC of PRC = 0.883929
min(+P, Se) = 0.75

-------------------------------

confusion matrix:
[[298   2]
 [ 36   3]]

stratified metric for:
demographic variable: Gender
value: F

overall metrics:
prevalence of IHM = 0.115044
average predicted risk of IHM = 0.10243400186300278
difference in average predicted and observed risk = -0.012609998136997216
number samples = 339
accuracy = 0.887906
precision class 0 = 0.892216
precision class 1 = 0.6
recall class 0 = 0.993333
recall class 1 = 0.076923
false negative rate = 0.923077
false positive rate = 0.006667
positive prediction rate = 0.014749
AUC of ROC = 0.848376
AUC of PRC = 0.417432
min(+P, Se) = 0.456522

-------------------------------

confusion matrix:
[[430   4]
 [ 34  10]]

stratified metric for:
demographic variable: Gender
value: M

overall metrics:
prevalence of IHM = 0.09205
average predicted risk of IHM = 0.0858440026640892
difference in average predicted and observed risk = -0.006205997335910804
number samples = 478
accuracy = 0.920502
precision class 0 = 0.926724
precision class 1 = 0.714286
recall class 0 = 0.990783
recall class 1 = 0.227273
false negative rate = 0.772727
false positive rate = 0.009217
positive prediction rate = 0.029289
AUC of ROC = 0.888825
AUC of PRC = 0.552975
min(+P, Se) = 0.531915

-------------------------------

confusion matrix:
[[386   2]
 [ 32   6]]

stratified metric for:
demographic variable: Ethnicity
value: WHITE

overall metrics:
prevalence of IHM = 0.089202
average predicted risk of IHM = 0.07375899702310562
difference in average predicted and observed risk = -0.015443002976894382
number samples = 426
accuracy = 0.920188
precision class 0 = 0.923445
precision class 1 = 0.75
recall class 0 = 0.994845
recall class 1 = 0.157895
false negative rate = 0.842105
false positive rate = 0.005155
positive prediction rate = 0.018779
AUC of ROC = 0.886734
AUC of PRC = 0.502808
min(+P, Se) = 0.512821

-------------------------------

confusion matrix:
[[89  1]
 [ 9  3]]

stratified metric for:
demographic variable: Ethnicity
value: OTHER

overall metrics:
prevalence of IHM = 0.117647
average predicted risk of IHM = 0.10567399859428406
difference in average predicted and observed risk = -0.011973001405715944
number samples = 102
accuracy = 0.901961
precision class 0 = 0.908163
precision class 1 = 0.75
recall class 0 = 0.988889
recall class 1 = 0.25
false negative rate = 0.75
false positive rate = 0.011111
positive prediction rate = 0.039216
AUC of ROC = 0.910185
AUC of PRC = 0.650838
min(+P, Se) = 0.642857

-------------------------------

confusion matrix:
[[112   1]
 [ 11   0]]

stratified metric for:
demographic variable: Ethnicity
value: ASIAN

overall metrics:
prevalence of IHM = 0.08871
average predicted risk of IHM = 0.10346300154924393
difference in average predicted and observed risk = 0.01475300154924393
number samples = 124
accuracy = 0.903226
precision class 0 = 0.910569
precision class 1 = 0.0
recall class 0 = 0.99115
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.00885
positive prediction rate = 0.008065
AUC of ROC = 0.84473
AUC of PRC = 0.249658
min(+P, Se) = 0.352941

-------------------------------

confusion matrix:
[[106   2]
 [ 15   4]]

stratified metric for:
demographic variable: Ethnicity
value: HISPANIC

overall metrics:
prevalence of IHM = 0.149606
average predicted risk of IHM = 0.12031800299882889
difference in average predicted and observed risk = -0.0292879970011711
number samples = 127
accuracy = 0.866142
precision class 0 = 0.876033
precision class 1 = 0.666667
recall class 0 = 0.981481
recall class 1 = 0.210526
false negative rate = 0.789474
false positive rate = 0.018519
positive prediction rate = 0.047244
AUC of ROC = 0.861111
AUC of PRC = 0.623236
min(+P, Se) = 0.631579

-------------------------------

confusion matrix:
[[35  0]
 [ 3  0]]
/share/pi/boussard/eroosli_work/benchmarking/models/evaluation/metrics.py:34: RuntimeWarning: invalid value encountered in float_scalars
  prec1 = np.round(float(cf[1][1] / (cf[1][1] + cf[0][1])),6)

stratified metric for:
demographic variable: Ethnicity
value: BLACK

overall metrics:
prevalence of IHM = 0.078947
average predicted risk of IHM = 0.14338800311088562
difference in average predicted and observed risk = 0.06444100311088562
number samples = 38
accuracy = 0.921053
precision class 0 = 0.921053
precision class 1 = nan
recall class 0 = 1.0
recall class 1 = 0.0
false negative rate = 1.0
false positive rate = 0.0
positive prediction rate = 0.0
AUC of ROC = 0.809524
AUC of PRC = 0.163173
min(+P, Se) = 0.25

-------------------------------

confusion matrix:
[[728   6]
 [ 70  13]]
prevalence of IHM = 0.101591
average predicted risk of IHM = 0.09272799640893936
difference in average predicted and observed risk = -0.00886300359106064
number samples = 817
accuracy = 0.906977
precision class 0 = 0.912281
precision class 1 = 0.684211
recall class 0 = 0.991826
recall class 1 = 0.156627
false negative rate = 0.843373
false positive rate = 0.008174
positive prediction rate = 0.023256
AUC of ROC = 0.873116
AUC of PRC = 0.485733
min(+P, Se) = 0.494382

-------------------------------

Epoch 00100: saving model to models/outputs/starr/keras_states/2020-06-01_10-11/k_clstms.none.epoch100.state
